2025-07-29 14:51:46,877	INFO worker.py:1917 -- Started a local Ray instance.
[36m(TaskRunner pid=2893537)[0m TaskRunner hostname: node3006, PID: 2893537
[36m(TaskRunner pid=2893537)[0m {'actor_rollout_ref': {'actor': {'_target_': 'verl.workers.config.FSDPActorConfig',
[36m(TaskRunner pid=2893537)[0m                                  'checkpoint': {'_target_': 'verl.trainer.config.CheckpointConfig',
[36m(TaskRunner pid=2893537)[0m                                                 'async_save': False,
[36m(TaskRunner pid=2893537)[0m                                                 'load_contents': ['model',
[36m(TaskRunner pid=2893537)[0m                                                                   'optimizer',
[36m(TaskRunner pid=2893537)[0m                                                                   'extra'],
[36m(TaskRunner pid=2893537)[0m                                                 'save_contents': ['model',
[36m(TaskRunner pid=2893537)[0m                                                                   'optimizer',
[36m(TaskRunner pid=2893537)[0m                                                                   'extra']},
[36m(TaskRunner pid=2893537)[0m                                  'clip_ratio': 0.2,
[36m(TaskRunner pid=2893537)[0m                                  'clip_ratio_c': 3.0,
[36m(TaskRunner pid=2893537)[0m                                  'clip_ratio_high': 0.2,
[36m(TaskRunner pid=2893537)[0m                                  'clip_ratio_low': 0.2,
[36m(TaskRunner pid=2893537)[0m                                  'entropy_checkpointing': False,
[36m(TaskRunner pid=2893537)[0m                                  'entropy_coeff': 0.001,
[36m(TaskRunner pid=2893537)[0m                                  'entropy_from_logits_with_chunking': False,
[36m(TaskRunner pid=2893537)[0m                                  'fsdp_config': {'_target_': 'verl.workers.config.FSDPEngineConfig',
[36m(TaskRunner pid=2893537)[0m                                                  'forward_prefetch': False,
[36m(TaskRunner pid=2893537)[0m                                                  'fsdp_size': -1,
[36m(TaskRunner pid=2893537)[0m                                                  'offload_policy': False,
[36m(TaskRunner pid=2893537)[0m                                                  'optimizer_offload': False,
[36m(TaskRunner pid=2893537)[0m                                                  'param_offload': False,
[36m(TaskRunner pid=2893537)[0m                                                  'reshard_after_forward': True,
[36m(TaskRunner pid=2893537)[0m                                                  'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=2893537)[0m                                  'grad_clip': 1.0,
[36m(TaskRunner pid=2893537)[0m                                  'kl_loss_coef': 0.001,
[36m(TaskRunner pid=2893537)[0m                                  'kl_loss_type': 'low_var_kl',
[36m(TaskRunner pid=2893537)[0m                                  'loss_agg_mode': 'token-mean',
[36m(TaskRunner pid=2893537)[0m                                  'optim': {'_target_': 'verl.workers.config.FSDPOptimizerConfig',
[36m(TaskRunner pid=2893537)[0m                                            'lr': 1e-06,
[36m(TaskRunner pid=2893537)[0m                                            'lr_warmup_steps': -1,
[36m(TaskRunner pid=2893537)[0m                                            'lr_warmup_steps_ratio': 0.0,
[36m(TaskRunner pid=2893537)[0m                                            'min_lr_ratio': 0.0,
[36m(TaskRunner pid=2893537)[0m                                            'num_cycles': 0.5,
[36m(TaskRunner pid=2893537)[0m                                            'total_training_steps': -1,
[36m(TaskRunner pid=2893537)[0m                                            'warmup_style': 'constant',
[36m(TaskRunner pid=2893537)[0m                                            'weight_decay': 0.01},
[36m(TaskRunner pid=2893537)[0m                                  'policy_loss': {'_target_': 'verl.workers.config.PolicyLossConfig',
[36m(TaskRunner pid=2893537)[0m                                                  'clip_cov_lb': 1.0,
[36m(TaskRunner pid=2893537)[0m                                                  'clip_cov_ratio': 0.0002,
[36m(TaskRunner pid=2893537)[0m                                                  'clip_cov_ub': 5.0,
[36m(TaskRunner pid=2893537)[0m                                                  'kl_cov_ratio': 0.0002,
[36m(TaskRunner pid=2893537)[0m                                                  'loss_mode': 'vanilla',
[36m(TaskRunner pid=2893537)[0m                                                  'ppo_kl_coef': 0.1},
[36m(TaskRunner pid=2893537)[0m                                  'ppo_epochs': 1,
[36m(TaskRunner pid=2893537)[0m                                  'ppo_max_token_len_per_gpu': 16384,
[36m(TaskRunner pid=2893537)[0m                                  'ppo_micro_batch_size': None,
[36m(TaskRunner pid=2893537)[0m                                  'ppo_micro_batch_size_per_gpu': 4,
[36m(TaskRunner pid=2893537)[0m                                  'ppo_mini_batch_size': 64,
[36m(TaskRunner pid=2893537)[0m                                  'shuffle': True,
[36m(TaskRunner pid=2893537)[0m                                  'strategy': 'fsdp',
[36m(TaskRunner pid=2893537)[0m                                  'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=2893537)[0m                                  'use_dynamic_bsz': False,
[36m(TaskRunner pid=2893537)[0m                                  'use_fused_kernels': False,
[36m(TaskRunner pid=2893537)[0m                                  'use_kl_loss': False,
[36m(TaskRunner pid=2893537)[0m                                  'use_remove_padding': False,
[36m(TaskRunner pid=2893537)[0m                                  'use_torch_compile': True},
[36m(TaskRunner pid=2893537)[0m                        'hybrid_engine': True,
[36m(TaskRunner pid=2893537)[0m                        'model': {'custom_chat_template': None,
[36m(TaskRunner pid=2893537)[0m                                  'enable_activation_offload': False,
[36m(TaskRunner pid=2893537)[0m                                  'enable_gradient_checkpointing': False,
[36m(TaskRunner pid=2893537)[0m                                  'exclude_modules': None,
[36m(TaskRunner pid=2893537)[0m                                  'external_lib': None,
[36m(TaskRunner pid=2893537)[0m                                  'fused_kernel_options': {'impl_backend': 'torch'},
[36m(TaskRunner pid=2893537)[0m                                  'lora_alpha': 16,
[36m(TaskRunner pid=2893537)[0m                                  'lora_rank': 0,
[36m(TaskRunner pid=2893537)[0m                                  'override_config': {},
[36m(TaskRunner pid=2893537)[0m                                  'path': 'Qwen/Qwen2.5-0.5B-Instruct',
[36m(TaskRunner pid=2893537)[0m                                  'target_modules': 'all-linear',
[36m(TaskRunner pid=2893537)[0m                                  'trust_remote_code': False,
[36m(TaskRunner pid=2893537)[0m                                  'use_fused_kernels': False,
[36m(TaskRunner pid=2893537)[0m                                  'use_liger': False,
[36m(TaskRunner pid=2893537)[0m                                  'use_remove_padding': False,
[36m(TaskRunner pid=2893537)[0m                                  'use_shm': False},
[36m(TaskRunner pid=2893537)[0m                        'profiler': {'_target_': 'verl.utils.profiler.ProfilerConfig',
[36m(TaskRunner pid=2893537)[0m                                     'all_ranks': False,
[36m(TaskRunner pid=2893537)[0m                                     'discrete': False,
[36m(TaskRunner pid=2893537)[0m                                     'ranks': []},
[36m(TaskRunner pid=2893537)[0m                        'ref': {'entropy_checkpointing': False,
[36m(TaskRunner pid=2893537)[0m                                'entropy_from_logits_with_chunking': False,
[36m(TaskRunner pid=2893537)[0m                                'fsdp_config': {'_target_': 'verl.workers.config.FSDPEngineConfig',
[36m(TaskRunner pid=2893537)[0m                                                'forward_prefetch': False,
[36m(TaskRunner pid=2893537)[0m                                                'param_offload': True,
[36m(TaskRunner pid=2893537)[0m                                                'reshard_after_forward': True,
[36m(TaskRunner pid=2893537)[0m                                                'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=2893537)[0m                                'log_prob_max_token_len_per_gpu': 16384,
[36m(TaskRunner pid=2893537)[0m                                'log_prob_micro_batch_size': 4,
[36m(TaskRunner pid=2893537)[0m                                'log_prob_micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=2893537)[0m                                'log_prob_use_dynamic_bsz': False,
[36m(TaskRunner pid=2893537)[0m                                'strategy': 'fsdp',
[36m(TaskRunner pid=2893537)[0m                                'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=2893537)[0m                                'use_torch_compile': True},
[36m(TaskRunner pid=2893537)[0m                        'rollout': {'agent': {'agent_loop_config_path': None,
[36m(TaskRunner pid=2893537)[0m                                              'custom_async_server': {'name': None,
[36m(TaskRunner pid=2893537)[0m                                                                      'path': None},
[36m(TaskRunner pid=2893537)[0m                                              'num_workers': 8},
[36m(TaskRunner pid=2893537)[0m                                    'calculate_log_probs': False,
[36m(TaskRunner pid=2893537)[0m                                    'disable_log_stats': True,
[36m(TaskRunner pid=2893537)[0m                                    'do_sample': True,
[36m(TaskRunner pid=2893537)[0m                                    'dtype': 'bfloat16',
[36m(TaskRunner pid=2893537)[0m                                    'enable_chunked_prefill': True,
[36m(TaskRunner pid=2893537)[0m                                    'enforce_eager': True,
[36m(TaskRunner pid=2893537)[0m                                    'engine_kwargs': {'sglang': {'attention_backend': None},
[36m(TaskRunner pid=2893537)[0m                                                      'vllm': {'disable_mm_preprocessor_cache': False,
[36m(TaskRunner pid=2893537)[0m                                                               'swap_space': None}},
[36m(TaskRunner pid=2893537)[0m                                    'free_cache_engine': True,
[36m(TaskRunner pid=2893537)[0m                                    'gpu_memory_utilization': 0.4,
[36m(TaskRunner pid=2893537)[0m                                    'ignore_eos': False,
[36m(TaskRunner pid=2893537)[0m                                    'layered_summon': False,
[36m(TaskRunner pid=2893537)[0m                                    'load_format': 'dummy_dtensor',
[36m(TaskRunner pid=2893537)[0m                                    'log_prob_max_token_len_per_gpu': 16384,
[36m(TaskRunner pid=2893537)[0m                                    'log_prob_micro_batch_size': 4,
[36m(TaskRunner pid=2893537)[0m                                    'log_prob_micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=2893537)[0m                                    'log_prob_use_dynamic_bsz': False,
[36m(TaskRunner pid=2893537)[0m                                    'max_model_len': None,
[36m(TaskRunner pid=2893537)[0m                                    'max_num_batched_tokens': 8192,
[36m(TaskRunner pid=2893537)[0m                                    'max_num_seqs': 1024,
[36m(TaskRunner pid=2893537)[0m                                    'mode': 'sync',
[36m(TaskRunner pid=2893537)[0m                                    'multi_stage_wake_up': False,
[36m(TaskRunner pid=2893537)[0m                                    'multi_turn': {'enable': False,
[36m(TaskRunner pid=2893537)[0m                                                   'format': 'hermes',
[36m(TaskRunner pid=2893537)[0m                                                   'interaction_config_path': None,
[36m(TaskRunner pid=2893537)[0m                                                   'max_assistant_turns': None,
[36m(TaskRunner pid=2893537)[0m                                                   'max_parallel_calls': 1,
[36m(TaskRunner pid=2893537)[0m                                                   'max_tool_response_length': 256,
[36m(TaskRunner pid=2893537)[0m                                                   'max_user_turns': None,
[36m(TaskRunner pid=2893537)[0m                                                   'tokenization_sanity_check_mode': 'strict',
[36m(TaskRunner pid=2893537)[0m                                                   'tool_config_path': None,
[36m(TaskRunner pid=2893537)[0m                                                   'tool_response_truncate_side': 'middle',
[36m(TaskRunner pid=2893537)[0m                                                   'use_inference_chat_template': False},
[36m(TaskRunner pid=2893537)[0m                                    'n': 1,
[36m(TaskRunner pid=2893537)[0m                                    'name': 'vllm',
[36m(TaskRunner pid=2893537)[0m                                    'prompt_length': 1024,
[36m(TaskRunner pid=2893537)[0m                                    'response_length': 512,
[36m(TaskRunner pid=2893537)[0m                                    'temperature': 1.0,
[36m(TaskRunner pid=2893537)[0m                                    'tensor_model_parallel_size': 1,
[36m(TaskRunner pid=2893537)[0m                                    'top_k': -1,
[36m(TaskRunner pid=2893537)[0m                                    'top_p': 1,
[36m(TaskRunner pid=2893537)[0m                                    'trace': {'backend': None,
[36m(TaskRunner pid=2893537)[0m                                              'token2text': False},
[36m(TaskRunner pid=2893537)[0m                                    'update_weights_bucket_megabytes': 512,
[36m(TaskRunner pid=2893537)[0m                                    'val_kwargs': {'do_sample': False,
[36m(TaskRunner pid=2893537)[0m                                                   'n': 1,
[36m(TaskRunner pid=2893537)[0m                                                   'temperature': 0,
[36m(TaskRunner pid=2893537)[0m                                                   'top_k': -1,
[36m(TaskRunner pid=2893537)[0m                                                   'top_p': 1.0}}},
[36m(TaskRunner pid=2893537)[0m  'algorithm': {'_target_': 'verl.trainer.config.AlgoConfig',
[36m(TaskRunner pid=2893537)[0m                'adv_estimator': 'gae',
[36m(TaskRunner pid=2893537)[0m                'gamma': 1.0,
[36m(TaskRunner pid=2893537)[0m                'kl_ctrl': {'_target_': 'verl.trainer.config.KLControlConfig',
[36m(TaskRunner pid=2893537)[0m                            'horizon': 10000,
[36m(TaskRunner pid=2893537)[0m                            'kl_coef': 0.001,
[36m(TaskRunner pid=2893537)[0m                            'target_kl': 0.1,
[36m(TaskRunner pid=2893537)[0m                            'type': 'fixed'},
[36m(TaskRunner pid=2893537)[0m                'kl_penalty': 'kl',
[36m(TaskRunner pid=2893537)[0m                'lam': 1.0,
[36m(TaskRunner pid=2893537)[0m                'norm_adv_by_std_in_grpo': True,
[36m(TaskRunner pid=2893537)[0m                'pf_ppo': {'reweight_method': 'pow', 'weight_pow': 2.0},
[36m(TaskRunner pid=2893537)[0m                'use_kl_in_reward': False,
[36m(TaskRunner pid=2893537)[0m                'use_pf_ppo': False},
[36m(TaskRunner pid=2893537)[0m  'critic': {'_target_': 'verl.workers.config.FSDPCriticConfig',
[36m(TaskRunner pid=2893537)[0m             'checkpoint': {'_target_': 'verl.trainer.config.CheckpointConfig',
[36m(TaskRunner pid=2893537)[0m                            'async_save': False,
[36m(TaskRunner pid=2893537)[0m                            'load_contents': ['model', 'optimizer', 'extra'],
[36m(TaskRunner pid=2893537)[0m                            'save_contents': ['model', 'optimizer', 'extra']},
[36m(TaskRunner pid=2893537)[0m             'cliprange_value': 0.5,
[36m(TaskRunner pid=2893537)[0m             'enable': None,
[36m(TaskRunner pid=2893537)[0m             'forward_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=2893537)[0m             'forward_micro_batch_size': None,
[36m(TaskRunner pid=2893537)[0m             'forward_micro_batch_size_per_gpu': 1,
[36m(TaskRunner pid=2893537)[0m             'grad_clip': 1.0,
[36m(TaskRunner pid=2893537)[0m             'loss_agg_mode': 'token-mean',
[36m(TaskRunner pid=2893537)[0m             'model': {'_target_': 'verl.workers.config.FSDPCriticModelCfg',
[36m(TaskRunner pid=2893537)[0m                       'enable_activation_offload': False,
[36m(TaskRunner pid=2893537)[0m                       'enable_gradient_checkpointing': False,
[36m(TaskRunner pid=2893537)[0m                       'external_lib': None,
[36m(TaskRunner pid=2893537)[0m                       'fsdp_config': {'_target_': 'verl.workers.config.FSDPEngineConfig',
[36m(TaskRunner pid=2893537)[0m                                       'forward_prefetch': False,
[36m(TaskRunner pid=2893537)[0m                                       'fsdp_size': -1,
[36m(TaskRunner pid=2893537)[0m                                       'offload_policy': False,
[36m(TaskRunner pid=2893537)[0m                                       'optimizer_offload': False,
[36m(TaskRunner pid=2893537)[0m                                       'param_offload': False,
[36m(TaskRunner pid=2893537)[0m                                       'reshard_after_forward': True,
[36m(TaskRunner pid=2893537)[0m                                       'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=2893537)[0m                       'lora_alpha': 16,
[36m(TaskRunner pid=2893537)[0m                       'lora_rank': 0,
[36m(TaskRunner pid=2893537)[0m                       'override_config': {},
[36m(TaskRunner pid=2893537)[0m                       'path': 'Qwen/Qwen2.5-0.5B-Instruct',
[36m(TaskRunner pid=2893537)[0m                       'target_modules': 'all-linear',
[36m(TaskRunner pid=2893537)[0m                       'tokenizer_path': 'Qwen/Qwen2.5-0.5B-Instruct',
[36m(TaskRunner pid=2893537)[0m                       'trust_remote_code': False,
[36m(TaskRunner pid=2893537)[0m                       'use_remove_padding': False,
[36m(TaskRunner pid=2893537)[0m                       'use_shm': False},
[36m(TaskRunner pid=2893537)[0m             'optim': {'_target_': 'verl.workers.config.FSDPOptimizerConfig',
[36m(TaskRunner pid=2893537)[0m                       'lr': 1e-05,
[36m(TaskRunner pid=2893537)[0m                       'lr_warmup_steps': -1,
[36m(TaskRunner pid=2893537)[0m                       'lr_warmup_steps_ratio': 0.0,
[36m(TaskRunner pid=2893537)[0m                       'min_lr_ratio': None,
[36m(TaskRunner pid=2893537)[0m                       'total_training_steps': -1,
[36m(TaskRunner pid=2893537)[0m                       'warmup_style': 'constant',
[36m(TaskRunner pid=2893537)[0m                       'weight_decay': 0.01},
[36m(TaskRunner pid=2893537)[0m             'ppo_epochs': 1,
[36m(TaskRunner pid=2893537)[0m             'ppo_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=2893537)[0m             'ppo_micro_batch_size': None,
[36m(TaskRunner pid=2893537)[0m             'ppo_micro_batch_size_per_gpu': 1,
[36m(TaskRunner pid=2893537)[0m             'ppo_mini_batch_size': 64,
[36m(TaskRunner pid=2893537)[0m             'profiler': {'_target_': 'verl.utils.profiler.ProfilerConfig',
[36m(TaskRunner pid=2893537)[0m                          'all_ranks': False,
[36m(TaskRunner pid=2893537)[0m                          'discrete': False,
[36m(TaskRunner pid=2893537)[0m                          'ranks': []},
[36m(TaskRunner pid=2893537)[0m             'rollout_n': 1,
[36m(TaskRunner pid=2893537)[0m             'shuffle': True,
[36m(TaskRunner pid=2893537)[0m             'strategy': 'fsdp',
[36m(TaskRunner pid=2893537)[0m             'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=2893537)[0m             'use_dynamic_bsz': False},
[36m(TaskRunner pid=2893537)[0m  'custom_reward_function': {'name': 'compute_score',
[36m(TaskRunner pid=2893537)[0m                             'path': '/home/yeopjin/orcd/pool/workspace/RL_NTL/custom_NTL.py'},
[36m(TaskRunner pid=2893537)[0m  'data': {'custom_cls': {'name': None, 'path': None},
[36m(TaskRunner pid=2893537)[0m           'datagen': {'name': None, 'path': None},
[36m(TaskRunner pid=2893537)[0m           'dataloader_num_workers': 8,
[36m(TaskRunner pid=2893537)[0m           'filter_overlong_prompts': False,
[36m(TaskRunner pid=2893537)[0m           'filter_overlong_prompts_workers': 1,
[36m(TaskRunner pid=2893537)[0m           'image_key': 'images',
[36m(TaskRunner pid=2893537)[0m           'max_prompt_length': 1024,
[36m(TaskRunner pid=2893537)[0m           'max_response_length': 512,
[36m(TaskRunner pid=2893537)[0m           'prompt_key': 'prompt',
[36m(TaskRunner pid=2893537)[0m           'return_full_prompt': False,
[36m(TaskRunner pid=2893537)[0m           'return_multi_modal_inputs': True,
[36m(TaskRunner pid=2893537)[0m           'return_raw_chat': False,
[36m(TaskRunner pid=2893537)[0m           'return_raw_input_ids': False,
[36m(TaskRunner pid=2893537)[0m           'reward_fn_key': 'data_source',
[36m(TaskRunner pid=2893537)[0m           'sampler': {'class_name': None, 'class_path': None},
[36m(TaskRunner pid=2893537)[0m           'shuffle': True,
[36m(TaskRunner pid=2893537)[0m           'tokenizer': None,
[36m(TaskRunner pid=2893537)[0m           'train_batch_size': 256,
[36m(TaskRunner pid=2893537)[0m           'train_files': '/home/yeopjin/orcd/pool/workspace/RL_NTL/data/train.parquet',
[36m(TaskRunner pid=2893537)[0m           'truncation': 'error',
[36m(TaskRunner pid=2893537)[0m           'trust_remote_code': False,
[36m(TaskRunner pid=2893537)[0m           'use_shm': False,
[36m(TaskRunner pid=2893537)[0m           'val_batch_size': 1312,
[36m(TaskRunner pid=2893537)[0m           'val_files': '/home/yeopjin/orcd/pool/workspace/RL_NTL/data/test.parquet',
[36m(TaskRunner pid=2893537)[0m           'validation_shuffle': False,
[36m(TaskRunner pid=2893537)[0m           'video_key': 'videos'},
[36m(TaskRunner pid=2893537)[0m  'ray_init': {'num_cpus': None, 'timeline_json_file': None},
[36m(TaskRunner pid=2893537)[0m  'reward_model': {'enable': False,
[36m(TaskRunner pid=2893537)[0m                   'forward_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=2893537)[0m                   'launch_reward_fn_async': False,
[36m(TaskRunner pid=2893537)[0m                   'max_length': None,
[36m(TaskRunner pid=2893537)[0m                   'micro_batch_size': 64,
[36m(TaskRunner pid=2893537)[0m                   'micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=2893537)[0m                   'model': {'external_lib': None,
[36m(TaskRunner pid=2893537)[0m                             'fsdp_config': {'_target_': 'verl.workers.config.FSDPEngineConfig',
[36m(TaskRunner pid=2893537)[0m                                             'forward_prefetch': False,
[36m(TaskRunner pid=2893537)[0m                                             'fsdp_size': -1,
[36m(TaskRunner pid=2893537)[0m                                             'param_offload': False,
[36m(TaskRunner pid=2893537)[0m                                             'reshard_after_forward': True,
[36m(TaskRunner pid=2893537)[0m                                             'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=2893537)[0m                             'input_tokenizer': 'Qwen/Qwen2.5-0.5B-Instruct',
[36m(TaskRunner pid=2893537)[0m                             'path': '~/models/FsfairX-LLaMA3-RM-v0.1',
[36m(TaskRunner pid=2893537)[0m                             'trust_remote_code': False,
[36m(TaskRunner pid=2893537)[0m                             'use_fused_kernels': False,
[36m(TaskRunner pid=2893537)[0m                             'use_remove_padding': False,
[36m(TaskRunner pid=2893537)[0m                             'use_shm': False},
[36m(TaskRunner pid=2893537)[0m                   'profiler': {'_target_': 'verl.utils.profiler.ProfilerConfig',
[36m(TaskRunner pid=2893537)[0m                                'all_ranks': False,
[36m(TaskRunner pid=2893537)[0m                                'discrete': False,
[36m(TaskRunner pid=2893537)[0m                                'ranks': []},
[36m(TaskRunner pid=2893537)[0m                   'reward_manager': 'naive',
[36m(TaskRunner pid=2893537)[0m                   'sandbox_fusion': {'max_concurrent': 64,
[36m(TaskRunner pid=2893537)[0m                                      'memory_limit_mb': 1024,
[36m(TaskRunner pid=2893537)[0m                                      'url': None},
[36m(TaskRunner pid=2893537)[0m                   'strategy': 'fsdp',
[36m(TaskRunner pid=2893537)[0m                   'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=2893537)[0m                   'use_dynamic_bsz': False},
[36m(TaskRunner pid=2893537)[0m  'trainer': {'balance_batch': True,
[36m(TaskRunner pid=2893537)[0m              'controller_nsight_options': {'cuda-graph-trace': 'graph',
[36m(TaskRunner pid=2893537)[0m                                            'cuda-memory-usage': 'true',
[36m(TaskRunner pid=2893537)[0m                                            'trace': 'cuda,nvtx,cublas,ucx'},
[36m(TaskRunner pid=2893537)[0m              'critic_warmup': 0,
[36m(TaskRunner pid=2893537)[0m              'default_hdfs_dir': None,
[36m(TaskRunner pid=2893537)[0m              'default_local_dir': 'checkpoints/RL-NTL/gsm8k-ppo-qwen2.5-0.5b-Jul29',
[36m(TaskRunner pid=2893537)[0m              'del_local_ckpt_after_load': False,
[36m(TaskRunner pid=2893537)[0m              'device': 'cuda',
[36m(TaskRunner pid=2893537)[0m              'esi_redundant_time': 0,
[36m(TaskRunner pid=2893537)[0m              'experiment_name': 'gsm8k-ppo-qwen2.5-0.5b-Jul29',
[36m(TaskRunner pid=2893537)[0m              'log_val_generations': 0,
[36m(TaskRunner pid=2893537)[0m              'logger': ['console', 'wandb'],
[36m(TaskRunner pid=2893537)[0m              'max_actor_ckpt_to_keep': None,
[36m(TaskRunner pid=2893537)[0m              'max_critic_ckpt_to_keep': None,
[36m(TaskRunner pid=2893537)[0m              'mode': 'standard',
[36m(TaskRunner pid=2893537)[0m              'n_gpus_per_node': 4,
[36m(TaskRunner pid=2893537)[0m              'nnodes': 1,
[36m(TaskRunner pid=2893537)[0m              'npu_profile': {'options': {'analysis': True,
[36m(TaskRunner pid=2893537)[0m                                          'level': 'level1',
[36m(TaskRunner pid=2893537)[0m                                          'record_shapes': False,
[36m(TaskRunner pid=2893537)[0m                                          'roles': ['all'],
[36m(TaskRunner pid=2893537)[0m                                          'save_path': './profiler_data',
[36m(TaskRunner pid=2893537)[0m                                          'with_cpu': True,
[36m(TaskRunner pid=2893537)[0m                                          'with_memory': False,
[36m(TaskRunner pid=2893537)[0m                                          'with_module': False,
[36m(TaskRunner pid=2893537)[0m                                          'with_npu': True,
[36m(TaskRunner pid=2893537)[0m                                          'with_stack': False}},
[36m(TaskRunner pid=2893537)[0m              'profile_steps': None,
[36m(TaskRunner pid=2893537)[0m              'project_name': 'RL-NTL',
[36m(TaskRunner pid=2893537)[0m              'ray_wait_register_center_timeout': 300,
[36m(TaskRunner pid=2893537)[0m              'resume_from_path': None,
[36m(TaskRunner pid=2893537)[0m              'resume_mode': 'auto',
[36m(TaskRunner pid=2893537)[0m              'rollout_data_dir': None,
[36m(TaskRunner pid=2893537)[0m              'save_freq': -1,
[36m(TaskRunner pid=2893537)[0m              'test_freq': 10,
[36m(TaskRunner pid=2893537)[0m              'total_epochs': 15,
[36m(TaskRunner pid=2893537)[0m              'total_training_steps': None,
[36m(TaskRunner pid=2893537)[0m              'use_legacy_worker_impl': 'auto',
[36m(TaskRunner pid=2893537)[0m              'val_before_train': True,
[36m(TaskRunner pid=2893537)[0m              'val_only': False,
[36m(TaskRunner pid=2893537)[0m              'validation_data_dir': None,
[36m(TaskRunner pid=2893537)[0m              'worker_nsight_options': {'capture-range': 'cudaProfilerApi',
[36m(TaskRunner pid=2893537)[0m                                        'capture-range-end': None,
[36m(TaskRunner pid=2893537)[0m                                        'cuda-graph-trace': 'graph',
[36m(TaskRunner pid=2893537)[0m                                        'cuda-memory-usage': 'true',
[36m(TaskRunner pid=2893537)[0m                                        'kill': 'none',
[36m(TaskRunner pid=2893537)[0m                                        'trace': 'cuda,nvtx,cublas,ucx'}}}
[36m(TaskRunner pid=2893537)[0m using customized reward function 'compute_score' from '/home/yeopjin/orcd/pool/workspace/RL_NTL/custom_NTL.py'
[36m(TaskRunner pid=2893537)[0m using customized reward function 'compute_score' from '/home/yeopjin/orcd/pool/workspace/RL_NTL/custom_NTL.py'
[36m(TaskRunner pid=2893537)[0m Using dataset class: RLHFDataset
[36m(TaskRunner pid=2893537)[0m dataset len: 7473
[36m(TaskRunner pid=2893537)[0m Using dataset class: RLHFDataset
[36m(TaskRunner pid=2893537)[0m dataset len: 1319
[36m(TaskRunner pid=2893537)[0m WARNING: val_batch_size is deprecated. Validation datasets are sent to inference engines as a whole batch, which will schedule the memory themselves.
[36m(TaskRunner pid=2893537)[0m [validate_config] All configuration checks passed successfully!
[36m(TaskRunner pid=2893537)[0m Size of train dataloader: 29, Size of val dataloader: 2
[36m(TaskRunner pid=2893537)[0m Total training steps: 435
[36m(TaskRunner pid=2893537)[0m colocated worker base class <class 'verl.single_controller.base.worker.Worker'>
[36m(TaskRunner pid=2893537)[0m DeprecationWarning: `ray.state.available_resources_per_node` is a private attribute and access will be removed in a future Ray version.
[36m(TaskRunner pid=2893537)[0m WARNING:2025-07-29 14:51:59,033:Waiting for register center actor 81HTQg_register_center to be ready. Elapsed time: 0 seconds out of 300 seconds.
[36m(WorkerDict pid=2894091)[0m Critic overriding config {'bos_token_id': None, 'eos_token_id': 151645, 'pad_token_id': 151643}
[36m(WorkerDict pid=2894388)[0m Flash Attention 2.0 only supports torch.float16 and torch.bfloat16 dtypes, but the current dype in Qwen2ForTokenClassification is torch.float32. You should run training or inference using Automatic Mixed-Precision via the `with torch.autocast(device_type='torch_device'):` decorator, or load the model with the `torch_dtype` argument. Example: `model = AutoModel.from_pretrained("openai/whisper-tiny", attn_implementation="flash_attention_2", torch_dtype=torch.float16)`
[36m(WorkerDict pid=2894388)[0m You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
[36m(WorkerDict pid=2894388)[0m Skipping monkey patch for Qwen2ForTokenClassification as use_fused_kernels is False or fused_kernels_backend is None
[36m(WorkerDict pid=2894388)[0m Some weights of Qwen2ForTokenClassification were not initialized from the model checkpoint at Qwen/Qwen2.5-0.5B-Instruct and are newly initialized: ['score.bias', 'score.weight']
[36m(WorkerDict pid=2894388)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(WorkerDict pid=2894091)[0m Qwen2ForTokenClassification contains 494.03M parameters
[36m(WorkerDict pid=2894091)[0m Before critic FSDP, memory allocated (GB): 0.00, memory reserved (GB): 0.00, device memory used/total (GB): 0.42/44.52
[36m(WorkerDict pid=2894091)[0m NCCL version 2.21.5+cuda12.4
[36m(WorkerDict pid=2894091)[0m After critic FSDP, memory allocated (GB): 0.46, memory reserved (GB): 2.21, device memory used/total (GB): 2.85/44.52
[36m(WorkerDict pid=2894091)[0m Total steps: 435, num_warmup_steps: 0
[36m(WorkerDict pid=2894091)[0m Critic use_remove_padding=False
[36m(WorkerDict pid=2894091)[0m Model config after override: Qwen2Config {
[36m(WorkerDict pid=2894091)[0m   "architectures": [
[36m(WorkerDict pid=2894091)[0m     "Qwen2ForCausalLM"
[36m(WorkerDict pid=2894091)[0m   ],
[36m(WorkerDict pid=2894091)[0m   "attention_dropout": 0.0,
[36m(WorkerDict pid=2894091)[0m   "eos_token_id": 151645,
[36m(WorkerDict pid=2894091)[0m   "hidden_act": "silu",
[36m(WorkerDict pid=2894091)[0m   "hidden_size": 896,
[36m(WorkerDict pid=2894091)[0m   "initializer_range": 0.02,
[36m(WorkerDict pid=2894091)[0m   "intermediate_size": 4864,
[36m(WorkerDict pid=2894091)[0m   "layer_types": [
[36m(WorkerDict pid=2894091)[0m     "full_attention",
[36m(WorkerDict pid=2894091)[0m     "full_attention",
[36m(WorkerDict pid=2894091)[0m     "full_attention",
[36m(WorkerDict pid=2894091)[0m     "full_attention",
[36m(WorkerDict pid=2894091)[0m     "full_attention",
[36m(WorkerDict pid=2894091)[0m     "full_attention",
[36m(WorkerDict pid=2894091)[0m     "full_attention",
[36m(WorkerDict pid=2894091)[0m     "full_attention",
[36m(WorkerDict pid=2894091)[0m     "full_attention",
[36m(WorkerDict pid=2894091)[0m     "full_attention",
[36m(WorkerDict pid=2894091)[0m     "full_attention",
[36m(WorkerDict pid=2894091)[0m     "full_attention",
[36m(WorkerDict pid=2894091)[0m     "full_attention",
[36m(WorkerDict pid=2894091)[0m     "full_attention",
[36m(WorkerDict pid=2894091)[0m     "full_attention",
[36m(WorkerDict pid=2894091)[0m     "full_attention",
[36m(WorkerDict pid=2894091)[0m     "full_attention",
[36m(WorkerDict pid=2894091)[0m     "full_attention",
[36m(WorkerDict pid=2894091)[0m     "full_attention",
[36m(WorkerDict pid=2894091)[0m     "full_attention",
[36m(WorkerDict pid=2894091)[0m     "full_attention",
[36m(WorkerDict pid=2894091)[0m     "full_attention",
[36m(WorkerDict pid=2894091)[0m     "full_attention",
[36m(WorkerDict pid=2894091)[0m     "full_attention"
[36m(WorkerDict pid=2894091)[0m   ],
[36m(WorkerDict pid=2894091)[0m   "max_position_embeddings": 32768,
[36m(WorkerDict pid=2894091)[0m   "max_window_layers": 21,
[36m(WorkerDict pid=2894091)[0m   "model_type": "qwen2",
[36m(WorkerDict pid=2894091)[0m   "num_attention_heads": 14,
[36m(WorkerDict pid=2894091)[0m   "num_hidden_layers": 24,
[36m(WorkerDict pid=2894091)[0m   "num_key_value_heads": 2,
[36m(WorkerDict pid=2894091)[0m   "pad_token_id": 151643,
[36m(WorkerDict pid=2894091)[0m   "rms_norm_eps": 1e-06,
[36m(WorkerDict pid=2894091)[0m   "rope_scaling": null,
[36m(WorkerDict pid=2894091)[0m   "rope_theta": 1000000.0,
[36m(WorkerDict pid=2894091)[0m   "sliding_window": null,
[36m(WorkerDict pid=2894091)[0m   "tie_word_embeddings": true,
[36m(WorkerDict pid=2894091)[0m   "torch_dtype": "bfloat16",
[36m(WorkerDict pid=2894091)[0m   "transformers_version": "4.53.2",
[36m(WorkerDict pid=2894091)[0m   "use_cache": true,
[36m(WorkerDict pid=2894091)[0m   "use_sliding_window": false,
[36m(WorkerDict pid=2894091)[0m   "vocab_size": 151936
[36m(WorkerDict pid=2894091)[0m }
[36m(WorkerDict pid=2894091)[0m 
[36m(WorkerDict pid=2894387)[0m Skipping monkey patch for Qwen2ForCausalLM as use_fused_kernels is False or fused_kernels_backend is torch
[36m(WorkerDict pid=2894091)[0m Qwen2ForCausalLM contains 494.03M parameters
[36m(WorkerDict pid=2894091)[0m wrap_policy: functools.partial(<function _or_policy at 0x148fbc07f0a0>, policies=[functools.partial(<function transformer_auto_wrap_policy at 0x148fbc07ef80>, transformer_layer_cls={<class 'transformers.models.qwen2.modeling_qwen2.Qwen2DecoderLayer'>})])
[36m(WorkerDict pid=2894091)[0m Total steps: 435, num_warmup_steps: 0
[36m(WorkerDict pid=2894091)[0m Actor use_remove_padding=False
[36m(WorkerDict pid=2894091)[0m Actor use_fused_kernels=False
[36m(WorkerDict pid=2894387)[0m WARNING 07-29 14:52:23 [cuda.py:96] To see benefits of async output processing, enable CUDA graph. Since, enforce-eager is enabled, async output processor cannot be used
[36m(WorkerDict pid=2894091)[0m Skipping monkey patch for Qwen2ForTokenClassification as use_fused_kernels is False or fused_kernels_backend is None[32m [repeated 3x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)[0m
[36m(WorkerDict pid=2894389)[0m Critic use_remove_padding=False[32m [repeated 3x across cluster][0m
[36m(WorkerDict pid=2894388)[0m Skipping monkey patch for Qwen2ForCausalLM as use_fused_kernels is False or fused_kernels_backend is torch[32m [repeated 3x across cluster][0m
[36m(WorkerDict pid=2894387)[0m WARNING 07-29 14:52:23 [utils.py:2444] Methods determine_num_available_blocks,device_config,get_cache_block_size_bytes,initialize_cache not implemented in <vllm.v1.worker.gpu_worker.Worker object at 0x1453f1bd8eb0>
[36m(WorkerDict pid=2894091)[0m WARNING 07-29 14:52:25 [topk_topp_sampler.py:69] FlashInfer is not available. Falling back to the PyTorch-native implementation of top-p & top-k sampling. For the best performance, please install FlashInfer.
[36m(WorkerDict pid=2894091)[0m kwargs: {'n': 1, 'logprobs': 0, 'max_tokens': 512, 'detokenize': False, 'temperature': 1.0, 'top_k': -1, 'top_p': 1, 'ignore_eos': False}
[36m(WorkerDict pid=2894091)[0m /home/yeopjin/orcd/pool/conda_install/envs/ntl/lib/python3.10/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:690: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .
[36m(WorkerDict pid=2894091)[0m   warnings.warn(
[36m(WorkerDict pid=2894388)[0m Flash Attention 2.0 only supports torch.float16 and torch.bfloat16 dtypes, but the current dype in Qwen2ForCausalLM is torch.float32. You should run training or inference using Automatic Mixed-Precision via the `with torch.autocast(device_type='torch_device'):` decorator, or load the model with the `torch_dtype` argument. Example: `model = AutoModel.from_pretrained("openai/whisper-tiny", attn_implementation="flash_attention_2", torch_dtype=torch.float16)`[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2894389)[0m You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.[32m [repeated 3x across cluster][0m
[36m(WorkerDict pid=2894389)[0m Some weights of Qwen2ForTokenClassification were not initialized from the model checkpoint at Qwen/Qwen2.5-0.5B-Instruct and are newly initialized: ['score.bias', 'score.weight'][32m [repeated 3x across cluster][0m
[36m(WorkerDict pid=2894389)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.[32m [repeated 3x across cluster][0m
[36m(TaskRunner pid=2893537)[0m wandb: WARNING Path /nobackup/users/yeopjin/.cache/wandb/wandb/ wasn't writable, using system temp directory
[36m(TaskRunner pid=2893537)[0m wandb: Currently logged in as: sjinyeop to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[36m(TaskRunner pid=2893537)[0m wandb: WARNING Unable to create root directory /nobackup/users/yeopjin/.cache/wandb
[36m(TaskRunner pid=2893537)[0m wandb: WARNING Falling back to temporary directory /tmp.
[36m(TaskRunner pid=2893537)[0m wandb: Tracking run with wandb version 0.21.0
[36m(TaskRunner pid=2893537)[0m wandb: Run data is saved locally in /tmp/wandb/run-20250729_145228-wbise9qx
[36m(TaskRunner pid=2893537)[0m wandb: Run `wandb offline` to turn off syncing.
[36m(TaskRunner pid=2893537)[0m wandb: Syncing run gsm8k-ppo-qwen2.5-0.5b-Jul29
[36m(TaskRunner pid=2893537)[0m wandb: ⭐️ View project at https://wandb.ai/sjinyeop/RL-NTL
[36m(TaskRunner pid=2893537)[0m wandb: 🚀 View run at https://wandb.ai/sjinyeop/RL-NTL/runs/wbise9qx
[36m(TaskRunner pid=2893537)[0m Checkpoint tracker file does not exist: /orcd/pool/006/yeopjin/workspace/RL_NTL/checkpoints/RL-NTL/gsm8k-ppo-qwen2.5-0.5b-Jul29/latest_checkpointed_iteration.txt
[36m(TaskRunner pid=2893537)[0m Training from scratch
[36m(WorkerDict pid=2894091)[0m WARNING 07-29 14:52:23 [cuda.py:96] To see benefits of async output processing, enable CUDA graph. Since, enforce-eager is enabled, async output processor cannot be used[32m [repeated 3x across cluster][0m
[36m(WorkerDict pid=2894091)[0m WARNING 07-29 14:52:24 [utils.py:2444] Methods determine_num_available_blocks,device_config,get_cache_block_size_bytes,initialize_cache not implemented in <vllm.v1.worker.gpu_worker.Worker object at 0x148e9699d360>[32m [repeated 3x across cluster][0m
[36m(TaskRunner pid=2893537)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 0}
[36m(WorkerDict pid=2894389)[0m WARNING 07-29 14:52:25 [topk_topp_sampler.py:69] FlashInfer is not available. Falling back to the PyTorch-native implementation of top-p & top-k sampling. For the best performance, please install FlashInfer.[32m [repeated 3x across cluster][0m
[36m(TaskRunner pid=2893537)[0m validation generation end
[36m(WorkerDict pid=2894389)[0m kwargs: {'n': 1, 'logprobs': 0, 'max_tokens': 512, 'detokenize': False, 'temperature': 1.0, 'top_k': -1, 'top_p': 1, 'ignore_eos': False}[32m [repeated 3x across cluster][0m
[36m(TaskRunner pid=2893537)[0m [prompt] system
[36m(TaskRunner pid=2893537)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2893537)[0m user
[36m(TaskRunner pid=2893537)[0m Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and bakes muffins for her friends every day with four. She sells the remainder at the farmers' market daily for $2 per fresh duck egg. How much in dollars does she make every day at the farmers' market? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2893537)[0m assistant
[36m(TaskRunner pid=2893537)[0m 
[36m(TaskRunner pid=2893537)[0m [response] To determine how much Janet makes at the farmers' market every day, we need to follow these steps:
[36m(TaskRunner pid=2893537)[0m 
[36m(TaskRunner pid=2893537)[0m 1. **Calculate the total number of eggs laid by the ducks in a day:**
[36m(TaskRunner pid=2893537)[0m    - Janet's ducks lay 16 eggs per day.
[36m(TaskRunner pid=2893537)[0m 
[36m(TaskRunner pid=2893537)[0m 2. **Calculate the total number of eggs Janet eats in a day:**
[36m(TaskRunner pid=2893537)[0m    - Janet eats 3 eggs for breakfast.
[36m(TaskRunner pid=2893537)[0m    - She eats 4 muffins for baking.
[36m(TaskRunner pid=2893537)[0m    - Therefore, the total number of eggs she eats in a day is:
[36m(TaskRunner pid=2893537)[0m      \[
[36m(TaskRunner pid=2893537)[0m      3 \text{ (breakfast)} + 4 \text{ (baking)} = 7 \text{ eggs}
[36m(TaskRunner pid=2893537)[0m      \]
[36m(TaskRunner pid=2893537)[0m 
[36m(TaskRunner pid=2893537)[0m 3. **Calculate the number of eggs Janet sells at the farmers' market:**
[36m(TaskRunner pid=2893537)[0m    - The total number of eggs laid by the ducks is 16.
[36m(TaskRunner pid=2893537)[0m    - The number of eggs she eats is 7.
[36m(TaskRunner pid=2893537)[0m    - Therefore, the number of eggs she sells is:
[36m(TaskRunner pid=2893537)[0m      \[
[36m(TaskRunner pid=2893537)[0m      16 \text{ (total)} - 7 \text{ (eaten)} = 9 \text{ eggs}
[36m(TaskRunner pid=2893537)[0m      \]
[36m(TaskRunner pid=2893537)[0m 
[36m(TaskRunner pid=2893537)[0m 4. **Calculate the total revenue from selling the eggs at the farmers' market:**
[36m(TaskRunner pid=2893537)[0m    - Janet sells each egg for $2.
[36m(TaskRunner pid=2893537)[0m    - The number of eggs sold is 9.
[36m(TaskRunner pid=2893537)[0m    - Therefore, the total revenue is:
[36m(TaskRunner pid=2893537)[0m      \[
[36m(TaskRunner pid=2893537)[0m      9 \text{ eggs} \times 2 \text{ dollars/egg} = 18 \text{ dollars}
[36m(TaskRunner pid=2893537)[0m      \]
[36m(TaskRunner pid=2893537)[0m 
[36m(TaskRunner pid=2893537)[0m Thus, Janet makes \(\boxed{18}\) dollars every day at the farmers' market.
[36m(TaskRunner pid=2893537)[0m [ground_truth] 18
[36m(TaskRunner pid=2893537)[0m [score] 0.0
[36m(TaskRunner pid=2893537)[0m len reward_extra_infos_dict['reward']: 1312
[36m(TaskRunner pid=2893537)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 0}
[36m(TaskRunner pid=2893537)[0m validation generation end
[36m(TaskRunner pid=2893537)[0m [prompt] system
[36m(TaskRunner pid=2893537)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2893537)[0m user
[36m(TaskRunner pid=2893537)[0m Tom's restaurant gets 6 reservations a night.  They normally order 2 meals that cost $5 each and a $5 bottle of wine.  How much do they make a week if they are open 2 days a week? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2893537)[0m assistant
[36m(TaskRunner pid=2893537)[0m 
[36m(TaskRunner pid=2893537)[0m [response] To determine how much Tom's restaurant makes in a week, we need to calculate the total number of reservations and the total revenue from these reservations. Here's the step-by-step process:
[36m(TaskRunner pid=2893537)[0m 
[36m(TaskRunner pid=2893537)[0m 1. **Calculate the total number of reservations per night:**
[36m(TaskRunner pid=2893537)[0m    - Tom's restaurant gets 6 reservations a night.
[36m(TaskRunner pid=2893537)[0m 
[36m(TaskRunner pid=2893537)[0m 2. **Calculate the total number of reservations per week:**
[36m(TaskRunner pid=2893537)[0m    - Since the restaurant is open 2 days a week, the total number of reservations per week is:
[36m(TaskRunner pid=2893537)[0m      \[
[36m(TaskRunner pid=2893537)[0m      6 \text{ reservations/day} \times 2 \text{ days/week} = 12 \text{ reservations/week}
[36m(TaskRunner pid=2893537)[0m      \]
[36m(TaskRunner pid=2893537)[0m 
[36m(TaskRunner pid=2893537)[0m 3. **Calculate the total revenue from reservations:**
[36m(TaskRunner pid=2893537)[0m    - The restaurant normally orders 2 meals that cost $5 each and a $5 bottle of wine.
[36m(TaskRunner pid=2893537)[0m    - The total cost for the meals is:
[36m(TaskRunner pid=2893537)[0m      \[
[36m(TaskRunner pid=2893537)[0m      2 \text{ meals} \times \$5/\text{meal} = \$10
[36m(TaskRunner pid=2893537)[0m      \]
[36m(TaskRunner pid=2893537)[0m    - The total cost for the wine is:
[36m(TaskRunner pid=2893537)[0m      \[
[36m(TaskRunner pid=2893537)[0m      1 \text{ bottle} \times \$5/\text{bottle} = \$5
[36m(TaskRunner pid=2893537)[0m      \]
[36m(TaskRunner pid=2893537)[0m    - Therefore, the total revenue from reservations is:
[36m(TaskRunner pid=2893537)[0m      \[
[36m(TaskRunner pid=2893537)[0m      \$10 + \$5 = \$15
[36m(TaskRunner pid=2893537)[0m      \]
[36m(TaskRunner pid=2893537)[0m 
[36m(TaskRunner pid=2893537)[0m 4. **Calculate the total weekly revenue:**
[36m(TaskRunner pid=2893537)[0m    - The total weekly revenue is the total revenue from reservations multiplied by the number of reservations per week:
[36m(TaskRunner pid=2893537)[0m      \[
[36m(TaskRunner pid=2893537)[0m      \$15 \times 12 \text{ reservations/week} = \$180
[36m(TaskRunner pid=2893537)[0m      \]
[36m(TaskRunner pid=2893537)[0m 
[36m(TaskRunner pid=2893537)[0m Thus, the total amount Tom's restaurant makes in a week is \(\boxed{180}\).
[36m(TaskRunner pid=2893537)[0m [ground_truth] 180
[36m(TaskRunner pid=2893537)[0m [score] 0.0
[36m(TaskRunner pid=2893537)[0m len reward_extra_infos_dict['reward']: 1319
[36m(TaskRunner pid=2893537)[0m ("Initial validation metrics: {'val-core/openai/gsm8k/reward/mean@1': "
[36m(TaskRunner pid=2893537)[0m  '0.000758150113722517}')
[36m(TaskRunner pid=2893537)[0m step:0 - val-core/openai/gsm8k/reward/mean@1:0.000758150113722517
[36m(TaskRunner pid=2893537)[0m Training Progress:   0%|          | 0/435 [00:00<?, ?it/s]
[36m(WorkerDict pid=2894389)[0m /home/yeopjin/orcd/pool/conda_install/envs/ntl/lib/python3.10/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:690: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .[32m [repeated 3x across cluster][0m
[36m(WorkerDict pid=2894389)[0m   warnings.warn([32m [repeated 3x across cluster][0m
[36m(TaskRunner pid=2893537)[0m step:1 - global_seqlen/min:24290 - global_seqlen/max:26579 - global_seqlen/minmax_diff:2289 - global_seqlen/balanced_min:25624 - global_seqlen/balanced_max:25625 - global_seqlen/mean:25624.5 - actor/entropy:0.4920010268688202 - critic/vf_loss:7.457017540931702 - critic/vf_clipfrac:0.4097578600049019 - critic/vpred_mean:-0.21069935662671924 - critic/grad_norm:355.4600944519043 - perf/mfu/critic:0.0332328873906909 - critic/lr:1e-05 - actor/pg_loss:-0.023430234170518816 - actor/pg_clipfrac:0.0018210090493084863 - actor/ppo_kl:5.3102269248483935e-06 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.8897264003753662 - perf/mfu/actor:0.06833523039352392 - perf/max_memory_allocated_gb:34.137545585632324 - perf/max_memory_reserved_gb:39.931640625 - perf/cpu_memory_used_gb:83.39233779907227 - actor/lr:1e-06 - training/global_step:1 - training/epoch:0 - critic/score/mean:0.0 - critic/score/max:0.0 - critic/score/min:0.0 - critic/rewards/mean:0.0 - critic/rewards/max:0.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.512008740434112e-09 - critic/advantages/max:4.0178327560424805 - critic/advantages/min:-4.465669631958008 - critic/returns/mean:0.0 - critic/returns/max:0.0 - critic/returns/min:0.0 - critic/values/mean:-1.1640625 - critic/values/max:15.25 - critic/values/min:-15.9375 - critic/vf_explained_var:-1351482.625 - response_length/mean:295.65625 - response_length/max:512.0 - response_length/min:80.0 - response_length/clip_ratio:0.0859375 - prompt_length/mean:104.7265625 - prompt_length/max:189.0 - prompt_length/min:66.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:1.4183111488819122e-05 - timing_s/generate_sequences:3.5984416007995605 - timing_s/reshard:0.7032536864280701 - timing_s/gen:5.00386769277975 - timing_s/reward:0.039437415078282356 - timing_s/old_log_prob:5.638940206728876 - timing_s/values:3.9195018340833485 - timing_s/adv:0.043225498870015144 - timing_s/update_critic:16.59384813392535 - timing_s/update_actor:8.08059166977182 - timing_s/step:39.32923248503357 - timing_s/stop_profile:2.520158886909485e-06 - timing_per_token_ms/update_critic:0.16189436022093454 - timing_per_token_ms/update_actor:0.07883657895541202 - timing_per_token_ms/gen:0.06611177059480697 - timing_per_token_ms/values:0.03823978842595317 - timing_per_token_ms/adv:0.00042172041278868994 - perf/total_num_tokens:102498 - perf/time_per_step:39.32923248503357 - perf/throughput:651.5382676168725
[36m(TaskRunner pid=2893537)[0m Training Progress:   0%|          | 1/435 [00:39<4:47:01, 39.68s/it]
[36m(TaskRunner pid=2893537)[0m step:2 - global_seqlen/min:26037 - global_seqlen/max:27747 - global_seqlen/minmax_diff:1710 - global_seqlen/balanced_min:26671 - global_seqlen/balanced_max:26672 - global_seqlen/mean:26671.25 - actor/entropy:0.47050178050994873 - critic/vf_loss:2.483529291115701 - critic/vf_clipfrac:0.4329610695131123 - critic/vpred_mean:-0.7109856976603623 - critic/grad_norm:196.28420639038086 - perf/mfu/critic:0.03436546548466025 - critic/lr:1e-05 - actor/pg_loss:0.00024775287602096796 - actor/pg_clipfrac:0.001178609993075952 - actor/ppo_kl:-0.000108962591966133 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.9833508133888245 - perf/mfu/actor:0.08117567977385073 - perf/max_memory_allocated_gb:34.16158962249756 - perf/max_memory_reserved_gb:40.7421875 - perf/cpu_memory_used_gb:85.91148376464844 - actor/lr:1e-06 - training/global_step:2 - training/epoch:0 - critic/score/mean:0.01953125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.01953125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.3579518842732341e-08 - critic/advantages/max:5.651552200317383 - critic/advantages/min:-4.767258644104004 - critic/returns/mean:0.014677864499390125 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:-1.3671875 - critic/values/max:8.0 - critic/values/min:-12.5 - critic/vf_explained_var:-266.50054931640625 - response_length/mean:311.640625 - response_length/max:512.0 - response_length/min:16.0 - response_length/clip_ratio:0.11328125 - prompt_length/mean:105.09765625 - prompt_length/max:215.0 - prompt_length/min:65.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.549045115709305e-06 - timing_s/generate_sequences:3.696061134338379 - timing_s/reshard:0.9851459860801697 - timing_s/gen:5.288473265245557 - timing_s/reward:0.0383353759534657 - timing_s/old_log_prob:4.704139799345285 - timing_s/values:3.9655853020958602 - timing_s/adv:0.033648105803877115 - timing_s/update_critic:16.72233563195914 - timing_s/update_actor:7.088713000062853 - timing_s/step:37.84813292231411 - timing_s/stop_profile:1.6464851796627045e-05 - timing_per_token_ms/update_critic:0.15674495601030267 - timing_per_token_ms/update_actor:0.06644526409582278 - timing_per_token_ms/gen:0.06628820838863822 - timing_per_token_ms/values:0.03717097344608764 - timing_per_token_ms/adv:0.0003153967830892545 - perf/total_num_tokens:106685 - perf/time_per_step:37.84813292231411 - perf/throughput:704.6913002219839
[36m(TaskRunner pid=2893537)[0m Training Progress:   0%|          | 2/435 [01:17<4:38:38, 38.61s/it]
[36m(TaskRunner pid=2893537)[0m step:3 - global_seqlen/min:26210 - global_seqlen/max:27710 - global_seqlen/minmax_diff:1500 - global_seqlen/balanced_min:26934 - global_seqlen/balanced_max:26934 - global_seqlen/mean:26934.0 - actor/entropy:0.5186736583709717 - critic/vf_loss:1.1641396107152104 - critic/vf_clipfrac:0.3057529963552952 - critic/vpred_mean:-0.6438206961574906 - critic/grad_norm:140.34563732147217 - perf/mfu/critic:0.0354209693627201 - critic/lr:1e-05 - actor/pg_loss:0.001588459505001083 - actor/pg_clipfrac:0.001582508655701531 - actor/ppo_kl:0.0002700619891840006 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.9797980189323425 - perf/mfu/actor:0.08541024033965733 - perf/max_memory_allocated_gb:34.16158962249756 - perf/max_memory_reserved_gb:40.7421875 - perf/cpu_memory_used_gb:85.0909538269043 - actor/lr:1e-06 - training/global_step:3 - training/epoch:0 - critic/score/mean:0.00390625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.00390625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.2236398561071837e-08 - critic/advantages/max:6.807344436645508 - critic/advantages/min:-8.101141929626465 - critic/returns/mean:0.006316698621958494 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:-0.9609375 - critic/values/max:10.375 - critic/values/min:-10.5 - critic/vf_explained_var:-310.8537902832031 - response_length/mean:316.62109375 - response_length/max:512.0 - response_length/min:102.0 - response_length/clip_ratio:0.109375 - prompt_length/mean:104.22265625 - prompt_length/max:190.0 - prompt_length/min:67.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.932990461587906e-06 - timing_s/generate_sequences:3.6325931549072266 - timing_s/reshard:0.664438009262085 - timing_s/gen:4.921454987023026 - timing_s/reward:0.04350832896307111 - timing_s/old_log_prob:4.679473728872836 - timing_s/values:3.9277800410054624 - timing_s/adv:0.03497039107605815 - timing_s/update_critic:16.387141378130764 - timing_s/update_actor:6.8050743117928505 - timing_s/step:36.807474652305245 - timing_s/stop_profile:4.298985004425049e-06 - timing_per_token_ms/update_critic:0.15210460178706062 - timing_per_token_ms/update_actor:0.06316434907359518 - timing_per_token_ms/gen:0.06071747562794431 - timing_per_token_ms/values:0.03645745192883959 - timing_per_token_ms/adv:0.0003245933678255936 - perf/total_num_tokens:107736 - perf/time_per_step:36.807474652305245 - perf/throughput:731.7535433883163
[36m(TaskRunner pid=2893537)[0m Training Progress:   1%|          | 3/435 [01:54<4:32:05, 37.79s/it]
[36m(TaskRunner pid=2893537)[0m step:4 - global_seqlen/min:25955 - global_seqlen/max:27346 - global_seqlen/minmax_diff:1391 - global_seqlen/balanced_min:26729 - global_seqlen/balanced_max:26729 - global_seqlen/mean:26729.0 - actor/entropy:0.549111008644104 - critic/vf_loss:0.5289359344169497 - critic/vf_clipfrac:0.28899954771623015 - critic/vpred_mean:-0.45603061181464 - critic/grad_norm:121.05407238006592 - perf/mfu/critic:0.03535911589453995 - critic/lr:1e-05 - actor/pg_loss:0.08110670279711485 - actor/pg_clipfrac:0.0020572097855620086 - actor/ppo_kl:-0.000489370461764338 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.1597756147384644 - perf/mfu/actor:0.08455629789942219 - perf/max_memory_allocated_gb:34.16158962249756 - perf/max_memory_reserved_gb:40.7421875 - perf/cpu_memory_used_gb:86.11370086669922 - actor/lr:1e-06 - training/global_step:4 - training/epoch:0 - critic/score/mean:0.00390625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.00390625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:3.500136003253829e-08 - critic/advantages/max:7.423882484436035 - critic/advantages/min:-8.224824905395508 - critic/returns/mean:0.0035706288181245327 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:-0.84765625 - critic/values/max:7.34375 - critic/values/min:-8.25 - critic/vf_explained_var:-277.30987548828125 - response_length/mean:313.9765625 - response_length/max:512.0 - response_length/min:57.0 - response_length/clip_ratio:0.125 - prompt_length/mean:103.6640625 - prompt_length/max:206.0 - prompt_length/min:71.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.204711437225342e-06 - timing_s/generate_sequences:3.6878044605255127 - timing_s/reshard:0.6650919318199158 - timing_s/gen:4.920255239121616 - timing_s/reward:0.03855806775391102 - timing_s/old_log_prob:4.661131977103651 - timing_s/values:3.9799779541790485 - timing_s/adv:0.03341002110391855 - timing_s/update_critic:16.29023448890075 - timing_s/update_actor:6.820460794027895 - timing_s/step:36.754385464824736 - timing_s/stop_profile:2.605840563774109e-06 - timing_per_token_ms/update_critic:0.1523647956236742 - timing_per_token_ms/update_actor:0.06379270449724919 - timing_per_token_ms/gen:0.06121395455375371 - timing_per_token_ms/values:0.03722527923022792 - timing_per_token_ms/adv:0.00031248850596653964 - perf/total_num_tokens:106916 - perf/time_per_step:36.754385464824736 - perf/throughput:727.2329454557364
[36m(TaskRunner pid=2893537)[0m Training Progress:   1%|          | 4/435 [02:31<4:28:33, 37.39s/it]
[36m(TaskRunner pid=2893537)[0m step:5 - global_seqlen/min:24599 - global_seqlen/max:27014 - global_seqlen/minmax_diff:2415 - global_seqlen/balanced_min:25966 - global_seqlen/balanced_max:25967 - global_seqlen/mean:25966.75 - actor/entropy:0.5629155039787292 - critic/vf_loss:0.32761661033146083 - critic/vf_clipfrac:0.18328806779027218 - critic/vpred_mean:-0.29880798166050226 - critic/grad_norm:102.3137674331665 - perf/mfu/critic:0.034925437480307665 - critic/lr:1e-05 - actor/pg_loss:0.01823503093328327 - actor/pg_clipfrac:0.0017059811143553816 - actor/ppo_kl:0.00012392483222356532 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.1333792209625244 - perf/mfu/actor:0.0820732134277695 - perf/max_memory_allocated_gb:34.16158962249756 - perf/max_memory_reserved_gb:40.7421875 - perf/cpu_memory_used_gb:86.0649185180664 - actor/lr:1e-06 - training/global_step:5 - training/epoch:0 - critic/score/mean:0.0078125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.0078125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:6.782463657373228e-08 - critic/advantages/max:12.34729290008545 - critic/advantages/min:-20.53919219970703 - critic/returns/mean:0.007970265112817287 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:-0.58984375 - critic/values/max:14.3125 - critic/values/min:-9.5625 - critic/vf_explained_var:-65.57328033447266 - response_length/mean:305.82421875 - response_length/max:512.0 - response_length/min:4.0 - response_length/clip_ratio:0.078125 - prompt_length/mean:99.90625 - prompt_length/max:256.0 - prompt_length/min:66.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:6.83218240737915e-06 - timing_s/generate_sequences:3.5593841075897217 - timing_s/reshard:0.6684108972549438 - timing_s/gen:4.898334630765021 - timing_s/reward:0.03875064104795456 - timing_s/old_log_prob:4.590390770696104 - timing_s/values:4.149888523854315 - timing_s/adv:0.034464452881366014 - timing_s/update_critic:16.004602089058608 - timing_s/update_actor:6.818523509893566 - timing_s/step:36.54264344088733 - timing_s/stop_profile:2.8298236429691315e-06 - timing_per_token_ms/update_critic:0.1540874588566013 - timing_per_token_ms/update_actor:0.06564667805841669 - timing_per_token_ms/gen:0.06256574358182959 - timing_per_token_ms/values:0.03995386911968494 - timing_per_token_ms/adv:0.0003318133081861035 - perf/total_num_tokens:103867 - perf/time_per_step:36.54264344088733 - perf/throughput:710.5876191470584
[36m(TaskRunner pid=2893537)[0m Training Progress:   1%|          | 5/435 [03:07<4:25:46, 37.09s/it]
[36m(TaskRunner pid=2893537)[0m step:6 - global_seqlen/min:25835 - global_seqlen/max:27426 - global_seqlen/minmax_diff:1591 - global_seqlen/balanced_min:26614 - global_seqlen/balanced_max:26615 - global_seqlen/mean:26614.5 - actor/entropy:0.5649840831756592 - critic/vf_loss:0.15604914858704433 - critic/vf_clipfrac:0.11976435715405387 - critic/vpred_mean:-0.22776258544399752 - critic/grad_norm:63.7354474067688 - perf/mfu/critic:0.03417571196111345 - critic/lr:1e-05 - actor/pg_loss:-0.03650971275055781 - actor/pg_clipfrac:0.0015468595192942303 - actor/ppo_kl:-8.766702421780792e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.9610519707202911 - perf/mfu/actor:0.08424396552698965 - perf/max_memory_allocated_gb:34.16158962249756 - perf/max_memory_reserved_gb:40.7421875 - perf/cpu_memory_used_gb:85.15846252441406 - actor/lr:1e-06 - training/global_step:6 - training/epoch:0 - critic/score/mean:0.0078125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.0078125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-3.063937015213014e-08 - critic/advantages/max:17.22314453125 - critic/advantages/min:-9.128440856933594 - critic/returns/mean:0.005019954405725002 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:-0.470703125 - critic/values/max:3.84375 - critic/values/min:-8.625 - critic/vf_explained_var:-43.734657287597656 - response_length/mean:311.2578125 - response_length/max:512.0 - response_length/min:4.0 - response_length/clip_ratio:0.109375 - prompt_length/mean:104.59375 - prompt_length/max:189.0 - prompt_length/min:67.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:6.393995136022568e-06 - timing_s/generate_sequences:3.6050329208374023 - timing_s/reshard:1.0576287508010864 - timing_s/gen:5.840607023797929 - timing_s/reward:0.03725401405245066 - timing_s/old_log_prob:4.574239280074835 - timing_s/values:3.9665565309114754 - timing_s/adv:0.040505143348127604 - timing_s/update_critic:16.781376597005874 - timing_s/update_actor:6.817433764226735 - timing_s/step:38.064703366253525 - timing_s/stop_profile:2.436339855194092e-06 - timing_per_token_ms/update_critic:0.15763377667254574 - timing_per_token_ms/update_actor:0.06403871728030523 - timing_per_token_ms/gen:0.07329895112820875 - timing_per_token_ms/values:0.03725935609265133 - timing_per_token_ms/adv:0.0003804800329531609 - perf/total_num_tokens:106458 - perf/time_per_step:38.064703366253525 - perf/throughput:699.1910522438284
[36m(TaskRunner pid=2893537)[0m Training Progress:   1%|▏         | 6/435 [03:45<4:27:34, 37.42s/it]
[36m(TaskRunner pid=2893537)[0m step:7 - global_seqlen/min:25608 - global_seqlen/max:28293 - global_seqlen/minmax_diff:2685 - global_seqlen/balanced_min:26765 - global_seqlen/balanced_max:26766 - global_seqlen/mean:26765.75 - actor/entropy:0.5829655528068542 - critic/vf_loss:0.07685250960639678 - critic/vf_clipfrac:0.040588866744656116 - critic/vpred_mean:0.15117350617038028 - critic/grad_norm:75.94733572006226 - perf/mfu/critic:0.035437411069418355 - critic/lr:1e-05 - actor/pg_loss:0.060322289587929845 - actor/pg_clipfrac:0.0014757068311155308 - actor/ppo_kl:-0.00022898787767644535 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.0478620529174805 - perf/mfu/actor:0.08412019183829528 - perf/max_memory_allocated_gb:34.16158962249756 - perf/max_memory_reserved_gb:40.7421875 - perf/cpu_memory_used_gb:85.66335678100586 - actor/lr:1e-06 - training/global_step:7 - training/epoch:0 - critic/score/mean:0.0078125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.0078125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.2651299563515295e-08 - critic/advantages/max:17.206003189086914 - critic/advantages/min:-8.033130645751953 - critic/returns/mean:0.010036011226475239 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:-0.173828125 - critic/values/max:2.53125 - critic/values/min:-6.0 - critic/vf_explained_var:-10.488243103027344 - response_length/mean:315.66015625 - response_length/max:512.0 - response_length/min:4.0 - response_length/clip_ratio:0.125 - prompt_length/mean:102.5546875 - prompt_length/max:183.0 - prompt_length/min:63.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.042180418968201e-06 - timing_s/generate_sequences:3.6709823608398438 - timing_s/reshard:0.6638961434364319 - timing_s/gen:5.060231506824493 - timing_s/reward:0.037313621025532484 - timing_s/old_log_prob:4.56903637573123 - timing_s/values:3.9053362691774964 - timing_s/adv:0.03590903477743268 - timing_s/update_critic:16.279096759855747 - timing_s/update_actor:6.869792399927974 - timing_s/step:36.76398034999147 - timing_s/stop_profile:2.3311004042625427e-06 - timing_per_token_ms/update_critic:0.15205156552549198 - timing_per_token_ms/update_actor:0.06416588737405055 - timing_per_token_ms/gen:0.0626196525984048 - timing_per_token_ms/values:0.03647699269754721 - timing_per_token_ms/adv:0.0003354009767840681 - perf/total_num_tokens:107063 - perf/time_per_step:36.76398034999147 - perf/throughput:728.0427675456042
[36m(TaskRunner pid=2893537)[0m Training Progress:   2%|▏         | 7/435 [04:22<4:25:26, 37.21s/it]
[36m(TaskRunner pid=2893537)[0m step:8 - global_seqlen/min:25614 - global_seqlen/max:27586 - global_seqlen/minmax_diff:1972 - global_seqlen/balanced_min:26583 - global_seqlen/balanced_max:26584 - global_seqlen/mean:26583.75 - actor/entropy:0.543799102306366 - critic/vf_loss:0.04472367349808337 - critic/vf_clipfrac:0.001195454504340887 - critic/vpred_mean:0.1001116020779591 - critic/grad_norm:50.44627285003662 - perf/mfu/critic:0.03551792820704078 - critic/lr:1e-05 - actor/pg_loss:0.028253658674657345 - actor/pg_clipfrac:0.0014228067921067122 - actor/ppo_kl:0.00035769901114690583 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.822647213935852 - perf/mfu/actor:0.08335199651985188 - perf/max_memory_allocated_gb:34.16158962249756 - perf/max_memory_reserved_gb:40.7421875 - perf/cpu_memory_used_gb:84.6147689819336 - actor/lr:1e-06 - training/global_step:8 - training/epoch:0 - critic/score/mean:0.0078125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.0078125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:9.924912447445422e-09 - critic/advantages/max:10.242086410522461 - critic/advantages/min:-12.024584770202637 - critic/returns/mean:0.005191003903746605 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:-0.049072265625 - critic/values/max:2.46875 - critic/values/min:-2.203125 - critic/vf_explained_var:-7.508146286010742 - response_length/mean:312.2890625 - response_length/max:512.0 - response_length/min:5.0 - response_length/clip_ratio:0.10546875 - prompt_length/mean:103.08203125 - prompt_length/max:180.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:6.171874701976776e-06 - timing_s/generate_sequences:3.605465888977051 - timing_s/reshard:0.6660252213478088 - timing_s/gen:5.37525849789381 - timing_s/reward:0.03708914993330836 - timing_s/old_log_prob:4.584238483104855 - timing_s/values:3.966183229815215 - timing_s/adv:0.0354123841971159 - timing_s/update_critic:16.125990405213088 - timing_s/update_actor:6.881004135124385 - timing_s/step:37.01372219296172 - timing_s/stop_profile:3.712717443704605e-06 - timing_per_token_ms/update_critic:0.15165270517903878 - timing_per_token_ms/update_actor:0.06471062336130518 - timing_per_token_ms/gen:0.06723611560170378 - timing_per_token_ms/values:0.03729894418409004 - timing_per_token_ms/adv:0.00033302660645239947 - perf/total_num_tokens:106335 - perf/time_per_step:37.01372219296172 - perf/throughput:718.2133658812348
[36m(TaskRunner pid=2893537)[0m Training Progress:   2%|▏         | 8/435 [04:59<4:24:23, 37.15s/it]
[36m(TaskRunner pid=2893537)[0m step:9 - global_seqlen/min:26280 - global_seqlen/max:27933 - global_seqlen/minmax_diff:1653 - global_seqlen/balanced_min:26875 - global_seqlen/balanced_max:26876 - global_seqlen/mean:26875.5 - actor/entropy:0.6046400666236877 - critic/vf_loss:0.034087024490872864 - critic/vf_clipfrac:0.0020232309034327045 - critic/vpred_mean:0.10194879383584521 - critic/grad_norm:42.684706687927246 - perf/mfu/critic:0.03533081557031804 - critic/lr:1e-05 - actor/pg_loss:-0.0054893590859137475 - actor/pg_clipfrac:0.001296898175496608 - actor/ppo_kl:0.0002425512516310846 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.0466550290584564 - perf/mfu/actor:0.08507384834270428 - perf/max_memory_allocated_gb:34.16158962249756 - perf/max_memory_reserved_gb:40.7421875 - perf/cpu_memory_used_gb:84.44550704956055 - actor/lr:1e-06 - training/global_step:9 - training/epoch:0 - critic/score/mean:0.01953125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.01953125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:1.6408110425913947e-08 - critic/advantages/max:12.588955879211426 - critic/advantages/min:-6.632436275482178 - critic/returns/mean:0.013781425543129444 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:-0.0869140625 - critic/values/max:1.328125 - critic/values/min:-2.8125 - critic/vf_explained_var:-2.4116928577423096 - response_length/mean:316.0390625 - response_length/max:512.0 - response_length/min:4.0 - response_length/clip_ratio:0.1171875 - prompt_length/mean:103.890625 - prompt_length/max:201.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.023809641599655e-06 - timing_s/generate_sequences:3.639583110809326 - timing_s/reshard:0.7619837522506714 - timing_s/gen:5.532097808085382 - timing_s/reward:0.03726384602487087 - timing_s/old_log_prob:4.64670516224578 - timing_s/values:3.96462173294276 - timing_s/adv:0.03340492397546768 - timing_s/update_critic:16.392179252114147 - timing_s/update_actor:6.816196168772876 - timing_s/step:37.42958034994081 - timing_s/stop_profile:2.2761523723602295e-06 - timing_per_token_ms/update_critic:0.15248255150708032 - timing_per_token_ms/update_actor:0.06340529635516433 - timing_per_token_ms/gen:0.06837685472134801 - timing_per_token_ms/values:0.036879516036378485 - timing_per_token_ms/adv:0.0003107376976750915 - perf/total_num_tokens:107502 - perf/time_per_step:37.42958034994081 - perf/throughput:718.0283548127599
[36m(TaskRunner pid=2893537)[0m Training Progress:   2%|▏         | 9/435 [05:37<4:24:26, 37.25s/it]
[36m(TaskRunner pid=2893537)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 10}
[36m(TaskRunner pid=2893537)[0m validation generation end
[36m(TaskRunner pid=2893537)[0m [prompt] system
[36m(TaskRunner pid=2893537)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2893537)[0m user
[36m(TaskRunner pid=2893537)[0m Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and bakes muffins for her friends every day with four. She sells the remainder at the farmers' market daily for $2 per fresh duck egg. How much in dollars does she make every day at the farmers' market? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2893537)[0m assistant
[36m(TaskRunner pid=2893537)[0m 
[36m(TaskRunner pid=2893537)[0m [response] To calculate how much Janet makes at the farmers' market every day, we need to follow these steps:
[36m(TaskRunner pid=2893537)[0m 
[36m(TaskRunner pid=2893537)[0m 1. **Calculate the daily egg production:**
[36m(TaskRunner pid=2893537)[0m    - Janet's ducks lay 16 eggs per day.
[36m(TaskRunner pid=2893537)[0m 
[36m(TaskRunner pid=2893537)[0m 2. **Calculate the daily consumption:**
[36m(TaskRunner pid=2893537)[0m    - She eats 3 eggs for breakfast.
[36m(TaskRunner pid=2893537)[0m    - She bakes muffins for her friends, which is not mentioned as part of her daily consumption.
[36m(TaskRunner pid=2893537)[0m 
[36m(TaskRunner pid=2893537)[0m 3. **Calculate the daily consumption of muffins:**
[36m(TaskRunner pid=2893537)[0m    - She bakes muffins for her friends every day, which is not mentioned as part of her daily consumption.
[36m(TaskRunner pid=2893537)[0m 
[36m(TaskRunner pid=2893537)[0m 4. **Calculate the daily sales:**
[36m(TaskRunner pid=2893537)[0m    - She sells the remainder of the eggs at the farmers' market.
[36m(TaskRunner pid=2893537)[0m    - The remainder is the total eggs minus the eggs she eats and bakes muffins.
[36m(TaskRunner pid=2893537)[0m 
[36m(TaskRunner pid=2893537)[0m 5. **Calculate the daily sales amount:**
[36m(TaskRunner pid=2893537)[0m    - Total eggs per day: 16
[36m(TaskRunner pid=2893537)[0m    - Eggs eaten: 3
[36m(TaskRunner pid=2893537)[0m    - Eggs baked muffins: 0 (since she doesn't bake muffins)
[36m(TaskRunner pid=2893537)[0m    - Eggs sold: 16 - 3 - 0 = 13
[36m(TaskRunner pid=2893537)[0m 
[36m(TaskRunner pid=2893537)[0m 6. **Calculate the daily earnings:**
[36m(TaskRunner pid=2893537)[0m    - She sells each egg for $2.
[36m(TaskRunner pid=2893537)[0m    - Daily sales amount: 13 eggs * $2/egg = $26
[36m(TaskRunner pid=2893537)[0m 
[36m(TaskRunner pid=2893537)[0m ### Final Answer:
[36m(TaskRunner pid=2893537)[0m #### Janet makes $#### in dollars every day at the farmers' market.
[36m(TaskRunner pid=2893537)[0m [ground_truth] 18
[36m(TaskRunner pid=2893537)[0m [score] 0.0
[36m(TaskRunner pid=2893537)[0m len reward_extra_infos_dict['reward']: 1312
[36m(TaskRunner pid=2893537)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 10}
[36m(TaskRunner pid=2893537)[0m validation generation end
[36m(TaskRunner pid=2893537)[0m [prompt] system
[36m(TaskRunner pid=2893537)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2893537)[0m user
[36m(TaskRunner pid=2893537)[0m Tom's restaurant gets 6 reservations a night.  They normally order 2 meals that cost $5 each and a $5 bottle of wine.  How much do they make a week if they are open 2 days a week? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2893537)[0m assistant
[36m(TaskRunner pid=2893537)[0m 
[36m(TaskRunner pid=2893537)[0m [response] To calculate how much Tom's restaurant makes in a week, we need to consider the number of reservations, the number of meals ordered, the cost of each meal, and the cost of the wine. Here's the step-by-step calculation:
[36m(TaskRunner pid=2893537)[0m 
[36m(TaskRunner pid=2893537)[0m 1. **Number of reservations per night**: 6
[36m(TaskRunner pid=2893537)[0m 2. **Number of meals per reservation**: 2
[36m(TaskRunner pid=2893537)[0m 3. **Cost of each meal**: $5
[36m(TaskRunner pid=2893537)[0m 4. **Cost of the wine**: $5
[36m(TaskRunner pid=2893537)[0m 
[36m(TaskRunner pid=2893537)[0m First, let's calculate the total number of meals ordered per night:
[36m(TaskRunner pid=2893537)[0m \[ 6 \text{ reservations} \times 2 \text{ meals/reservation} = 12 \text{ meals} \]
[36m(TaskRunner pid=2893537)[0m 
[36m(TaskRunner pid=2893537)[0m Next, we calculate the total revenue from the meals:
[36m(TaskRunner pid=2893537)[0m \[ 12 \text{ meals} \times \$5 \text{ per meal} = \$60 \]
[36m(TaskRunner pid=2893537)[0m 
[36m(TaskRunner pid=2893537)[0m Now, let's calculate the total revenue from the wine:
[36m(TaskRunner pid=2893537)[0m \[ 1 \text{ bottle} \times \$5 \text{ per bottle} = \$5 \]
[36m(TaskRunner pid=2893537)[0m 
[36m(TaskRunner pid=2893537)[0m Finally, we add the revenue from the meals and the wine to get the total weekly revenue:
[36m(TaskRunner pid=2893537)[0m \[ \$60 + \$5 = \$65 \]
[36m(TaskRunner pid=2893537)[0m 
[36m(TaskRunner pid=2893537)[0m So, the total amount Tom's restaurant makes in a week is **\$65**.
[36m(TaskRunner pid=2893537)[0m [ground_truth] 180
[36m(TaskRunner pid=2893537)[0m [score] 0.0
[36m(TaskRunner pid=2893537)[0m len reward_extra_infos_dict['reward']: 1319
[36m(TaskRunner pid=2893537)[0m step:10 - global_seqlen/min:25066 - global_seqlen/max:26770 - global_seqlen/minmax_diff:1704 - global_seqlen/balanced_min:25690 - global_seqlen/balanced_max:25691 - global_seqlen/mean:25690.75 - actor/entropy:0.582476019859314 - critic/vf_loss:0.030996493027487304 - critic/vf_clipfrac:0.0005009021151636261 - critic/vpred_mean:0.040010218872339465 - critic/grad_norm:24.14000231027603 - perf/mfu/critic:0.03370772093406479 - critic/lr:1e-05 - actor/pg_loss:-0.00451265351875918 - actor/pg_clipfrac:0.0013160375492589083 - actor/ppo_kl:-2.805754957080353e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.1622021198272705 - perf/mfu/actor:0.08132230144146946 - perf/max_memory_allocated_gb:34.16158962249756 - perf/max_memory_reserved_gb:40.7421875 - perf/cpu_memory_used_gb:84.7121467590332 - actor/lr:1e-06 - val-core/openai/gsm8k/reward/mean@1:0.003032600454890068 - training/global_step:10 - training/epoch:0 - critic/score/mean:0.01171875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.01171875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.2988584430217998e-08 - critic/advantages/max:21.092348098754883 - critic/advantages/min:-7.358589172363281 - critic/returns/mean:0.012323044240474701 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:-0.006256103515625 - critic/values/max:1.4140625 - critic/values/min:-4.125 - critic/vf_explained_var:-2.1116018295288086 - response_length/mean:298.28515625 - response_length/max:512.0 - response_length/min:13.0 - response_length/clip_ratio:0.05859375 - prompt_length/mean:103.1328125 - prompt_length/max:184.0 - prompt_length/min:69.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:6.451737135648727e-06 - timing_s/generate_sequences:3.571115493774414 - timing_s/reshard:0.6647313833236694 - timing_s/gen:5.2491217399947345 - timing_s/reward:0.03815909381955862 - timing_s/old_log_prob:4.58438370609656 - timing_s/values:3.9819245929829776 - timing_s/adv:0.03298040200024843 - timing_s/update_critic:16.404861879069358 - timing_s/update_actor:6.8119516130536795 - timing_s/testing:14.170189143624157 - timing_s/step:51.28123429603875 - timing_s/stop_profile:2.4065375328063965e-06 - timing_per_token_ms/update_critic:0.15963782566750054 - timing_per_token_ms/update_actor:0.06628797926348666 - timing_per_token_ms/gen:0.06874087217289893 - timing_per_token_ms/values:0.0387486215173066 - timing_per_token_ms/adv:0.00032093654331080674 - perf/total_num_tokens:102763 - perf/time_per_step:51.28123429603875 - perf/throughput:500.97760618808854
[36m(TaskRunner pid=2893537)[0m Training Progress:   2%|▏         | 10/435 [06:28<4:54:33, 41.58s/it]
[36m(TaskRunner pid=2893537)[0m step:11 - global_seqlen/min:24084 - global_seqlen/max:26590 - global_seqlen/minmax_diff:2506 - global_seqlen/balanced_min:25273 - global_seqlen/balanced_max:25273 - global_seqlen/mean:25273.0 - actor/entropy:0.6488744616508484 - critic/vf_loss:0.0675408513925504 - critic/vf_clipfrac:0.17877303157001734 - critic/vpred_mean:-0.12951646506553516 - critic/grad_norm:80.1940975189209 - perf/mfu/critic:0.033306848172051484 - critic/lr:1e-05 - actor/pg_loss:0.05456460401182994 - actor/pg_clipfrac:0.00181285418511834 - actor/ppo_kl:-9.496478105575079e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.0657643377780914 - perf/mfu/actor:0.08002913214797408 - perf/max_memory_allocated_gb:34.16158962249756 - perf/max_memory_reserved_gb:40.7421875 - perf/cpu_memory_used_gb:85.74052810668945 - actor/lr:1e-06 - training/global_step:11 - training/epoch:0 - critic/score/mean:0.01171875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.01171875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-5.586387530343018e-08 - critic/advantages/max:7.036775588989258 - critic/advantages/min:-2.8913140296936035 - critic/returns/mean:0.010905961506068707 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:-0.474609375 - critic/values/max:0.1923828125 - critic/values/min:-1.921875 - critic/vf_explained_var:-4.080163478851318 - response_length/mean:290.48046875 - response_length/max:512.0 - response_length/min:4.0 - response_length/clip_ratio:0.1015625 - prompt_length/mean:104.41015625 - prompt_length/max:183.0 - prompt_length/min:72.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.695984095335007e-06 - timing_s/generate_sequences:3.5751585960388184 - timing_s/reshard:0.6887832880020142 - timing_s/gen:4.914767370093614 - timing_s/reward:0.037590593099594116 - timing_s/old_log_prob:5.128299449104816 - timing_s/values:4.234747153241187 - timing_s/adv:0.04544954560697079 - timing_s/update_critic:16.33147311815992 - timing_s/update_actor:6.806141506880522 - timing_s/step:37.506774633191526 - timing_s/stop_profile:2.332031726837158e-06 - timing_per_token_ms/update_critic:0.16155059864440233 - timing_per_token_ms/update_actor:0.06732621282475885 - timing_per_token_ms/gen:0.06609156933009176 - timing_per_token_ms/values:0.04189003237883499 - timing_per_token_ms/adv:0.0004495859771986981 - perf/total_num_tokens:101092 - perf/time_per_step:37.506774633191526 - perf/throughput:673.8249355527021
[36m(TaskRunner pid=2893537)[0m Training Progress:   3%|▎         | 11/435 [07:05<4:45:03, 40.34s/it]
