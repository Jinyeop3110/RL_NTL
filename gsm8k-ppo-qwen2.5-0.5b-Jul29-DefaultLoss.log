2025-07-29 15:00:40,276	INFO worker.py:1917 -- Started a local Ray instance.
[36m(TaskRunner pid=2914832)[0m TaskRunner hostname: node3006, PID: 2914832
[36m(TaskRunner pid=2914832)[0m {'actor_rollout_ref': {'actor': {'_target_': 'verl.workers.config.FSDPActorConfig',
[36m(TaskRunner pid=2914832)[0m                                  'checkpoint': {'_target_': 'verl.trainer.config.CheckpointConfig',
[36m(TaskRunner pid=2914832)[0m                                                 'async_save': False,
[36m(TaskRunner pid=2914832)[0m                                                 'load_contents': ['model',
[36m(TaskRunner pid=2914832)[0m                                                                   'optimizer',
[36m(TaskRunner pid=2914832)[0m                                                                   'extra'],
[36m(TaskRunner pid=2914832)[0m                                                 'save_contents': ['model',
[36m(TaskRunner pid=2914832)[0m                                                                   'optimizer',
[36m(TaskRunner pid=2914832)[0m                                                                   'extra']},
[36m(TaskRunner pid=2914832)[0m                                  'clip_ratio': 0.2,
[36m(TaskRunner pid=2914832)[0m                                  'clip_ratio_c': 3.0,
[36m(TaskRunner pid=2914832)[0m                                  'clip_ratio_high': 0.2,
[36m(TaskRunner pid=2914832)[0m                                  'clip_ratio_low': 0.2,
[36m(TaskRunner pid=2914832)[0m                                  'entropy_checkpointing': False,
[36m(TaskRunner pid=2914832)[0m                                  'entropy_coeff': 0.001,
[36m(TaskRunner pid=2914832)[0m                                  'entropy_from_logits_with_chunking': False,
[36m(TaskRunner pid=2914832)[0m                                  'fsdp_config': {'_target_': 'verl.workers.config.FSDPEngineConfig',
[36m(TaskRunner pid=2914832)[0m                                                  'forward_prefetch': False,
[36m(TaskRunner pid=2914832)[0m                                                  'fsdp_size': -1,
[36m(TaskRunner pid=2914832)[0m                                                  'offload_policy': False,
[36m(TaskRunner pid=2914832)[0m                                                  'optimizer_offload': False,
[36m(TaskRunner pid=2914832)[0m                                                  'param_offload': False,
[36m(TaskRunner pid=2914832)[0m                                                  'reshard_after_forward': True,
[36m(TaskRunner pid=2914832)[0m                                                  'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=2914832)[0m                                  'grad_clip': 1.0,
[36m(TaskRunner pid=2914832)[0m                                  'kl_loss_coef': 0.001,
[36m(TaskRunner pid=2914832)[0m                                  'kl_loss_type': 'low_var_kl',
[36m(TaskRunner pid=2914832)[0m                                  'loss_agg_mode': 'token-mean',
[36m(TaskRunner pid=2914832)[0m                                  'optim': {'_target_': 'verl.workers.config.FSDPOptimizerConfig',
[36m(TaskRunner pid=2914832)[0m                                            'lr': 1e-06,
[36m(TaskRunner pid=2914832)[0m                                            'lr_warmup_steps': -1,
[36m(TaskRunner pid=2914832)[0m                                            'lr_warmup_steps_ratio': 0.0,
[36m(TaskRunner pid=2914832)[0m                                            'min_lr_ratio': 0.0,
[36m(TaskRunner pid=2914832)[0m                                            'num_cycles': 0.5,
[36m(TaskRunner pid=2914832)[0m                                            'total_training_steps': -1,
[36m(TaskRunner pid=2914832)[0m                                            'warmup_style': 'constant',
[36m(TaskRunner pid=2914832)[0m                                            'weight_decay': 0.01},
[36m(TaskRunner pid=2914832)[0m                                  'policy_loss': {'_target_': 'verl.workers.config.PolicyLossConfig',
[36m(TaskRunner pid=2914832)[0m                                                  'clip_cov_lb': 1.0,
[36m(TaskRunner pid=2914832)[0m                                                  'clip_cov_ratio': 0.0002,
[36m(TaskRunner pid=2914832)[0m                                                  'clip_cov_ub': 5.0,
[36m(TaskRunner pid=2914832)[0m                                                  'kl_cov_ratio': 0.0002,
[36m(TaskRunner pid=2914832)[0m                                                  'loss_mode': 'vanilla',
[36m(TaskRunner pid=2914832)[0m                                                  'ppo_kl_coef': 0.1},
[36m(TaskRunner pid=2914832)[0m                                  'ppo_epochs': 1,
[36m(TaskRunner pid=2914832)[0m                                  'ppo_max_token_len_per_gpu': 16384,
[36m(TaskRunner pid=2914832)[0m                                  'ppo_micro_batch_size': None,
[36m(TaskRunner pid=2914832)[0m                                  'ppo_micro_batch_size_per_gpu': 4,
[36m(TaskRunner pid=2914832)[0m                                  'ppo_mini_batch_size': 64,
[36m(TaskRunner pid=2914832)[0m                                  'shuffle': True,
[36m(TaskRunner pid=2914832)[0m                                  'strategy': 'fsdp',
[36m(TaskRunner pid=2914832)[0m                                  'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=2914832)[0m                                  'use_dynamic_bsz': False,
[36m(TaskRunner pid=2914832)[0m                                  'use_fused_kernels': False,
[36m(TaskRunner pid=2914832)[0m                                  'use_kl_loss': False,
[36m(TaskRunner pid=2914832)[0m                                  'use_remove_padding': False,
[36m(TaskRunner pid=2914832)[0m                                  'use_torch_compile': True},
[36m(TaskRunner pid=2914832)[0m                        'hybrid_engine': True,
[36m(TaskRunner pid=2914832)[0m                        'model': {'custom_chat_template': None,
[36m(TaskRunner pid=2914832)[0m                                  'enable_activation_offload': False,
[36m(TaskRunner pid=2914832)[0m                                  'enable_gradient_checkpointing': False,
[36m(TaskRunner pid=2914832)[0m                                  'exclude_modules': None,
[36m(TaskRunner pid=2914832)[0m                                  'external_lib': None,
[36m(TaskRunner pid=2914832)[0m                                  'fused_kernel_options': {'impl_backend': 'torch'},
[36m(TaskRunner pid=2914832)[0m                                  'lora_alpha': 16,
[36m(TaskRunner pid=2914832)[0m                                  'lora_rank': 0,
[36m(TaskRunner pid=2914832)[0m                                  'override_config': {},
[36m(TaskRunner pid=2914832)[0m                                  'path': 'Qwen/Qwen2.5-0.5B-Instruct',
[36m(TaskRunner pid=2914832)[0m                                  'target_modules': 'all-linear',
[36m(TaskRunner pid=2914832)[0m                                  'trust_remote_code': False,
[36m(TaskRunner pid=2914832)[0m                                  'use_fused_kernels': False,
[36m(TaskRunner pid=2914832)[0m                                  'use_liger': False,
[36m(TaskRunner pid=2914832)[0m                                  'use_remove_padding': False,
[36m(TaskRunner pid=2914832)[0m                                  'use_shm': False},
[36m(TaskRunner pid=2914832)[0m                        'profiler': {'_target_': 'verl.utils.profiler.ProfilerConfig',
[36m(TaskRunner pid=2914832)[0m                                     'all_ranks': False,
[36m(TaskRunner pid=2914832)[0m                                     'discrete': False,
[36m(TaskRunner pid=2914832)[0m                                     'ranks': []},
[36m(TaskRunner pid=2914832)[0m                        'ref': {'entropy_checkpointing': False,
[36m(TaskRunner pid=2914832)[0m                                'entropy_from_logits_with_chunking': False,
[36m(TaskRunner pid=2914832)[0m                                'fsdp_config': {'_target_': 'verl.workers.config.FSDPEngineConfig',
[36m(TaskRunner pid=2914832)[0m                                                'forward_prefetch': False,
[36m(TaskRunner pid=2914832)[0m                                                'param_offload': True,
[36m(TaskRunner pid=2914832)[0m                                                'reshard_after_forward': True,
[36m(TaskRunner pid=2914832)[0m                                                'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=2914832)[0m                                'log_prob_max_token_len_per_gpu': 16384,
[36m(TaskRunner pid=2914832)[0m                                'log_prob_micro_batch_size': 16,
[36m(TaskRunner pid=2914832)[0m                                'log_prob_micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=2914832)[0m                                'log_prob_use_dynamic_bsz': False,
[36m(TaskRunner pid=2914832)[0m                                'strategy': 'fsdp',
[36m(TaskRunner pid=2914832)[0m                                'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=2914832)[0m                                'use_torch_compile': True},
[36m(TaskRunner pid=2914832)[0m                        'rollout': {'agent': {'agent_loop_config_path': None,
[36m(TaskRunner pid=2914832)[0m                                              'custom_async_server': {'name': None,
[36m(TaskRunner pid=2914832)[0m                                                                      'path': None},
[36m(TaskRunner pid=2914832)[0m                                              'num_workers': 8},
[36m(TaskRunner pid=2914832)[0m                                    'calculate_log_probs': False,
[36m(TaskRunner pid=2914832)[0m                                    'disable_log_stats': True,
[36m(TaskRunner pid=2914832)[0m                                    'do_sample': True,
[36m(TaskRunner pid=2914832)[0m                                    'dtype': 'bfloat16',
[36m(TaskRunner pid=2914832)[0m                                    'enable_chunked_prefill': True,
[36m(TaskRunner pid=2914832)[0m                                    'enforce_eager': True,
[36m(TaskRunner pid=2914832)[0m                                    'engine_kwargs': {'sglang': {'attention_backend': None},
[36m(TaskRunner pid=2914832)[0m                                                      'vllm': {'disable_mm_preprocessor_cache': False,
[36m(TaskRunner pid=2914832)[0m                                                               'swap_space': None}},
[36m(TaskRunner pid=2914832)[0m                                    'free_cache_engine': True,
[36m(TaskRunner pid=2914832)[0m                                    'gpu_memory_utilization': 0.4,
[36m(TaskRunner pid=2914832)[0m                                    'ignore_eos': False,
[36m(TaskRunner pid=2914832)[0m                                    'layered_summon': False,
[36m(TaskRunner pid=2914832)[0m                                    'load_format': 'dummy_dtensor',
[36m(TaskRunner pid=2914832)[0m                                    'log_prob_max_token_len_per_gpu': 16384,
[36m(TaskRunner pid=2914832)[0m                                    'log_prob_micro_batch_size': 16,
[36m(TaskRunner pid=2914832)[0m                                    'log_prob_micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=2914832)[0m                                    'log_prob_use_dynamic_bsz': False,
[36m(TaskRunner pid=2914832)[0m                                    'max_model_len': None,
[36m(TaskRunner pid=2914832)[0m                                    'max_num_batched_tokens': 8192,
[36m(TaskRunner pid=2914832)[0m                                    'max_num_seqs': 1024,
[36m(TaskRunner pid=2914832)[0m                                    'mode': 'sync',
[36m(TaskRunner pid=2914832)[0m                                    'multi_stage_wake_up': False,
[36m(TaskRunner pid=2914832)[0m                                    'multi_turn': {'enable': False,
[36m(TaskRunner pid=2914832)[0m                                                   'format': 'hermes',
[36m(TaskRunner pid=2914832)[0m                                                   'interaction_config_path': None,
[36m(TaskRunner pid=2914832)[0m                                                   'max_assistant_turns': None,
[36m(TaskRunner pid=2914832)[0m                                                   'max_parallel_calls': 1,
[36m(TaskRunner pid=2914832)[0m                                                   'max_tool_response_length': 256,
[36m(TaskRunner pid=2914832)[0m                                                   'max_user_turns': None,
[36m(TaskRunner pid=2914832)[0m                                                   'tokenization_sanity_check_mode': 'strict',
[36m(TaskRunner pid=2914832)[0m                                                   'tool_config_path': None,
[36m(TaskRunner pid=2914832)[0m                                                   'tool_response_truncate_side': 'middle',
[36m(TaskRunner pid=2914832)[0m                                                   'use_inference_chat_template': False},
[36m(TaskRunner pid=2914832)[0m                                    'n': 1,
[36m(TaskRunner pid=2914832)[0m                                    'name': 'vllm',
[36m(TaskRunner pid=2914832)[0m                                    'prompt_length': 1024,
[36m(TaskRunner pid=2914832)[0m                                    'response_length': 512,
[36m(TaskRunner pid=2914832)[0m                                    'temperature': 1.0,
[36m(TaskRunner pid=2914832)[0m                                    'tensor_model_parallel_size': 1,
[36m(TaskRunner pid=2914832)[0m                                    'top_k': -1,
[36m(TaskRunner pid=2914832)[0m                                    'top_p': 1,
[36m(TaskRunner pid=2914832)[0m                                    'trace': {'backend': None,
[36m(TaskRunner pid=2914832)[0m                                              'token2text': False},
[36m(TaskRunner pid=2914832)[0m                                    'update_weights_bucket_megabytes': 512,
[36m(TaskRunner pid=2914832)[0m                                    'val_kwargs': {'do_sample': False,
[36m(TaskRunner pid=2914832)[0m                                                   'n': 1,
[36m(TaskRunner pid=2914832)[0m                                                   'temperature': 0,
[36m(TaskRunner pid=2914832)[0m                                                   'top_k': -1,
[36m(TaskRunner pid=2914832)[0m                                                   'top_p': 1.0}}},
[36m(TaskRunner pid=2914832)[0m  'algorithm': {'_target_': 'verl.trainer.config.AlgoConfig',
[36m(TaskRunner pid=2914832)[0m                'adv_estimator': 'gae',
[36m(TaskRunner pid=2914832)[0m                'gamma': 1.0,
[36m(TaskRunner pid=2914832)[0m                'kl_ctrl': {'_target_': 'verl.trainer.config.KLControlConfig',
[36m(TaskRunner pid=2914832)[0m                            'horizon': 10000,
[36m(TaskRunner pid=2914832)[0m                            'kl_coef': 0.001,
[36m(TaskRunner pid=2914832)[0m                            'target_kl': 0.1,
[36m(TaskRunner pid=2914832)[0m                            'type': 'fixed'},
[36m(TaskRunner pid=2914832)[0m                'kl_penalty': 'kl',
[36m(TaskRunner pid=2914832)[0m                'lam': 1.0,
[36m(TaskRunner pid=2914832)[0m                'norm_adv_by_std_in_grpo': True,
[36m(TaskRunner pid=2914832)[0m                'pf_ppo': {'reweight_method': 'pow', 'weight_pow': 2.0},
[36m(TaskRunner pid=2914832)[0m                'use_kl_in_reward': False,
[36m(TaskRunner pid=2914832)[0m                'use_pf_ppo': False},
[36m(TaskRunner pid=2914832)[0m  'critic': {'_target_': 'verl.workers.config.FSDPCriticConfig',
[36m(TaskRunner pid=2914832)[0m             'checkpoint': {'_target_': 'verl.trainer.config.CheckpointConfig',
[36m(TaskRunner pid=2914832)[0m                            'async_save': False,
[36m(TaskRunner pid=2914832)[0m                            'load_contents': ['model', 'optimizer', 'extra'],
[36m(TaskRunner pid=2914832)[0m                            'save_contents': ['model', 'optimizer', 'extra']},
[36m(TaskRunner pid=2914832)[0m             'cliprange_value': 0.5,
[36m(TaskRunner pid=2914832)[0m             'enable': None,
[36m(TaskRunner pid=2914832)[0m             'forward_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=2914832)[0m             'forward_micro_batch_size': None,
[36m(TaskRunner pid=2914832)[0m             'forward_micro_batch_size_per_gpu': 4,
[36m(TaskRunner pid=2914832)[0m             'grad_clip': 1.0,
[36m(TaskRunner pid=2914832)[0m             'loss_agg_mode': 'token-mean',
[36m(TaskRunner pid=2914832)[0m             'model': {'_target_': 'verl.workers.config.FSDPCriticModelCfg',
[36m(TaskRunner pid=2914832)[0m                       'enable_activation_offload': False,
[36m(TaskRunner pid=2914832)[0m                       'enable_gradient_checkpointing': False,
[36m(TaskRunner pid=2914832)[0m                       'external_lib': None,
[36m(TaskRunner pid=2914832)[0m                       'fsdp_config': {'_target_': 'verl.workers.config.FSDPEngineConfig',
[36m(TaskRunner pid=2914832)[0m                                       'forward_prefetch': False,
[36m(TaskRunner pid=2914832)[0m                                       'fsdp_size': -1,
[36m(TaskRunner pid=2914832)[0m                                       'offload_policy': False,
[36m(TaskRunner pid=2914832)[0m                                       'optimizer_offload': False,
[36m(TaskRunner pid=2914832)[0m                                       'param_offload': False,
[36m(TaskRunner pid=2914832)[0m                                       'reshard_after_forward': True,
[36m(TaskRunner pid=2914832)[0m                                       'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=2914832)[0m                       'lora_alpha': 16,
[36m(TaskRunner pid=2914832)[0m                       'lora_rank': 0,
[36m(TaskRunner pid=2914832)[0m                       'override_config': {},
[36m(TaskRunner pid=2914832)[0m                       'path': 'Qwen/Qwen2.5-0.5B-Instruct',
[36m(TaskRunner pid=2914832)[0m                       'target_modules': 'all-linear',
[36m(TaskRunner pid=2914832)[0m                       'tokenizer_path': 'Qwen/Qwen2.5-0.5B-Instruct',
[36m(TaskRunner pid=2914832)[0m                       'trust_remote_code': False,
[36m(TaskRunner pid=2914832)[0m                       'use_remove_padding': False,
[36m(TaskRunner pid=2914832)[0m                       'use_shm': False},
[36m(TaskRunner pid=2914832)[0m             'optim': {'_target_': 'verl.workers.config.FSDPOptimizerConfig',
[36m(TaskRunner pid=2914832)[0m                       'lr': 1e-05,
[36m(TaskRunner pid=2914832)[0m                       'lr_warmup_steps': -1,
[36m(TaskRunner pid=2914832)[0m                       'lr_warmup_steps_ratio': 0.0,
[36m(TaskRunner pid=2914832)[0m                       'min_lr_ratio': None,
[36m(TaskRunner pid=2914832)[0m                       'total_training_steps': -1,
[36m(TaskRunner pid=2914832)[0m                       'warmup_style': 'constant',
[36m(TaskRunner pid=2914832)[0m                       'weight_decay': 0.01},
[36m(TaskRunner pid=2914832)[0m             'ppo_epochs': 1,
[36m(TaskRunner pid=2914832)[0m             'ppo_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=2914832)[0m             'ppo_micro_batch_size': None,
[36m(TaskRunner pid=2914832)[0m             'ppo_micro_batch_size_per_gpu': 4,
[36m(TaskRunner pid=2914832)[0m             'ppo_mini_batch_size': 64,
[36m(TaskRunner pid=2914832)[0m             'profiler': {'_target_': 'verl.utils.profiler.ProfilerConfig',
[36m(TaskRunner pid=2914832)[0m                          'all_ranks': False,
[36m(TaskRunner pid=2914832)[0m                          'discrete': False,
[36m(TaskRunner pid=2914832)[0m                          'ranks': []},
[36m(TaskRunner pid=2914832)[0m             'rollout_n': 1,
[36m(TaskRunner pid=2914832)[0m             'shuffle': True,
[36m(TaskRunner pid=2914832)[0m             'strategy': 'fsdp',
[36m(TaskRunner pid=2914832)[0m             'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=2914832)[0m             'use_dynamic_bsz': False},
[36m(TaskRunner pid=2914832)[0m  'custom_reward_function': {'name': 'compute_score',
[36m(TaskRunner pid=2914832)[0m                             'path': '/home/yeopjin/orcd/pool/workspace/RL_NTL/custom_NTL.py'},
[36m(TaskRunner pid=2914832)[0m  'data': {'custom_cls': {'name': None, 'path': None},
[36m(TaskRunner pid=2914832)[0m           'datagen': {'name': None, 'path': None},
[36m(TaskRunner pid=2914832)[0m           'dataloader_num_workers': 8,
[36m(TaskRunner pid=2914832)[0m           'filter_overlong_prompts': False,
[36m(TaskRunner pid=2914832)[0m           'filter_overlong_prompts_workers': 1,
[36m(TaskRunner pid=2914832)[0m           'image_key': 'images',
[36m(TaskRunner pid=2914832)[0m           'max_prompt_length': 1024,
[36m(TaskRunner pid=2914832)[0m           'max_response_length': 512,
[36m(TaskRunner pid=2914832)[0m           'prompt_key': 'prompt',
[36m(TaskRunner pid=2914832)[0m           'return_full_prompt': False,
[36m(TaskRunner pid=2914832)[0m           'return_multi_modal_inputs': True,
[36m(TaskRunner pid=2914832)[0m           'return_raw_chat': False,
[36m(TaskRunner pid=2914832)[0m           'return_raw_input_ids': False,
[36m(TaskRunner pid=2914832)[0m           'reward_fn_key': 'data_source',
[36m(TaskRunner pid=2914832)[0m           'sampler': {'class_name': None, 'class_path': None},
[36m(TaskRunner pid=2914832)[0m           'shuffle': True,
[36m(TaskRunner pid=2914832)[0m           'tokenizer': None,
[36m(TaskRunner pid=2914832)[0m           'train_batch_size': 256,
[36m(TaskRunner pid=2914832)[0m           'train_files': '/home/yeopjin/orcd/pool/workspace/RL_NTL/data/train.parquet',
[36m(TaskRunner pid=2914832)[0m           'truncation': 'error',
[36m(TaskRunner pid=2914832)[0m           'trust_remote_code': False,
[36m(TaskRunner pid=2914832)[0m           'use_shm': False,
[36m(TaskRunner pid=2914832)[0m           'val_batch_size': 1312,
[36m(TaskRunner pid=2914832)[0m           'val_files': '/home/yeopjin/orcd/pool/workspace/RL_NTL/data/test.parquet',
[36m(TaskRunner pid=2914832)[0m           'validation_shuffle': False,
[36m(TaskRunner pid=2914832)[0m           'video_key': 'videos'},
[36m(TaskRunner pid=2914832)[0m  'ray_init': {'num_cpus': None, 'timeline_json_file': None},
[36m(TaskRunner pid=2914832)[0m  'reward_model': {'enable': False,
[36m(TaskRunner pid=2914832)[0m                   'forward_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=2914832)[0m                   'launch_reward_fn_async': False,
[36m(TaskRunner pid=2914832)[0m                   'max_length': None,
[36m(TaskRunner pid=2914832)[0m                   'micro_batch_size': 64,
[36m(TaskRunner pid=2914832)[0m                   'micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=2914832)[0m                   'model': {'external_lib': None,
[36m(TaskRunner pid=2914832)[0m                             'fsdp_config': {'_target_': 'verl.workers.config.FSDPEngineConfig',
[36m(TaskRunner pid=2914832)[0m                                             'forward_prefetch': False,
[36m(TaskRunner pid=2914832)[0m                                             'fsdp_size': -1,
[36m(TaskRunner pid=2914832)[0m                                             'param_offload': False,
[36m(TaskRunner pid=2914832)[0m                                             'reshard_after_forward': True,
[36m(TaskRunner pid=2914832)[0m                                             'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=2914832)[0m                             'input_tokenizer': 'Qwen/Qwen2.5-0.5B-Instruct',
[36m(TaskRunner pid=2914832)[0m                             'path': '~/models/FsfairX-LLaMA3-RM-v0.1',
[36m(TaskRunner pid=2914832)[0m                             'trust_remote_code': False,
[36m(TaskRunner pid=2914832)[0m                             'use_fused_kernels': False,
[36m(TaskRunner pid=2914832)[0m                             'use_remove_padding': False,
[36m(TaskRunner pid=2914832)[0m                             'use_shm': False},
[36m(TaskRunner pid=2914832)[0m                   'profiler': {'_target_': 'verl.utils.profiler.ProfilerConfig',
[36m(TaskRunner pid=2914832)[0m                                'all_ranks': False,
[36m(TaskRunner pid=2914832)[0m                                'discrete': False,
[36m(TaskRunner pid=2914832)[0m                                'ranks': []},
[36m(TaskRunner pid=2914832)[0m                   'reward_manager': 'naive',
[36m(TaskRunner pid=2914832)[0m                   'sandbox_fusion': {'max_concurrent': 64,
[36m(TaskRunner pid=2914832)[0m                                      'memory_limit_mb': 1024,
[36m(TaskRunner pid=2914832)[0m                                      'url': None},
[36m(TaskRunner pid=2914832)[0m                   'strategy': 'fsdp',
[36m(TaskRunner pid=2914832)[0m                   'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=2914832)[0m                   'use_dynamic_bsz': False},
[36m(TaskRunner pid=2914832)[0m  'trainer': {'balance_batch': True,
[36m(TaskRunner pid=2914832)[0m              'controller_nsight_options': {'cuda-graph-trace': 'graph',
[36m(TaskRunner pid=2914832)[0m                                            'cuda-memory-usage': 'true',
[36m(TaskRunner pid=2914832)[0m                                            'trace': 'cuda,nvtx,cublas,ucx'},
[36m(TaskRunner pid=2914832)[0m              'critic_warmup': 0,
[36m(TaskRunner pid=2914832)[0m              'default_hdfs_dir': None,
[36m(TaskRunner pid=2914832)[0m              'default_local_dir': 'checkpoints/RL-NTL/gsm8k-ppo-qwen2.5-0.5b-Jul29-DefaultLoss',
[36m(TaskRunner pid=2914832)[0m              'del_local_ckpt_after_load': False,
[36m(TaskRunner pid=2914832)[0m              'device': 'cuda',
[36m(TaskRunner pid=2914832)[0m              'esi_redundant_time': 0,
[36m(TaskRunner pid=2914832)[0m              'experiment_name': 'gsm8k-ppo-qwen2.5-0.5b-Jul29-DefaultLoss',
[36m(TaskRunner pid=2914832)[0m              'log_val_generations': 0,
[36m(TaskRunner pid=2914832)[0m              'logger': ['console', 'wandb'],
[36m(TaskRunner pid=2914832)[0m              'max_actor_ckpt_to_keep': None,
[36m(TaskRunner pid=2914832)[0m              'max_critic_ckpt_to_keep': None,
[36m(TaskRunner pid=2914832)[0m              'mode': 'standard',
[36m(TaskRunner pid=2914832)[0m              'n_gpus_per_node': 4,
[36m(TaskRunner pid=2914832)[0m              'nnodes': 1,
[36m(TaskRunner pid=2914832)[0m              'npu_profile': {'options': {'analysis': True,
[36m(TaskRunner pid=2914832)[0m                                          'level': 'level1',
[36m(TaskRunner pid=2914832)[0m                                          'record_shapes': False,
[36m(TaskRunner pid=2914832)[0m                                          'roles': ['all'],
[36m(TaskRunner pid=2914832)[0m                                          'save_path': './profiler_data',
[36m(TaskRunner pid=2914832)[0m                                          'with_cpu': True,
[36m(TaskRunner pid=2914832)[0m                                          'with_memory': False,
[36m(TaskRunner pid=2914832)[0m                                          'with_module': False,
[36m(TaskRunner pid=2914832)[0m                                          'with_npu': True,
[36m(TaskRunner pid=2914832)[0m                                          'with_stack': False}},
[36m(TaskRunner pid=2914832)[0m              'profile_steps': None,
[36m(TaskRunner pid=2914832)[0m              'project_name': 'RL-NTL',
[36m(TaskRunner pid=2914832)[0m              'ray_wait_register_center_timeout': 300,
[36m(TaskRunner pid=2914832)[0m              'resume_from_path': None,
[36m(TaskRunner pid=2914832)[0m              'resume_mode': 'auto',
[36m(TaskRunner pid=2914832)[0m              'rollout_data_dir': None,
[36m(TaskRunner pid=2914832)[0m              'save_freq': -1,
[36m(TaskRunner pid=2914832)[0m              'test_freq': 10,
[36m(TaskRunner pid=2914832)[0m              'total_epochs': 15,
[36m(TaskRunner pid=2914832)[0m              'total_training_steps': None,
[36m(TaskRunner pid=2914832)[0m              'use_legacy_worker_impl': 'auto',
[36m(TaskRunner pid=2914832)[0m              'val_before_train': True,
[36m(TaskRunner pid=2914832)[0m              'val_only': False,
[36m(TaskRunner pid=2914832)[0m              'validation_data_dir': None,
[36m(TaskRunner pid=2914832)[0m              'worker_nsight_options': {'capture-range': 'cudaProfilerApi',
[36m(TaskRunner pid=2914832)[0m                                        'capture-range-end': None,
[36m(TaskRunner pid=2914832)[0m                                        'cuda-graph-trace': 'graph',
[36m(TaskRunner pid=2914832)[0m                                        'cuda-memory-usage': 'true',
[36m(TaskRunner pid=2914832)[0m                                        'kill': 'none',
[36m(TaskRunner pid=2914832)[0m                                        'trace': 'cuda,nvtx,cublas,ucx'}}}
[36m(TaskRunner pid=2914832)[0m using customized reward function 'compute_score' from '/home/yeopjin/orcd/pool/workspace/RL_NTL/custom_NTL.py'
[36m(TaskRunner pid=2914832)[0m using customized reward function 'compute_score' from '/home/yeopjin/orcd/pool/workspace/RL_NTL/custom_NTL.py'
[36m(TaskRunner pid=2914832)[0m Using dataset class: RLHFDataset
[36m(TaskRunner pid=2914832)[0m dataset len: 7473
[36m(TaskRunner pid=2914832)[0m Using dataset class: RLHFDataset
[36m(TaskRunner pid=2914832)[0m dataset len: 1319
[36m(TaskRunner pid=2914832)[0m WARNING: val_batch_size is deprecated. Validation datasets are sent to inference engines as a whole batch, which will schedule the memory themselves.
[36m(TaskRunner pid=2914832)[0m [validate_config] All configuration checks passed successfully!
[36m(TaskRunner pid=2914832)[0m Size of train dataloader: 29, Size of val dataloader: 2
[36m(TaskRunner pid=2914832)[0m Total training steps: 435
[36m(TaskRunner pid=2914832)[0m colocated worker base class <class 'verl.single_controller.base.worker.Worker'>
[36m(TaskRunner pid=2914832)[0m DeprecationWarning: `ray.state.available_resources_per_node` is a private attribute and access will be removed in a future Ray version.
[36m(TaskRunner pid=2914832)[0m WARNING:2025-07-29 15:00:48,967:Waiting for register center actor jFZUVr_register_center to be ready. Elapsed time: 0 seconds out of 300 seconds.
[36m(WorkerDict pid=2915982)[0m Flash Attention 2.0 only supports torch.float16 and torch.bfloat16 dtypes, but the current dype in Qwen2ForTokenClassification is torch.float32. You should run training or inference using Automatic Mixed-Precision via the `with torch.autocast(device_type='torch_device'):` decorator, or load the model with the `torch_dtype` argument. Example: `model = AutoModel.from_pretrained("openai/whisper-tiny", attn_implementation="flash_attention_2", torch_dtype=torch.float16)`
[36m(WorkerDict pid=2915982)[0m You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
[36m(WorkerDict pid=2915538)[0m Critic overriding config {'bos_token_id': None, 'eos_token_id': 151645, 'pad_token_id': 151643}
[36m(WorkerDict pid=2915982)[0m Skipping monkey patch for Qwen2ForTokenClassification as use_fused_kernels is False or fused_kernels_backend is None
[36m(WorkerDict pid=2915982)[0m Some weights of Qwen2ForTokenClassification were not initialized from the model checkpoint at Qwen/Qwen2.5-0.5B-Instruct and are newly initialized: ['score.bias', 'score.weight']
[36m(WorkerDict pid=2915982)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(WorkerDict pid=2915538)[0m Qwen2ForTokenClassification contains 494.03M parameters
[36m(WorkerDict pid=2915538)[0m Before critic FSDP, memory allocated (GB): 0.00, memory reserved (GB): 0.00, device memory used/total (GB): 0.42/44.52
[36m(WorkerDict pid=2915538)[0m NCCL version 2.21.5+cuda12.4
[36m(WorkerDict pid=2915538)[0m After critic FSDP, memory allocated (GB): 0.46, memory reserved (GB): 2.21, device memory used/total (GB): 2.85/44.52
[36m(WorkerDict pid=2915538)[0m Total steps: 435, num_warmup_steps: 0
[36m(WorkerDict pid=2915538)[0m Critic use_remove_padding=False
[36m(WorkerDict pid=2915538)[0m Model config after override: Qwen2Config {
[36m(WorkerDict pid=2915538)[0m   "architectures": [
[36m(WorkerDict pid=2915538)[0m     "Qwen2ForCausalLM"
[36m(WorkerDict pid=2915538)[0m   ],
[36m(WorkerDict pid=2915538)[0m   "attention_dropout": 0.0,
[36m(WorkerDict pid=2915538)[0m   "eos_token_id": 151645,
[36m(WorkerDict pid=2915538)[0m   "hidden_act": "silu",
[36m(WorkerDict pid=2915538)[0m   "hidden_size": 896,
[36m(WorkerDict pid=2915538)[0m   "initializer_range": 0.02,
[36m(WorkerDict pid=2915538)[0m   "intermediate_size": 4864,
[36m(WorkerDict pid=2915538)[0m   "layer_types": [
[36m(WorkerDict pid=2915538)[0m     "full_attention",
[36m(WorkerDict pid=2915538)[0m     "full_attention",
[36m(WorkerDict pid=2915538)[0m     "full_attention",
[36m(WorkerDict pid=2915538)[0m     "full_attention",
[36m(WorkerDict pid=2915538)[0m     "full_attention",
[36m(WorkerDict pid=2915538)[0m     "full_attention",
[36m(WorkerDict pid=2915538)[0m     "full_attention",
[36m(WorkerDict pid=2915538)[0m     "full_attention",
[36m(WorkerDict pid=2915538)[0m     "full_attention",
[36m(WorkerDict pid=2915538)[0m     "full_attention",
[36m(WorkerDict pid=2915538)[0m     "full_attention",
[36m(WorkerDict pid=2915538)[0m     "full_attention",
[36m(WorkerDict pid=2915538)[0m     "full_attention",
[36m(WorkerDict pid=2915538)[0m     "full_attention",
[36m(WorkerDict pid=2915538)[0m     "full_attention",
[36m(WorkerDict pid=2915538)[0m     "full_attention",
[36m(WorkerDict pid=2915538)[0m     "full_attention",
[36m(WorkerDict pid=2915538)[0m     "full_attention",
[36m(WorkerDict pid=2915538)[0m     "full_attention",
[36m(WorkerDict pid=2915538)[0m     "full_attention",
[36m(WorkerDict pid=2915538)[0m     "full_attention",
[36m(WorkerDict pid=2915538)[0m     "full_attention",
[36m(WorkerDict pid=2915538)[0m     "full_attention",
[36m(WorkerDict pid=2915538)[0m     "full_attention"
[36m(WorkerDict pid=2915538)[0m   ],
[36m(WorkerDict pid=2915538)[0m   "max_position_embeddings": 32768,
[36m(WorkerDict pid=2915538)[0m   "max_window_layers": 21,
[36m(WorkerDict pid=2915538)[0m   "model_type": "qwen2",
[36m(WorkerDict pid=2915538)[0m   "num_attention_heads": 14,
[36m(WorkerDict pid=2915538)[0m   "num_hidden_layers": 24,
[36m(WorkerDict pid=2915538)[0m   "num_key_value_heads": 2,
[36m(WorkerDict pid=2915538)[0m   "pad_token_id": 151643,
[36m(WorkerDict pid=2915538)[0m   "rms_norm_eps": 1e-06,
[36m(WorkerDict pid=2915538)[0m   "rope_scaling": null,
[36m(WorkerDict pid=2915538)[0m   "rope_theta": 1000000.0,
[36m(WorkerDict pid=2915538)[0m   "sliding_window": null,
[36m(WorkerDict pid=2915538)[0m   "tie_word_embeddings": true,
[36m(WorkerDict pid=2915538)[0m   "torch_dtype": "bfloat16",
[36m(WorkerDict pid=2915538)[0m   "transformers_version": "4.53.2",
[36m(WorkerDict pid=2915538)[0m   "use_cache": true,
[36m(WorkerDict pid=2915538)[0m   "use_sliding_window": false,
[36m(WorkerDict pid=2915538)[0m   "vocab_size": 151936
[36m(WorkerDict pid=2915538)[0m }
[36m(WorkerDict pid=2915538)[0m 
[36m(WorkerDict pid=2915538)[0m Skipping monkey patch for Qwen2ForCausalLM as use_fused_kernels is False or fused_kernels_backend is torch
[36m(WorkerDict pid=2915538)[0m Qwen2ForCausalLM contains 494.03M parameters
[36m(WorkerDict pid=2915538)[0m wrap_policy: functools.partial(<function _or_policy at 0x14d6edbcb0a0>, policies=[functools.partial(<function transformer_auto_wrap_policy at 0x14d6edbcaf80>, transformer_layer_cls={<class 'transformers.models.qwen2.modeling_qwen2.Qwen2DecoderLayer'>})])
[36m(WorkerDict pid=2915538)[0m Total steps: 435, num_warmup_steps: 0
[36m(WorkerDict pid=2915538)[0m Actor use_remove_padding=False
[36m(WorkerDict pid=2915538)[0m Actor use_fused_kernels=False
[36m(WorkerDict pid=2915538)[0m WARNING 07-29 15:01:14 [cuda.py:96] To see benefits of async output processing, enable CUDA graph. Since, enforce-eager is enabled, async output processor cannot be used
[36m(WorkerDict pid=2915538)[0m Skipping monkey patch for Qwen2ForTokenClassification as use_fused_kernels is False or fused_kernels_backend is None[32m [repeated 3x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)[0m
[36m(WorkerDict pid=2915983)[0m Critic use_remove_padding=False[32m [repeated 3x across cluster][0m
[36m(WorkerDict pid=2915983)[0m Skipping monkey patch for Qwen2ForCausalLM as use_fused_kernels is False or fused_kernels_backend is torch[32m [repeated 3x across cluster][0m
[36m(WorkerDict pid=2915982)[0m WARNING 07-29 15:01:14 [utils.py:2444] Methods determine_num_available_blocks,device_config,get_cache_block_size_bytes,initialize_cache not implemented in <vllm.v1.worker.gpu_worker.Worker object at 0x14be86fb4820>
[36m(WorkerDict pid=2915538)[0m WARNING 07-29 15:01:16 [topk_topp_sampler.py:69] FlashInfer is not available. Falling back to the PyTorch-native implementation of top-p & top-k sampling. For the best performance, please install FlashInfer.
[36m(WorkerDict pid=2915538)[0m kwargs: {'n': 1, 'logprobs': 0, 'max_tokens': 512, 'detokenize': False, 'temperature': 1.0, 'top_k': -1, 'top_p': 1, 'ignore_eos': False}
[36m(WorkerDict pid=2915538)[0m /home/yeopjin/orcd/pool/conda_install/envs/ntl/lib/python3.10/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:690: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .
[36m(WorkerDict pid=2915538)[0m   warnings.warn(
[36m(WorkerDict pid=2915981)[0m Flash Attention 2.0 only supports torch.float16 and torch.bfloat16 dtypes, but the current dype in Qwen2ForCausalLM is torch.float32. You should run training or inference using Automatic Mixed-Precision via the `with torch.autocast(device_type='torch_device'):` decorator, or load the model with the `torch_dtype` argument. Example: `model = AutoModel.from_pretrained("openai/whisper-tiny", attn_implementation="flash_attention_2", torch_dtype=torch.float16)`[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2915538)[0m You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.[32m [repeated 3x across cluster][0m
[36m(WorkerDict pid=2915538)[0m Some weights of Qwen2ForTokenClassification were not initialized from the model checkpoint at Qwen/Qwen2.5-0.5B-Instruct and are newly initialized: ['score.bias', 'score.weight'][32m [repeated 3x across cluster][0m
[36m(WorkerDict pid=2915538)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.[32m [repeated 3x across cluster][0m
[36m(TaskRunner pid=2914832)[0m wandb: WARNING Path /nobackup/users/yeopjin/.cache/wandb/wandb/ wasn't writable, using system temp directory
[36m(TaskRunner pid=2914832)[0m wandb: Currently logged in as: sjinyeop to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[36m(TaskRunner pid=2914832)[0m wandb: WARNING Unable to create root directory /nobackup/users/yeopjin/.cache/wandb
[36m(TaskRunner pid=2914832)[0m wandb: WARNING Falling back to temporary directory /tmp.
[36m(TaskRunner pid=2914832)[0m wandb: Tracking run with wandb version 0.21.0
[36m(TaskRunner pid=2914832)[0m wandb: Run data is saved locally in /tmp/wandb/run-20250729_150119-s005hbu5
[36m(TaskRunner pid=2914832)[0m wandb: Run `wandb offline` to turn off syncing.
[36m(TaskRunner pid=2914832)[0m wandb: Syncing run gsm8k-ppo-qwen2.5-0.5b-Jul29-DefaultLoss
[36m(TaskRunner pid=2914832)[0m wandb: ⭐️ View project at https://wandb.ai/sjinyeop/RL-NTL
[36m(TaskRunner pid=2914832)[0m wandb: 🚀 View run at https://wandb.ai/sjinyeop/RL-NTL/runs/s005hbu5
[36m(TaskRunner pid=2914832)[0m Checkpoint tracker file does not exist: /orcd/pool/006/yeopjin/workspace/RL_NTL/checkpoints/RL-NTL/gsm8k-ppo-qwen2.5-0.5b-Jul29-DefaultLoss/latest_checkpointed_iteration.txt
[36m(TaskRunner pid=2914832)[0m Training from scratch
[36m(WorkerDict pid=2915981)[0m WARNING 07-29 15:01:15 [cuda.py:96] To see benefits of async output processing, enable CUDA graph. Since, enforce-eager is enabled, async output processor cannot be used[32m [repeated 3x across cluster][0m
[36m(WorkerDict pid=2915981)[0m WARNING 07-29 15:01:15 [utils.py:2444] Methods determine_num_available_blocks,device_config,get_cache_block_size_bytes,initialize_cache not implemented in <vllm.v1.worker.gpu_worker.Worker object at 0x14aca2afc730>[32m [repeated 3x across cluster][0m
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 0}
[36m(WorkerDict pid=2915983)[0m WARNING 07-29 15:01:16 [topk_topp_sampler.py:69] FlashInfer is not available. Falling back to the PyTorch-native implementation of top-p & top-k sampling. For the best performance, please install FlashInfer.[32m [repeated 3x across cluster][0m
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(WorkerDict pid=2915983)[0m kwargs: {'n': 1, 'logprobs': 0, 'max_tokens': 512, 'detokenize': False, 'temperature': 1.0, 'top_k': -1, 'top_p': 1, 'ignore_eos': False}[32m [repeated 3x across cluster][0m
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and bakes muffins for her friends every day with four. She sells the remainder at the farmers' market daily for $2 per fresh duck egg. How much in dollars does she make every day at the farmers' market? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much Janet makes at the farmers' market every day, we need to follow these steps:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. **Calculate the total number of eggs laid by the ducks in a day:**
[36m(TaskRunner pid=2914832)[0m    - Janet's ducks lay 16 eggs per day.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 2. **Calculate the total number of eggs Janet eats in a day:**
[36m(TaskRunner pid=2914832)[0m    - Janet eats 3 eggs for breakfast.
[36m(TaskRunner pid=2914832)[0m    - She eats 4 muffins for baking.
[36m(TaskRunner pid=2914832)[0m    - Therefore, the total number of eggs she eats in a day is:
[36m(TaskRunner pid=2914832)[0m      \[
[36m(TaskRunner pid=2914832)[0m      3 \text{ (breakfast)} + 4 \text{ (baking)} = 7 \text{ eggs}
[36m(TaskRunner pid=2914832)[0m      \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 3. **Calculate the number of eggs Janet sells at the farmers' market:**
[36m(TaskRunner pid=2914832)[0m    - The total number of eggs laid by the ducks is 16.
[36m(TaskRunner pid=2914832)[0m    - The number of eggs she eats is 7.
[36m(TaskRunner pid=2914832)[0m    - Therefore, the number of eggs she sells is:
[36m(TaskRunner pid=2914832)[0m      \[
[36m(TaskRunner pid=2914832)[0m      16 \text{ (total)} - 7 \text{ (eaten)} = 9 \text{ eggs}
[36m(TaskRunner pid=2914832)[0m      \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 4. **Calculate the total revenue from selling the eggs at the farmers' market:**
[36m(TaskRunner pid=2914832)[0m    - Janet sells each egg for $2.
[36m(TaskRunner pid=2914832)[0m    - The number of eggs sold is 9.
[36m(TaskRunner pid=2914832)[0m    - Therefore, the total revenue is:
[36m(TaskRunner pid=2914832)[0m      \[
[36m(TaskRunner pid=2914832)[0m      9 \text{ eggs} \times 2 \text{ dollars/egg} = 18 \text{ dollars}
[36m(TaskRunner pid=2914832)[0m      \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Thus, Janet makes \(\boxed{18}\) dollars every day at the farmers' market.
[36m(TaskRunner pid=2914832)[0m [ground_truth] 18
[36m(TaskRunner pid=2914832)[0m [score] 0.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1312
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 0}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Tom's restaurant gets 6 reservations a night.  They normally order 2 meals that cost $5 each and a $5 bottle of wine.  How much do they make a week if they are open 2 days a week? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much Tom's restaurant makes in a week, we need to calculate the total number of reservations and the total revenue from these reservations. Here's the step-by-step process:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. **Calculate the total number of reservations per night:**
[36m(TaskRunner pid=2914832)[0m    - Tom's restaurant gets 6 reservations a night.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 2. **Calculate the total number of reservations per week:**
[36m(TaskRunner pid=2914832)[0m    - Since the restaurant is open 2 days a week, the total number of reservations per week is:
[36m(TaskRunner pid=2914832)[0m      \[
[36m(TaskRunner pid=2914832)[0m      6 \text{ reservations/day} \times 2 \text{ days/week} = 12 \text{ reservations/week}
[36m(TaskRunner pid=2914832)[0m      \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 3. **Calculate the total revenue from reservations:**
[36m(TaskRunner pid=2914832)[0m    - The restaurant normally orders 2 meals that cost $5 each and a $5 bottle of wine.
[36m(TaskRunner pid=2914832)[0m    - The total cost for the meals is:
[36m(TaskRunner pid=2914832)[0m      \[
[36m(TaskRunner pid=2914832)[0m      2 \text{ meals} \times \$5/\text{meal} = \$10
[36m(TaskRunner pid=2914832)[0m      \]
[36m(TaskRunner pid=2914832)[0m    - The total cost for the wine is:
[36m(TaskRunner pid=2914832)[0m      \[
[36m(TaskRunner pid=2914832)[0m      1 \text{ bottle} \times \$5/\text{bottle} = \$5
[36m(TaskRunner pid=2914832)[0m      \]
[36m(TaskRunner pid=2914832)[0m    - Therefore, the total revenue from reservations is:
[36m(TaskRunner pid=2914832)[0m      \[
[36m(TaskRunner pid=2914832)[0m      \$10 + \$5 = \$15
[36m(TaskRunner pid=2914832)[0m      \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 4. **Calculate the total weekly revenue:**
[36m(TaskRunner pid=2914832)[0m    - The total weekly revenue is the total revenue from reservations multiplied by the number of reservations per week:
[36m(TaskRunner pid=2914832)[0m      \[
[36m(TaskRunner pid=2914832)[0m      \$15 \times 12 \text{ reservations/week} = \$180
[36m(TaskRunner pid=2914832)[0m      \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Thus, the total amount Tom's restaurant makes in a week is \(\boxed{180}\).
[36m(TaskRunner pid=2914832)[0m [ground_truth] 180
[36m(TaskRunner pid=2914832)[0m [score] 0.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1319
[36m(TaskRunner pid=2914832)[0m ("Initial validation metrics: {'val-core/openai/gsm8k/reward/mean@1': "
[36m(TaskRunner pid=2914832)[0m  '0.000758150113722517}')
[36m(TaskRunner pid=2914832)[0m step:0 - val-core/openai/gsm8k/reward/mean@1:0.000758150113722517
[36m(TaskRunner pid=2914832)[0m Training Progress:   0%|          | 0/435 [00:00<?, ?it/s]
[36m(WorkerDict pid=2915983)[0m /home/yeopjin/orcd/pool/conda_install/envs/ntl/lib/python3.10/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:690: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .[32m [repeated 3x across cluster][0m
[36m(WorkerDict pid=2915983)[0m   warnings.warn([32m [repeated 3x across cluster][0m
[36m(TaskRunner pid=2914832)[0m step:1 - global_seqlen/min:24290 - global_seqlen/max:26579 - global_seqlen/minmax_diff:2289 - global_seqlen/balanced_min:25624 - global_seqlen/balanced_max:25625 - global_seqlen/mean:25624.5 - actor/entropy:0.4925868511199951 - critic/vf_loss:15.21254825592041 - critic/vf_clipfrac:0.5016189254820347 - critic/vpred_mean:-1.7220328385010362 - critic/grad_norm:718.4734840393066 - perf/mfu/critic:0.09458364324845682 - critic/lr:1e-05 - actor/pg_loss:0.05630244396161288 - actor/pg_clipfrac:0.0011143895753775723 - actor/ppo_kl:0.00017715045760269277 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.9046536087989807 - perf/mfu/actor:0.08134849501714095 - perf/max_memory_allocated_gb:34.02649974822998 - perf/max_memory_reserved_gb:39.77734375 - perf/cpu_memory_used_gb:88.67679977416992 - actor/lr:1e-06 - training/global_step:1 - training/epoch:0 - critic/score/mean:0.0 - critic/score/max:0.0 - critic/score/min:0.0 - critic/rewards/mean:0.0 - critic/rewards/max:0.0 - critic/rewards/min:0.0 - critic/advantages/mean:-2.681295541151485e-08 - critic/advantages/max:3.7388319969177246 - critic/advantages/min:-4.39470100402832 - critic/returns/mean:0.0 - critic/returns/max:0.0 - critic/returns/min:0.0 - critic/values/mean:-4.03125 - critic/values/max:13.5625 - critic/values/min:-19.0 - critic/vf_explained_var:-1602790.25 - response_length/mean:295.65625 - response_length/max:512.0 - response_length/min:80.0 - response_length/clip_ratio:0.0859375 - prompt_length/mean:104.7265625 - prompt_length/max:189.0 - prompt_length/min:66.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:1.6673002392053604e-05 - timing_s/generate_sequences:3.5416321754455566 - timing_s/reshard:0.307653546333313 - timing_s/gen:4.4940165020525455 - timing_s/reward:0.03465992398560047 - timing_s/old_log_prob:2.6717595527879894 - timing_s/values:1.3544748211279511 - timing_s/adv:0.03389246901497245 - timing_s/update_critic:5.837322256993502 - timing_s/update_actor:6.787295297719538 - timing_s/step:21.22063713008538 - timing_s/stop_profile:7.24010169506073e-06 - timing_per_token_ms/values:0.013214646345567242 - timing_per_token_ms/adv:0.00033066468628629287 - timing_per_token_ms/update_actor:0.06621880717398913 - timing_per_token_ms/update_critic:0.05695059666523739 - timing_per_token_ms/gen:0.0593755483306805 - perf/total_num_tokens:102498 - perf/time_per_step:21.22063713008538 - perf/throughput:1207.527363241657
[36m(TaskRunner pid=2914832)[0m Training Progress:   0%|          | 1/435 [00:21<2:35:49, 21.54s/it]
[36m(TaskRunner pid=2914832)[0m step:2 - global_seqlen/min:25904 - global_seqlen/max:27170 - global_seqlen/minmax_diff:1266 - global_seqlen/balanced_min:26542 - global_seqlen/balanced_max:26543 - global_seqlen/mean:26542.75 - actor/entropy:0.4652850925922394 - critic/vf_loss:5.400561541318893 - critic/vf_clipfrac:0.4444384276866913 - critic/vpred_mean:-0.7101217115996405 - critic/grad_norm:340.1658811569214 - perf/mfu/critic:0.11102435082631636 - critic/lr:1e-05 - actor/pg_loss:-0.007048678846331313 - actor/pg_clipfrac:0.0007917974326119293 - actor/ppo_kl:4.058312697452493e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.8893812894821167 - perf/mfu/actor:0.08317484817882193 - perf/max_memory_allocated_gb:34.05656433105469 - perf/max_memory_reserved_gb:40.744140625 - perf/cpu_memory_used_gb:87.86423873901367 - actor/lr:1e-06 - training/global_step:2 - training/epoch:0 - critic/score/mean:0.0 - critic/score/max:0.0 - critic/score/min:0.0 - critic/rewards/mean:0.0 - critic/rewards/max:0.0 - critic/rewards/min:0.0 - critic/advantages/mean:-2.5313889651101817e-08 - critic/advantages/max:4.714053153991699 - critic/advantages/min:-4.496163845062256 - critic/returns/mean:0.0 - critic/returns/max:0.0 - critic/returns/min:0.0 - critic/values/mean:-1.8828125 - critic/values/max:10.6875 - critic/values/min:-15.0625 - critic/vf_explained_var:-781653.5 - response_length/mean:309.6328125 - response_length/max:512.0 - response_length/min:16.0 - response_length/clip_ratio:0.109375 - prompt_length/mean:105.09765625 - prompt_length/max:215.0 - prompt_length/min:65.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.359280526638031e-06 - timing_s/generate_sequences:3.6098999977111816 - timing_s/reshard:0.5788495540618896 - timing_s/gen:5.203788004349917 - timing_s/reward:0.03481786884367466 - timing_s/old_log_prob:2.074999852105975 - timing_s/values:1.336054028943181 - timing_s/adv:0.032255020923912525 - timing_s/update_critic:5.157247021794319 - timing_s/update_actor:6.881649465300143 - timing_s/step:20.727140286937356 - timing_s/stop_profile:1.773238182067871e-06 - timing_per_token_ms/values:0.012583982716025855 - timing_per_token_ms/adv:0.0003038025536531871 - timing_per_token_ms/update_actor:0.06481665864784303 - timing_per_token_ms/update_critic:0.04857491237526555 - timing_per_token_ms/gen:0.06564968592271488 - perf/total_num_tokens:106171 - perf/time_per_step:20.727140286937356 - perf/throughput:1280.579454403932
[36m(TaskRunner pid=2914832)[0m Training Progress:   0%|          | 2/435 [00:42<2:32:02, 21.07s/it]
[36m(TaskRunner pid=2914832)[0m step:3 - global_seqlen/min:24701 - global_seqlen/max:27396 - global_seqlen/minmax_diff:2695 - global_seqlen/balanced_min:26109 - global_seqlen/balanced_max:26110 - global_seqlen/mean:26109.25 - actor/entropy:0.5295774936676025 - critic/vf_loss:3.272283524274826 - critic/vf_clipfrac:0.36694020172581077 - critic/vpred_mean:-1.3291272185742855 - critic/grad_norm:285.01135063171387 - perf/mfu/critic:0.10064524171910592 - critic/lr:1e-05 - actor/pg_loss:-0.0330509600462392 - actor/pg_clipfrac:0.0010186171093664598 - actor/ppo_kl:1.8869549876399105e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.9830527901649475 - perf/mfu/actor:0.08220727386573336 - perf/max_memory_allocated_gb:34.06075477600098 - perf/max_memory_reserved_gb:40.744140625 - perf/cpu_memory_used_gb:88.73504257202148 - actor/lr:1e-06 - training/global_step:3 - training/epoch:0 - critic/score/mean:0.01171875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.01171875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:1.1708132063859011e-07 - critic/advantages/max:6.1319379806518555 - critic/advantages/min:-5.955670356750488 - critic/returns/mean:0.010867328383028507 - critic/returns/max:1.0 - critic/returns/min:-1.1920928955078125e-07 - critic/values/mean:-1.8515625 - critic/values/max:9.6875 - critic/values/min:-13.75 - critic/vf_explained_var:-348.4258728027344 - response_length/mean:303.734375 - response_length/max:512.0 - response_length/min:25.0 - response_length/clip_ratio:0.09375 - prompt_length/mean:104.22265625 - prompt_length/max:190.0 - prompt_length/min:67.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.5942142605781555e-06 - timing_s/generate_sequences:3.5972509384155273 - timing_s/reshard:0.5848515033721924 - timing_s/gen:4.743616046383977 - timing_s/reward:0.035405890084803104 - timing_s/old_log_prob:2.075933236628771 - timing_s/values:1.3409278760664165 - timing_s/adv:0.03270539129152894 - timing_s/update_critic:5.592413450125605 - timing_s/update_actor:6.850577667821199 - timing_s/step:20.67764932382852 - timing_s/stop_profile:1.8370337784290314e-06 - timing_per_token_ms/values:0.012839586315830754 - timing_per_token_ms/adv:0.0003131590460423886 - timing_per_token_ms/update_actor:0.06559531265567949 - timing_per_token_ms/update_critic:0.053548200830410723 - timing_per_token_ms/gen:0.06100643096846516 - perf/total_num_tokens:104437 - perf/time_per_step:20.67764932382852 - perf/throughput:1262.6797945505446
[36m(TaskRunner pid=2914832)[0m Training Progress:   1%|          | 3/435 [01:02<2:30:26, 20.89s/it]
[36m(TaskRunner pid=2914832)[0m step:4 - global_seqlen/min:25811 - global_seqlen/max:27575 - global_seqlen/minmax_diff:1764 - global_seqlen/balanced_min:26558 - global_seqlen/balanced_max:26559 - global_seqlen/mean:26558.5 - actor/entropy:0.4847579598426819 - critic/vf_loss:1.168472547084093 - critic/vf_clipfrac:0.22939316369593143 - critic/vpred_mean:-0.22561821395356674 - critic/grad_norm:133.10492515563965 - perf/mfu/critic:0.10839432007403364 - critic/lr:1e-05 - actor/pg_loss:0.029601456131786108 - actor/pg_clipfrac:0.0014352835387398954 - actor/ppo_kl:-7.189865164036746e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.9251528680324554 - perf/mfu/actor:0.08375443182579799 - perf/max_memory_allocated_gb:34.06075477600098 - perf/max_memory_reserved_gb:40.744140625 - perf/cpu_memory_used_gb:87.96273040771484 - actor/lr:1e-06 - training/global_step:4 - training/epoch:0 - critic/score/mean:0.01171875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.01171875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:1.9696695829907185e-08 - critic/advantages/max:5.464931964874268 - critic/advantages/min:-7.614752769470215 - critic/returns/mean:0.009849930182099342 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:-0.62890625 - critic/values/max:11.1875 - critic/values/min:-9.125 - critic/vf_explained_var:-246.02882385253906 - response_length/mean:311.3125 - response_length/max:512.0 - response_length/min:39.0 - response_length/clip_ratio:0.09765625 - prompt_length/mean:103.6640625 - prompt_length/max:206.0 - prompt_length/min:71.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.710854798555374e-06 - timing_s/generate_sequences:3.5819761753082275 - timing_s/reshard:0.8993554711341858 - timing_s/gen:5.052687492687255 - timing_s/reward:0.04740723920986056 - timing_s/old_log_prob:2.0989189371466637 - timing_s/values:1.350024321116507 - timing_s/adv:0.034553056582808495 - timing_s/update_critic:5.285462740343064 - timing_s/update_actor:6.837904646992683 - timing_s/step:20.717562770005316 - timing_s/stop_profile:1.7778947949409485e-06 - timing_per_token_ms/values:0.012708024936616404 - timing_per_token_ms/adv:0.0003252542178851262 - timing_per_token_ms/update_actor:0.06436644244773503 - timing_per_token_ms/update_critic:0.0497530238938858 - timing_per_token_ms/gen:0.06339951180344378 - perf/total_num_tokens:106234 - perf/time_per_step:20.717562770005316 - perf/throughput:1281.9316777189224
[36m(TaskRunner pid=2914832)[0m Training Progress:   1%|          | 4/435 [01:23<2:29:36, 20.83s/it]
[36m(TaskRunner pid=2914832)[0m step:5 - global_seqlen/min:24734 - global_seqlen/max:26604 - global_seqlen/minmax_diff:1870 - global_seqlen/balanced_min:25953 - global_seqlen/balanced_max:25954 - global_seqlen/mean:25953.25 - actor/entropy:0.4658442735671997 - critic/vf_loss:0.619262307882309 - critic/vf_clipfrac:0.2315043183043599 - critic/vpred_mean:0.011199652799405158 - critic/grad_norm:131.25114917755127 - perf/mfu/critic:0.10840097024946552 - critic/lr:1e-05 - actor/pg_loss:0.019952834816649556 - actor/pg_clipfrac:0.0013177807813917752 - actor/ppo_kl:-0.0005987201184325386 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.022230803966522 - perf/mfu/actor:0.08130305386361555 - perf/max_memory_allocated_gb:34.06075477600098 - perf/max_memory_reserved_gb:40.744140625 - perf/cpu_memory_used_gb:87.94777297973633 - actor/lr:1e-06 - training/global_step:5 - training/epoch:0 - critic/score/mean:0.0234375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.0234375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.7455445089353816e-08 - critic/advantages/max:8.829343795776367 - critic/advantages/min:-8.244095802307129 - critic/returns/mean:0.02689264714717865 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:-0.455078125 - critic/values/max:8.8125 - critic/values/min:-10.4375 - critic/vf_explained_var:-47.55720138549805 - response_length/mean:305.61328125 - response_length/max:512.0 - response_length/min:45.0 - response_length/clip_ratio:0.08203125 - prompt_length/mean:99.90625 - prompt_length/max:256.0 - prompt_length/min:66.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.328096449375153e-06 - timing_s/generate_sequences:3.616577625274658 - timing_s/reshard:0.5927318334579468 - timing_s/gen:4.932838479988277 - timing_s/reward:0.036893934942781925 - timing_s/old_log_prob:2.133822089061141 - timing_s/values:1.6461339038796723 - timing_s/adv:0.03654034715145826 - timing_s/update_critic:5.16542279580608 - timing_s/update_actor:6.879998266231269 - timing_s/step:20.838709671981633 - timing_s/stop_profile:3.0159950256347656e-05 - timing_per_token_ms/values:0.015856722220527992 - timing_per_token_ms/adv:0.00035198238324158114 - timing_per_token_ms/update_actor:0.06627299342309026 - timing_per_token_ms/update_critic:0.049756993785037326 - timing_per_token_ms/gen:0.06304994414392522 - perf/total_num_tokens:103813 - perf/time_per_step:20.838709671981633 - perf/throughput:1245.4345978482077
[36m(TaskRunner pid=2914832)[0m Training Progress:   1%|          | 5/435 [01:44<2:29:19, 20.84s/it]
[36m(TaskRunner pid=2914832)[0m step:6 - global_seqlen/min:26253 - global_seqlen/max:27502 - global_seqlen/minmax_diff:1249 - global_seqlen/balanced_min:27082 - global_seqlen/balanced_max:27083 - global_seqlen/mean:27082.5 - actor/entropy:0.5119773745536804 - critic/vf_loss:0.31510370690375566 - critic/vf_clipfrac:0.10381313014659099 - critic/vpred_mean:0.07388492510654032 - critic/grad_norm:80.10445404052734 - perf/mfu/critic:0.10508583551570701 - critic/lr:1e-05 - actor/pg_loss:0.05664406481082551 - actor/pg_clipfrac:0.0018293505163455848 - actor/ppo_kl:7.668273610761389e-06 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.9900659322738647 - perf/mfu/actor:0.08600455004019848 - perf/max_memory_allocated_gb:34.06075477600098 - perf/max_memory_reserved_gb:40.744140625 - perf/cpu_memory_used_gb:87.78452682495117 - actor/lr:1e-06 - training/global_step:6 - training/epoch:0 - critic/score/mean:0.02734375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.02734375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:1.6464838381580194e-08 - critic/advantages/max:12.688344955444336 - critic/advantages/min:-8.451005935668945 - critic/returns/mean:0.02280697412788868 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:-0.1357421875 - critic/values/max:7.1875 - critic/values/min:-11.1875 - critic/vf_explained_var:-32.886226654052734 - response_length/mean:318.5703125 - response_length/max:512.0 - response_length/min:99.0 - response_length/clip_ratio:0.1328125 - prompt_length/mean:104.59375 - prompt_length/max:189.0 - prompt_length/min:67.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:1.0594259947538376e-05 - timing_s/generate_sequences:3.6204981803894043 - timing_s/reshard:0.5856393575668335 - timing_s/gen:4.869378021918237 - timing_s/reward:0.03740046499297023 - timing_s/old_log_prob:2.0853488319553435 - timing_s/values:1.34194245794788 - timing_s/adv:0.03310937713831663 - timing_s/update_critic:5.5626210337504745 - timing_s/update_actor:6.794065854977816 - timing_s/step:20.73074054531753 - timing_s/stop_profile:2.116430550813675e-06 - timing_per_token_ms/values:0.012387542305435983 - timing_per_token_ms/adv:0.0003056344238744266 - timing_per_token_ms/update_actor:0.06271638378083463 - timing_per_token_ms/update_critic:0.05134885104542116 - timing_per_token_ms/gen:0.05970740885693206 - perf/total_num_tokens:108330 - perf/time_per_step:20.73074054531753 - perf/throughput:1306.393273351595
[36m(TaskRunner pid=2914832)[0m Training Progress:   1%|▏         | 6/435 [02:05<2:28:45, 20.80s/it]
[36m(TaskRunner pid=2914832)[0m step:7 - global_seqlen/min:25753 - global_seqlen/max:27394 - global_seqlen/minmax_diff:1641 - global_seqlen/balanced_min:26685 - global_seqlen/balanced_max:26686 - global_seqlen/mean:26685.75 - actor/entropy:0.5029448866844177 - critic/vf_loss:0.15349280508235097 - critic/vf_clipfrac:0.11186566296964884 - critic/vpred_mean:-0.08008645352674648 - critic/grad_norm:69.69629096984863 - perf/mfu/critic:0.11092274048996198 - critic/lr:1e-05 - actor/pg_loss:0.013055360643193126 - actor/pg_clipfrac:0.0009633877452870365 - actor/ppo_kl:-0.0002556371309765382 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.9183559119701385 - perf/mfu/actor:0.08464865215921823 - perf/max_memory_allocated_gb:34.06075477600098 - perf/max_memory_reserved_gb:40.744140625 - perf/cpu_memory_used_gb:88.88389205932617 - actor/lr:1e-06 - training/global_step:7 - training/epoch:0 - critic/score/mean:0.015625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.015625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:3.801000403313992e-08 - critic/advantages/max:11.155374526977539 - critic/advantages/min:-17.58424186706543 - critic/returns/mean:0.01115680392831564 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:-0.296875 - critic/values/max:10.4375 - critic/values/min:-7.125 - critic/vf_explained_var:-32.8177490234375 - response_length/mean:314.41015625 - response_length/max:512.0 - response_length/min:86.0 - response_length/clip_ratio:0.1171875 - prompt_length/mean:102.5546875 - prompt_length/max:183.0 - prompt_length/min:63.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.566274583339691e-06 - timing_s/generate_sequences:3.6251752376556396 - timing_s/reshard:0.8788450956344604 - timing_s/gen:5.074763257987797 - timing_s/reward:0.035891600884497166 - timing_s/old_log_prob:2.4175568581558764 - timing_s/values:1.34485396835953 - timing_s/adv:0.04110838985070586 - timing_s/update_critic:5.196289172861725 - timing_s/update_actor:6.801429450046271 - timing_s/step:20.918317335192114 - timing_s/stop_profile:1.948792487382889e-06 - timing_per_token_ms/values:0.012598989801294043 - timing_per_token_ms/adv:0.0003851155565302255 - timing_per_token_ms/update_actor:0.0637178030413823 - timing_per_token_ms/update_critic:0.048680374102861315 - timing_per_token_ms/gen:0.06304915277848895 - perf/total_num_tokens:106743 - perf/time_per_step:20.918317335192114 - perf/throughput:1275.7120743696241
[36m(TaskRunner pid=2914832)[0m Training Progress:   2%|▏         | 7/435 [02:26<2:28:41, 20.84s/it]
[36m(TaskRunner pid=2914832)[0m step:8 - global_seqlen/min:25574 - global_seqlen/max:28041 - global_seqlen/minmax_diff:2467 - global_seqlen/balanced_min:26743 - global_seqlen/balanced_max:26744 - global_seqlen/mean:26743.25 - actor/entropy:0.45694461464881897 - critic/vf_loss:0.17117624869570136 - critic/vf_clipfrac:0.043070453335531056 - critic/vpred_mean:-0.07993150575930486 - critic/grad_norm:111.22561812400818 - perf/mfu/critic:0.10793142735607478 - critic/lr:1e-05 - actor/pg_loss:0.01163481641560793 - actor/pg_clipfrac:0.000972740843280917 - actor/ppo_kl:5.742207531511667e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.8404181599617004 - perf/mfu/actor:0.0804323853267083 - perf/max_memory_allocated_gb:34.06075477600098 - perf/max_memory_reserved_gb:40.744140625 - perf/cpu_memory_used_gb:88.08418273925781 - actor/lr:1e-06 - training/global_step:8 - training/epoch:0 - critic/score/mean:0.0078125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.0078125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.1550508105528934e-08 - critic/advantages/max:9.206940650939941 - critic/advantages/min:-9.80294418334961 - critic/returns/mean:0.0048396703787148 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:-0.408203125 - critic/values/max:3.671875 - critic/values/min:-4.25 - critic/vf_explained_var:-34.98172378540039 - response_length/mean:314.78125 - response_length/max:512.0 - response_length/min:97.0 - response_length/clip_ratio:0.09765625 - prompt_length/mean:103.08203125 - prompt_length/max:180.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.61492857336998e-06 - timing_s/generate_sequences:3.601273775100708 - timing_s/reshard:0.5886319875717163 - timing_s/gen:5.0254075629636645 - timing_s/reward:0.037782648112624884 - timing_s/old_log_prob:2.0818232111632824 - timing_s/values:1.3405431569553912 - timing_s/adv:0.03384713688865304 - timing_s/update_critic:5.345007864758372 - timing_s/update_actor:7.169403899926692 - timing_s/step:21.040746453218162 - timing_s/stop_profile:1.8668361008167267e-06 - timing_per_token_ms/values:0.012531602899380136 - timing_per_token_ms/adv:0.0003164082234643605 - timing_per_token_ms/update_actor:0.06702068652769103 - timing_per_token_ms/update_critic:0.04996595276152274 - timing_per_token_ms/gen:0.06236234938652418 - perf/total_num_tokens:106973 - perf/time_per_step:21.040746453218162 - perf/throughput:1271.0219221290813
[36m(TaskRunner pid=2914832)[0m Training Progress:   2%|▏         | 8/435 [02:47<2:28:49, 20.91s/it]
[36m(TaskRunner pid=2914832)[0m step:9 - global_seqlen/min:25828 - global_seqlen/max:28928 - global_seqlen/minmax_diff:3100 - global_seqlen/balanced_min:27116 - global_seqlen/balanced_max:27117 - global_seqlen/mean:27116.25 - actor/entropy:0.465907484292984 - critic/vf_loss:0.21539383893832564 - critic/vf_clipfrac:0.3250287640839815 - critic/vpred_mean:0.3167205330246361 - critic/grad_norm:114.02295064926147 - perf/mfu/critic:0.11397937811655443 - critic/lr:1e-05 - actor/pg_loss:-0.05564101884374395 - actor/pg_clipfrac:0.0013916524112573825 - actor/ppo_kl:-0.00021131948687980184 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.8629756271839142 - perf/mfu/actor:0.08555542936889321 - perf/max_memory_allocated_gb:34.06110715866089 - perf/max_memory_reserved_gb:40.744140625 - perf/cpu_memory_used_gb:88.04403305053711 - actor/lr:1e-06 - training/global_step:9 - training/epoch:0 - critic/score/mean:0.01171875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.01171875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-2.8912282346027496e-08 - critic/advantages/max:10.334831237792969 - critic/advantages/min:-22.144309997558594 - critic/returns/mean:0.010455728508532047 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.8203125 - critic/values/max:9.875 - critic/values/min:-3.421875 - critic/vf_explained_var:-15.183622360229492 - response_length/mean:319.80078125 - response_length/max:512.0 - response_length/min:39.0 - response_length/clip_ratio:0.1015625 - prompt_length/mean:103.890625 - prompt_length/max:201.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.760230123996735e-06 - timing_s/generate_sequences:3.815579652786255 - timing_s/reshard:0.587627112865448 - timing_s/gen:5.1527544860728085 - timing_s/reward:0.03639896959066391 - timing_s/old_log_prob:2.081668458878994 - timing_s/values:1.3371932869777083 - timing_s/adv:0.03285790514200926 - timing_s/update_critic:5.134182632435113 - timing_s/update_actor:6.8351625530049205 - timing_s/step:20.61745994584635 - timing_s/stop_profile:1.941341906785965e-06 - timing_per_token_ms/values:0.01232833897550093 - timing_per_token_ms/adv:0.00030293555655750017 - timing_per_token_ms/update_actor:0.06301721802429282 - timing_per_token_ms/update_critic:0.047334924929102594 - timing_per_token_ms/gen:0.06293901826176952 - perf/total_num_tokens:108465 - perf/time_per_step:20.61745994584635 - perf/throughput:1315.2080843723388
[36m(TaskRunner pid=2914832)[0m Training Progress:   2%|▏         | 9/435 [03:07<2:27:51, 20.83s/it]
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 10}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and bakes muffins for her friends every day with four. She sells the remainder at the farmers' market daily for $2 per fresh duck egg. How much in dollars does she make every day at the farmers' market? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much Janet makes at the farmers' market every day, we need to follow these steps:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. **Calculate the total number of eggs laid by the ducks in a day:**
[36m(TaskRunner pid=2914832)[0m    - Janet's ducks lay 16 eggs per day.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 2. **Determine the number of eggs Janet eats in a day:**
[36m(TaskRunner pid=2914832)[0m    - Janet eats 3 eggs for breakfast.
[36m(TaskRunner pid=2914832)[0m    - She eats 4 muffins for baking.
[36m(TaskRunner pid=2914832)[0m    - Therefore, the total number of eggs she eats in a day is:
[36m(TaskRunner pid=2914832)[0m      \[
[36m(TaskRunner pid=2914832)[0m      3 \text{ (breakfast)} + 4 \text{ (baking)} = 7 \text{ eggs}
[36m(TaskRunner pid=2914832)[0m      \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 3. **Calculate the number of eggs Janet sells in a day:**
[36m(TaskRunner pid=2914832)[0m    - The remainder of the eggs is sold at the farmers' market.
[36m(TaskRunner pid=2914832)[0m    - The total number of eggs laid in a day is 16.
[36m(TaskRunner pid=2914832)[0m    - Subtract the number of eggs eaten from the total number of eggs:
[36m(TaskRunner pid=2914832)[0m      \[
[36m(TaskRunner pid=2914832)[0m      16 \text{ (total eggs)} - 7 \text{ (eggs eaten)} = 9 \text{ eggs}
[36m(TaskRunner pid=2914832)[0m      \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 4. **Determine the price per egg at the farmers' market:**
[36m(TaskRunner pid=2914832)[0m    - The price per egg is $2.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 5. **Calculate the total revenue from selling the eggs at the farmers' market:**
[36m(TaskRunner pid=2914832)[0m    - Multiply the number of eggs sold by the price per egg:
[36m(TaskRunner pid=2914832)[0m      \[
[36m(TaskRunner pid=2914832)[0m      9 \text{ eggs} \times 2 \text{ dollars/egg} = 18 \text{ dollars}
[36m(TaskRunner pid=2914832)[0m      \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Therefore, Janet makes \(\boxed{18}\) dollars every day at the farmers' market.
[36m(TaskRunner pid=2914832)[0m [ground_truth] 18
[36m(TaskRunner pid=2914832)[0m [score] 0.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1312
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 10}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Tom's restaurant gets 6 reservations a night.  They normally order 2 meals that cost $5 each and a $5 bottle of wine.  How much do they make a week if they are open 2 days a week? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much Tom's restaurant makes in a week, we need to calculate the daily revenue and then multiply by the number of days the restaurant is open in a week.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. **Calculate the daily revenue:**
[36m(TaskRunner pid=2914832)[0m    - Tom's restaurant gets 6 reservations a night.
[36m(TaskRunner pid=2914832)[0m    - They normally order 2 meals that cost $5 each and a $5 bottle of wine.
[36m(TaskRunner pid=2914832)[0m    - The cost of 2 meals is \(2 \times 5 = 10\) dollars.
[36m(TaskRunner pid=2914832)[0m    - The cost of the wine is $5.
[36m(TaskRunner pid=2914832)[0m    - Therefore, the daily revenue is \(6 \times (10 + 5) = 6 \times 15 = 90\) dollars.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 2. **Calculate the weekly revenue:**
[36m(TaskRunner pid=2914832)[0m    - The restaurant is open 2 days a week.
[36m(TaskRunner pid=2914832)[0m    - So, the weekly revenue is \(90 \times 2 = 180\) dollars.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Thus, the restaurant makes \(\boxed{180}\) dollars in a week.
[36m(TaskRunner pid=2914832)[0m [ground_truth] 180
[36m(TaskRunner pid=2914832)[0m [score] 0.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1319
[36m(TaskRunner pid=2914832)[0m step:10 - global_seqlen/min:25459 - global_seqlen/max:27671 - global_seqlen/minmax_diff:2212 - global_seqlen/balanced_min:26725 - global_seqlen/balanced_max:26725 - global_seqlen/mean:26725.0 - actor/entropy:0.42866215109825134 - critic/vf_loss:0.05391136521939188 - critic/vf_clipfrac:0.0008395124568778556 - critic/vpred_mean:0.10101578145986423 - critic/grad_norm:19.65037965774536 - perf/mfu/critic:0.10738086681572288 - critic/lr:1e-05 - actor/pg_loss:0.05387121008243412 - actor/pg_clipfrac:0.0012817666683986317 - actor/ppo_kl:-0.00010907203522947384 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.9215918183326721 - perf/mfu/actor:0.08013897912316087 - perf/max_memory_allocated_gb:34.06110715866089 - perf/max_memory_reserved_gb:40.744140625 - perf/cpu_memory_used_gb:87.51886749267578 - actor/lr:1e-06 - val-core/openai/gsm8k/reward/mean@1:0.006065200909780136 - training/global_step:10 - training/epoch:0 - critic/score/mean:0.05078125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.05078125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-8.529969508508373e-10 - critic/advantages/max:10.924886703491211 - critic/advantages/min:-10.394850730895996 - critic/returns/mean:0.041889239102602005 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.10400390625 - critic/values/max:3.421875 - critic/values/min:-3.46875 - critic/vf_explained_var:-1.6020867824554443 - response_length/mean:314.4453125 - response_length/max:512.0 - response_length/min:58.0 - response_length/clip_ratio:0.09765625 - prompt_length/mean:103.1328125 - prompt_length/max:184.0 - prompt_length/min:69.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.217028617858887e-06 - timing_s/generate_sequences:3.5548691749572754 - timing_s/reshard:0.7802314758300781 - timing_s/gen:5.22936075180769 - timing_s/reward:0.038365431129932404 - timing_s/old_log_prob:2.1275881570763886 - timing_s/values:1.6117397411726415 - timing_s/adv:0.03282044921070337 - timing_s/update_critic:5.368713004048914 - timing_s/update_actor:7.190699206665158 - timing_s/testing:14.675450693815947 - timing_s/step:36.281031710561365 - timing_s/stop_profile:1.9208528101444244e-06 - timing_per_token_ms/values:0.01507707896326138 - timing_per_token_ms/adv:0.00030702010487093894 - timing_per_token_ms/update_actor:0.06726566142811187 - timing_per_token_ms/update_critic:0.050221824172581045 - timing_per_token_ms/gen:0.06496261710611058 - perf/total_num_tokens:106900 - perf/time_per_step:36.281031710561365 - perf/throughput:736.6108057015475
[36m(TaskRunner pid=2914832)[0m Training Progress:   2%|▏         | 10/435 [03:44<3:01:20, 25.60s/it]
[36m(TaskRunner pid=2914832)[0m step:11 - global_seqlen/min:25050 - global_seqlen/max:26423 - global_seqlen/minmax_diff:1373 - global_seqlen/balanced_min:25831 - global_seqlen/balanced_max:25831 - global_seqlen/mean:25831.0 - actor/entropy:0.4694761335849762 - critic/vf_loss:0.11317873280495405 - critic/vf_clipfrac:0.0215646312572062 - critic/vpred_mean:-0.2377236019819975 - critic/grad_norm:102.97708129882812 - perf/mfu/critic:0.10241855972696425 - critic/lr:1e-05 - actor/pg_loss:-0.07002339340397157 - actor/pg_clipfrac:0.0016448165479232557 - actor/ppo_kl:-0.00022139429665912758 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.208092749118805 - perf/mfu/actor:0.07792005084343331 - perf/max_memory_allocated_gb:34.06110715866089 - perf/max_memory_reserved_gb:40.744140625 - perf/cpu_memory_used_gb:87.1087417602539 - actor/lr:1e-06 - training/global_step:11 - training/epoch:0 - critic/score/mean:0.01953125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.01953125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:1.797905468947647e-08 - critic/advantages/max:8.325299263000488 - critic/advantages/min:-30.6761474609375 - critic/returns/mean:0.013956524431705475 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:-0.40625 - critic/values/max:9.375 - critic/values/min:-3.078125 - critic/vf_explained_var:-6.4028801918029785 - response_length/mean:299.19921875 - response_length/max:512.0 - response_length/min:3.0 - response_length/clip_ratio:0.0625 - prompt_length/mean:104.41015625 - prompt_length/max:183.0 - prompt_length/min:72.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.8638321459293365e-06 - timing_s/generate_sequences:3.60166597366333 - timing_s/reshard:0.3029744029045105 - timing_s/gen:4.510517360176891 - timing_s/reward:0.03549716202542186 - timing_s/old_log_prob:2.0918806730769575 - timing_s/values:1.3438870296813548 - timing_s/adv:0.03304419433698058 - timing_s/update_critic:5.436248091980815 - timing_s/update_actor:7.141333065927029 - timing_s/step:20.599660466890782 - timing_s/stop_profile:5.088746547698975e-06 - timing_per_token_ms/values:0.013006533135393081 - timing_per_token_ms/adv:0.00031981141203380224 - timing_per_token_ms/update_actor:0.06911591755958953 - timing_per_token_ms/update_critic:0.052613604699593655 - timing_per_token_ms/gen:0.05888788250116706 - perf/total_num_tokens:103324 - perf/time_per_step:20.599660466890782 - perf/throughput:1253.9527067214235
[36m(TaskRunner pid=2914832)[0m Training Progress:   3%|▎         | 11/435 [04:04<2:50:07, 24.07s/it]
[36m(TaskRunner pid=2914832)[0m step:12 - global_seqlen/min:25759 - global_seqlen/max:28575 - global_seqlen/minmax_diff:2816 - global_seqlen/balanced_min:27066 - global_seqlen/balanced_max:27067 - global_seqlen/mean:27066.5 - actor/entropy:0.5069588422775269 - critic/vf_loss:0.117222108412534 - critic/vf_clipfrac:0.05648423335514963 - critic/vpred_mean:0.007102222181856632 - critic/grad_norm:96.69940567016602 - perf/mfu/critic:0.1111916842148435 - critic/lr:1e-05 - actor/pg_loss:-0.018688984418986365 - actor/pg_clipfrac:0.0009974567110475618 - actor/ppo_kl:-0.00018515399051466375 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.210463285446167 - perf/mfu/actor:0.08569403471931157 - perf/max_memory_allocated_gb:34.06110715866089 - perf/max_memory_reserved_gb:40.744140625 - perf/cpu_memory_used_gb:87.76857376098633 - actor/lr:1e-06 - training/global_step:12 - training/epoch:0 - critic/score/mean:0.03515625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.03515625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-3.2080965439718057e-08 - critic/advantages/max:10.085662841796875 - critic/advantages/min:-19.382917404174805 - critic/returns/mean:0.021159041672945023 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.431640625 - critic/values/max:7.65625 - critic/values/min:-3.359375 - critic/vf_explained_var:-5.743365287780762 - response_length/mean:319.56640625 - response_length/max:512.0 - response_length/min:111.0 - response_length/clip_ratio:0.140625 - prompt_length/mean:103.34765625 - prompt_length/max:196.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.275942385196686e-06 - timing_s/generate_sequences:3.6155338287353516 - timing_s/reshard:0.8884413242340088 - timing_s/gen:5.135250645224005 - timing_s/reward:0.03581116767600179 - timing_s/old_log_prob:2.076438891235739 - timing_s/values:1.3483975767157972 - timing_s/adv:0.03363008191809058 - timing_s/update_critic:5.2539243209175766 - timing_s/update_actor:6.817954326048493 - timing_s/step:20.707622460089624 - timing_s/stop_profile:1.7480924725532532e-06 - timing_per_token_ms/values:0.012454487805181656 - timing_per_token_ms/adv:0.00031062459052787195 - timing_per_token_ms/update_actor:0.0629741038372942 - timing_per_token_ms/update_critic:0.0485279249341213 - timing_per_token_ms/gen:0.06277121887841197 - perf/total_num_tokens:108266 - perf/time_per_step:20.707622460089624 - perf/throughput:1307.0790744889239
[36m(TaskRunner pid=2914832)[0m Training Progress:   3%|▎         | 12/435 [04:25<2:42:30, 23.05s/it]
[36m(TaskRunner pid=2914832)[0m step:13 - global_seqlen/min:25525 - global_seqlen/max:28702 - global_seqlen/minmax_diff:3177 - global_seqlen/balanced_min:26838 - global_seqlen/balanced_max:26839 - global_seqlen/mean:26838.25 - actor/entropy:0.45563769340515137 - critic/vf_loss:0.08512269135098904 - critic/vf_clipfrac:0.028399888156855013 - critic/vpred_mean:0.20685019064694643 - critic/grad_norm:81.0273208618164 - perf/mfu/critic:0.10476765052623736 - critic/lr:1e-05 - actor/pg_loss:-0.12292722705751657 - actor/pg_clipfrac:0.001518122029665392 - actor/ppo_kl:-4.105055904801702e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.958407700061798 - perf/mfu/actor:0.08117564286196641 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.84554290771484 - actor/lr:1e-06 - training/global_step:13 - training/epoch:0 - critic/score/mean:0.0546875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.0546875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-9.75553238191651e-09 - critic/advantages/max:12.078784942626953 - critic/advantages/min:-14.374215126037598 - critic/returns/mean:0.05225196108222008 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:-0.1806640625 - critic/values/max:3.5625 - critic/values/min:-2.421875 - critic/vf_explained_var:-0.4073967933654785 - response_length/mean:314.65625 - response_length/max:512.0 - response_length/min:23.0 - response_length/clip_ratio:0.1015625 - prompt_length/mean:104.69140625 - prompt_length/max:189.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.8929283618927e-06 - timing_s/generate_sequences:3.602386474609375 - timing_s/reshard:0.5895553827285767 - timing_s/gen:5.00879946583882 - timing_s/reward:0.03736631199717522 - timing_s/old_log_prob:2.1305329226888716 - timing_s/values:1.6391954952850938 - timing_s/adv:0.03626936115324497 - timing_s/update_critic:5.532497115898877 - timing_s/update_actor:7.132160357199609 - timing_s/step:21.524302744306624 - timing_s/stop_profile:2.6891939342021942e-06 - timing_per_token_ms/values:0.015269209945554328 - timing_per_token_ms/adv:0.0003378513982212418 - timing_per_token_ms/update_actor:0.06643652582787261 - timing_per_token_ms/update_critic:0.05153556133409292 - timing_per_token_ms/gen:0.06218094480383876 - perf/total_num_tokens:107353 - perf/time_per_step:21.524302744306624 - perf/throughput:1246.8812727092386
[36m(TaskRunner pid=2914832)[0m Training Progress:   3%|▎         | 13/435 [04:47<2:38:53, 22.59s/it]
[36m(TaskRunner pid=2914832)[0m step:14 - global_seqlen/min:25386 - global_seqlen/max:26652 - global_seqlen/minmax_diff:1266 - global_seqlen/balanced_min:26216 - global_seqlen/balanced_max:26216 - global_seqlen/mean:26216.0 - actor/entropy:0.48114362359046936 - critic/vf_loss:0.055061110528185964 - critic/vf_clipfrac:0.00774032631306909 - critic/vpred_mean:-0.09987071715295315 - critic/grad_norm:72.9627046585083 - perf/mfu/critic:0.10737204506840035 - critic/lr:1e-05 - actor/pg_loss:0.03628729470074177 - actor/pg_clipfrac:0.0015959140146151185 - actor/ppo_kl:-1.1072641882492462e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.7602560818195343 - perf/mfu/actor:0.08269032767501606 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:87.03395462036133 - actor/lr:1e-06 - training/global_step:14 - training/epoch:0 - critic/score/mean:0.05078125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.05078125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-5.860527707568508e-08 - critic/advantages/max:6.344222068786621 - critic/advantages/min:-5.25695276260376 - critic/returns/mean:0.04380502924323082 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:-0.197265625 - critic/values/max:1.03125 - critic/values/min:-1.2265625 - critic/vf_explained_var:-0.3989243507385254 - response_length/mean:306.1328125 - response_length/max:512.0 - response_length/min:77.0 - response_length/clip_ratio:0.109375 - prompt_length/mean:103.4921875 - prompt_length/max:199.0 - prompt_length/min:65.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:6.1211176216602325e-06 - timing_s/generate_sequences:3.5603575706481934 - timing_s/reshard:0.9513257741928101 - timing_s/gen:5.057059735991061 - timing_s/reward:0.03711862117052078 - timing_s/old_log_prob:2.085907564032823 - timing_s/values:1.3504206128418446 - timing_s/adv:0.0363050838932395 - timing_s/update_critic:5.269226127769798 - timing_s/update_actor:6.835646517574787 - timing_s/step:20.680786152835935 - timing_s/stop_profile:1.2283213436603546e-05 - timing_per_token_ms/values:0.012877828547850974 - timing_per_token_ms/adv:0.0003462111295891774 - timing_per_token_ms/update_actor:0.06518582657131892 - timing_per_token_ms/update_critic:0.050248189347820015 - timing_per_token_ms/gen:0.06452800479764018 - perf/total_num_tokens:104864 - perf/time_per_step:20.680786152835935 - perf/throughput:1267.6500693086575
[36m(TaskRunner pid=2914832)[0m Training Progress:   3%|▎         | 14/435 [05:07<2:34:29, 22.02s/it]
[36m(TaskRunner pid=2914832)[0m step:15 - global_seqlen/min:25071 - global_seqlen/max:27680 - global_seqlen/minmax_diff:2609 - global_seqlen/balanced_min:26078 - global_seqlen/balanced_max:26079 - global_seqlen/mean:26078.5 - actor/entropy:0.5172480940818787 - critic/vf_loss:0.0736424521310255 - critic/vf_clipfrac:0.016850967542268336 - critic/vpred_mean:0.0140220383182168 - critic/grad_norm:75.21702194213867 - perf/mfu/critic:0.10212892894955419 - critic/lr:1e-05 - actor/pg_loss:-0.09553069900721312 - actor/pg_clipfrac:0.001099175638955785 - actor/ppo_kl:9.1966407126165e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.1351490318775177 - perf/mfu/actor:0.07931270409992387 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.84783172607422 - actor/lr:1e-06 - training/global_step:15 - training/epoch:0 - critic/score/mean:0.06640625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.06640625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-5.96023532750678e-08 - critic/advantages/max:6.796120643615723 - critic/advantages/min:-9.143823623657227 - critic/returns/mean:0.05479750409722328 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.39453125 - critic/values/max:2.765625 - critic/values/min:-0.83203125 - critic/vf_explained_var:-0.3583989143371582 - response_length/mean:304.88671875 - response_length/max:512.0 - response_length/min:82.0 - response_length/clip_ratio:0.09765625 - prompt_length/mean:102.58984375 - prompt_length/max:160.0 - prompt_length/min:70.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:6.178859621286392e-06 - timing_s/generate_sequences:3.5698094367980957 - timing_s/reshard:0.5848342180252075 - timing_s/gen:5.023545547854155 - timing_s/reward:0.038675568997859955 - timing_s/old_log_prob:2.1200336520560086 - timing_s/values:1.6164144990034401 - timing_s/adv:0.03287496604025364 - timing_s/update_critic:5.5058192210271955 - timing_s/update_actor:7.086986766662449 - timing_s/step:21.431796839926392 - timing_s/stop_profile:2.027023583650589e-06 - timing_per_token_ms/values:0.01549566212592212 - timing_per_token_ms/adv:0.00031515392028158866 - timing_per_token_ms/update_actor:0.06793898006655337 - timing_per_token_ms/update_critic:0.05278121077733761 - timing_per_token_ms/gen:0.06436234702763777 - perf/total_num_tokens:104314 - perf/time_per_step:21.431796839926392 - perf/throughput:1216.8135128743395
[36m(TaskRunner pid=2914832)[0m Training Progress:   3%|▎         | 15/435 [05:29<2:32:54, 21.84s/it]
[36m(TaskRunner pid=2914832)[0m step:16 - global_seqlen/min:24719 - global_seqlen/max:26481 - global_seqlen/minmax_diff:1762 - global_seqlen/balanced_min:25698 - global_seqlen/balanced_max:25699 - global_seqlen/mean:25698.5 - actor/entropy:0.5149032473564148 - critic/vf_loss:0.03564427845412865 - critic/vf_clipfrac:0.0022776157820771914 - critic/vpred_mean:0.08660478750243783 - critic/grad_norm:46.79498052597046 - perf/mfu/critic:0.10712493727764234 - critic/lr:1e-05 - actor/pg_loss:0.14854233991354704 - actor/pg_clipfrac:0.0013862932464689948 - actor/ppo_kl:0.0002220320116066432 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.9116926193237305 - perf/mfu/actor:0.08078918034115627 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.83094787597656 - actor/lr:1e-06 - training/global_step:16 - training/epoch:0 - critic/score/mean:0.1015625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.1015625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-6.85604817363128e-08 - critic/advantages/max:7.529378414154053 - critic/advantages/min:-7.5998077392578125 - critic/returns/mean:0.08264300227165222 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:-0.193359375 - critic/values/max:1.96875 - critic/values/min:-1.734375 - critic/vf_explained_var:-0.15062427520751953 - response_length/mean:297.54296875 - response_length/max:512.0 - response_length/min:52.0 - response_length/clip_ratio:0.11328125 - prompt_length/mean:103.99609375 - prompt_length/max:238.0 - prompt_length/min:56.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.112254828214645e-06 - timing_s/generate_sequences:3.5910165309906006 - timing_s/reshard:0.9556881785392761 - timing_s/gen:5.2134637562558055 - timing_s/reward:0.035719253588467836 - timing_s/old_log_prob:2.0804837020114064 - timing_s/values:1.3355088699609041 - timing_s/adv:0.0327619886957109 - timing_s/update_critic:5.17235458875075 - timing_s/update_actor:6.853903879411519 - timing_s/step:20.730760839302093 - timing_s/stop_profile:1.6582198441028595e-06 - timing_per_token_ms/values:0.012992089713027065 - timing_per_token_ms/adv:0.00031871499013279856 - timing_per_token_ms/update_actor:0.06667610832744633 - timing_per_token_ms/update_critic:0.0503176701826055 - timing_per_token_ms/gen:0.06844420785148948 - perf/total_num_tokens:102794 - perf/time_per_step:20.730760839302093 - perf/throughput:1239.6312995555809
[36m(TaskRunner pid=2914832)[0m Training Progress:   4%|▎         | 16/435 [05:49<2:30:13, 21.51s/it]
[36m(TaskRunner pid=2914832)[0m step:17 - global_seqlen/min:26804 - global_seqlen/max:27162 - global_seqlen/minmax_diff:358 - global_seqlen/balanced_min:26899 - global_seqlen/balanced_max:26900 - global_seqlen/mean:26899.75 - actor/entropy:0.5281203985214233 - critic/vf_loss:0.11882382346084341 - critic/vf_clipfrac:0.00013351730740396306 - critic/vpred_mean:-0.1834628307260573 - critic/grad_norm:74.53661841154099 - perf/mfu/critic:0.1074698202980739 - critic/lr:1e-05 - actor/pg_loss:-0.07050442893523723 - actor/pg_clipfrac:0.0012481622252380475 - actor/ppo_kl:-0.00012297493231017143 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.9550563395023346 - perf/mfu/actor:0.08110886439781546 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:87.06401824951172 - actor/lr:1e-06 - training/global_step:17 - training/epoch:0 - critic/score/mean:0.11328125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.11328125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.65694267195704e-08 - critic/advantages/max:4.713931560516357 - critic/advantages/min:-11.731769561767578 - critic/returns/mean:0.08819562196731567 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:-0.275390625 - critic/values/max:3.109375 - critic/values/min:-1.609375 - critic/vf_explained_var:-0.08903837203979492 - response_length/mean:315.66015625 - response_length/max:512.0 - response_length/min:20.0 - response_length/clip_ratio:0.1171875 - prompt_length/mean:104.6484375 - prompt_length/max:193.0 - prompt_length/min:62.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.00003045797348e-06 - timing_s/generate_sequences:3.591627836227417 - timing_s/reshard:0.6856436729431152 - timing_s/gen:5.094411371275783 - timing_s/reward:0.03669464914128184 - timing_s/old_log_prob:2.122525134589523 - timing_s/values:1.6339952680282295 - timing_s/adv:0.03516417322680354 - timing_s/update_critic:5.400763651356101 - timing_s/update_actor:7.153621751349419 - timing_s/step:21.484163282904774 - timing_s/stop_profile:1.8202699720859528e-06 - timing_per_token_ms/values:0.015185970762072412 - timing_per_token_ms/adv:0.00032680762113777585 - timing_per_token_ms/update_actor:0.06648409140744263 - timing_per_token_ms/update_critic:0.05019343721926878 - timing_per_token_ms/gen:0.06304262360969425 - perf/total_num_tokens:107599 - perf/time_per_step:21.484163282904774 - perf/throughput:1252.0734294271763
[36m(TaskRunner pid=2914832)[0m Training Progress:   4%|▍         | 17/435 [06:11<2:29:52, 21.51s/it]
[36m(TaskRunner pid=2914832)[0m step:18 - global_seqlen/min:24515 - global_seqlen/max:28090 - global_seqlen/minmax_diff:3575 - global_seqlen/balanced_min:26188 - global_seqlen/balanced_max:26188 - global_seqlen/mean:26188.0 - actor/entropy:0.4923033118247986 - critic/vf_loss:0.06958097711321898 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.12892609235132113 - critic/grad_norm:28.398382663726807 - perf/mfu/critic:0.10938403086392809 - critic/lr:1e-05 - actor/pg_loss:-0.03493350907228887 - actor/pg_clipfrac:0.0013231567536422517 - actor/ppo_kl:1.181963671115227e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.9076417982578278 - perf/mfu/actor:0.08315624422089443 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.52120208740234 - actor/lr:1e-06 - training/global_step:18 - training/epoch:0 - critic/score/mean:0.13671875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.13671875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:1.8075109187165594e-09 - critic/advantages/max:4.734494686126709 - critic/advantages/min:-4.819235801696777 - critic/returns/mean:0.120867520570755 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.2216796875 - critic/values/max:1.734375 - critic/values/min:-1.0625 - critic/vf_explained_var:-0.08111703395843506 - response_length/mean:307.08984375 - response_length/max:512.0 - response_length/min:4.0 - response_length/clip_ratio:0.09765625 - prompt_length/mean:102.09765625 - prompt_length/max:211.0 - prompt_length/min:64.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.734137862920761e-06 - timing_s/generate_sequences:3.71209979057312 - timing_s/reshard:0.5836435556411743 - timing_s/gen:4.940382117871195 - timing_s/reward:0.03856616374105215 - timing_s/old_log_prob:2.0809767968021333 - timing_s/values:1.4101222190074623 - timing_s/adv:0.03338477620854974 - timing_s/update_critic:5.163608299102634 - timing_s/update_actor:6.789185833185911 - timing_s/step:20.46258023288101 - timing_s/stop_profile:1.8267892301082611e-06 - timing_per_token_ms/values:0.013461530271569634 - timing_per_token_ms/adv:0.00031870299572848 - timing_per_token_ms/update_actor:0.0648119924506063 - timing_per_token_ms/update_critic:0.04929364880004806 - timing_per_token_ms/gen:0.06284274143447427 - perf/total_num_tokens:104752 - perf/time_per_step:20.46258023288101 - perf/throughput:1279.7995024067834
[36m(TaskRunner pid=2914832)[0m Training Progress:   4%|▍         | 18/435 [06:31<2:27:20, 21.20s/it]
[36m(TaskRunner pid=2914832)[0m step:19 - global_seqlen/min:27208 - global_seqlen/max:28203 - global_seqlen/minmax_diff:995 - global_seqlen/balanced_min:27739 - global_seqlen/balanced_max:27740 - global_seqlen/mean:27739.25 - actor/entropy:0.5186133980751038 - critic/vf_loss:0.1059563378803432 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.33580452436581254 - critic/grad_norm:59.642590284347534 - perf/mfu/critic:0.10833607174631614 - critic/lr:1e-05 - actor/pg_loss:-0.06187397940084338 - actor/pg_clipfrac:0.0016755652977735735 - actor/ppo_kl:3.181405031682516e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.754475176334381 - perf/mfu/actor:0.08336792472124253 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.83668518066406 - actor/lr:1e-06 - training/global_step:19 - training/epoch:0 - critic/score/mean:0.1640625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.1640625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.2408697180887884e-08 - critic/advantages/max:6.446760177612305 - critic/advantages/min:-2.853781223297119 - critic/returns/mean:0.12410933524370193 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.11572265625 - critic/values/max:0.94921875 - critic/values/min:-2.171875 - critic/vf_explained_var:-0.03585195541381836 - response_length/mean:327.8359375 - response_length/max:512.0 - response_length/min:66.0 - response_length/clip_ratio:0.10546875 - prompt_length/mean:105.58984375 - prompt_length/max:180.0 - prompt_length/min:70.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.824010491371155e-06 - timing_s/generate_sequences:3.6261425018310547 - timing_s/reshard:0.9819250106811523 - timing_s/gen:5.368295699823648 - timing_s/reward:0.03615720523521304 - timing_s/old_log_prob:2.1135148028843105 - timing_s/values:1.6149809481576085 - timing_s/adv:0.03383350279182196 - timing_s/update_critic:5.5294394148513675 - timing_s/update_actor:7.181351498700678 - timing_s/step:21.884087671991438 - timing_s/stop_profile:4.575122147798538e-06 - timing_per_token_ms/values:0.01455501634108356 - timing_per_token_ms/adv:0.00030492445534596247 - timing_per_token_ms/update_actor:0.06472193280911234 - timing_per_token_ms/update_critic:0.049834074595125746 - timing_per_token_ms/gen:0.06396463193555808 - perf/total_num_tokens:110957 - perf/time_per_step:21.884087671991438 - perf/throughput:1267.553412130694
[36m(TaskRunner pid=2914832)[0m Training Progress:   4%|▍         | 19/435 [06:53<2:28:25, 21.41s/it]
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 20}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and bakes muffins for her friends every day with four. She sells the remainder at the farmers' market daily for $2 per fresh duck egg. How much in dollars does she make every day at the farmers' market? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much Janet makes at the farmers' market every day, we need to follow these steps:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. **Calculate the total number of eggs laid by the ducks in a day:**
[36m(TaskRunner pid=2914832)[0m    - Janet's ducks lay 16 eggs per day.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 2. **Determine the number of eggs Janet eats in a day:**
[36m(TaskRunner pid=2914832)[0m    - Janet eats 3 eggs for breakfast every morning.
[36m(TaskRunner pid=2914832)[0m    - She eats 4 eggs for baking muffins every day.
[36m(TaskRunner pid=2914832)[0m    - Therefore, the total number of eggs she eats in a day is:
[36m(TaskRunner pid=2914832)[0m      \[
[36m(TaskRunner pid=2914832)[0m      3 + 4 = 7 \text{ eggs}
[36m(TaskRunner pid=2914832)[0m      \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 3. **Calculate the number of eggs Janet sells in a day:**
[36m(TaskRunner pid=2914832)[0m    - The remainder of the eggs is sold at the farmers' market.
[36m(TaskRunner pid=2914832)[0m    - The total number of eggs laid in a day is 16.
[36m(TaskRunner pid=2914832)[0m    - Subtract the number of eggs eaten from the total number of eggs:
[36m(TaskRunner pid=2914832)[0m      \[
[36m(TaskRunner pid=2914832)[0m      16 - 7 = 9 \text{ eggs}
[36m(TaskRunner pid=2914832)[0m      \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 4. **Determine the price per egg at the farmers' market:**
[36m(TaskRunner pid=2914832)[0m    - The price per egg is $2.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 5. **Calculate the total revenue from selling the eggs at the farmers' market:**
[36m(TaskRunner pid=2914832)[0m    - The number of eggs sold is 9.
[36m(TaskRunner pid=2914832)[0m    - The price per egg is $2.
[36m(TaskRunner pid=2914832)[0m    - Therefore, the total revenue is:
[36m(TaskRunner pid=2914832)[0m      \[
[36m(TaskRunner pid=2914832)[0m      9 \times 2 = 18 \text{ dollars}
[36m(TaskRunner pid=2914832)[0m      \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m #### Final Answer:
[36m(TaskRunner pid=2914832)[0m #### Janet makes #### $18 every day at the farmers' market.
[36m(TaskRunner pid=2914832)[0m [ground_truth] 18
[36m(TaskRunner pid=2914832)[0m [score] 0.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1312
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 20}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Tom's restaurant gets 6 reservations a night.  They normally order 2 meals that cost $5 each and a $5 bottle of wine.  How much do they make a week if they are open 2 days a week? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much Tom's restaurant makes in a week, we need to calculate the daily revenue and then multiply by the number of days the restaurant is open in a week.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. **Calculate the daily revenue:**
[36m(TaskRunner pid=2914832)[0m    - Tom's restaurant gets 6 reservations a night.
[36m(TaskRunner pid=2914832)[0m    - They normally order 2 meals that cost $5 each and a $5 bottle of wine.
[36m(TaskRunner pid=2914832)[0m    - The cost of 2 meals is \(2 \times 5 = 10\) dollars.
[36m(TaskRunner pid=2914832)[0m    - The cost of the wine is $5.
[36m(TaskRunner pid=2914832)[0m    - Therefore, the daily revenue is \(6 \times (10 + 5) = 6 \times 15 = 90\) dollars.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 2. **Calculate the weekly revenue:**
[36m(TaskRunner pid=2914832)[0m    - The restaurant is open 2 days a week.
[36m(TaskRunner pid=2914832)[0m    - So, the weekly revenue is \(90 \times 2 = 180\) dollars.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m #### Final Answer: #### 180
[36m(TaskRunner pid=2914832)[0m [ground_truth] 180
[36m(TaskRunner pid=2914832)[0m [score] 1.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1319
[36m(TaskRunner pid=2914832)[0m step:20 - global_seqlen/min:25357 - global_seqlen/max:27975 - global_seqlen/minmax_diff:2618 - global_seqlen/balanced_min:26369 - global_seqlen/balanced_max:26369 - global_seqlen/mean:26369.0 - actor/entropy:0.5204215049743652 - critic/vf_loss:0.07181730156298727 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.014400145912077278 - critic/grad_norm:52.32091236114502 - perf/mfu/critic:0.1105012586999496 - critic/lr:1e-05 - actor/pg_loss:0.1508389568189159 - actor/pg_clipfrac:0.002084695668600034 - actor/ppo_kl:6.162375495932793e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.9507884681224823 - perf/mfu/actor:0.08325678078029634 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.01980209350586 - actor/lr:1e-06 - val-core/openai/gsm8k/reward/mean@1:0.31311599696739956 - training/global_step:20 - training/epoch:0 - critic/score/mean:0.2265625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.2265625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:5.22241849765237e-09 - critic/advantages/max:3.7333967685699463 - critic/advantages/min:-2.1376962661743164 - critic/returns/mean:0.18218865990638733 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:-0.03759765625 - critic/values/max:1.046875 - critic/values/min:-0.86328125 - critic/vf_explained_var:0.028002798557281494 - response_length/mean:306.73046875 - response_length/max:512.0 - response_length/min:5.0 - response_length/clip_ratio:0.109375 - prompt_length/mean:105.28515625 - prompt_length/max:201.0 - prompt_length/min:64.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.393979907035828e-06 - timing_s/generate_sequences:3.634007453918457 - timing_s/reshard:0.9124553203582764 - timing_s/gen:5.237642420921475 - timing_s/reward:0.03746986482292414 - timing_s/old_log_prob:2.083443650044501 - timing_s/values:1.3606105693615973 - timing_s/adv:0.037470229901373386 - timing_s/update_critic:5.154683039989322 - timing_s/update_actor:6.832774320617318 - timing_s/testing:15.364216377027333 - timing_s/step:36.116024477873 - timing_s/stop_profile:2.1150335669517517e-06 - timing_per_token_ms/values:0.012899717180795606 - timing_per_token_ms/adv:0.00035524887084619616 - timing_per_token_ms/update_actor:0.0647803701374466 - timing_per_token_ms/update_critic:0.0488706723803455 - timing_per_token_ms/gen:0.06670201623628076 - perf/total_num_tokens:105476 - perf/time_per_step:36.116024477873 - perf/throughput:730.1191197318893
[36m(TaskRunner pid=2914832)[0m Training Progress:   5%|▍         | 20/435 [07:29<2:58:38, 25.83s/it]
[36m(TaskRunner pid=2914832)[0m step:21 - global_seqlen/min:24064 - global_seqlen/max:26378 - global_seqlen/minmax_diff:2314 - global_seqlen/balanced_min:25531 - global_seqlen/balanced_max:25531 - global_seqlen/mean:25531.0 - actor/entropy:0.509418785572052 - critic/vf_loss:0.12809569702949375 - critic/vf_clipfrac:0.016649421049805824 - critic/vpred_mean:0.04127192962914705 - critic/grad_norm:71.17950010299683 - perf/mfu/critic:0.10650984422307833 - critic/lr:1e-05 - actor/pg_loss:-0.0425622962648049 - actor/pg_clipfrac:0.0011947762541240081 - actor/ppo_kl:-2.6794350560521707e-06 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.8630081415176392 - perf/mfu/actor:0.07960952252336038 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.26700210571289 - actor/lr:1e-06 - training/global_step:21 - training/epoch:0 - critic/score/mean:0.22265625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.22265625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:4.058668512385566e-09 - critic/advantages/max:3.9977006912231445 - critic/advantages/min:-3.8388664722442627 - critic/returns/mean:0.1959385722875595 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.359375 - critic/values/max:1.6875 - critic/values/min:-1.25 - critic/vf_explained_var:-0.0004546642303466797 - response_length/mean:297.38671875 - response_length/max:512.0 - response_length/min:63.0 - response_length/clip_ratio:0.09375 - prompt_length/mean:101.53515625 - prompt_length/max:172.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.30807301402092e-06 - timing_s/generate_sequences:3.4781908988952637 - timing_s/reshard:0.30038148164749146 - timing_s/gen:4.477670067921281 - timing_s/reward:0.03516657277941704 - timing_s/old_log_prob:2.0867430260404944 - timing_s/values:1.6349178510718048 - timing_s/adv:0.03273539524525404 - timing_s/update_critic:5.165525628253818 - timing_s/update_actor:6.912030880339444 - timing_s/step:20.353276377078146 - timing_s/stop_profile:2.2202730178833008e-06 - timing_per_token_ms/values:0.01600914428608167 - timing_per_token_ms/adv:0.00032054556465917943 - timing_per_token_ms/update_actor:0.06768272766773181 - timing_per_token_ms/update_critic:0.05058091759286571 - timing_per_token_ms/gen:0.058815332360290566 - perf/total_num_tokens:102124 - perf/time_per_step:20.353276377078146 - perf/throughput:1254.3926357111234
[36m(TaskRunner pid=2914832)[0m Training Progress:   5%|▍         | 21/435 [07:50<2:46:53, 24.19s/it]
[36m(TaskRunner pid=2914832)[0m step:22 - global_seqlen/min:24906 - global_seqlen/max:26233 - global_seqlen/minmax_diff:1327 - global_seqlen/balanced_min:25493 - global_seqlen/balanced_max:25494 - global_seqlen/mean:25493.5 - actor/entropy:0.4642336368560791 - critic/vf_loss:0.21196850866544992 - critic/vf_clipfrac:0.1403908801439684 - critic/vpred_mean:0.42390974843874574 - critic/grad_norm:107.04079580307007 - perf/mfu/critic:0.09883910573483383 - critic/lr:1e-05 - actor/pg_loss:-0.09377360987127759 - actor/pg_clipfrac:0.002795968350255862 - actor/ppo_kl:-4.649881475415896e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.9526216089725494 - perf/mfu/actor:0.08062723757713554 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:87.66316604614258 - actor/lr:1e-06 - training/global_step:22 - training/epoch:0 - critic/score/mean:0.28515625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.28515625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:1.6715354655971737e-09 - critic/advantages/max:4.196156978607178 - critic/advantages/min:-4.429211616516113 - critic/returns/mean:0.2403898537158966 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:-0.1279296875 - critic/values/max:1.4453125 - critic/values/min:-1.21875 - critic/vf_explained_var:0.08216392993927002 - response_length/mean:294.18359375 - response_length/max:512.0 - response_length/min:5.0 - response_length/clip_ratio:0.078125 - prompt_length/mean:104.15234375 - prompt_length/max:217.0 - prompt_length/min:66.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.16790896654129e-06 - timing_s/generate_sequences:3.59926700592041 - timing_s/reshard:0.5865688920021057 - timing_s/gen:4.91980085009709 - timing_s/reward:0.04109664959833026 - timing_s/old_log_prob:2.0985967870801687 - timing_s/values:1.3563300701789558 - timing_s/adv:0.038101859856396914 - timing_s/update_critic:5.565887819044292 - timing_s/update_actor:6.820642517879605 - timing_s/step:20.847766500897706 - timing_s/stop_profile:2.8959475457668304e-06 - timing_per_token_ms/values:0.013300744014934746 - timing_per_token_ms/adv:0.00037364288795572315 - timing_per_token_ms/update_actor:0.06688609368936793 - timing_per_token_ms/update_critic:0.05458144055390876 - timing_per_token_ms/gen:0.06532645762368167 - perf/total_num_tokens:101974 - perf/time_per_step:20.847766500897706 - perf/throughput:1222.8408256060548
[36m(TaskRunner pid=2914832)[0m Training Progress:   5%|▌         | 22/435 [08:11<2:39:37, 23.19s/it]
[36m(TaskRunner pid=2914832)[0m step:23 - global_seqlen/min:24207 - global_seqlen/max:26486 - global_seqlen/minmax_diff:2279 - global_seqlen/balanced_min:24891 - global_seqlen/balanced_max:24891 - global_seqlen/mean:24891.0 - actor/entropy:0.41268953680992126 - critic/vf_loss:0.20204069116152823 - critic/vf_clipfrac:0.28633518889546394 - critic/vpred_mean:0.5214410657063127 - critic/grad_norm:92.28597640991211 - perf/mfu/critic:0.10027083794795087 - critic/lr:1e-05 - actor/pg_loss:-0.14611625857651234 - actor/pg_clipfrac:0.0017621574334043544 - actor/ppo_kl:-0.00036218702462065266 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.960413247346878 - perf/mfu/actor:0.07474978384544491 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.81771850585938 - actor/lr:1e-06 - training/global_step:23 - training/epoch:0 - critic/score/mean:0.33984375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.33984375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-4.7577422890299204e-08 - critic/advantages/max:2.9577016830444336 - critic/advantages/min:-2.496027946472168 - critic/returns/mean:0.28324878215789795 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.9375 - critic/values/max:1.71875 - critic/values/min:-0.193359375 - critic/vf_explained_var:0.10394918918609619 - response_length/mean:285.63671875 - response_length/max:512.0 - response_length/min:5.0 - response_length/clip_ratio:0.07421875 - prompt_length/mean:103.28515625 - prompt_length/max:186.0 - prompt_length/min:64.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.768612027168274e-06 - timing_s/generate_sequences:3.558697462081909 - timing_s/reshard:0.8679888248443604 - timing_s/gen:4.985738882329315 - timing_s/reward:0.0358272478915751 - timing_s/old_log_prob:2.460183244664222 - timing_s/values:1.3462060559540987 - timing_s/adv:0.03475411795079708 - timing_s/update_critic:5.347470108885318 - timing_s/update_actor:7.16896216571331 - timing_s/step:21.386168703902513 - timing_s/stop_profile:1.1735595762729645e-05 - timing_per_token_ms/values:0.013521012172613582 - timing_per_token_ms/adv:0.00034906309460042866 - timing_per_token_ms/update_actor:0.07200355716637852 - timing_per_token_ms/update_critic:0.05370887176976937 - timing_per_token_ms/gen:0.06818290937638383 - perf/total_num_tokens:99564 - perf/time_per_step:21.386168703902513 - perf/throughput:1163.883084652649
[36m(TaskRunner pid=2914832)[0m Training Progress:   5%|▌         | 23/435 [08:32<2:35:32, 22.65s/it]
[36m(TaskRunner pid=2914832)[0m step:24 - global_seqlen/min:23631 - global_seqlen/max:25110 - global_seqlen/minmax_diff:1479 - global_seqlen/balanced_min:24575 - global_seqlen/balanced_max:24576 - global_seqlen/mean:24575.25 - actor/entropy:0.3618274927139282 - critic/vf_loss:0.1109136207960546 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.3737842235714197 - critic/grad_norm:33.70705842971802 - perf/mfu/critic:0.08897137856111752 - critic/lr:1e-05 - actor/pg_loss:0.03176167781930417 - actor/pg_clipfrac:0.0017320644947176334 - actor/ppo_kl:5.4776340220996644e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.9773955941200256 - perf/mfu/actor:0.07805506996490448 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:86.87209701538086 - actor/lr:1e-06 - training/global_step:24 - training/epoch:0 - critic/score/mean:0.36328125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.36328125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:3.2339175781714857e-09 - critic/advantages/max:2.7258238792419434 - critic/advantages/min:-2.145735263824463 - critic/returns/mean:0.31015217304229736 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.208984375 - critic/values/max:0.85546875 - critic/values/min:-0.5 - critic/vf_explained_var:0.07774883508682251 - response_length/mean:281.07421875 - response_length/max:512.0 - response_length/min:68.0 - response_length/clip_ratio:0.078125 - prompt_length/mean:102.9140625 - prompt_length/max:216.0 - prompt_length/min:67.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:1.0797753930091858e-05 - timing_s/generate_sequences:3.583679676055908 - timing_s/reshard:0.5859574675559998 - timing_s/gen:4.704654259141535 - timing_s/reward:0.03519707778468728 - timing_s/old_log_prob:2.085121056996286 - timing_s/values:1.3433683100156486 - timing_s/adv:0.03394513810053468 - timing_s/update_critic:5.945892100222409 - timing_s/update_actor:6.775995086878538 - timing_s/step:20.931406288873404 - timing_s/stop_profile:2.3222528398036957e-06 - timing_per_token_ms/values:0.013665866166322302 - timing_per_token_ms/adv:0.00034531833959506697 - timing_per_token_ms/update_actor:0.06893109008940436 - timing_per_token_ms/update_critic:0.060486588134631473 - timing_per_token_ms/gen:0.06538328481886643 - perf/total_num_tokens:98301 - perf/time_per_step:20.931406288873404 - perf/throughput:1174.0849927060835
[36m(TaskRunner pid=2914832)[0m Training Progress:   6%|▌         | 24/435 [08:53<2:31:39, 22.14s/it]
[36m(TaskRunner pid=2914832)[0m step:25 - global_seqlen/min:23865 - global_seqlen/max:27245 - global_seqlen/minmax_diff:3380 - global_seqlen/balanced_min:25183 - global_seqlen/balanced_max:25184 - global_seqlen/mean:25183.25 - actor/entropy:0.39116358757019043 - critic/vf_loss:0.15790686980471946 - critic/vf_clipfrac:0.0 - critic/vpred_mean:-0.01688008531345986 - critic/grad_norm:80.74544668197632 - perf/mfu/critic:0.10434117745431645 - critic/lr:1e-05 - actor/pg_loss:-0.024673604231793433 - actor/pg_clipfrac:0.00200546032647253 - actor/ppo_kl:0.00021908544977122801 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.0574532747268677 - perf/mfu/actor:0.07971944579889308 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.13017272949219 - actor/lr:1e-06 - training/global_step:25 - training/epoch:0 - critic/score/mean:0.34375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.34375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-7.76224098331113e-08 - critic/advantages/max:2.79721736907959 - critic/advantages/min:-2.4607014656066895 - critic/returns/mean:0.29198744893074036 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:-0.04150390625 - critic/values/max:0.73046875 - critic/values/min:-1.109375 - critic/vf_explained_var:0.09571307897567749 - response_length/mean:289.73046875 - response_length/max:512.0 - response_length/min:5.0 - response_length/clip_ratio:0.078125 - prompt_length/mean:103.7578125 - prompt_length/max:169.0 - prompt_length/min:69.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.207955837249756e-06 - timing_s/generate_sequences:3.5674681663513184 - timing_s/reshard:0.8543322682380676 - timing_s/gen:4.88577733701095 - timing_s/reward:0.0357661759480834 - timing_s/old_log_prob:2.4263928811997175 - timing_s/values:1.3639129288494587 - timing_s/adv:0.03462216258049011 - timing_s/update_critic:5.200876612216234 - timing_s/update_actor:6.805037550162524 - timing_s/step:20.759419828187674 - timing_s/stop_profile:2.2347085177898407e-06 - timing_per_token_ms/values:0.013539881953773428 - timing_per_token_ms/adv:0.00034370228803361474 - timing_per_token_ms/update_actor:0.06755519591556415 - timing_per_token_ms/update_critic:0.051630315906567206 - timing_per_token_ms/gen:0.06587180079830324 - perf/total_num_tokens:100733 - perf/time_per_step:20.759419828187674 - perf/throughput:1213.099894333537
[36m(TaskRunner pid=2914832)[0m Training Progress:   6%|▌         | 25/435 [09:14<2:28:30, 21.73s/it]
[36m(TaskRunner pid=2914832)[0m step:26 - global_seqlen/min:25186 - global_seqlen/max:26232 - global_seqlen/minmax_diff:1046 - global_seqlen/balanced_min:25641 - global_seqlen/balanced_max:25642 - global_seqlen/mean:25641.75 - actor/entropy:0.3682178556919098 - critic/vf_loss:0.20142158214002848 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.7526356801390648 - critic/grad_norm:100.46955299377441 - perf/mfu/critic:0.10336840301054118 - critic/lr:1e-05 - actor/pg_loss:0.09016806399449706 - actor/pg_clipfrac:0.0020935159554937854 - actor/ppo_kl:0.000593739207715771 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.9270833730697632 - perf/mfu/actor:0.076981289486764 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:87.32306289672852 - actor/lr:1e-06 - training/global_step:26 - training/epoch:0 - critic/score/mean:0.390625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.390625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-4.225623584375171e-08 - critic/advantages/max:3.1247010231018066 - critic/advantages/min:-2.5039865970611572 - critic/returns/mean:0.33164599537849426 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.65625 - critic/values/max:1.453125 - critic/values/min:-0.353515625 - critic/vf_explained_var:0.08415251970291138 - response_length/mean:297.09765625 - response_length/max:512.0 - response_length/min:94.0 - response_length/clip_ratio:0.08203125 - prompt_length/mean:103.5546875 - prompt_length/max:212.0 - prompt_length/min:65.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.536937922239304e-06 - timing_s/generate_sequences:3.577575922012329 - timing_s/reshard:0.5864061713218689 - timing_s/gen:4.968863239046186 - timing_s/reward:0.037040560971945524 - timing_s/old_log_prob:2.0834463979117572 - timing_s/values:1.349429582245648 - timing_s/adv:0.0341518996283412 - timing_s/update_critic:5.34706113813445 - timing_s/update_actor:7.177199984900653 - timing_s/step:21.004607860930264 - timing_s/stop_profile:2.1192245185375214e-06 - timing_per_token_ms/values:0.01315656675388427 - timing_per_token_ms/adv:0.000332971614928205 - timing_per_token_ms/update_actor:0.06997572303860553 - timing_per_token_ms/update_critic:0.05213237335726354 - timing_per_token_ms/gen:0.0653307813751027 - perf/total_num_tokens:102567 - perf/time_per_step:21.004607860930264 - perf/throughput:1220.7678510244925
[36m(TaskRunner pid=2914832)[0m Training Progress:   6%|▌         | 26/435 [09:35<2:26:40, 21.52s/it]
[36m(TaskRunner pid=2914832)[0m step:27 - global_seqlen/min:24034 - global_seqlen/max:26310 - global_seqlen/minmax_diff:2276 - global_seqlen/balanced_min:25224 - global_seqlen/balanced_max:25225 - global_seqlen/mean:25224.75 - actor/entropy:0.32397323846817017 - critic/vf_loss:0.10027838591486216 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.2451362112769857 - critic/grad_norm:48.72735071182251 - perf/mfu/critic:0.10424571812207581 - critic/lr:1e-05 - actor/pg_loss:0.11231790669262409 - actor/pg_clipfrac:0.0011638228897936642 - actor/ppo_kl:0.00016679395707797084 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.0400094389915466 - perf/mfu/actor:0.07911411769075279 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.13332748413086 - actor/lr:1e-06 - training/global_step:27 - training/epoch:0 - critic/score/mean:0.41796875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.41796875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-9.426132763223904e-09 - critic/advantages/max:4.363936424255371 - critic/advantages/min:-2.527637243270874 - critic/returns/mean:0.3583826720714569 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.255859375 - critic/values/max:1.03125 - critic/values/min:-1.0625 - critic/vf_explained_var:0.1236335039138794 - response_length/mean:291.6640625 - response_length/max:512.0 - response_length/min:81.0 - response_length/clip_ratio:0.05859375 - prompt_length/mean:102.47265625 - prompt_length/max:202.0 - prompt_length/min:70.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.37605956196785e-06 - timing_s/generate_sequences:3.6770710945129395 - timing_s/reshard:0.5882043838500977 - timing_s/gen:4.943890804890543 - timing_s/reward:0.035915530286729336 - timing_s/old_log_prob:2.0804003477096558 - timing_s/values:1.4455114821903408 - timing_s/adv:0.034246647730469704 - timing_s/update_critic:5.2138612871058285 - timing_s/update_actor:6.869467532262206 - timing_s/step:20.63273400813341 - timing_s/stop_profile:2.1061860024929047e-06 - timing_per_token_ms/values:0.014326321194366057 - timing_per_token_ms/adv:0.0003394151352388993 - timing_per_token_ms/update_actor:0.06808261263503311 - timing_per_token_ms/update_critic:0.05167406304429012 - timing_per_token_ms/gen:0.0662134144709847 - perf/total_num_tokens:100899 - perf/time_per_step:20.63273400813341 - perf/throughput:1222.5597436605551
[36m(TaskRunner pid=2914832)[0m Training Progress:   6%|▌         | 27/435 [09:55<2:24:32, 21.26s/it]
[36m(TaskRunner pid=2914832)[0m step:28 - global_seqlen/min:24064 - global_seqlen/max:26554 - global_seqlen/minmax_diff:2490 - global_seqlen/balanced_min:25587 - global_seqlen/balanced_max:25588 - global_seqlen/mean:25587.75 - actor/entropy:0.32506996393203735 - critic/vf_loss:0.131278186570853 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.42276633344590664 - critic/grad_norm:41.60347509384155 - perf/mfu/critic:0.10806372364006023 - critic/lr:1e-05 - actor/pg_loss:0.02088551176711917 - actor/pg_clipfrac:0.0019324395652802195 - actor/ppo_kl:-0.000323774091384621 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.053019493818283 - perf/mfu/actor:0.07996910225482798 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.07657623291016 - actor/lr:1e-06 - training/global_step:28 - training/epoch:0 - critic/score/mean:0.3828125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.3828125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-3.405530435429682e-08 - critic/advantages/max:4.27004337310791 - critic/advantages/min:-5.3157501220703125 - critic/returns/mean:0.322243332862854 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.453125 - critic/values/max:2.53125 - critic/values/min:-0.796875 - critic/vf_explained_var:0.06661665439605713 - response_length/mean:296.2265625 - response_length/max:512.0 - response_length/min:91.0 - response_length/clip_ratio:0.0625 - prompt_length/mean:103.58203125 - prompt_length/max:177.0 - prompt_length/min:66.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.893905371427536e-06 - timing_s/generate_sequences:3.549675226211548 - timing_s/reshard:0.7878210544586182 - timing_s/gen:5.233115572016686 - timing_s/reward:0.038647588808089495 - timing_s/old_log_prob:2.121185078751296 - timing_s/values:1.6207560747861862 - timing_s/adv:0.03293277323246002 - timing_s/update_critic:5.103758822195232 - timing_s/update_actor:6.893005832098424 - timing_s/step:21.051194122061133 - timing_s/stop_profile:8.40192660689354e-06 - timing_per_token_ms/values:0.01583527346861473 - timing_per_token_ms/adv:0.00032176308226065226 - timing_per_token_ms/update_actor:0.06734673654481563 - timing_per_token_ms/update_critic:0.0498652560521659 - timing_per_token_ms/gen:0.0690075107737517 - perf/total_num_tokens:102351 - perf/time_per_step:21.051194122061133 - perf/throughput:1215.5011184465145
[36m(TaskRunner pid=2914832)[0m Training Progress:   6%|▋         | 28/435 [10:17<2:23:47, 21.20s/it]
[36m(TaskRunner pid=2914832)[0m step:29 - global_seqlen/min:24788 - global_seqlen/max:25774 - global_seqlen/minmax_diff:986 - global_seqlen/balanced_min:25199 - global_seqlen/balanced_max:25200 - global_seqlen/mean:25199.75 - actor/entropy:0.35780325531959534 - critic/vf_loss:0.10984516143798828 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.39938537776470184 - critic/grad_norm:27.378318071365356 - perf/mfu/critic:0.09512528389162601 - critic/lr:1e-05 - actor/pg_loss:-0.12363229488255456 - actor/pg_clipfrac:0.0018928341014543548 - actor/ppo_kl:4.6152016693667974e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.0160407721996307 - perf/mfu/actor:0.0800644448642145 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.65741348266602 - actor/lr:1e-06 - training/global_step:29 - training/epoch:0 - critic/score/mean:0.4296875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.4296875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-6.446824585282229e-08 - critic/advantages/max:5.628807067871094 - critic/advantages/min:-2.7627451419830322 - critic/returns/mean:0.37648314237594604 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.56640625 - critic/values/max:1.484375 - critic/values/min:-1.4453125 - critic/vf_explained_var:0.06585705280303955 - response_length/mean:289.38671875 - response_length/max:512.0 - response_length/min:68.0 - response_length/clip_ratio:0.0546875 - prompt_length/mean:104.359375 - prompt_length/max:232.0 - prompt_length/min:66.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:6.095040589570999e-06 - timing_s/generate_sequences:3.5452322959899902 - timing_s/reshard:0.5820896029472351 - timing_s/gen:4.696863149758428 - timing_s/reward:0.036046176217496395 - timing_s/old_log_prob:2.0875927498564124 - timing_s/values:1.3475080290809274 - timing_s/adv:0.032849045004695654 - timing_s/update_critic:5.70589775685221 - timing_s/update_actor:6.7769849160686135 - timing_s/step:20.690765649080276 - timing_s/stop_profile:2.387911081314087e-06 - timing_per_token_ms/values:0.013368267830840856 - timing_per_token_ms/adv:0.0003258866159852345 - timing_per_token_ms/update_actor:0.06723266020564304 - timing_per_token_ms/update_critic:0.05660669011450718 - timing_per_token_ms/gen:0.06340001282019395 - perf/total_num_tokens:100799 - perf/time_per_step:20.690765649080276 - perf/throughput:1217.9225470624453
[36m(TaskRunner pid=2914832)[0m Training Progress:   7%|▋         | 29/435 [10:37<2:22:25, 21.05s/it]
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 30}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and bakes muffins for her friends every day with four. She sells the remainder at the farmers' market daily for $2 per fresh duck egg. How much in dollars does she make every day at the farmers' market? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much Janet makes at the farmers' market every day, we need to follow these steps:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. Calculate the total number of eggs laid by the ducks in a day.
[36m(TaskRunner pid=2914832)[0m 2. Determine the number of eggs Janet eats in a day.
[36m(TaskRunner pid=2914832)[0m 3. Calculate the number of eggs Janet sells in a day.
[36m(TaskRunner pid=2914832)[0m 4. Find out how many ducks she has.
[36m(TaskRunner pid=2914832)[0m 5. Calculate the total revenue from selling the eggs.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Let's start with the first step:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. The ducks lay 16 eggs per day.
[36m(TaskRunner pid=2914832)[0m 2. Janet eats 3 eggs for breakfast every morning.
[36m(TaskRunner pid=2914832)[0m 3. Janet bakes muffins for her friends every day, which means she eats 4 muffins.
[36m(TaskRunner pid=2914832)[0m 4. The number of eggs she sells in a day is the total number of eggs laid minus the number of eggs she eats:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    16 - 3 - 4 = 7 \text{ eggs}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m 5. Janet sells each egg for $2.
[36m(TaskRunner pid=2914832)[0m 6. The total revenue from selling the eggs is:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    7 \text{ eggs} \times 2 \text{ dollars/egg} = 14 \text{ dollars}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Therefore, the final answer is:
[36m(TaskRunner pid=2914832)[0m #### 14
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Janet makes $14 every day at the farmers' market.
[36m(TaskRunner pid=2914832)[0m [ground_truth] 18
[36m(TaskRunner pid=2914832)[0m [score] 0.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1312
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 30}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Tom's restaurant gets 6 reservations a night.  They normally order 2 meals that cost $5 each and a $5 bottle of wine.  How much do they make a week if they are open 2 days a week? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much Tom's restaurant makes in a week, we need to calculate the daily revenue and then multiply by the number of days the restaurant is open in a week.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. **Calculate the daily revenue:**
[36m(TaskRunner pid=2914832)[0m    - Tom's restaurant gets 6 reservations a night.
[36m(TaskRunner pid=2914832)[0m    - They order 2 meals that cost $5 each and a $5 bottle of wine.
[36m(TaskRunner pid=2914832)[0m    - The cost of the meals is \(2 \times 5 = 10\) dollars.
[36m(TaskRunner pid=2914832)[0m    - The cost of the wine is $5.
[36m(TaskRunner pid=2914832)[0m    - Therefore, the daily revenue is \(10 + 5 = 15\) dollars.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 2. **Calculate the weekly revenue:**
[36m(TaskRunner pid=2914832)[0m    - The restaurant is open 2 days a week.
[36m(TaskRunner pid=2914832)[0m    - The daily revenue is $15.
[36m(TaskRunner pid=2914832)[0m    - Therefore, the weekly revenue is \(15 \times 2 = 30\) dollars.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m #### Final answer: #### 30
[36m(TaskRunner pid=2914832)[0m [ground_truth] 180
[36m(TaskRunner pid=2914832)[0m [score] 0.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1319
[36m(TaskRunner pid=2914832)[0m step:30 - global_seqlen/min:24203 - global_seqlen/max:27416 - global_seqlen/minmax_diff:3213 - global_seqlen/balanced_min:25598 - global_seqlen/balanced_max:25599 - global_seqlen/mean:25598.75 - actor/entropy:0.31164273619651794 - critic/vf_loss:0.11028365744277835 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.40315646678209305 - critic/grad_norm:21.590280055999756 - perf/mfu/critic:0.10268029278770942 - critic/lr:1e-05 - actor/pg_loss:-0.040963432809803635 - actor/pg_clipfrac:0.002334006807359401 - actor/ppo_kl:2.0074530993952067e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.915434092283249 - perf/mfu/actor:0.07674446515222523 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:87.58063125610352 - actor/lr:1e-06 - val-core/openai/gsm8k/reward/mean@1:0.44806671721000757 - training/global_step:30 - training/epoch:1 - critic/score/mean:0.43359375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.43359375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:1.3239872309611656e-08 - critic/advantages/max:3.1595115661621094 - critic/advantages/min:-2.7627413272857666 - critic/returns/mean:0.38065898418426514 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.26171875 - critic/values/max:1.2421875 - critic/values/min:-1.375 - critic/vf_explained_var:0.10612952709197998 - response_length/mean:295.4375 - response_length/max:512.0 - response_length/min:99.0 - response_length/clip_ratio:0.0546875 - prompt_length/mean:104.54296875 - prompt_length/max:202.0 - prompt_length/min:67.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:1.0326039046049118e-05 - timing_s/generate_sequences:3.5786778926849365 - timing_s/reshard:0.8359761238098145 - timing_s/gen:5.241478828713298 - timing_s/reward:0.03619840508326888 - timing_s/old_log_prob:2.1031188210472465 - timing_s/values:1.64147939812392 - timing_s/adv:0.04010496707633138 - timing_s/update_critic:5.37442489201203 - timing_s/update_actor:7.185344495810568 - timing_s/testing:13.753481450956315 - timing_s/step:35.384940904099494 - timing_s/stop_profile:2.168118953704834e-06 - timing_per_token_ms/values:0.016030855003895894 - timing_per_token_ms/adv:0.0003916691935771412 - timing_per_token_ms/update_actor:0.07017280624845518 - timing_per_token_ms/update_critic:0.05248718093668665 - timing_per_token_ms/gen:0.06930239619094164 - perf/total_num_tokens:102395 - perf/time_per_step:35.384940904099494 - perf/throughput:723.4362795568292
[36m(TaskRunner pid=2914832)[0m Training Progress:   7%|▋         | 30/435 [11:13<2:51:57, 25.48s/it]
[36m(TaskRunner pid=2914832)[0m step:31 - global_seqlen/min:24674 - global_seqlen/max:25845 - global_seqlen/minmax_diff:1171 - global_seqlen/balanced_min:25212 - global_seqlen/balanced_max:25213 - global_seqlen/mean:25212.5 - actor/entropy:0.2999115586280823 - critic/vf_loss:0.2315991920477245 - critic/vf_clipfrac:0.0 - critic/vpred_mean:-0.04874438891420141 - critic/grad_norm:115.20077610015869 - perf/mfu/critic:0.10494628563899837 - critic/lr:1e-05 - actor/pg_loss:-0.025982314662542194 - actor/pg_clipfrac:0.002351590261241654 - actor/ppo_kl:0.00017732864655783942 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.9512355625629425 - perf/mfu/actor:0.07969524574969053 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.39925384521484 - actor/lr:1e-06 - training/global_step:31 - training/epoch:1 - critic/score/mean:0.4765625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.4765625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:2.808689636424333e-08 - critic/advantages/max:3.233227014541626 - critic/advantages/min:-3.473731517791748 - critic/returns/mean:0.4234992563724518 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:-0.048583984375 - critic/values/max:1.1484375 - critic/values/min:-0.98046875 - critic/vf_explained_var:0.10863059759140015 - response_length/mean:291.0 - response_length/max:512.0 - response_length/min:81.0 - response_length/clip_ratio:0.05859375 - prompt_length/mean:102.9453125 - prompt_length/max:201.0 - prompt_length/min:66.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.631963282823563e-06 - timing_s/generate_sequences:3.624605417251587 - timing_s/reshard:0.30005040764808655 - timing_s/gen:4.851729323621839 - timing_s/reward:0.0382866351865232 - timing_s/old_log_prob:2.0829463019035757 - timing_s/values:1.339130889158696 - timing_s/adv:0.038395331241190434 - timing_s/update_critic:5.179153116419911 - timing_s/update_actor:6.812224680092186 - timing_s/step:20.349033838137984 - timing_s/stop_profile:1.6987323760986328e-06 - timing_per_token_ms/values:0.013278442133452611 - timing_per_token_ms/adv:0.0003807172160752646 - timing_per_token_ms/update_actor:0.06754808805247581 - timing_per_token_ms/update_critic:0.05135501354903234 - timing_per_token_ms/gen:0.0651273803106454 - perf/total_num_tokens:100850 - perf/time_per_step:20.349033838137984 - perf/throughput:1239.0023133553864
[36m(TaskRunner pid=2914832)[0m Training Progress:   7%|▋         | 31/435 [11:33<2:41:12, 23.94s/it]
[36m(TaskRunner pid=2914832)[0m step:32 - global_seqlen/min:24067 - global_seqlen/max:25263 - global_seqlen/minmax_diff:1196 - global_seqlen/balanced_min:24736 - global_seqlen/balanced_max:24737 - global_seqlen/mean:24736.25 - actor/entropy:0.2675827741622925 - critic/vf_loss:0.15017385920509696 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.7057638056576252 - critic/grad_norm:72.4225263595581 - perf/mfu/critic:0.09644153533960438 - critic/lr:1e-05 - actor/pg_loss:-0.08490700993570499 - actor/pg_clipfrac:0.0013264302688185126 - actor/ppo_kl:0.00028581363091007006 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.005085974931717 - perf/mfu/actor:0.07767454449695127 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.70362854003906 - actor/lr:1e-06 - training/global_step:32 - training/epoch:1 - critic/score/mean:0.46875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.46875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-3.0812923768053224e-08 - critic/advantages/max:2.2730298042297363 - critic/advantages/min:-2.638185739517212 - critic/returns/mean:0.40590929985046387 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.6328125 - critic/values/max:1.4375 - critic/values/min:-0.08740234375 - critic/vf_explained_var:0.12437891960144043 - response_length/mean:285.56640625 - response_length/max:512.0 - response_length/min:86.0 - response_length/clip_ratio:0.04296875 - prompt_length/mean:100.9375 - prompt_length/max:201.0 - prompt_length/min:69.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.082918167114258e-06 - timing_s/generate_sequences:3.5781123638153076 - timing_s/reshard:0.5863234400749207 - timing_s/gen:4.719821994192898 - timing_s/reward:0.03533662483096123 - timing_s/old_log_prob:2.073717668186873 - timing_s/values:1.3415944939479232 - timing_s/adv:0.03377022221684456 - timing_s/update_critic:5.520567768253386 - timing_s/update_actor:6.8557843482121825 - timing_s/step:20.58792654518038 - timing_s/stop_profile:3.092922270298004e-06 - timing_per_token_ms/values:0.013558992308332136 - timing_per_token_ms/adv:0.0003413029684859726 - timing_per_token_ms/update_actor:0.06928884075205602 - timing_per_token_ms/update_critic:0.05579430762800936 - timing_per_token_ms/gen:0.06456223232600915 - perf/total_num_tokens:98945 - perf/time_per_step:20.58792654518038 - perf/throughput:1201.493018042205
[36m(TaskRunner pid=2914832)[0m Training Progress:   7%|▋         | 32/435 [11:54<2:34:04, 22.94s/it]
[36m(TaskRunner pid=2914832)[0m step:33 - global_seqlen/min:24285 - global_seqlen/max:26357 - global_seqlen/minmax_diff:2072 - global_seqlen/balanced_min:25227 - global_seqlen/balanced_max:25228 - global_seqlen/mean:25227.75 - actor/entropy:0.27855968475341797 - critic/vf_loss:0.16839780093869194 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.13765604685249855 - critic/grad_norm:57.81891441345215 - perf/mfu/critic:0.10477301877005261 - critic/lr:1e-05 - actor/pg_loss:-0.1716561252833344 - actor/pg_clipfrac:0.0023374752345262095 - actor/ppo_kl:0.0006658544048150361 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.9444376230239868 - perf/mfu/actor:0.07988631167852481 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:87.98834609985352 - actor/lr:1e-06 - training/global_step:33 - training/epoch:1 - critic/score/mean:0.43359375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.43359375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:3.15546415663448e-08 - critic/advantages/max:5.387515544891357 - critic/advantages/min:-2.6380650997161865 - critic/returns/mean:0.36201632022857666 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.1806640625 - critic/values/max:1.0078125 - critic/values/min:-1.609375 - critic/vf_explained_var:0.12051844596862793 - response_length/mean:289.125 - response_length/max:512.0 - response_length/min:75.0 - response_length/clip_ratio:0.0546875 - prompt_length/mean:105.05859375 - prompt_length/max:206.0 - prompt_length/min:65.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:6.075017154216766e-06 - timing_s/generate_sequences:3.5760157108306885 - timing_s/reshard:0.9471949338912964 - timing_s/gen:5.160758679267019 - timing_s/reward:0.03596252901479602 - timing_s/old_log_prob:2.4209714881144464 - timing_s/values:1.3456534147262573 - timing_s/adv:0.03582436591386795 - timing_s/update_critic:5.187793876044452 - timing_s/update_actor:6.802063079085201 - timing_s/step:20.995914958417416 - timing_s/stop_profile:1.5157274901866913e-06 - timing_per_token_ms/values:0.013335051825135589 - timing_per_token_ms/adv:0.0003550095223897093 - timing_per_token_ms/update_actor:0.0674065570560712 - timing_per_token_ms/update_critic:0.051409597328779345 - timing_per_token_ms/gen:0.06972490649679824 - perf/total_num_tokens:100911 - perf/time_per_step:20.995914958417416 - perf/throughput:1201.5551620381284
[36m(TaskRunner pid=2914832)[0m Training Progress:   8%|▊         | 33/435 [12:15<2:29:49, 22.36s/it]
[36m(TaskRunner pid=2914832)[0m step:34 - global_seqlen/min:25043 - global_seqlen/max:27825 - global_seqlen/minmax_diff:2782 - global_seqlen/balanced_min:26122 - global_seqlen/balanced_max:26123 - global_seqlen/mean:26122.75 - actor/entropy:0.2763175666332245 - critic/vf_loss:0.15360158821567893 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.7196257561445236 - critic/grad_norm:76.38045024871826 - perf/mfu/critic:0.10355756865804683 - critic/lr:1e-05 - actor/pg_loss:-0.0979953408241272 - actor/pg_clipfrac:0.0034836070553865284 - actor/ppo_kl:0.0005900284800191002 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.0735954344272614 - perf/mfu/actor:0.07948525368073975 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.05548858642578 - actor/lr:1e-06 - training/global_step:34 - training/epoch:1 - critic/score/mean:0.46484375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.46484375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-8.869272427602937e-09 - critic/advantages/max:4.672342777252197 - critic/advantages/min:-3.097687244415283 - critic/returns/mean:0.38258132338523865 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.66796875 - critic/values/max:2.671875 - critic/values/min:-0.8046875 - critic/vf_explained_var:0.15252447128295898 - response_length/mean:302.8359375 - response_length/max:512.0 - response_length/min:120.0 - response_length/clip_ratio:0.09375 - prompt_length/mean:105.33203125 - prompt_length/max:211.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.297122359275818e-06 - timing_s/generate_sequences:3.663661003112793 - timing_s/reshard:0.5820683240890503 - timing_s/gen:5.065743054263294 - timing_s/reward:0.03590956889092922 - timing_s/old_log_prob:2.0767024853266776 - timing_s/values:1.3423892492428422 - timing_s/adv:0.03396611614152789 - timing_s/update_critic:5.438240936025977 - timing_s/update_actor:7.083354999311268 - timing_s/step:21.083380804862827 - timing_s/stop_profile:1.8472783267498016e-06 - timing_per_token_ms/values:0.012846936571023745 - timing_per_token_ms/adv:0.0003250626000471609 - timing_per_token_ms/update_actor:0.06778913972793128 - timing_per_token_ms/update_critic:0.05204506547000198 - timing_per_token_ms/gen:0.06534250515005667 - perf/total_num_tokens:104491 - perf/time_per_step:21.083380804862827 - perf/throughput:1239.020925618099
[36m(TaskRunner pid=2914832)[0m Training Progress:   8%|▊         | 34/435 [12:36<2:26:54, 21.98s/it]
[36m(TaskRunner pid=2914832)[0m step:35 - global_seqlen/min:23805 - global_seqlen/max:26097 - global_seqlen/minmax_diff:2292 - global_seqlen/balanced_min:24843 - global_seqlen/balanced_max:24844 - global_seqlen/mean:24843.25 - actor/entropy:0.23235823214054108 - critic/vf_loss:0.14451236103195697 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.13447678365628235 - critic/grad_norm:77.94077587127686 - perf/mfu/critic:0.09808053673093908 - critic/lr:1e-05 - actor/pg_loss:0.044368751579895616 - actor/pg_clipfrac:0.0016387222640332766 - actor/ppo_kl:0.00017083896545955213 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.014436960220337 - perf/mfu/actor:0.07792084009009816 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.94461441040039 - actor/lr:1e-06 - training/global_step:35 - training/epoch:1 - critic/score/mean:0.515625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.515625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:2.0595246397192568e-08 - critic/advantages/max:3.92950439453125 - critic/advantages/min:-2.4788596630096436 - critic/returns/mean:0.45487266778945923 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.1904296875 - critic/values/max:1.03125 - critic/values/min:-1.046875 - critic/vf_explained_var:0.17060714960098267 - response_length/mean:286.515625 - response_length/max:512.0 - response_length/min:108.0 - response_length/clip_ratio:0.046875 - prompt_length/mean:101.66015625 - prompt_length/max:186.0 - prompt_length/min:64.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.275942385196686e-06 - timing_s/generate_sequences:3.565638542175293 - timing_s/reshard:0.5852133631706238 - timing_s/gen:4.98309881798923 - timing_s/reward:0.03558280086144805 - timing_s/old_log_prob:2.0855318941175938 - timing_s/values:1.4073617137037218 - timing_s/adv:0.034072937443852425 - timing_s/update_critic:5.453801183030009 - timing_s/update_actor:6.860960048157722 - timing_s/step:20.867302641738206 - timing_s/stop_profile:1.9837170839309692e-06 - timing_per_token_ms/values:0.014162415482110047 - timing_per_token_ms/adv:0.0003428792271930245 - timing_per_token_ms/update_actor:0.06904249693737456 - timing_per_token_ms/update_critic:0.054882122739879136 - timing_per_token_ms/gen:0.06793775996604175 - perf/total_num_tokens:99373 - perf/time_per_step:20.867302641738206 - perf/throughput:1190.5348010963914
[36m(TaskRunner pid=2914832)[0m Training Progress:   8%|▊         | 35/435 [12:57<2:24:19, 21.65s/it]
[36m(TaskRunner pid=2914832)[0m step:36 - global_seqlen/min:24980 - global_seqlen/max:26115 - global_seqlen/minmax_diff:1135 - global_seqlen/balanced_min:25539 - global_seqlen/balanced_max:25540 - global_seqlen/mean:25539.75 - actor/entropy:0.2654295861721039 - critic/vf_loss:0.1639320906251669 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.728571280837059 - critic/grad_norm:57.527769565582275 - perf/mfu/critic:0.10362403453591967 - critic/lr:1e-05 - actor/pg_loss:0.18526148406090215 - actor/pg_clipfrac:0.002261507986986544 - actor/ppo_kl:-0.00011296834918539389 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.098426431417465 - perf/mfu/actor:0.07661165917603606 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.91726684570312 - actor/lr:1e-06 - training/global_step:36 - training/epoch:1 - critic/score/mean:0.53515625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.53515625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-6.389274886942076e-08 - critic/advantages/max:2.547062635421753 - critic/advantages/min:-6.265055179595947 - critic/returns/mean:0.47706833481788635 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.671875 - critic/values/max:3.0 - critic/values/min:-0.1982421875 - critic/vf_explained_var:0.19646036624908447 - response_length/mean:295.375 - response_length/max:512.0 - response_length/min:129.0 - response_length/clip_ratio:0.06640625 - prompt_length/mean:103.68359375 - prompt_length/max:256.0 - prompt_length/min:56.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.913657903671265e-06 - timing_s/generate_sequences:3.5541179180145264 - timing_s/reshard:0.5879281759262085 - timing_s/gen:5.023705760017037 - timing_s/reward:0.03551279008388519 - timing_s/old_log_prob:2.123001310043037 - timing_s/values:1.6045270836912096 - timing_s/adv:0.033479646779596806 - timing_s/update_critic:5.311495476868004 - timing_s/update_actor:7.179804710671306 - timing_s/step:21.319162433966994 - timing_s/stop_profile:2.0149163901805878e-06 - timing_per_token_ms/values:0.015706174528834556 - timing_per_token_ms/adv:0.0003277209720102664 - timing_per_token_ms/update_actor:0.07028068707281107 - timing_per_token_ms/update_critic:0.05199243803157826 - timing_per_token_ms/gen:0.06643707363543479 - perf/total_num_tokens:102159 - perf/time_per_step:21.319162433966994 - perf/throughput:1197.9715469172704
[36m(TaskRunner pid=2914832)[0m Training Progress:   8%|▊         | 36/435 [13:18<2:23:19, 21.55s/it]
[36m(TaskRunner pid=2914832)[0m step:37 - global_seqlen/min:25002 - global_seqlen/max:26081 - global_seqlen/minmax_diff:1079 - global_seqlen/balanced_min:25677 - global_seqlen/balanced_max:25677 - global_seqlen/mean:25677.0 - actor/entropy:0.23948881030082703 - critic/vf_loss:0.19116978999227285 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.15481655064650113 - critic/grad_norm:75.66411256790161 - perf/mfu/critic:0.10011767833217837 - critic/lr:1e-05 - actor/pg_loss:-0.2713334350846708 - actor/pg_clipfrac:0.0022227809859032277 - actor/ppo_kl:0.0004187896118992285 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.1279134154319763 - perf/mfu/actor:0.08160214288532293 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:87.97896194458008 - actor/lr:1e-06 - training/global_step:37 - training/epoch:1 - critic/score/mean:0.5 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.5 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-7.38657046639446e-09 - critic/advantages/max:3.060859203338623 - critic/advantages/min:-3.437747001647949 - critic/returns/mean:0.4457426965236664 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.1806640625 - critic/values/max:1.2890625 - critic/values/min:-0.6484375 - critic/vf_explained_var:0.1730175018310547 - response_length/mean:295.5390625 - response_length/max:512.0 - response_length/min:119.0 - response_length/clip_ratio:0.0625 - prompt_length/mean:105.6640625 - prompt_length/max:189.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.851018846035004e-06 - timing_s/generate_sequences:3.552417039871216 - timing_s/reshard:0.5862331986427307 - timing_s/gen:4.652791539207101 - timing_s/reward:0.04051281278952956 - timing_s/old_log_prob:2.089420720934868 - timing_s/values:1.348376754205674 - timing_s/adv:0.04283503396436572 - timing_s/update_critic:5.525762537959963 - timing_s/update_actor:6.777176550123841 - timing_s/step:20.483260108623654 - timing_s/stop_profile:1.701992005109787e-06 - timing_per_token_ms/values:0.013128254412564494 - timing_per_token_ms/adv:0.0004170564509518803 - timing_per_token_ms/update_actor:0.06598489455664447 - timing_per_token_ms/update_critic:0.053800702359698985 - timing_per_token_ms/gen:0.061497680869268295 - perf/total_num_tokens:102708 - perf/time_per_step:20.483260108623654 - perf/throughput:1253.560217652547
[36m(TaskRunner pid=2914832)[0m Training Progress:   9%|▊         | 37/435 [13:39<2:20:51, 21.23s/it]
[36m(TaskRunner pid=2914832)[0m step:38 - global_seqlen/min:24979 - global_seqlen/max:26565 - global_seqlen/minmax_diff:1586 - global_seqlen/balanced_min:25694 - global_seqlen/balanced_max:25695 - global_seqlen/mean:25694.75 - actor/entropy:0.24441000819206238 - critic/vf_loss:0.15406082943081856 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.734283659607172 - critic/grad_norm:71.50063228607178 - perf/mfu/critic:0.10517540064224908 - critic/lr:1e-05 - actor/pg_loss:0.045999105903320014 - actor/pg_clipfrac:0.0028885376632388216 - actor/ppo_kl:0.0008457701870270284 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.060913383960724 - perf/mfu/actor:0.08138349338183219 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.11489868164062 - actor/lr:1e-06 - training/global_step:38 - training/epoch:1 - critic/score/mean:0.484375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.484375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:2.149939959394942e-08 - critic/advantages/max:2.869459867477417 - critic/advantages/min:-5.747082233428955 - critic/returns/mean:0.41597625613212585 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.6875 - critic/values/max:3.765625 - critic/values/min:-0.095703125 - critic/vf_explained_var:0.1958562135696411 - response_length/mean:297.51171875 - response_length/max:512.0 - response_length/min:101.0 - response_length/clip_ratio:0.078125 - prompt_length/mean:103.96875 - prompt_length/max:184.0 - prompt_length/min:65.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.308763891458511e-06 - timing_s/generate_sequences:3.5599606037139893 - timing_s/reshard:0.8789645433425903 - timing_s/gen:4.980407345108688 - timing_s/reward:0.03506297478452325 - timing_s/old_log_prob:2.40619380120188 - timing_s/values:1.342105405870825 - timing_s/adv:0.03422670904546976 - timing_s/update_critic:5.265934878960252 - timing_s/update_actor:6.801051458809525 - timing_s/step:20.871670812834054 - timing_s/stop_profile:9.85199585556984e-06 - timing_per_token_ms/values:0.013058167581615165 - timing_per_token_ms/adv:0.00033301266839986534 - timing_per_token_ms/update_actor:0.06617160566661988 - timing_per_token_ms/update_critic:0.051235513859448446 - timing_per_token_ms/gen:0.06539142818834195 - perf/total_num_tokens:102779 - perf/time_per_step:20.871670812834054 - perf/throughput:1231.0825630787651
[36m(TaskRunner pid=2914832)[0m Training Progress:   9%|▊         | 38/435 [14:00<2:19:48, 21.13s/it]
[36m(TaskRunner pid=2914832)[0m step:39 - global_seqlen/min:24224 - global_seqlen/max:26335 - global_seqlen/minmax_diff:2111 - global_seqlen/balanced_min:25051 - global_seqlen/balanced_max:25052 - global_seqlen/mean:25051.25 - actor/entropy:0.23189009726047516 - critic/vf_loss:0.15023290715180337 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.13632640927971806 - critic/grad_norm:80.7728443145752 - perf/mfu/critic:0.10431545360432429 - critic/lr:1e-05 - actor/pg_loss:0.10266856278758496 - actor/pg_clipfrac:0.0021527189564949367 - actor/ppo_kl:0.0003570196865894104 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.09000563621521 - perf/mfu/actor:0.0754200426976384 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.84881210327148 - actor/lr:1e-06 - training/global_step:39 - training/epoch:1 - critic/score/mean:0.515625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.515625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:7.0231429560863035e-09 - critic/advantages/max:6.108504772186279 - critic/advantages/min:-1.9310277700424194 - critic/returns/mean:0.46486544609069824 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.1943359375 - critic/values/max:1.03125 - critic/values/min:-2.078125 - critic/vf_explained_var:0.15076661109924316 - response_length/mean:288.2890625 - response_length/max:512.0 - response_length/min:92.0 - response_length/clip_ratio:0.05859375 - prompt_length/mean:103.13671875 - prompt_length/max:179.0 - prompt_length/min:65.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.393048584461212e-06 - timing_s/generate_sequences:3.583120346069336 - timing_s/reshard:0.5846446752548218 - timing_s/gen:4.882880699355155 - timing_s/reward:0.0348105956800282 - timing_s/old_log_prob:2.0854997811838984 - timing_s/values:1.3500152942724526 - timing_s/adv:0.03620921541005373 - timing_s/update_critic:5.173892765771598 - timing_s/update_actor:7.151602985803038 - timing_s/step:20.72210059966892 - timing_s/stop_profile:5.359761416912079e-06 - timing_per_token_ms/values:0.013472534247517116 - timing_per_token_ms/adv:0.0003613513837638215 - timing_per_token_ms/update_actor:0.07136972192807782 - timing_per_token_ms/update_critic:0.0516330798440357 - timing_per_token_ms/gen:0.06616190210773631 - perf/total_num_tokens:100205 - perf/time_per_step:20.72210059966892 - perf/throughput:1208.9146020457138
[36m(TaskRunner pid=2914832)[0m Training Progress:   9%|▉         | 39/435 [14:20<2:18:41, 21.01s/it]
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 40}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and bakes muffins for her friends every day with four. She sells the remainder at the farmers' market daily for $2 per fresh duck egg. How much in dollars does she make every day at the farmers' market? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much money Janet makes every day at the farmers' market, we need to follow these steps:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. Calculate the total number of eggs laid by the ducks in a day.
[36m(TaskRunner pid=2914832)[0m 2. Determine the number of eggs Janet sells at the farmers' market.
[36m(TaskRunner pid=2914832)[0m 3. Calculate the total revenue from selling the eggs.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m First, we know that Janet's ducks lay 16 eggs per day. She eats 3 eggs for breakfast and bakes 4 muffins for her friends, so the number of eggs she eats in a day is:
[36m(TaskRunner pid=2914832)[0m \[ 3 + 4 = 7 \text{ eggs} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Therefore, the number of eggs she sells at the farmers' market is:
[36m(TaskRunner pid=2914832)[0m \[ 16 - 7 = 9 \text{ eggs} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Since she sells each egg for $2, the total revenue from selling the eggs is:
[36m(TaskRunner pid=2914832)[0m \[ 9 \times 2 = 18 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m So, the final answer is:
[36m(TaskRunner pid=2914832)[0m #### 18
[36m(TaskRunner pid=2914832)[0m [ground_truth] 18
[36m(TaskRunner pid=2914832)[0m [score] 1.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1312
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 40}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Tom's restaurant gets 6 reservations a night.  They normally order 2 meals that cost $5 each and a $5 bottle of wine.  How much do they make a week if they are open 2 days a week? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much Tom's restaurant makes in a week, we need to follow these steps:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. Calculate the number of meals ordered per night.
[36m(TaskRunner pid=2914832)[0m 2. Calculate the total revenue from meals ordered per night.
[36m(TaskRunner pid=2914832)[0m 3. Calculate the total revenue from wine ordered per night.
[36m(TaskRunner pid=2914832)[0m 4. Calculate the total revenue from meals and wine ordered per night.
[36m(TaskRunner pid=2914832)[0m 5. Calculate the total revenue for the week.
[36m(TaskRunner pid=2914832)[0m 6. Convert the weekly revenue into a daily revenue.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Let's start with the first step:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. The number of meals ordered per night is 6.
[36m(TaskRunner pid=2914832)[0m 2. The cost of each meal is $5, so the total revenue from meals ordered per night is:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    6 \text{ meals} \times 5 \text{ dollars/meal} = 30 \text{ dollars}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m 3. The cost of a bottle of wine is $5, so the total revenue from wine ordered per night is:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    6 \text{ meals} \times 5 \text{ dollars/meal} = 30 \text{ dollars}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m 4. The total revenue from meals and wine ordered per night is:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    30 \text{ dollars} + 30 \text{ dollars} = 60 \text{ dollars}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m 5. Since the restaurant is open 2 days a week, the total revenue for the week is:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    60 \text{ dollars/day} \times 2 \text{ days/week} = 120 \text{ dollars/week}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m 6. The cost of each reservation is $5, so the total revenue for the week is:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    120 \text{ dollars/week} \times 6 \text{ reservations/week} = 720 \text{ dollars/week}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Therefore, the final answer is:
[36m(TaskRunner pid=2914832)[0m #### 720
[36m(TaskRunner pid=2914832)[0m [ground_truth] 180
[36m(TaskRunner pid=2914832)[0m [score] 0.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1319
[36m(TaskRunner pid=2914832)[0m step:40 - global_seqlen/min:24829 - global_seqlen/max:26829 - global_seqlen/minmax_diff:2000 - global_seqlen/balanced_min:25713 - global_seqlen/balanced_max:25713 - global_seqlen/mean:25713.0 - actor/entropy:0.2248523086309433 - critic/vf_loss:0.1198808578774333 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6263721752911806 - critic/grad_norm:41.999069064855576 - perf/mfu/critic:0.09770732158813246 - critic/lr:1e-05 - actor/pg_loss:-0.16489481704775244 - actor/pg_clipfrac:0.0017466744320699945 - actor/ppo_kl:0.0004427568630944734 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.1378928422927856 - perf/mfu/actor:0.08150045861379251 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.15476608276367 - actor/lr:1e-06 - val-core/openai/gsm8k/reward/mean@1:0.489764973464746 - training/global_step:40 - training/epoch:1 - critic/score/mean:0.5234375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.5234375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-2.7343434183535464e-08 - critic/advantages/max:2.8208999633789062 - critic/advantages/min:-8.059303283691406 - critic/returns/mean:0.4503370523452759 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.609375 - critic/values/max:3.78125 - critic/values/min:-0.1728515625 - critic/vf_explained_var:0.1831466555595398 - response_length/mean:297.27734375 - response_length/max:512.0 - response_length/min:131.0 - response_length/clip_ratio:0.06640625 - prompt_length/mean:104.48828125 - prompt_length/max:194.0 - prompt_length/min:70.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:1.5458092093467712e-05 - timing_s/generate_sequences:3.5575389862060547 - timing_s/reshard:0.5818371772766113 - timing_s/gen:4.614593825768679 - timing_s/reward:0.034899733029305935 - timing_s/old_log_prob:2.089079823810607 - timing_s/values:1.3404800510033965 - timing_s/adv:0.033193779177963734 - timing_s/update_critic:5.669948719907552 - timing_s/update_actor:6.795145860873163 - timing_s/testing:13.79237935692072 - timing_s/step:34.376403119415045 - timing_s/stop_profile:3.4188851714134216e-06 - timing_per_token_ms/values:0.013033096595140556 - timing_per_token_ms/adv:0.0003227334342352481 - timing_per_token_ms/update_actor:0.06606722145289506 - timing_per_token_ms/update_critic:0.055127257806435966 - timing_per_token_ms/gen:0.06063616185654546 - perf/total_num_tokens:102852 - perf/time_per_step:34.376403119415045 - perf/throughput:747.9840142285816
[36m(TaskRunner pid=2914832)[0m Training Progress:   9%|▉         | 40/435 [14:55<2:44:45, 25.03s/it]
[36m(TaskRunner pid=2914832)[0m step:41 - global_seqlen/min:24829 - global_seqlen/max:26800 - global_seqlen/minmax_diff:1971 - global_seqlen/balanced_min:25906 - global_seqlen/balanced_max:25907 - global_seqlen/mean:25906.25 - actor/entropy:0.22356292605400085 - critic/vf_loss:0.10261858126614243 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.33395025692880154 - critic/grad_norm:26.00945782661438 - perf/mfu/critic:0.10477514253182492 - critic/lr:1e-05 - actor/pg_loss:-0.039225894201081246 - actor/pg_clipfrac:0.002259134933410678 - actor/ppo_kl:0.00044140558975414024 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.153332620859146 - perf/mfu/actor:0.07804793751454712 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.98658752441406 - actor/lr:1e-06 - training/global_step:41 - training/epoch:1 - critic/score/mean:0.51171875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.51171875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:1.002535476857247e-08 - critic/advantages/max:3.1878855228424072 - critic/advantages/min:-6.722177505493164 - critic/returns/mean:0.43537768721580505 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.462890625 - critic/values/max:2.953125 - critic/values/min:-0.361328125 - critic/vf_explained_var:0.22900569438934326 - response_length/mean:300.2421875 - response_length/max:512.0 - response_length/min:90.0 - response_length/clip_ratio:0.0703125 - prompt_length/mean:104.54296875 - prompt_length/max:175.0 - prompt_length/min:67.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:6.150919944047928e-06 - timing_s/generate_sequences:3.609658718109131 - timing_s/reshard:0.30145442485809326 - timing_s/gen:4.430542249698192 - timing_s/reward:0.03506444813683629 - timing_s/old_log_prob:2.0919012990780175 - timing_s/values:1.35197080578655 - timing_s/adv:0.0351853771135211 - timing_s/update_critic:5.329841787926853 - timing_s/update_actor:7.155501440633088 - timing_s/step:20.43836316699162 - timing_s/stop_profile:2.4922192096710205e-06 - timing_per_token_ms/values:0.013046762902644633 - timing_per_token_ms/adv:0.00033954525561902146 - timing_per_token_ms/update_actor:0.06905188362492727 - timing_per_token_ms/update_critic:0.05143393763982487 - timing_per_token_ms/gen:0.057642817643285264 - perf/total_num_tokens:103625 - perf/time_per_step:20.43836316699162 - perf/throughput:1267.53056437705
[36m(TaskRunner pid=2914832)[0m Training Progress:   9%|▉         | 41/435 [15:15<2:35:19, 23.65s/it]
[36m(TaskRunner pid=2914832)[0m step:42 - global_seqlen/min:24714 - global_seqlen/max:25892 - global_seqlen/minmax_diff:1178 - global_seqlen/balanced_min:25241 - global_seqlen/balanced_max:25241 - global_seqlen/mean:25241.0 - actor/entropy:0.24930833280086517 - critic/vf_loss:0.21083848271518946 - critic/vf_clipfrac:0.00016375545237679034 - critic/vpred_mean:0.8997093383222818 - critic/grad_norm:81.09029340744019 - perf/mfu/critic:0.10309414545842582 - critic/lr:1e-05 - actor/pg_loss:0.022541184909641743 - actor/pg_clipfrac:0.0017714320165396202 - actor/ppo_kl:-0.00010348616569899605 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.0529694855213165 - perf/mfu/actor:0.08010900285484142 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.04487991333008 - actor/lr:1e-06 - training/global_step:42 - training/epoch:1 - critic/score/mean:0.54296875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.54296875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-4.653259111364605e-08 - critic/advantages/max:4.31846809387207 - critic/advantages/min:-3.054896831512451 - critic/returns/mean:0.4839465022087097 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.87890625 - critic/values/max:1.90625 - critic/values/min:-0.609375 - critic/vf_explained_var:0.1376541256904602 - response_length/mean:290.2890625 - response_length/max:512.0 - response_length/min:90.0 - response_length/clip_ratio:0.046875 - prompt_length/mean:104.1015625 - prompt_length/max:212.0 - prompt_length/min:63.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.016328603029251e-06 - timing_s/generate_sequences:3.5795202255249023 - timing_s/reshard:0.9697518348693848 - timing_s/gen:5.20845883525908 - timing_s/reward:0.035529982298612595 - timing_s/old_log_prob:2.4214296378195286 - timing_s/values:1.3439945937134326 - timing_s/adv:0.03474262822419405 - timing_s/update_critic:5.272791760973632 - timing_s/update_actor:6.783069019205868 - timing_s/step:21.107757010962814 - timing_s/stop_profile:2.2868625819683075e-06 - timing_per_token_ms/values:0.013311621901999054 - timing_per_token_ms/adv:0.00034410907079943396 - timing_per_token_ms/update_actor:0.06718304563216461 - timing_per_token_ms/update_critic:0.05222447368342808 - timing_per_token_ms/gen:0.07008718189384341 - perf/total_num_tokens:100964 - perf/time_per_step:21.107757010962814 - perf/throughput:1195.8163052043137
[36m(TaskRunner pid=2914832)[0m Training Progress:  10%|▉         | 42/435 [15:36<2:29:56, 22.89s/it]
[36m(TaskRunner pid=2914832)[0m step:43 - global_seqlen/min:24435 - global_seqlen/max:25166 - global_seqlen/minmax_diff:731 - global_seqlen/balanced_min:24808 - global_seqlen/balanced_max:24809 - global_seqlen/mean:24808.5 - actor/entropy:0.2262413203716278 - critic/vf_loss:0.3397400127723813 - critic/vf_clipfrac:0.0 - critic/vpred_mean:-0.16164236818440259 - critic/grad_norm:170.24544143676758 - perf/mfu/critic:0.09990051060564847 - critic/lr:1e-05 - actor/pg_loss:0.019478709378745407 - actor/pg_clipfrac:0.002567543509940151 - actor/ppo_kl:-0.00023082274708485784 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.1092749536037445 - perf/mfu/actor:0.07446231915567059 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.13106155395508 - actor/lr:1e-06 - training/global_step:43 - training/epoch:1 - critic/score/mean:0.578125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.578125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:1.236460889231239e-07 - critic/advantages/max:3.6396400928497314 - critic/advantages/min:-2.9249684810638428 - critic/returns/mean:0.5172598958015442 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:-0.06103515625 - critic/values/max:0.99609375 - critic/values/min:-1.328125 - critic/vf_explained_var:0.0742805004119873 - response_length/mean:283.69140625 - response_length/max:512.0 - response_length/min:96.0 - response_length/clip_ratio:0.05078125 - prompt_length/mean:103.94140625 - prompt_length/max:232.0 - prompt_length/min:69.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.436355084180832e-06 - timing_s/generate_sequences:3.586479663848877 - timing_s/reshard:0.586295485496521 - timing_s/gen:4.997822513338178 - timing_s/reward:0.035158077254891396 - timing_s/old_log_prob:2.0771274748258293 - timing_s/values:1.3423494221642613 - timing_s/adv:0.03491863468661904 - timing_s/update_critic:5.347202728968114 - timing_s/update_actor:7.169520916417241 - timing_s/step:21.01173159573227 - timing_s/stop_profile:3.0677765607833862e-06 - timing_per_token_ms/values:0.013527111898787324 - timing_per_token_ms/adv:0.00035188176115665036 - timing_per_token_ms/update_actor:0.0722486336983014 - timing_per_token_ms/update_critic:0.05388478474079563 - timing_per_token_ms/gen:0.06881683323012983 - perf/total_num_tokens:99234 - perf/time_per_step:21.01173159573227 - perf/throughput:1180.697549222402
[36m(TaskRunner pid=2914832)[0m Training Progress:  10%|▉         | 43/435 [15:57<2:25:54, 22.33s/it]
[36m(TaskRunner pid=2914832)[0m step:44 - global_seqlen/min:24080 - global_seqlen/max:26101 - global_seqlen/minmax_diff:2021 - global_seqlen/balanced_min:25229 - global_seqlen/balanced_max:25230 - global_seqlen/mean:25229.75 - actor/entropy:0.22035612165927887 - critic/vf_loss:0.31905788264703006 - critic/vf_clipfrac:0.0920897867763415 - critic/vpred_mean:1.0539119001477957 - critic/grad_norm:141.579909324646 - perf/mfu/critic:0.10161565525425978 - critic/lr:1e-05 - actor/pg_loss:-0.01330531966232229 - actor/pg_clipfrac:0.002543659385992214 - actor/ppo_kl:0.00026701175738708116 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.9957438111305237 - perf/mfu/actor:0.07912739689825525 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:87.3101806640625 - actor/lr:1e-06 - training/global_step:44 - training/epoch:1 - critic/score/mean:0.5703125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.5703125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-3.613525478840529e-08 - critic/advantages/max:3.3642773628234863 - critic/advantages/min:-2.7089948654174805 - critic/returns/mean:0.5065249800682068 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.404296875 - critic/values/max:1.1875 - critic/values/min:-0.5859375 - critic/vf_explained_var:0.22118622064590454 - response_length/mean:291.546875 - response_length/max:512.0 - response_length/min:125.0 - response_length/clip_ratio:0.0625 - prompt_length/mean:102.66796875 - prompt_length/max:180.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.295725375413895e-06 - timing_s/generate_sequences:3.584519147872925 - timing_s/reshard:0.9659184813499451 - timing_s/gen:5.234087857883424 - timing_s/reward:0.03596833208575845 - timing_s/old_log_prob:2.0817712312564254 - timing_s/values:1.345533134881407 - timing_s/adv:0.03466812428086996 - timing_s/update_critic:5.347669099923223 - timing_s/update_actor:6.866931734606624 - timing_s/step:20.953877611085773 - timing_s/stop_profile:2.435874193906784e-06 - timing_per_token_ms/values:0.013332802890252649 - timing_per_token_ms/adv:0.00034352425490611244 - timing_per_token_ms/update_actor:0.06804399304993732 - timing_per_token_ms/update_critic:0.05298971551366168 - timing_per_token_ms/gen:0.07012819360474065 - perf/total_num_tokens:100919 - perf/time_per_step:20.953877611085773 - perf/throughput:1204.0611512712117
[36m(TaskRunner pid=2914832)[0m Training Progress:  10%|█         | 44/435 [16:18<2:22:51, 21.92s/it]
[36m(TaskRunner pid=2914832)[0m step:45 - global_seqlen/min:24300 - global_seqlen/max:25553 - global_seqlen/minmax_diff:1253 - global_seqlen/balanced_min:24833 - global_seqlen/balanced_max:24834 - global_seqlen/mean:24833.25 - actor/entropy:0.21743598580360413 - critic/vf_loss:0.2214477697852999 - critic/vf_clipfrac:0.12743609864264727 - critic/vpred_mean:0.5616730239707977 - critic/grad_norm:106.28693389892578 - perf/mfu/critic:0.09917836583222514 - critic/lr:1e-05 - actor/pg_loss:-0.3623708332888782 - actor/pg_clipfrac:0.002854082085832488 - actor/ppo_kl:2.5703423716549878e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.0624600648880005 - perf/mfu/actor:0.074629551422637 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.9658203125 - actor/lr:1e-06 - training/global_step:45 - training/epoch:1 - critic/score/mean:0.57421875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.57421875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:2.439053048419737e-08 - critic/advantages/max:2.4171364307403564 - critic/advantages/min:-2.4518465995788574 - critic/returns/mean:0.5364190340042114 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:1.1640625 - critic/values/max:1.8984375 - critic/values/min:0.28125 - critic/vf_explained_var:0.15319699048995972 - response_length/mean:285.84375 - response_length/max:512.0 - response_length/min:103.0 - response_length/clip_ratio:0.04296875 - prompt_length/mean:102.17578125 - prompt_length/max:172.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.366971552371979e-06 - timing_s/generate_sequences:3.604078769683838 - timing_s/reshard:0.5925858020782471 - timing_s/gen:4.927500460762531 - timing_s/reward:0.03558709006756544 - timing_s/old_log_prob:2.1217511580325663 - timing_s/values:1.6217534583993256 - timing_s/adv:0.03553655790165067 - timing_s/update_critic:5.390194667037576 - timing_s/update_actor:7.159636231139302 - timing_s/step:21.299958297982812 - timing_s/stop_profile:2.144835889339447e-06 - timing_per_token_ms/values:0.016326431884663966 - timing_per_token_ms/adv:0.0003577517834118638 - timing_per_token_ms/update_actor:0.07207711667964627 - timing_per_token_ms/update_critic:0.05426388679530042 - timing_per_token_ms/gen:0.06733765798571295 - perf/total_num_tokens:99333 - perf/time_per_step:21.299958297982812 - perf/throughput:1165.8825643030393
[36m(TaskRunner pid=2914832)[0m Training Progress:  10%|█         | 45/435 [16:40<2:21:17, 21.74s/it]
[36m(TaskRunner pid=2914832)[0m step:46 - global_seqlen/min:25366 - global_seqlen/max:26579 - global_seqlen/minmax_diff:1213 - global_seqlen/balanced_min:26046 - global_seqlen/balanced_max:26047 - global_seqlen/mean:26046.25 - actor/entropy:0.2396523505449295 - critic/vf_loss:0.14548902749083936 - critic/vf_clipfrac:0.1587335237127263 - critic/vpred_mean:0.28584273054730147 - critic/grad_norm:55.542240858078 - perf/mfu/critic:0.106605956768559 - critic/lr:1e-05 - actor/pg_loss:-0.09528524521738291 - actor/pg_clipfrac:0.0024477031220158096 - actor/ppo_kl:0.00012244602362443402 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.0401248037815094 - perf/mfu/actor:0.08275275231752972 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.74706268310547 - actor/lr:1e-06 - training/global_step:46 - training/epoch:1 - critic/score/mean:0.546875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.546875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-4.0635921294551736e-08 - critic/advantages/max:2.645012855529785 - critic/advantages/min:-2.4299874305725098 - critic/returns/mean:0.49810609221458435 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.01226806640625 - critic/values/max:0.859375 - critic/values/min:-0.84765625 - critic/vf_explained_var:0.15824896097183228 - response_length/mean:302.16015625 - response_length/max:512.0 - response_length/min:122.0 - response_length/clip_ratio:0.06640625 - prompt_length/mean:104.8125 - prompt_length/max:199.0 - prompt_length/min:67.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:1.2448988854885101e-05 - timing_s/generate_sequences:3.6162548065185547 - timing_s/reshard:0.5837007164955139 - timing_s/gen:4.845839473884553 - timing_s/reward:0.036333682015538216 - timing_s/old_log_prob:2.0926249506883323 - timing_s/values:1.3518525091931224 - timing_s/adv:0.0342211676761508 - timing_s/update_critic:5.2675988068804145 - timing_s/update_actor:6.781618408858776 - timing_s/step:20.422153741121292 - timing_s/stop_profile:2.1243467926979065e-06 - timing_per_token_ms/values:0.012975500400183543 - timing_per_token_ms/adv:0.00032846539978068626 - timing_per_token_ms/update_actor:0.06509208051887293 - timing_per_token_ms/update_critic:0.05056004997725598 - timing_per_token_ms/gen:0.06264578586330916 - perf/total_num_tokens:104185 - perf/time_per_step:20.422153741121292 - perf/throughput:1275.3919263448809
[36m(TaskRunner pid=2914832)[0m Training Progress:  11%|█         | 46/435 [17:00<2:18:24, 21.35s/it]
[36m(TaskRunner pid=2914832)[0m step:47 - global_seqlen/min:24255 - global_seqlen/max:25537 - global_seqlen/minmax_diff:1282 - global_seqlen/balanced_min:24672 - global_seqlen/balanced_max:24672 - global_seqlen/mean:24672.0 - actor/entropy:0.23805886507034302 - critic/vf_loss:0.1077958857640624 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.5805233344435692 - critic/grad_norm:16.066683292388916 - perf/mfu/critic:0.09999296046576024 - critic/lr:1e-05 - actor/pg_loss:-0.2823498686775565 - actor/pg_clipfrac:0.002028328337473795 - actor/ppo_kl:0.0003767766938835848 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.1688027381896973 - perf/mfu/actor:0.07412923686397724 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.13837432861328 - actor/lr:1e-06 - training/global_step:47 - training/epoch:1 - critic/score/mean:0.60546875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.60546875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-2.1222164026113433e-09 - critic/advantages/max:3.211341381072998 - critic/advantages/min:-2.348675489425659 - critic/returns/mean:0.5623154044151306 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.5234375 - critic/values/max:1.7890625 - critic/values/min:-0.53125 - critic/vf_explained_var:0.12114149332046509 - response_length/mean:284.37109375 - response_length/max:512.0 - response_length/min:113.0 - response_length/clip_ratio:0.03515625 - prompt_length/mean:101.12890625 - prompt_length/max:170.0 - prompt_length/min:64.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.976056516170502e-06 - timing_s/generate_sequences:3.5504801273345947 - timing_s/reshard:0.8518960475921631 - timing_s/gen:4.97521616704762 - timing_s/reward:0.03789101913571358 - timing_s/old_log_prob:2.460630079265684 - timing_s/values:1.745396370999515 - timing_s/adv:0.03484061732888222 - timing_s/update_critic:5.311458506155759 - timing_s/update_actor:7.1581506775692105 - timing_s/step:21.73138853814453 - timing_s/stop_profile:2.1047890186309814e-06 - timing_per_token_ms/values:0.01768600408357161 - timing_per_token_ms/adv:0.0003530380322722339 - timing_per_token_ms/update_actor:0.07253314159339748 - timing_per_token_ms/update_critic:0.05382071281367298 - timing_per_token_ms/gen:0.06834182017675544 - perf/total_num_tokens:98688 - perf/time_per_step:21.73138853814453 - perf/throughput:1135.3163170726018
[36m(TaskRunner pid=2914832)[0m Training Progress:  11%|█         | 47/435 [17:22<2:18:50, 21.47s/it]
[36m(TaskRunner pid=2914832)[0m step:48 - global_seqlen/min:25342 - global_seqlen/max:28528 - global_seqlen/minmax_diff:3186 - global_seqlen/balanced_min:27184 - global_seqlen/balanced_max:27184 - global_seqlen/mean:27184.0 - actor/entropy:0.2395341545343399 - critic/vf_loss:0.12699143588542938 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.3884938941337168 - critic/grad_norm:30.4816712141037 - perf/mfu/critic:0.10616333022922296 - critic/lr:1e-05 - actor/pg_loss:-0.034739380702376366 - actor/pg_clipfrac:0.0024104813746816944 - actor/ppo_kl:-8.333721763165158e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.0238016545772552 - perf/mfu/actor:0.08507795698449819 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.98696517944336 - actor/lr:1e-06 - training/global_step:48 - training/epoch:1 - critic/score/mean:0.51953125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.51953125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:1.3920979036186054e-08 - critic/advantages/max:2.6465578079223633 - critic/advantages/min:-3.110814332962036 - critic/returns/mean:0.477744460105896 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.5234375 - critic/values/max:2.46875 - critic/values/min:-0.271484375 - critic/vf_explained_var:0.16004538536071777 - response_length/mean:320.3203125 - response_length/max:512.0 - response_length/min:128.0 - response_length/clip_ratio:0.1171875 - prompt_length/mean:104.4296875 - prompt_length/max:238.0 - prompt_length/min:70.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.821682184934616e-06 - timing_s/generate_sequences:3.594679355621338 - timing_s/reshard:0.584274411201477 - timing_s/gen:4.7129310220479965 - timing_s/reward:0.03615023475140333 - timing_s/old_log_prob:2.0788331353105605 - timing_s/values:1.4383153510279953 - timing_s/adv:0.0332776065915823 - timing_s/update_critic:5.526637425180525 - timing_s/update_actor:6.893699647858739 - timing_s/step:20.727398671209812 - timing_s/stop_profile:4.738103598356247e-06 - timing_per_token_ms/values:0.01322759114762356 - timing_per_token_ms/adv:0.000306040378454075 - timing_per_token_ms/update_actor:0.06339850323589923 - timing_per_token_ms/update_critic:0.050826197627101645 - timing_per_token_ms/gen:0.057473366772127464 - perf/total_num_tokens:108736 - perf/time_per_step:20.727398671209812 - perf/throughput:1311.500802932804
[36m(TaskRunner pid=2914832)[0m Training Progress:  11%|█         | 48/435 [17:43<2:17:03, 21.25s/it]
[36m(TaskRunner pid=2914832)[0m step:49 - global_seqlen/min:25202 - global_seqlen/max:27115 - global_seqlen/minmax_diff:1913 - global_seqlen/balanced_min:26300 - global_seqlen/balanced_max:26301 - global_seqlen/mean:26300.75 - actor/entropy:0.22509410977363586 - critic/vf_loss:0.12011989625170827 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6298611741513014 - critic/grad_norm:38.03230118751526 - perf/mfu/critic:0.10728846338634397 - critic/lr:1e-05 - actor/pg_loss:-0.045966231264173985 - actor/pg_clipfrac:0.0024352777618332766 - actor/ppo_kl:-0.00010721244871092495 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.066831886768341 - perf/mfu/actor:0.07890425349761773 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.21021270751953 - actor/lr:1e-06 - training/global_step:49 - training/epoch:1 - critic/score/mean:0.59375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.59375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-3.960278505132919e-08 - critic/advantages/max:2.3485803604125977 - critic/advantages/min:-6.947669982910156 - critic/returns/mean:0.5440711975097656 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.6796875 - critic/values/max:3.296875 - critic/values/min:-0.73046875 - critic/vf_explained_var:0.16634976863861084 - response_length/mean:307.78515625 - response_length/max:512.0 - response_length/min:121.0 - response_length/clip_ratio:0.078125 - prompt_length/mean:103.1640625 - prompt_length/max:196.0 - prompt_length/min:65.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.756054401397705e-06 - timing_s/generate_sequences:3.560509443283081 - timing_s/reshard:0.7859349250793457 - timing_s/gen:5.219101618975401 - timing_s/reward:0.03552459366619587 - timing_s/old_log_prob:2.1280718282796443 - timing_s/values:1.6331613040529191 - timing_s/adv:0.03815145790576935 - timing_s/update_critic:5.289707015734166 - timing_s/update_actor:7.185137927997857 - timing_s/step:21.53671332076192 - timing_s/stop_profile:1.623295247554779e-06 - timing_per_token_ms/values:0.015523904299810074 - timing_per_token_ms/adv:0.00036264610235230317 - timing_per_token_ms/update_actor:0.06829784253298725 - timing_per_token_ms/update_critic:0.05028095221366469 - timing_per_token_ms/gen:0.06623813814647748 - perf/total_num_tokens:105203 - perf/time_per_step:21.53671332076192 - perf/throughput:1221.2053718821355
[36m(TaskRunner pid=2914832)[0m Training Progress:  11%|█▏        | 49/435 [18:04<2:17:17, 21.34s/it]
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 50}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and bakes muffins for her friends every day with four. She sells the remainder at the farmers' market daily for $2 per fresh duck egg. How much in dollars does she make every day at the farmers' market? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much money Janet makes every day at the farmers' market, we need to follow these steps:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. Calculate the total number of eggs laid by the ducks in a day.
[36m(TaskRunner pid=2914832)[0m 2. Determine the number of eggs Janet sells at the farmers' market.
[36m(TaskRunner pid=2914832)[0m 3. Calculate the total revenue from selling the eggs.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m First, we know that Janet's ducks lay 16 eggs per day. She eats 3 eggs for breakfast and bakes 4 muffins for her friends, so the number of eggs she eats in a day is:
[36m(TaskRunner pid=2914832)[0m \[ 3 + 4 = 7 \text{ eggs} \]
[36m(TaskRunner pid=2914832)[0m Therefore, the number of eggs she sells at the farmers' market is:
[36m(TaskRunner pid=2914832)[0m \[ 16 - 7 = 9 \text{ eggs} \]
[36m(TaskRunner pid=2914832)[0m Since she sells each egg for $2, the total revenue is:
[36m(TaskRunner pid=2914832)[0m \[ 9 \times 2 = 18 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m #### 18
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [ground_truth] 18
[36m(TaskRunner pid=2914832)[0m [score] 1.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1312
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 50}
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Tom's restaurant gets 6 reservations a night.  They normally order 2 meals that cost $5 each and a $5 bottle of wine.  How much do they make a week if they are open 2 days a week? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much Tom's restaurant makes in a week, we need to follow these steps:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. Calculate the number of meals ordered per night.
[36m(TaskRunner pid=2914832)[0m 2. Calculate the total revenue from meals ordered per night.
[36m(TaskRunner pid=2914832)[0m 3. Calculate the total revenue from wine ordered per night.
[36m(TaskRunner pid=2914832)[0m 4. Calculate the total revenue from meals and wine ordered per night.
[36m(TaskRunner pid=2914832)[0m 5. Calculate the total revenue for the week by multiplying the revenue per night by the number of nights the restaurant is open in a week.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Let's start with the calculations:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. The number of meals ordered per night is the sum of the number of meals ordered for each type of meal:
[36m(TaskRunner pid=2914832)[0m    - 2 meals that cost $5 each
[36m(TaskRunner pid=2914832)[0m    - 1 bottle of wine that costs $5
[36m(TaskRunner pid=2914832)[0m    - Total meals per night = 2 + 1 = 3 meals
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 2. The total revenue from meals ordered per night is:
[36m(TaskRunner pid=2914832)[0m    - Revenue from meals = 3 meals * $5 per meal = $15
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 3. The total revenue from wine ordered per night is:
[36m(TaskRunner pid=2914832)[0m    - Revenue from wine = 1 bottle * $5 = $5
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 4. The total revenue from meals and wine ordered per night is:
[36m(TaskRunner pid=2914832)[0m    - Total revenue per night = Revenue from meals + Revenue from wine = $15 + $5 = $20
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 5. The total revenue for the week is:
[36m(TaskRunner pid=2914832)[0m    - Total revenue per week = Total revenue per night * Number of nights the restaurant is open in a week = $20 * 2 = $40
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Therefore, the final answer is:
[36m(TaskRunner pid=2914832)[0m #### 40
[36m(TaskRunner pid=2914832)[0m [ground_truth] 180
[36m(TaskRunner pid=2914832)[0m [score] 0.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1319
[36m(TaskRunner pid=2914832)[0m step:50 - global_seqlen/min:26337 - global_seqlen/max:27204 - global_seqlen/minmax_diff:867 - global_seqlen/balanced_min:26730 - global_seqlen/balanced_max:26731 - global_seqlen/mean:26730.5 - actor/entropy:0.24262084066867828 - critic/vf_loss:0.11423608055338264 - critic/vf_clipfrac:0.014235961250960827 - critic/vpred_mean:0.5313285486772656 - critic/grad_norm:43.836719036102295 - perf/mfu/critic:0.10492419078410457 - critic/lr:1e-05 - actor/pg_loss:-0.04952721113295411 - actor/pg_clipfrac:0.002433943998767063 - actor/ppo_kl:2.9312111792023643e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.018945276737213 - perf/mfu/actor:0.08490663854006358 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:87.2720718383789 - actor/lr:1e-06 - val-core/openai/gsm8k/reward/mean@1:0.49583017437452614 - training/global_step:50 - training/epoch:1 - critic/score/mean:0.58984375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.58984375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-3.487366839749484e-08 - critic/advantages/max:3.7094573974609375 - critic/advantages/min:-3.429609775543213 - critic/returns/mean:0.5236786007881165 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.3046875 - critic/values/max:1.421875 - critic/values/min:-0.83984375 - critic/vf_explained_var:0.2337985634803772 - response_length/mean:315.33984375 - response_length/max:512.0 - response_length/min:135.0 - response_length/clip_ratio:0.0859375 - prompt_length/mean:102.32421875 - prompt_length/max:182.0 - prompt_length/min:67.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.0978193283081055e-06 - timing_s/generate_sequences:3.6144397258758545 - timing_s/reshard:0.5884696841239929 - timing_s/gen:4.754720379598439 - timing_s/reward:0.03581755980849266 - timing_s/old_log_prob:2.0771598890423775 - timing_s/values:1.415294730104506 - timing_s/adv:0.03263056883588433 - timing_s/update_critic:5.498618199955672 - timing_s/update_actor:6.787368144840002 - timing_s/testing:14.037880095187575 - timing_s/step:34.64687156211585 - timing_s/stop_profile:3.10409814119339e-06 - timing_per_token_ms/values:0.01323670273755173 - timing_per_token_ms/adv:0.00030518105568437114 - timing_per_token_ms/update_actor:0.06347962201268216 - timing_per_token_ms/update_critic:0.05142644357527611 - timing_per_token_ms/gen:0.05889876224309635 - perf/total_num_tokens:106922 - perf/time_per_step:34.64687156211585 - perf/throughput:771.5126588580108
[36m(TaskRunner pid=2914832)[0m Training Progress:  11%|█▏        | 50/435 [18:39<2:42:34, 25.34s/it]
[36m(TaskRunner pid=2914832)[0m step:51 - global_seqlen/min:24669 - global_seqlen/max:26155 - global_seqlen/minmax_diff:1486 - global_seqlen/balanced_min:25502 - global_seqlen/balanced_max:25503 - global_seqlen/mean:25502.75 - actor/entropy:0.21597564220428467 - critic/vf_loss:0.11426000599749386 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.4276475729420781 - critic/grad_norm:37.03020763397217 - perf/mfu/critic:0.09393166311558437 - critic/lr:1e-05 - actor/pg_loss:-0.045085834339261055 - actor/pg_clipfrac:0.0022471812553703785 - actor/ppo_kl:-0.00012762533684451682 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.0628571808338165 - perf/mfu/actor:0.08040532712805255 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.07244110107422 - actor/lr:1e-06 - training/global_step:51 - training/epoch:1 - critic/score/mean:0.5703125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.5703125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-8.620427927041874e-09 - critic/advantages/max:2.9343607425689697 - critic/advantages/min:-3.029245138168335 - critic/returns/mean:0.5168343186378479 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.65234375 - critic/values/max:1.46875 - critic/values/min:-0.240234375 - critic/vf_explained_var:0.2617950439453125 - response_length/mean:295.15625 - response_length/max:512.0 - response_length/min:121.0 - response_length/clip_ratio:0.07421875 - prompt_length/mean:103.32421875 - prompt_length/max:190.0 - prompt_length/min:65.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.429144948720932e-06 - timing_s/generate_sequences:3.6114094257354736 - timing_s/reshard:0.30073291063308716 - timing_s/gen:4.684002097696066 - timing_s/reward:0.035494389943778515 - timing_s/old_log_prob:2.080336444079876 - timing_s/values:1.3455278710462153 - timing_s/adv:0.03465413488447666 - timing_s/update_critic:5.848998229019344 - timing_s/update_actor:6.834509658161551 - timing_s/step:20.872634433209896 - timing_s/stop_profile:3.2400712370872498e-06 - timing_per_token_ms/values:0.01319002726221893 - timing_per_token_ms/adv:0.0003397097850670679 - timing_per_token_ms/update_actor:0.06699777139878592 - timing_per_token_ms/update_critic:0.057336936497234064 - timing_per_token_ms/gen:0.0619904989107473 - perf/total_num_tokens:102011 - perf/time_per_step:20.872634433209896 - perf/throughput:1221.8270808893797
[36m(TaskRunner pid=2914832)[0m Training Progress:  12%|█▏        | 51/435 [19:00<2:33:35, 24.00s/it]
[36m(TaskRunner pid=2914832)[0m step:52 - global_seqlen/min:25502 - global_seqlen/max:28017 - global_seqlen/minmax_diff:2515 - global_seqlen/balanced_min:27021 - global_seqlen/balanced_max:27022 - global_seqlen/mean:27021.25 - actor/entropy:0.2531993091106415 - critic/vf_loss:0.1373409281950444 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6251655882224441 - critic/grad_norm:37.42879581451416 - perf/mfu/critic:0.10185205471885732 - critic/lr:1e-05 - actor/pg_loss:0.10133719828445464 - actor/pg_clipfrac:0.002535633411753224 - actor/ppo_kl:-9.34211852268163e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.9729096591472626 - perf/mfu/actor:0.08383916814303631 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.7599983215332 - actor/lr:1e-06 - training/global_step:52 - training/epoch:1 - critic/score/mean:0.57421875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.57421875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-4.132604480844293e-09 - critic/advantages/max:4.609615325927734 - critic/advantages/min:-3.0416946411132812 - critic/returns/mean:0.5359888076782227 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.6875 - critic/values/max:2.09375 - critic/values/min:-0.8828125 - critic/vf_explained_var:0.21770769357681274 - response_length/mean:319.109375 - response_length/max:512.0 - response_length/min:114.0 - response_length/clip_ratio:0.07421875 - prompt_length/mean:103.09765625 - prompt_length/max:165.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.6819837987422943e-06 - timing_s/generate_sequences:3.5517354011535645 - timing_s/reshard:0.6882270574569702 - timing_s/gen:5.12238014023751 - timing_s/reward:0.03741013677790761 - timing_s/old_log_prob:2.1258002799004316 - timing_s/values:1.6128151239827275 - timing_s/adv:0.034006398636847734 - timing_s/update_critic:5.724469288717955 - timing_s/update_actor:6.9520785147324204 - timing_s/step:21.616272701881826 - timing_s/stop_profile:2.007000148296356e-06 - timing_per_token_ms/values:0.014921729416503007 - timing_per_token_ms/adv:0.00031462643879213336 - timing_per_token_ms/update_actor:0.06432047476275543 - timing_per_token_ms/update_critic:0.05296266168957724 - timing_per_token_ms/gen:0.06270357122163138 - perf/total_num_tokens:108085 - perf/time_per_step:21.616272701881826 - perf/throughput:1250.0420573269155
[36m(TaskRunner pid=2914832)[0m Training Progress:  12%|█▏        | 52/435 [19:21<2:28:39, 23.29s/it]
[36m(TaskRunner pid=2914832)[0m step:53 - global_seqlen/min:24592 - global_seqlen/max:27865 - global_seqlen/minmax_diff:3273 - global_seqlen/balanced_min:26523 - global_seqlen/balanced_max:26524 - global_seqlen/mean:26523.75 - actor/entropy:0.28123733401298523 - critic/vf_loss:0.09317443589679897 - critic/vf_clipfrac:0.0001226692838827148 - critic/vpred_mean:0.5203474685549736 - critic/grad_norm:30.89076066017151 - perf/mfu/critic:0.10444449249185934 - critic/lr:1e-05 - actor/pg_loss:0.003469101488008164 - actor/pg_clipfrac:0.002258644854009617 - actor/ppo_kl:0.00021639429542119615 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.0532169342041016 - perf/mfu/actor:0.08352751629193522 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.8577651977539 - actor/lr:1e-06 - training/global_step:53 - training/epoch:1 - critic/score/mean:0.58203125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.58203125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:9.004043732829814e-09 - critic/advantages/max:3.0089993476867676 - critic/advantages/min:-2.7202043533325195 - critic/returns/mean:0.5367801189422607 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.294921875 - critic/values/max:1.296875 - critic/values/min:-1.0703125 - critic/vf_explained_var:0.2697274088859558 - response_length/mean:311.12890625 - response_length/max:512.0 - response_length/min:127.0 - response_length/clip_ratio:0.109375 - prompt_length/mean:103.3046875 - prompt_length/max:216.0 - prompt_length/min:63.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.7266872823238373e-06 - timing_s/generate_sequences:3.5676894187927246 - timing_s/reshard:0.8891196250915527 - timing_s/gen:4.911500067915767 - timing_s/reward:0.036665590945631266 - timing_s/old_log_prob:2.0729785482399166 - timing_s/values:1.3511324389837682 - timing_s/adv:0.03421007003635168 - timing_s/update_critic:5.479141409974545 - timing_s/update_actor:6.847667309921235 - timing_s/step:20.740829193033278 - timing_s/stop_profile:1.7210841178894043e-06 - timing_per_token_ms/values:0.012735118893291562 - timing_per_token_ms/adv:0.00032244752378860153 - timing_per_token_ms/update_actor:0.0645427900459139 - timing_per_token_ms/update_critic:0.0516437288276973 - timing_per_token_ms/gen:0.061664302978264224 - perf/total_num_tokens:106095 - perf/time_per_step:20.740829193033278 - perf/throughput:1278.8182069841823
[36m(TaskRunner pid=2914832)[0m Training Progress:  12%|█▏        | 53/435 [19:42<2:23:24, 22.53s/it]
[36m(TaskRunner pid=2914832)[0m step:54 - global_seqlen/min:25553 - global_seqlen/max:26951 - global_seqlen/minmax_diff:1398 - global_seqlen/balanced_min:26202 - global_seqlen/balanced_max:26203 - global_seqlen/mean:26202.75 - actor/entropy:0.25590401887893677 - critic/vf_loss:0.10448386368807405 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.5757542587816715 - critic/grad_norm:13.987370729446411 - perf/mfu/critic:0.10273689175227986 - critic/lr:1e-05 - actor/pg_loss:0.16712220840418013 - actor/pg_clipfrac:0.0024812360425130464 - actor/ppo_kl:0.000208352251775068 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.1953125298023224 - perf/mfu/actor:0.07932690699565755 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:87.29954528808594 - actor/lr:1e-06 - training/global_step:54 - training/epoch:1 - critic/score/mean:0.62109375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.62109375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:1.7309717548208425e-10 - critic/advantages/max:2.658574104309082 - critic/advantages/min:-2.643310546875 - critic/returns/mean:0.5757737755775452 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.59375 - critic/values/max:1.359375 - critic/values/min:-0.37109375 - critic/vf_explained_var:0.2505110502243042 - response_length/mean:306.6796875 - response_length/max:512.0 - response_length/min:99.0 - response_length/clip_ratio:0.09765625 - prompt_length/mean:102.73828125 - prompt_length/max:167.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.87128272652626e-06 - timing_s/generate_sequences:3.5514276027679443 - timing_s/reshard:0.5852829217910767 - timing_s/gen:5.0255791479721665 - timing_s/reward:0.0367516172118485 - timing_s/old_log_prob:2.142731251195073 - timing_s/values:1.6313671777024865 - timing_s/adv:0.033774449955672026 - timing_s/update_critic:5.5005439119413495 - timing_s/update_actor:7.1187176099047065 - timing_s/step:21.496321180369705 - timing_s/stop_profile:2.1350570023059845e-06 - timing_per_token_ms/values:0.015564846988412347 - timing_per_token_ms/adv:0.0003222414627822655 - timing_per_token_ms/update_actor:0.06791956578894111 - timing_per_token_ms/update_critic:0.05248059757030607 - timing_per_token_ms/gen:0.06401196214459516 - perf/total_num_tokens:104811 - perf/time_per_step:21.496321180369705 - perf/throughput:1218.9411285838144
[36m(TaskRunner pid=2914832)[0m Training Progress:  12%|█▏        | 54/435 [20:04<2:21:06, 22.22s/it]
[36m(TaskRunner pid=2914832)[0m step:55 - global_seqlen/min:24739 - global_seqlen/max:27205 - global_seqlen/minmax_diff:2466 - global_seqlen/balanced_min:26138 - global_seqlen/balanced_max:26139 - global_seqlen/mean:26138.5 - actor/entropy:0.29783177375793457 - critic/vf_loss:0.10667050303891301 - critic/vf_clipfrac:0.038280988577753305 - critic/vpred_mean:0.6272887624800205 - critic/grad_norm:45.14613962173462 - perf/mfu/critic:0.10813217971577385 - critic/lr:1e-05 - actor/pg_loss:-0.11048769135959446 - actor/pg_clipfrac:0.002001002707402222 - actor/ppo_kl:-8.397612054977799e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.3092034459114075 - perf/mfu/actor:0.08283498109874614 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.720947265625 - actor/lr:1e-06 - training/global_step:55 - training/epoch:1 - critic/score/mean:0.58203125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.58203125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:2.5650651380715317e-08 - critic/advantages/max:2.2966055870056152 - critic/advantages/min:-2.7874276638031006 - critic/returns/mean:0.5342628359794617 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.77734375 - critic/values/max:1.75 - critic/values/min:-0.1884765625 - critic/vf_explained_var:0.1839430332183838 - response_length/mean:306.51171875 - response_length/max:512.0 - response_length/min:78.0 - response_length/clip_ratio:0.109375 - prompt_length/mean:101.90234375 - prompt_length/max:190.0 - prompt_length/min:62.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.051027983427048e-06 - timing_s/generate_sequences:3.6420373916625977 - timing_s/reshard:0.5849483609199524 - timing_s/gen:4.953667310066521 - timing_s/reward:0.04408247396349907 - timing_s/old_log_prob:2.0846824352629483 - timing_s/values:1.4153905240818858 - timing_s/adv:0.037584700621664524 - timing_s/update_critic:5.212942500133067 - timing_s/update_actor:6.802369685377926 - timing_s/step:20.557624666020274 - timing_s/stop_profile:2.027023583650589e-06 - timing_per_token_ms/values:0.01353741152018943 - timing_per_token_ms/adv:0.00035947644874098096 - timing_per_token_ms/update_actor:0.06506082680125032 - timing_per_token_ms/update_critic:0.04985885284286653 - timing_per_token_ms/gen:0.06313058113686672 - perf/total_num_tokens:104554 - perf/time_per_step:20.557624666020274 - perf/throughput:1271.4747167849778
[36m(TaskRunner pid=2914832)[0m Training Progress:  13%|█▎        | 55/435 [20:24<2:17:36, 21.73s/it]
[36m(TaskRunner pid=2914832)[0m step:56 - global_seqlen/min:25399 - global_seqlen/max:27726 - global_seqlen/minmax_diff:2327 - global_seqlen/balanced_min:26809 - global_seqlen/balanced_max:26809 - global_seqlen/mean:26809.0 - actor/entropy:0.30255070328712463 - critic/vf_loss:0.12225249921903014 - critic/vf_clipfrac:0.11291594058275223 - critic/vpred_mean:0.4979563785600476 - critic/grad_norm:49.3432514667511 - perf/mfu/critic:0.10695267513194565 - critic/lr:1e-05 - actor/pg_loss:-0.1624753016512841 - actor/pg_clipfrac:0.0023924751367303543 - actor/ppo_kl:-4.07546290261962e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.1010654270648956 - perf/mfu/actor:0.08076501366791948 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.20392990112305 - actor/lr:1e-06 - training/global_step:56 - training/epoch:1 - critic/score/mean:0.55859375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.55859375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:2.127992226874653e-09 - critic/advantages/max:3.2272140979766846 - critic/advantages/min:-2.816070795059204 - critic/returns/mean:0.5174258947372437 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.2373046875 - critic/values/max:0.93359375 - critic/values/min:-0.6640625 - critic/vf_explained_var:0.284360408782959 - response_length/mean:312.484375 - response_length/max:512.0 - response_length/min:105.0 - response_length/clip_ratio:0.09765625 - prompt_length/mean:106.40625 - prompt_length/max:215.0 - prompt_length/min:67.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.843102604150772e-06 - timing_s/generate_sequences:3.5727345943450928 - timing_s/reshard:0.9890496730804443 - timing_s/gen:5.345631598960608 - timing_s/reward:0.03704624390229583 - timing_s/old_log_prob:2.120726388413459 - timing_s/values:1.6169323488138616 - timing_s/adv:0.03332589194178581 - timing_s/update_critic:5.409839060623199 - timing_s/update_actor:7.159042993560433 - timing_s/step:21.729880978818983 - timing_s/stop_profile:1.7099082469940186e-06 - timing_per_token_ms/values:0.015078260554420731 - timing_per_token_ms/adv:0.00031077149410445944 - timing_per_token_ms/update_actor:0.06675969817561671 - timing_per_token_ms/update_critic:0.050447975126106895 - timing_per_token_ms/gen:0.06682373617381629 - perf/total_num_tokens:107236 - perf/time_per_step:21.729880978818983 - perf/throughput:1233.7389250374563
[36m(TaskRunner pid=2914832)[0m Training Progress:  13%|█▎        | 56/435 [20:46<2:17:15, 21.73s/it]
[36m(TaskRunner pid=2914832)[0m step:57 - global_seqlen/min:24148 - global_seqlen/max:27332 - global_seqlen/minmax_diff:3184 - global_seqlen/balanced_min:25654 - global_seqlen/balanced_max:25655 - global_seqlen/mean:25654.75 - actor/entropy:0.21915456652641296 - critic/vf_loss:0.1877654711715877 - critic/vf_clipfrac:0.09608731511980295 - critic/vpred_mean:0.8354882672429085 - critic/grad_norm:71.89604568481445 - perf/mfu/critic:0.0997852499981098 - critic/lr:1e-05 - actor/pg_loss:0.24616684025386348 - actor/pg_clipfrac:0.0020687785508926027 - actor/ppo_kl:0.00015666645413148217 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.0695424675941467 - perf/mfu/actor:0.08134676362197904 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:87.12176513671875 - actor/lr:1e-06 - training/global_step:57 - training/epoch:1 - critic/score/mean:0.6015625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.6015625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:5.303777683707267e-08 - critic/advantages/max:3.031036615371704 - critic/advantages/min:-2.2519147396087646 - critic/returns/mean:0.5438559651374817 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:1.0 - critic/values/max:1.609375 - critic/values/min:0.10546875 - critic/vf_explained_var:0.19870537519454956 - response_length/mean:296.3359375 - response_length/max:512.0 - response_length/min:120.0 - response_length/clip_ratio:0.05859375 - prompt_length/mean:104.51953125 - prompt_length/max:191.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.173722118139267e-06 - timing_s/generate_sequences:3.547248601913452 - timing_s/reshard:0.5878795385360718 - timing_s/gen:4.648621493019164 - timing_s/reward:0.035743759013712406 - timing_s/old_log_prob:2.074841055087745 - timing_s/values:1.4486247282475233 - timing_s/adv:0.033281594049185514 - timing_s/update_critic:5.540763512719423 - timing_s/update_actor:6.79444148298353 - timing_s/step:20.583333142101765 - timing_s/stop_profile:5.114823579788208e-06 - timing_per_token_ms/values:0.014116535224934206 - timing_per_token_ms/adv:0.00032432194865654034 - timing_per_token_ms/update_actor:0.06621036536102992 - timing_per_token_ms/update_critic:0.053993544204478924 - timing_per_token_ms/gen:0.06127733902374263 - perf/total_num_tokens:102619 - perf/time_per_step:20.583333142101765 - perf/throughput:1246.3846269642795
[36m(TaskRunner pid=2914832)[0m Training Progress:  13%|█▎        | 57/435 [21:06<2:14:45, 21.39s/it]
[36m(TaskRunner pid=2914832)[0m step:58 - global_seqlen/min:24223 - global_seqlen/max:25726 - global_seqlen/minmax_diff:1503 - global_seqlen/balanced_min:25125 - global_seqlen/balanced_max:25126 - global_seqlen/mean:25125.5 - actor/entropy:0.23217950761318207 - critic/vf_loss:0.10651113209314644 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.5171601120382547 - critic/grad_norm:28.78825980424881 - perf/mfu/critic:0.09899472423159703 - critic/lr:1e-05 - actor/pg_loss:-0.05996477184817195 - actor/pg_clipfrac:0.0015757552027935162 - actor/ppo_kl:-0.0001971276834069613 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.206697106361389 - perf/mfu/actor:0.07572928428954577 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:87.86800384521484 - actor/lr:1e-06 - training/global_step:58 - training/epoch:1 - critic/score/mean:0.60546875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.60546875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:4.8659764217973134e-08 - critic/advantages/max:2.6560420989990234 - critic/advantages/min:-2.520534038543701 - critic/returns/mean:0.5440734624862671 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.345703125 - critic/values/max:1.046875 - critic/values/min:-0.44921875 - critic/vf_explained_var:0.23711758852005005 - response_length/mean:287.20703125 - response_length/max:512.0 - response_length/min:116.0 - response_length/clip_ratio:0.0703125 - prompt_length/mean:105.37890625 - prompt_length/max:222.0 - prompt_length/min:64.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.474314093589783e-06 - timing_s/generate_sequences:3.6248011589050293 - timing_s/reshard:0.8988754749298096 - timing_s/gen:5.3321556113660336 - timing_s/reward:0.035273747984319925 - timing_s/old_log_prob:2.125447934959084 - timing_s/values:1.6164889559149742 - timing_s/adv:0.03743912512436509 - timing_s/update_critic:5.466316883917898 - timing_s/update_actor:7.140629684086889 - timing_s/step:21.760717957746238 - timing_s/stop_profile:1.9739381968975067e-06 - timing_per_token_ms/values:0.01608414714050441 - timing_per_token_ms/adv:0.0003725211948455264 - timing_per_token_ms/update_actor:0.07104962770976586 - timing_per_token_ms/update_critic:0.054390130384648044 - timing_per_token_ms/gen:0.07252166761463494 - perf/total_num_tokens:100502 - perf/time_per_step:21.760717957746238 - perf/throughput:1154.6264258737838
[36m(TaskRunner pid=2914832)[0m Training Progress:  13%|█▎        | 58/435 [21:28<2:15:06, 21.50s/it]
[36m(TaskRunner pid=2914832)[0m step:59 - global_seqlen/min:24986 - global_seqlen/max:26707 - global_seqlen/minmax_diff:1721 - global_seqlen/balanced_min:25746 - global_seqlen/balanced_max:25747 - global_seqlen/mean:25746.5 - actor/entropy:0.2350570112466812 - critic/vf_loss:0.10924567270558327 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.47409259248524904 - critic/grad_norm:30.8164484500885 - perf/mfu/critic:0.0993145491664424 - critic/lr:1e-05 - actor/pg_loss:0.08696991857141256 - actor/pg_clipfrac:0.0022477873935713433 - actor/ppo_kl:0.0005173772538000776 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.098198115825653 - perf/mfu/actor:0.07985550967586012 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:86.95006561279297 - actor/lr:1e-06 - training/global_step:59 - training/epoch:2 - critic/score/mean:0.5703125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.5703125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:2.1861085386376544e-08 - critic/advantages/max:2.5832679271698 - critic/advantages/min:-2.4984047412872314 - critic/returns/mean:0.506921112537384 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.63671875 - critic/values/max:1.390625 - critic/values/min:-0.47265625 - critic/vf_explained_var:0.25975996255874634 - response_length/mean:300.2578125 - response_length/max:512.0 - response_length/min:122.0 - response_length/clip_ratio:0.078125 - prompt_length/mean:102.03125 - prompt_length/max:194.0 - prompt_length/min:66.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.640119969844818e-06 - timing_s/generate_sequences:3.5713987350463867 - timing_s/reshard:0.8755231499671936 - timing_s/gen:4.952090218197554 - timing_s/reward:0.035592878237366676 - timing_s/old_log_prob:2.419270812999457 - timing_s/values:1.3421435276977718 - timing_s/adv:0.034810920245945454 - timing_s/update_critic:5.586431819014251 - timing_s/update_actor:6.947397931013256 - timing_s/step:21.32836343999952 - timing_s/stop_profile:2.270098775625229e-06 - timing_per_token_ms/values:0.013032291065754294 - timing_per_token_ms/adv:0.00033801604340342816 - timing_per_token_ms/update_actor:0.06745963462036836 - timing_per_token_ms/update_critic:0.05424457517540492 - timing_per_token_ms/gen:0.06442497616888553 - perf/total_num_tokens:102986 - perf/time_per_step:21.32836343999952 - perf/throughput:1207.148409320269
[36m(TaskRunner pid=2914832)[0m Training Progress:  14%|█▎        | 59/435 [21:50<2:15:13, 21.58s/it]
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 60}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and bakes muffins for her friends every day with four. She sells the remainder at the farmers' market daily for $2 per fresh duck egg. How much in dollars does she make every day at the farmers' market? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much money Janet makes every day at the farmers' market, we need to follow these steps:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. Calculate the total number of eggs laid by the ducks in a day.
[36m(TaskRunner pid=2914832)[0m 2. Determine the number of eggs Janet sells at the farmers' market.
[36m(TaskRunner pid=2914832)[0m 3. Calculate the total revenue from selling the eggs.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m First, we know that Janet's ducks lay 16 eggs per day. She eats 3 eggs for breakfast and bakes 4 muffins for her friends, so the total number of eggs she eats in a day is:
[36m(TaskRunner pid=2914832)[0m \[ 3 + 4 = 7 \text{ eggs} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Therefore, the number of eggs she sells at the farmers' market is the total number of eggs laid minus the number of eggs she eats:
[36m(TaskRunner pid=2914832)[0m \[ 16 - 7 = 9 \text{ eggs} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Since she sells each egg for $2, the total revenue is:
[36m(TaskRunner pid=2914832)[0m \[ 9 \times 2 = 18 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m So, the final answer is:
[36m(TaskRunner pid=2914832)[0m #### 18
[36m(TaskRunner pid=2914832)[0m [ground_truth] 18
[36m(TaskRunner pid=2914832)[0m [score] 1.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1312
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 60}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Tom's restaurant gets 6 reservations a night.  They normally order 2 meals that cost $5 each and a $5 bottle of wine.  How much do they make a week if they are open 2 days a week? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] 
[36m(TaskRunner pid=2914832)[0m To determine how much Tom's restaurant makes in a week, we need to follow these steps:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. Calculate the number of meals ordered per night.
[36m(TaskRunner pid=2914832)[0m 2. Calculate the total revenue from meals ordered per night.
[36m(TaskRunner pid=2914832)[0m 3. Calculate the total revenue from meals ordered per week.
[36m(TaskRunner pid=2914832)[0m 4. Calculate the total revenue from wine ordered per week.
[36m(TaskRunner pid=2914832)[0m 5. Add the revenue from meals and wine to get the total revenue per week.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Let's start with the number of meals ordered per night. They get 6 reservations a night, and each reservation includes 2 meals. Therefore, the number of meals ordered per night is:
[36m(TaskRunner pid=2914832)[0m \[ 6 \text{ reservations/night} \times 2 \text{ meals/reservation} = 12 \text{ meals/night} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Next, we calculate the total revenue from meals ordered per night. The meals cost $5 each, so the revenue from meals per night is:
[36m(TaskRunner pid=2914832)[0m \[ 12 \text{ meals/night} \times 5 \text{ dollars/meal} = 60 \text{ dollars/night} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Since the restaurant is open 2 days a week, the total revenue from meals per week is:
[36m(TaskRunner pid=2914832)[0m \[ 60 \text{ dollars/night} \times 2 \text{ nights/week} = 120 \text{ dollars/week} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m The wine order does not affect the revenue calculation for meals, so the total revenue from wine per week is:
[36m(TaskRunner pid=2914832)[0m \[ 0 \text{ dollars/week} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Finally, the total revenue per week is the sum of the revenue from meals and wine:
[36m(TaskRunner pid=2914832)[0m \[ 120 \text{ dollars/week} + 0 \text{ dollars/week} = 120 \text{ dollars/week} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m #### 120
[36m(TaskRunner pid=2914832)[0m #### 120
[36m(TaskRunner pid=2914832)[0m [ground_truth] 180
[36m(TaskRunner pid=2914832)[0m [score] 0.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1319
[36m(TaskRunner pid=2914832)[0m step:60 - global_seqlen/min:23117 - global_seqlen/max:26880 - global_seqlen/minmax_diff:3763 - global_seqlen/balanced_min:25534 - global_seqlen/balanced_max:25535 - global_seqlen/mean:25534.75 - actor/entropy:0.20532940328121185 - critic/vf_loss:0.17567456990946084 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.8230266310274601 - critic/grad_norm:60.43884229660034 - perf/mfu/critic:0.10095131629704389 - critic/lr:1e-05 - actor/pg_loss:0.13750742794945836 - actor/pg_clipfrac:0.0022717280153301544 - actor/ppo_kl:-3.5158634204890404e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.1535977125167847 - perf/mfu/actor:0.08016438450770014 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.52057647705078 - actor/lr:1e-06 - val-core/openai/gsm8k/reward/mean@1:0.514783927217589 - training/global_step:60 - training/epoch:2 - critic/score/mean:0.60546875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.60546875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:4.389085006550886e-08 - critic/advantages/max:2.7500832080841064 - critic/advantages/min:-2.5660932064056396 - critic/returns/mean:0.5403790473937988 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.8515625 - critic/values/max:1.6171875 - critic/values/min:-0.2333984375 - critic/vf_explained_var:0.18018990755081177 - response_length/mean:295.5390625 - response_length/max:512.0 - response_length/min:113.0 - response_length/clip_ratio:0.05859375 - prompt_length/mean:103.44140625 - prompt_length/max:183.0 - prompt_length/min:72.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.643349140882492e-06 - timing_s/generate_sequences:3.6074881553649902 - timing_s/reshard:0.5816258788108826 - timing_s/gen:4.775477722752839 - timing_s/reward:0.03538671601563692 - timing_s/old_log_prob:2.081605085171759 - timing_s/values:1.3444014801643789 - timing_s/adv:0.03317770687863231 - timing_s/update_critic:5.448952711187303 - timing_s/update_actor:6.858326907269657 - timing_s/testing:14.005724838003516 - timing_s/step:34.59163438063115 - timing_s/stop_profile:2.0586885511875153e-06 - timing_per_token_ms/values:0.013162469577383554 - timing_per_token_ms/adv:0.00032482897696895706 - timing_per_token_ms/update_actor:0.06714699485279528 - timing_per_token_ms/update_critic:0.05334840473459994 - timing_per_token_ms/gen:0.06311926990870548 - perf/total_num_tokens:102139 - perf/time_per_step:34.59163438063115 - perf/throughput:738.1770320253397
[36m(TaskRunner pid=2914832)[0m Training Progress:  14%|█▍        | 60/435 [22:25<2:39:18, 25.49s/it]
[36m(TaskRunner pid=2914832)[0m step:61 - global_seqlen/min:24659 - global_seqlen/max:25882 - global_seqlen/minmax_diff:1223 - global_seqlen/balanced_min:25398 - global_seqlen/balanced_max:25398 - global_seqlen/mean:25398.0 - actor/entropy:0.24295291304588318 - critic/vf_loss:0.2134010496083647 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.18540130685869372 - critic/grad_norm:85.67304992675781 - perf/mfu/critic:0.09847756744296526 - critic/lr:1e-05 - actor/pg_loss:-0.1758174430578947 - actor/pg_clipfrac:0.0023415913092321716 - actor/ppo_kl:-0.00016093819795059972 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.268511712551117 - perf/mfu/actor:0.08033507229116305 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.51831436157227 - actor/lr:1e-06 - training/global_step:61 - training/epoch:2 - critic/score/mean:0.56640625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.56640625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-2.612285276981652e-09 - critic/advantages/max:2.7918448448181152 - critic/advantages/min:-3.3927366733551025 - critic/returns/mean:0.5295924544334412 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.25390625 - critic/values/max:1.296875 - critic/values/min:-0.796875 - critic/vf_explained_var:0.13731515407562256 - response_length/mean:293.76953125 - response_length/max:512.0 - response_length/min:118.0 - response_length/clip_ratio:0.06640625 - prompt_length/mean:103.07421875 - prompt_length/max:186.0 - prompt_length/min:70.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:1.2589618563652039e-05 - timing_s/generate_sequences:3.7333428859710693 - timing_s/reshard:0.30180710554122925 - timing_s/gen:4.830813168082386 - timing_s/reward:0.03504179511219263 - timing_s/old_log_prob:2.0916264168918133 - timing_s/values:1.3762927730567753 - timing_s/adv:0.03420906513929367 - timing_s/update_critic:5.554935242980719 - timing_s/update_actor:6.809584858827293 - timing_s/step:20.740992084145546 - timing_s/stop_profile:1.7452985048294067e-06 - timing_per_token_ms/values:0.013547255424214262 - timing_per_token_ms/adv:0.00033672991120652876 - timing_per_token_ms/update_actor:0.06702875087435323 - timing_per_token_ms/update_critic:0.0546788649005898 - timing_per_token_ms/gen:0.06423526584778122 - perf/total_num_tokens:101592 - perf/time_per_step:20.740992084145546 - perf/throughput:1224.531589277944
[36m(TaskRunner pid=2914832)[0m Training Progress:  14%|█▍        | 61/435 [22:45<2:30:02, 24.07s/it]
[36m(TaskRunner pid=2914832)[0m step:62 - global_seqlen/min:25293 - global_seqlen/max:27078 - global_seqlen/minmax_diff:1785 - global_seqlen/balanced_min:26074 - global_seqlen/balanced_max:26074 - global_seqlen/mean:26074.0 - actor/entropy:0.2371262162923813 - critic/vf_loss:0.19999714195728302 - critic/vf_clipfrac:0.06141926672717091 - critic/vpred_mean:0.9436874613165855 - critic/grad_norm:85.61799740791321 - perf/mfu/critic:0.10718782558348491 - critic/lr:1e-05 - actor/pg_loss:-0.06395842792699113 - actor/pg_clipfrac:0.002933576426585205 - actor/ppo_kl:0.0002621987996462849 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.3627554178237915 - perf/mfu/actor:0.08201331660029551 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.69123458862305 - actor/lr:1e-06 - training/global_step:62 - training/epoch:2 - critic/score/mean:0.59375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.59375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-7.820631253707688e-09 - critic/advantages/max:3.0179879665374756 - critic/advantages/min:-2.6350910663604736 - critic/returns/mean:0.551343560218811 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.4921875 - critic/values/max:1.4609375 - critic/values/min:-0.625 - critic/vf_explained_var:0.20570123195648193 - response_length/mean:302.953125 - response_length/max:512.0 - response_length/min:127.0 - response_length/clip_ratio:0.06640625 - prompt_length/mean:104.453125 - prompt_length/max:199.0 - prompt_length/min:67.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.734843969345093e-06 - timing_s/generate_sequences:3.6235153675079346 - timing_s/reshard:0.8851402997970581 - timing_s/gen:5.542297573294491 - timing_s/reward:0.03781377384439111 - timing_s/old_log_prob:2.0989472959190607 - timing_s/values:1.7020039367489517 - timing_s/adv:0.03451913921162486 - timing_s/update_critic:5.243389131035656 - timing_s/update_actor:6.854641571640968 - timing_s/step:21.52137996815145 - timing_s/stop_profile:2.2137537598609924e-06 - timing_per_token_ms/values:0.016318976151999613 - timing_per_token_ms/adv:0.00033097280060237076 - timing_per_token_ms/update_actor:0.06572295746376629 - timing_per_token_ms/update_critic:0.0502741153163655 - timing_per_token_ms/gen:0.07146188010333811 - perf/total_num_tokens:104296 - perf/time_per_step:21.52137996815145 - perf/throughput:1211.5394105111184
[36m(TaskRunner pid=2914832)[0m Training Progress:  14%|█▍        | 62/435 [23:07<2:24:54, 23.31s/it]
[36m(TaskRunner pid=2914832)[0m step:63 - global_seqlen/min:24967 - global_seqlen/max:26998 - global_seqlen/minmax_diff:2031 - global_seqlen/balanced_min:25810 - global_seqlen/balanced_max:25811 - global_seqlen/mean:25810.5 - actor/entropy:0.19003017246723175 - critic/vf_loss:0.1757502774707973 - critic/vf_clipfrac:0.2640912998467684 - critic/vpred_mean:0.5357678876607679 - critic/grad_norm:74.48734855651855 - perf/mfu/critic:0.10412879689361183 - critic/lr:1e-05 - actor/pg_loss:0.26301805512048304 - actor/pg_clipfrac:0.0028368524071993306 - actor/ppo_kl:0.00014138670849206392 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.178727239370346 - perf/mfu/actor:0.07940923572496064 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.03598403930664 - actor/lr:1e-06 - training/global_step:63 - training/epoch:2 - critic/score/mean:0.58203125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.58203125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-3.8660441958882075e-08 - critic/advantages/max:2.8062875270843506 - critic/advantages/min:-2.8587357997894287 - critic/returns/mean:0.5381615161895752 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.984375 - critic/values/max:1.71875 - critic/values/min:0.08837890625 - critic/vf_explained_var:0.20357155799865723 - response_length/mean:297.4609375 - response_length/max:512.0 - response_length/min:123.0 - response_length/clip_ratio:0.05078125 - prompt_length/mean:105.828125 - prompt_length/max:201.0 - prompt_length/min:66.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.747416824102402e-06 - timing_s/generate_sequences:3.5419678688049316 - timing_s/reshard:0.582159698009491 - timing_s/gen:4.712082031648606 - timing_s/reward:0.03600825695320964 - timing_s/old_log_prob:2.0966442162171006 - timing_s/values:1.3538184030912817 - timing_s/adv:0.03456172300502658 - timing_s/update_critic:5.341951988171786 - timing_s/update_actor:7.0016963430680335 - timing_s/step:20.587989051360637 - timing_s/stop_profile:2.032611519098282e-06 - timing_per_token_ms/values:0.013113058668868112 - timing_per_token_ms/adv:0.00033476417548116636 - timing_per_token_ms/update_actor:0.06781829432854879 - timing_per_token_ms/update_critic:0.0517420428524417 - timing_per_token_ms/gen:0.061878949857499754 - perf/total_num_tokens:103242 - perf/time_per_step:20.587989051360637 - perf/throughput:1253.6678514647945
[36m(TaskRunner pid=2914832)[0m Training Progress:  14%|█▍        | 63/435 [23:28<2:19:28, 22.50s/it]
[36m(TaskRunner pid=2914832)[0m step:64 - global_seqlen/min:23901 - global_seqlen/max:25165 - global_seqlen/minmax_diff:1264 - global_seqlen/balanced_min:24482 - global_seqlen/balanced_max:24483 - global_seqlen/mean:24482.5 - actor/entropy:0.16751372814178467 - critic/vf_loss:0.1556645855307579 - critic/vf_clipfrac:0.11758535727858543 - critic/vpred_mean:0.40580110251903534 - critic/grad_norm:73.5088062286377 - perf/mfu/critic:0.10289343245764546 - critic/lr:1e-05 - actor/pg_loss:-0.011549262795597315 - actor/pg_clipfrac:0.0028300598060013726 - actor/ppo_kl:-0.00022242549081852303 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.19460529088974 - perf/mfu/actor:0.07732773687158692 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.05703353881836 - actor/lr:1e-06 - training/global_step:64 - training/epoch:2 - critic/score/mean:0.6328125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.6328125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:8.173630661190145e-09 - critic/advantages/max:2.193880796432495 - critic/advantages/min:-2.567228317260742 - critic/returns/mean:0.5782143473625183 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.1201171875 - critic/values/max:0.8984375 - critic/values/min:-0.76171875 - critic/vf_explained_var:0.22180533409118652 - response_length/mean:280.75390625 - response_length/max:512.0 - response_length/min:120.0 - response_length/clip_ratio:0.03515625 - prompt_length/mean:101.78515625 - prompt_length/max:177.0 - prompt_length/min:66.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.1602179408073425e-06 - timing_s/generate_sequences:3.5156097412109375 - timing_s/reshard:0.92195063829422 - timing_s/gen:4.972463657613844 - timing_s/reward:0.036673313938081264 - timing_s/old_log_prob:2.079071093350649 - timing_s/values:1.3437217632308602 - timing_s/adv:0.033800635021179914 - timing_s/update_critic:5.1198828048072755 - timing_s/update_actor:6.809161392040551 - timing_s/step:20.40231432998553 - timing_s/stop_profile:8.836854249238968e-06 - timing_per_token_ms/values:0.01372124745461922 - timing_per_token_ms/adv:0.0003451509754026337 - timing_per_token_ms/update_actor:0.06953090362545238 - timing_per_token_ms/update_critic:0.05228104569393725 - timing_per_token_ms/gen:0.06918402818323771 - perf/total_num_tokens:97930 - perf/time_per_step:20.40231432998553 - perf/throughput:1199.9864135029902
[36m(TaskRunner pid=2914832)[0m Training Progress:  15%|█▍        | 64/435 [23:48<2:15:13, 21.87s/it]
[36m(TaskRunner pid=2914832)[0m step:65 - global_seqlen/min:24332 - global_seqlen/max:26021 - global_seqlen/minmax_diff:1689 - global_seqlen/balanced_min:25287 - global_seqlen/balanced_max:25288 - global_seqlen/mean:25287.75 - actor/entropy:0.18175774812698364 - critic/vf_loss:0.1412343747797422 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.8828930333256721 - critic/grad_norm:64.2858567237854 - perf/mfu/critic:0.10573041210976189 - critic/lr:1e-05 - actor/pg_loss:-0.045764945447444916 - actor/pg_clipfrac:0.0027187092637177557 - actor/ppo_kl:0.00014879108516652195 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.30998158454895 - perf/mfu/actor:0.0790974773322634 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.69443130493164 - actor/lr:1e-06 - training/global_step:65 - training/epoch:2 - critic/score/mean:0.62890625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.62890625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:8.817531949034674e-08 - critic/advantages/max:2.244846820831299 - critic/advantages/min:-2.381720542907715 - critic/returns/mean:0.580971360206604 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.99609375 - critic/values/max:1.78125 - critic/values/min:-0.018798828125 - critic/vf_explained_var:0.20825225114822388 - response_length/mean:292.4453125 - response_length/max:512.0 - response_length/min:119.0 - response_length/clip_ratio:0.0625 - prompt_length/mean:102.67578125 - prompt_length/max:232.0 - prompt_length/min:70.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:1.3892073184251785e-05 - timing_s/generate_sequences:3.6019506454467773 - timing_s/reshard:0.7810511589050293 - timing_s/gen:5.571991485077888 - timing_s/reward:0.03469849983230233 - timing_s/old_log_prob:2.101341316010803 - timing_s/values:1.3523848508484662 - timing_s/adv:0.033458868972957134 - timing_s/update_critic:5.151117703877389 - timing_s/update_actor:6.881576371844858 - timing_s/step:21.134084205143154 - timing_s/stop_profile:2.112705260515213e-06 - timing_per_token_ms/values:0.013369960265825015 - timing_per_token_ms/adv:0.0003307813958631861 - timing_per_token_ms/update_actor:0.06803270725791004 - timing_per_token_ms/update_critic:0.05092502994411711 - timing_per_token_ms/gen:0.07442619460206085 - perf/total_num_tokens:101151 - perf/time_per_step:21.134084205143154 - perf/throughput:1196.538717009844
[36m(TaskRunner pid=2914832)[0m Training Progress:  15%|█▍        | 65/435 [24:09<2:13:31, 21.65s/it]
[36m(TaskRunner pid=2914832)[0m step:66 - global_seqlen/min:25604 - global_seqlen/max:26659 - global_seqlen/minmax_diff:1055 - global_seqlen/balanced_min:25949 - global_seqlen/balanced_max:25950 - global_seqlen/mean:25949.25 - actor/entropy:0.1869734823703766 - critic/vf_loss:0.16518686804920435 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.1185943594755372 - critic/grad_norm:102.8036937713623 - perf/mfu/critic:0.10206075095216369 - critic/lr:1e-05 - actor/pg_loss:0.1614232383435592 - actor/pg_clipfrac:0.0031239428426488303 - actor/ppo_kl:0.00016120210875669727 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.0926893949508667 - perf/mfu/actor:0.08162211626498891 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.85658645629883 - actor/lr:1e-06 - training/global_step:66 - training/epoch:2 - critic/score/mean:0.609375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.609375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.1671316357819705e-08 - critic/advantages/max:2.2587311267852783 - critic/advantages/min:-2.4686787128448486 - critic/returns/mean:0.5829236507415771 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.248046875 - critic/values/max:0.88671875 - critic/values/min:-0.546875 - critic/vf_explained_var:0.25664979219436646 - response_length/mean:300.3515625 - response_length/max:512.0 - response_length/min:145.0 - response_length/clip_ratio:0.05859375 - prompt_length/mean:105.10546875 - prompt_length/max:215.0 - prompt_length/min:67.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.549781680107117e-06 - timing_s/generate_sequences:3.6212565898895264 - timing_s/reshard:0.5865299105644226 - timing_s/gen:4.745976475998759 - timing_s/reward:0.035981935914605856 - timing_s/old_log_prob:2.0830500670708716 - timing_s/values:1.3491515670903027 - timing_s/adv:0.04040303360670805 - timing_s/update_critic:5.480214866809547 - timing_s/update_actor:6.851089125033468 - timing_s/step:20.592983704060316 - timing_s/stop_profile:2.192799001932144e-06 - timing_per_token_ms/values:0.012997982283594927 - timing_per_token_ms/adv:0.0003892504947802735 - timing_per_token_ms/update_actor:0.06600469305503501 - timing_per_token_ms/update_critic:0.0527974302418138 - timing_per_token_ms/gen:0.061724235609295866 - perf/total_num_tokens:103797 - perf/time_per_step:20.592983704060316 - perf/throughput:1260.101516755126
[36m(TaskRunner pid=2914832)[0m Training Progress:  15%|█▌        | 66/435 [24:30<2:11:14, 21.34s/it]
[36m(TaskRunner pid=2914832)[0m step:67 - global_seqlen/min:25766 - global_seqlen/max:27298 - global_seqlen/minmax_diff:1532 - global_seqlen/balanced_min:26556 - global_seqlen/balanced_max:26556 - global_seqlen/mean:26556.0 - actor/entropy:0.20776793360710144 - critic/vf_loss:0.12327962089329958 - critic/vf_clipfrac:0.10517576686106622 - critic/vpred_mean:0.6692518033087254 - critic/grad_norm:55.599562644958496 - perf/mfu/critic:0.10506922564988794 - critic/lr:1e-05 - actor/pg_loss:0.03868495998904109 - actor/pg_clipfrac:0.002793604704493191 - actor/ppo_kl:0.0005510319206720737 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.1740447282791138 - perf/mfu/actor:0.08413271389159845 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.98369216918945 - actor/lr:1e-06 - training/global_step:67 - training/epoch:2 - critic/score/mean:0.57421875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.57421875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:5.738839403690577e-10 - critic/advantages/max:2.3878321647644043 - critic/advantages/min:-2.3526268005371094 - critic/returns/mean:0.5298916697502136 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.326171875 - critic/values/max:1.0234375 - critic/values/min:-0.458984375 - critic/vf_explained_var:0.22130626440048218 - response_length/mean:308.33984375 - response_length/max:512.0 - response_length/min:104.0 - response_length/clip_ratio:0.0859375 - prompt_length/mean:106.59765625 - prompt_length/max:217.0 - prompt_length/min:71.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.237983375787735e-06 - timing_s/generate_sequences:3.576585531234741 - timing_s/reshard:0.8591669797897339 - timing_s/gen:4.960702034179121 - timing_s/reward:0.03563973493874073 - timing_s/old_log_prob:2.090241178870201 - timing_s/values:1.3439374910667539 - timing_s/adv:0.036501475144177675 - timing_s/update_critic:5.452292043715715 - timing_s/update_actor:6.807753123808652 - timing_s/step:20.734096109867096 - timing_s/stop_profile:2.7832575142383575e-06 - timing_per_token_ms/values:0.012651919444445265 - timing_per_token_ms/adv:0.0003436273831165996 - timing_per_token_ms/update_actor:0.0640886534475133 - timing_per_token_ms/update_critic:0.05132825014794882 - timing_per_token_ms/gen:0.06284540487970003 - perf/total_num_tokens:106224 - perf/time_per_step:20.734096109867096 - perf/throughput:1280.7888928113116
[36m(TaskRunner pid=2914832)[0m Training Progress:  15%|█▌        | 67/435 [24:50<2:09:47, 21.16s/it]
[36m(TaskRunner pid=2914832)[0m step:68 - global_seqlen/min:25325 - global_seqlen/max:26864 - global_seqlen/minmax_diff:1539 - global_seqlen/balanced_min:25986 - global_seqlen/balanced_max:25987 - global_seqlen/mean:25986.5 - actor/entropy:0.1748359203338623 - critic/vf_loss:0.16855473350733519 - critic/vf_clipfrac:0.12096254713833332 - critic/vpred_mean:0.390670402237447 - critic/grad_norm:72.83384490013123 - perf/mfu/critic:0.10369541090132392 - critic/lr:1e-05 - actor/pg_loss:-0.020927418780047446 - actor/pg_clipfrac:0.0030167751683620736 - actor/ppo_kl:0.00013595760719908867 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.157323479652405 - perf/mfu/actor:0.0774660424807912 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.99283981323242 - actor/lr:1e-06 - training/global_step:68 - training/epoch:2 - critic/score/mean:0.578125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.578125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:2.144641264578695e-08 - critic/advantages/max:2.5843756198883057 - critic/advantages/min:-2.1708991527557373 - critic/returns/mean:0.5213560461997986 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.74609375 - critic/values/max:1.3125 - critic/values/min:-0.09912109375 - critic/vf_explained_var:0.19759565591812134 - response_length/mean:301.89453125 - response_length/max:512.0 - response_length/min:126.0 - response_length/clip_ratio:0.078125 - prompt_length/mean:104.14453125 - prompt_length/max:191.0 - prompt_length/min:70.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.765111953020096e-06 - timing_s/generate_sequences:3.6003541946411133 - timing_s/reshard:0.5881418585777283 - timing_s/gen:5.007166584953666 - timing_s/reward:0.03572731511667371 - timing_s/old_log_prob:2.1340147140435874 - timing_s/values:1.6424490679055452 - timing_s/adv:0.03628834383562207 - timing_s/update_critic:5.404493410605937 - timing_s/update_actor:7.226779057178646 - timing_s/step:21.494806917849928 - timing_s/stop_profile:1.9772909581661224e-05 - timing_per_token_ms/values:0.015800983856093985 - timing_per_token_ms/adv:0.00034910765046872487 - timing_per_token_ms/update_actor:0.06952435935176579 - timing_per_token_ms/update_critic:0.05199327930469606 - timing_per_token_ms/gen:0.06478833648125336 - perf/total_num_tokens:103946 - perf/time_per_step:21.494806917849928 - perf/throughput:1208.9664307903151
[36m(TaskRunner pid=2914832)[0m Training Progress:  16%|█▌        | 68/435 [25:12<2:10:05, 21.27s/it]
[36m(TaskRunner pid=2914832)[0m step:69 - global_seqlen/min:24497 - global_seqlen/max:26797 - global_seqlen/minmax_diff:2300 - global_seqlen/balanced_min:25820 - global_seqlen/balanced_max:25821 - global_seqlen/mean:25820.5 - actor/entropy:0.16675320267677307 - critic/vf_loss:0.15277775935828686 - critic/vf_clipfrac:0.17319727316498756 - critic/vpred_mean:0.25011156107666466 - critic/grad_norm:80.78481578826904 - perf/mfu/critic:0.10826568988189848 - critic/lr:1e-05 - actor/pg_loss:-0.011218864237889647 - actor/pg_clipfrac:0.002474032935424475 - actor/ppo_kl:0.00010525455491006142 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.1506024599075317 - perf/mfu/actor:0.08182645142334148 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.02615356445312 - actor/lr:1e-06 - training/global_step:69 - training/epoch:2 - critic/score/mean:0.62109375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.62109375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-8.580054355888933e-08 - critic/advantages/max:2.3871827125549316 - critic/advantages/min:-2.2379231452941895 - critic/returns/mean:0.5505383610725403 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.000652313232421875 - critic/values/max:0.5625 - critic/values/min:-0.79296875 - critic/vf_explained_var:0.2502549886703491 - response_length/mean:297.84765625 - response_length/max:512.0 - response_length/min:114.0 - response_length/clip_ratio:0.0625 - prompt_length/mean:105.59765625 - prompt_length/max:256.0 - prompt_length/min:66.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.465000867843628e-06 - timing_s/generate_sequences:3.5928831100463867 - timing_s/reshard:0.9698101282119751 - timing_s/gen:5.15919247828424 - timing_s/reward:0.0348295858129859 - timing_s/old_log_prob:2.077819907106459 - timing_s/values:1.3392961928620934 - timing_s/adv:0.035429087933152914 - timing_s/update_critic:5.140117004979402 - timing_s/update_actor:6.7978417640551925 - timing_s/step:20.591852753888816 - timing_s/stop_profile:1.9171275198459625e-06 - timing_per_token_ms/values:0.012967372754808132 - timing_per_token_ms/adv:0.00034303255100746416 - timing_per_token_ms/update_actor:0.06581826227275994 - timing_per_token_ms/update_critic:0.04976779114443371 - timing_per_token_ms/gen:0.0676624280749156 - perf/total_num_tokens:103282 - perf/time_per_step:20.591852753888816 - perf/throughput:1253.9182514853474
[36m(TaskRunner pid=2914832)[0m Training Progress:  16%|█▌        | 69/435 [25:33<2:08:31, 21.07s/it]
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 70}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and bakes muffins for her friends every day with four. She sells the remainder at the farmers' market daily for $2 per fresh duck egg. How much in dollars does she make every day at the farmers' market? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much money Janet makes every day at the farmers' market, we need to follow these steps:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. Calculate the total number of eggs laid by the ducks in a day.
[36m(TaskRunner pid=2914832)[0m 2. Determine the number of eggs eaten in a day.
[36m(TaskRunner pid=2914832)[0m 3. Calculate the number of eggs sold in a day.
[36m(TaskRunner pid=2914832)[0m 4. Find the total revenue from selling the eggs.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Let's start with the first step:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. Janet's ducks lay 16 eggs per day.
[36m(TaskRunner pid=2914832)[0m 2. Janet eats 3 eggs for breakfast every morning. Therefore, the number of eggs eaten in a day is:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    16 - 3 = 13 \text{ eggs}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m 3. Janet bakes 4 muffins for her friends every day. Therefore, the number of eggs baked in a day is:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    4 \text{ eggs}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m 4. The number of eggs sold at the farmers' market is the remainder after subtracting the number of eggs eaten and the number of eggs baked from the total number of eggs laid. So, the number of eggs sold is:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    16 - 13 - 4 = 0 \text{ eggs}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m 5. Since the number of eggs sold is 0, the total revenue is:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    0 \text{ dollars}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Therefore, the final answer is:
[36m(TaskRunner pid=2914832)[0m #### 0
[36m(TaskRunner pid=2914832)[0m [ground_truth] 18
[36m(TaskRunner pid=2914832)[0m [score] 0.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1312
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 70}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Tom's restaurant gets 6 reservations a night.  They normally order 2 meals that cost $5 each and a $5 bottle of wine.  How much do they make a week if they are open 2 days a week? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much Tom's restaurant makes in a week, we need to follow these steps:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. Calculate the number of meals ordered per night.
[36m(TaskRunner pid=2914832)[0m 2. Calculate the total number of meals ordered per week.
[36m(TaskRunner pid=2914832)[0m 3. Calculate the total revenue from meals ordered per week.
[36m(TaskRunner pid=2914832)[0m 4. Calculate the total revenue from wine ordered per week.
[36m(TaskRunner pid=2914832)[0m 5. Add the revenue from meals and wine to get the total revenue per week.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Let's start with the number of meals ordered per night. They get 6 reservations a night, and each reservation consists of 2 meals. Therefore, the number of meals ordered per night is:
[36m(TaskRunner pid=2914832)[0m \[ 6 \text{ reservations/night} \times 2 \text{ meals/reservation} = 12 \text{ meals/night} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Next, we calculate the total number of meals ordered per week. Since they are open 2 days a week, the total number of meals ordered per week is:
[36m(TaskRunner pid=2914832)[0m \[ 12 \text{ meals/night} \times 2 \text{ nights/week} = 24 \text{ meals/week} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Now, we calculate the total revenue from meals ordered per week. The cost of each meal is $5, so the total revenue from meals is:
[36m(TaskRunner pid=2914832)[0m \[ 24 \text{ meals/week} \times 5 \text{ dollars/meal} = 120 \text{ dollars/week} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m The cost of the wine is $5 per bottle, and they order 1 bottle per meal, so the total revenue from wine is:
[36m(TaskRunner pid=2914832)[0m \[ 1 \text{ bottle/meal} \times 5 \text{ dollars/bottle} = 5 \text{ dollars/week} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Finally, the total revenue per week is the sum of the revenue from meals and the revenue from wine:
[36m(TaskRunner pid=2914832)[0m \[ 120 \text{ dollars/week} + 5 \text{ dollars/week} = 125 \text{ dollars/week} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Therefore, the final answer is:
[36m(TaskRunner pid=2914832)[0m #### 125
[36m(TaskRunner pid=2914832)[0m [ground_truth] 180
[36m(TaskRunner pid=2914832)[0m [score] 0.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1319
[36m(TaskRunner pid=2914832)[0m step:70 - global_seqlen/min:24550 - global_seqlen/max:27396 - global_seqlen/minmax_diff:2846 - global_seqlen/balanced_min:25901 - global_seqlen/balanced_max:25902 - global_seqlen/mean:25901.75 - actor/entropy:0.19925573468208313 - critic/vf_loss:0.12068441731389612 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.7179445382207632 - critic/grad_norm:32.75280427932739 - perf/mfu/critic:0.10519369344134707 - critic/lr:1e-05 - actor/pg_loss:-0.007122129783965647 - actor/pg_clipfrac:0.0018626056189532392 - actor/ppo_kl:0.00025216704949571067 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.1406452655792236 - perf/mfu/actor:0.07793350168592715 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:86.98691940307617 - actor/lr:1e-06 - val-core/openai/gsm8k/reward/mean@1:0.5170583775587566 - training/global_step:70 - training/epoch:2 - critic/score/mean:0.63671875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.63671875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-7.099404086829963e-08 - critic/advantages/max:2.5031609535217285 - critic/advantages/min:-2.803907871246338 - critic/returns/mean:0.6130274534225464 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.80078125 - critic/values/max:1.78125 - critic/values/min:0.0537109375 - critic/vf_explained_var:0.1434551477432251 - response_length/mean:302.24609375 - response_length/max:512.0 - response_length/min:148.0 - response_length/clip_ratio:0.0390625 - prompt_length/mean:102.46875 - prompt_length/max:189.0 - prompt_length/min:62.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.211906343698502e-06 - timing_s/generate_sequences:3.5928497314453125 - timing_s/reshard:0.7888615131378174 - timing_s/gen:5.2207698239944875 - timing_s/reward:0.03564740112051368 - timing_s/old_log_prob:2.134812777861953 - timing_s/values:1.6225322908721864 - timing_s/adv:0.03365450678393245 - timing_s/update_critic:5.305425290949643 - timing_s/update_actor:7.156755986157805 - timing_s/testing:13.955346840899438 - timing_s/step:35.47245599189773 - timing_s/stop_profile:3.4458935260772705e-06 - timing_per_token_ms/values:0.015660450460607742 - timing_per_token_ms/adv:0.0003248285037104872 - timing_per_token_ms/update_actor:0.06907598894049441 - timing_per_token_ms/update_critic:0.051207208885013976 - timing_per_token_ms/gen:0.06747360031010646 - perf/total_num_tokens:103607 - perf/time_per_step:35.47245599189773 - perf/throughput:730.1933084620987
[36m(TaskRunner pid=2914832)[0m Training Progress:  16%|█▌        | 70/435 [26:08<2:34:28, 25.39s/it]
[36m(TaskRunner pid=2914832)[0m step:71 - global_seqlen/min:24748 - global_seqlen/max:25922 - global_seqlen/minmax_diff:1174 - global_seqlen/balanced_min:25284 - global_seqlen/balanced_max:25285 - global_seqlen/mean:25284.75 - actor/entropy:0.1369999200105667 - critic/vf_loss:0.0941843501641415 - critic/vf_clipfrac:0.07899943366646767 - critic/vpred_mean:0.5830403920263052 - critic/grad_norm:41.71890068054199 - perf/mfu/critic:0.09980307873601592 - critic/lr:1e-05 - actor/pg_loss:-0.1326338415965438 - actor/pg_clipfrac:0.0029583920768345706 - actor/ppo_kl:-0.00021370161920231112 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.4483826756477356 - perf/mfu/actor:0.07704787349919855 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:87.81521224975586 - actor/lr:1e-06 - training/global_step:71 - training/epoch:2 - critic/score/mean:0.69140625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.69140625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-3.363310696613553e-08 - critic/advantages/max:2.0625505447387695 - critic/advantages/min:-2.520918130874634 - critic/returns/mean:0.6317958831787109 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.375 - critic/values/max:0.98828125 - critic/values/min:-0.388671875 - critic/vf_explained_var:0.22649335861206055 - response_length/mean:290.91796875 - response_length/max:512.0 - response_length/min:133.0 - response_length/clip_ratio:0.05078125 - prompt_length/mean:104.15625 - prompt_length/max:186.0 - prompt_length/min:65.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:6.432179361581802e-06 - timing_s/generate_sequences:3.561570167541504 - timing_s/reshard:0.30389800667762756 - timing_s/gen:4.709708302747458 - timing_s/reward:0.03545242315158248 - timing_s/old_log_prob:2.0979786133393645 - timing_s/values:1.357183970976621 - timing_s/adv:0.034463126212358475 - timing_s/update_critic:5.455875345971435 - timing_s/update_actor:7.066692051943392 - timing_s/step:20.76442172890529 - timing_s/stop_profile:1.9152648746967316e-06 - timing_per_token_ms/values:0.01341899733017551 - timing_per_token_ms/adv:0.00034075011827641635 - timing_per_token_ms/update_actor:0.06987108881779919 - timing_per_token_ms/update_critic:0.05394432756870678 - timing_per_token_ms/gen:0.0632387821785493 - perf/total_num_tokens:101139 - perf/time_per_step:20.76442172890529 - perf/throughput:1217.6958419603927
[36m(TaskRunner pid=2914832)[0m Training Progress:  16%|█▋        | 71/435 [26:29<2:25:39, 24.01s/it]
[36m(TaskRunner pid=2914832)[0m step:72 - global_seqlen/min:24659 - global_seqlen/max:26410 - global_seqlen/minmax_diff:1751 - global_seqlen/balanced_min:25391 - global_seqlen/balanced_max:25392 - global_seqlen/mean:25391.5 - actor/entropy:0.15966299176216125 - critic/vf_loss:0.1570063910621684 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.9256993345916271 - critic/grad_norm:74.28784656524658 - perf/mfu/critic:0.10661942176226201 - critic/lr:1e-05 - actor/pg_loss:-0.07382780429907143 - actor/pg_clipfrac:0.0023949106107465923 - actor/ppo_kl:0.0003925666851500864 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.1944835782051086 - perf/mfu/actor:0.0804763833414486 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:87.91513061523438 - actor/lr:1e-06 - training/global_step:72 - training/epoch:2 - critic/score/mean:0.609375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.609375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.0022901619777258e-08 - critic/advantages/max:2.569880723953247 - critic/advantages/min:-2.253021478652954 - critic/returns/mean:0.5487626791000366 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:1.03125 - critic/values/max:1.5703125 - critic/values/min:0.2158203125 - critic/vf_explained_var:0.2318224310874939 - response_length/mean:294.5546875 - response_length/max:512.0 - response_length/min:108.0 - response_length/clip_ratio:0.0390625 - prompt_length/mean:102.1875 - prompt_length/max:201.0 - prompt_length/min:70.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.878042429685593e-06 - timing_s/generate_sequences:3.651855945587158 - timing_s/reshard:0.6832737922668457 - timing_s/gen:5.0262964786961675 - timing_s/reward:0.03574973624199629 - timing_s/old_log_prob:2.0851311930455267 - timing_s/values:1.3500592927448452 - timing_s/adv:0.03456760989502072 - timing_s/update_critic:5.130451099015772 - timing_s/update_actor:6.793707389850169 - timing_s/step:20.4629076551646 - timing_s/stop_profile:2.3581087589263916e-06 - timing_per_token_ms/values:0.013292433420089844 - timing_per_token_ms/adv:0.00034034627626391436 - timing_per_token_ms/update_actor:0.06688958302827885 - timing_per_token_ms/update_critic:0.05051347004918745 - timing_per_token_ms/gen:0.06665645278487345 - perf/total_num_tokens:101566 - perf/time_per_step:20.4629076551646 - perf/throughput:1240.8549375235773
[36m(TaskRunner pid=2914832)[0m Training Progress:  17%|█▋        | 72/435 [26:49<2:18:50, 22.95s/it]
[36m(TaskRunner pid=2914832)[0m step:73 - global_seqlen/min:24431 - global_seqlen/max:25728 - global_seqlen/minmax_diff:1297 - global_seqlen/balanced_min:25151 - global_seqlen/balanced_max:25152 - global_seqlen/mean:25151.75 - actor/entropy:0.15680433809757233 - critic/vf_loss:0.15021226787939668 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.14032797701656818 - critic/grad_norm:86.19269180297852 - perf/mfu/critic:0.104137294741614 - critic/lr:1e-05 - actor/pg_loss:0.019463055548840202 - actor/pg_clipfrac:0.002701252367842244 - actor/ppo_kl:-0.000547550859664625 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.1335085928440094 - perf/mfu/actor:0.07859362387382383 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.04056549072266 - actor/lr:1e-06 - training/global_step:73 - training/epoch:2 - critic/score/mean:0.62109375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.62109375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.1986267978159049e-08 - critic/advantages/max:2.093538284301758 - critic/advantages/min:-2.2586028575897217 - critic/returns/mean:0.5617355704307556 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.3046875 - critic/values/max:0.828125 - critic/values/min:-0.431640625 - critic/vf_explained_var:0.277199923992157 - response_length/mean:289.3515625 - response_length/max:512.0 - response_length/min:99.0 - response_length/clip_ratio:0.046875 - prompt_length/mean:103.64453125 - prompt_length/max:193.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.6691857278347015e-06 - timing_s/generate_sequences:3.518059492111206 - timing_s/reshard:0.9027979373931885 - timing_s/gen:5.376590929925442 - timing_s/reward:0.03567367000505328 - timing_s/old_log_prob:2.1168453758582473 - timing_s/values:1.6206562770530581 - timing_s/adv:0.0343601512722671 - timing_s/update_critic:5.203677195589989 - timing_s/update_actor:6.891068568918854 - timing_s/step:21.286571220029145 - timing_s/stop_profile:2.1797604858875275e-06 - timing_per_token_ms/values:0.016108782460992357 - timing_per_token_ms/adv:0.0003415284351214836 - timing_per_token_ms/update_actor:0.06849492151558892 - timing_per_token_ms/update_critic:0.051722814472054526 - timing_per_token_ms/gen:0.0725840501380436 - perf/total_num_tokens:100607 - perf/time_per_step:21.286571220029145 - perf/throughput:1181.5782701694106
[36m(TaskRunner pid=2914832)[0m Training Progress:  17%|█▋        | 73/435 [27:11<2:15:27, 22.45s/it]
[36m(TaskRunner pid=2914832)[0m step:74 - global_seqlen/min:24645 - global_seqlen/max:26326 - global_seqlen/minmax_diff:1681 - global_seqlen/balanced_min:25783 - global_seqlen/balanced_max:25783 - global_seqlen/mean:25783.0 - actor/entropy:0.16929952800273895 - critic/vf_loss:0.12678709533065557 - critic/vf_clipfrac:0.0036763689131475985 - critic/vpred_mean:0.651013558730483 - critic/grad_norm:49.660757064819336 - perf/mfu/critic:0.09961451774995889 - critic/lr:1e-05 - actor/pg_loss:-0.041098775807768106 - actor/pg_clipfrac:0.003037056165339891 - actor/ppo_kl:-5.501679197550402e-06 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.120379149913788 - perf/mfu/actor:0.08149740568550168 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.97604370117188 - actor/lr:1e-06 - training/global_step:74 - training/epoch:2 - critic/score/mean:0.6328125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.6328125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.946671979169423e-08 - critic/advantages/max:2.2480227947235107 - critic/advantages/min:-2.4599597454071045 - critic/returns/mean:0.5785232186317444 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.35546875 - critic/values/max:0.96875 - critic/values/min:-0.486328125 - critic/vf_explained_var:0.2778888940811157 - response_length/mean:296.140625 - response_length/max:512.0 - response_length/min:94.0 - response_length/clip_ratio:0.06640625 - prompt_length/mean:106.71875 - prompt_length/max:222.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.548819899559021e-06 - timing_s/generate_sequences:3.6121582984924316 - timing_s/reshard:0.5844714641571045 - timing_s/gen:4.788598780985922 - timing_s/reward:0.03627648716792464 - timing_s/old_log_prob:2.0888380762189627 - timing_s/values:1.3474192270077765 - timing_s/adv:0.03484394866973162 - timing_s/update_critic:5.579029236920178 - timing_s/update_actor:6.8186538317240775 - timing_s/step:20.70202305726707 - timing_s/stop_profile:2.0619481801986694e-06 - timing_per_token_ms/values:0.013064996577277437 - timing_per_token_ms/adv:0.00033785778099650564 - timing_per_token_ms/update_actor:0.06611579172055305 - timing_per_token_ms/update_critic:0.05409600547764203 - timing_per_token_ms/gen:0.06316412680032081 - perf/total_num_tokens:103132 - perf/time_per_step:20.70202305726707 - perf/throughput:1245.4338365230128
[36m(TaskRunner pid=2914832)[0m Training Progress:  17%|█▋        | 74/435 [27:31<2:11:57, 21.93s/it]
[36m(TaskRunner pid=2914832)[0m step:75 - global_seqlen/min:24630 - global_seqlen/max:26594 - global_seqlen/minmax_diff:1964 - global_seqlen/balanced_min:25892 - global_seqlen/balanced_max:25893 - global_seqlen/mean:25892.75 - actor/entropy:0.19444122910499573 - critic/vf_loss:0.09373038669582456 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.5262759113684297 - critic/grad_norm:36.180781841278076 - perf/mfu/critic:0.10124388746638943 - critic/lr:1e-05 - actor/pg_loss:0.2503167937975377 - actor/pg_clipfrac:0.0024509703944204375 - actor/ppo_kl:0.00016028679669943813 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.3265775442123413 - perf/mfu/actor:0.07891565444508519 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.9679069519043 - actor/lr:1e-06 - training/global_step:75 - training/epoch:2 - critic/score/mean:0.66015625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.66015625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-2.7232982535707606e-10 - critic/advantages/max:2.7958667278289795 - critic/advantages/min:-2.6281204223632812 - critic/returns/mean:0.6261259913444519 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.73046875 - critic/values/max:1.671875 - critic/values/min:-0.11181640625 - critic/vf_explained_var:0.24374371767044067 - response_length/mean:300.9453125 - response_length/max:512.0 - response_length/min:112.0 - response_length/clip_ratio:0.08203125 - prompt_length/mean:103.62890625 - prompt_length/max:202.0 - prompt_length/min:69.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.044043064117432e-06 - timing_s/generate_sequences:3.621979236602783 - timing_s/reshard:0.8823727965354919 - timing_s/gen:5.093730635009706 - timing_s/reward:0.03670562943443656 - timing_s/old_log_prob:2.473355619702488 - timing_s/values:1.723854382056743 - timing_s/adv:0.03523880522698164 - timing_s/update_critic:5.5145228728652 - timing_s/update_actor:7.071091383229941 - timing_s/step:21.956920836586505 - timing_s/stop_profile:2.3730099201202393e-06 - timing_per_token_ms/values:0.016644180147500198 - timing_per_token_ms/adv:0.0003402381480045731 - timing_per_token_ms/update_actor:0.06827288896727791 - timing_per_token_ms/update_critic:0.05324388943686167 - timing_per_token_ms/gen:0.06611628248240838 - perf/total_num_tokens:103571 - perf/time_per_step:21.956920836586505 - perf/throughput:1179.2523274418004
[36m(TaskRunner pid=2914832)[0m Training Progress:  17%|█▋        | 75/435 [27:53<2:11:40, 21.95s/it]
[36m(TaskRunner pid=2914832)[0m step:76 - global_seqlen/min:24235 - global_seqlen/max:26217 - global_seqlen/minmax_diff:1982 - global_seqlen/balanced_min:25044 - global_seqlen/balanced_max:25045 - global_seqlen/mean:25044.75 - actor/entropy:0.1939370185136795 - critic/vf_loss:0.09299721720162779 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.5604560449719429 - critic/grad_norm:21.877801656723022 - perf/mfu/critic:0.1053773291454761 - critic/lr:1e-05 - actor/pg_loss:0.10574220739363227 - actor/pg_clipfrac:0.0035201952123316005 - actor/ppo_kl:0.0003894298552040709 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.5455649495124817 - perf/mfu/actor:0.07884873145148366 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:87.89265823364258 - actor/lr:1e-06 - training/global_step:76 - training/epoch:2 - critic/score/mean:0.63671875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.63671875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:2.1527695182044226e-08 - critic/advantages/max:2.2777700424194336 - critic/advantages/min:-2.4363842010498047 - critic/returns/mean:0.5893632769584656 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.6484375 - critic/values/max:1.3828125 - critic/values/min:-0.310546875 - critic/vf_explained_var:0.2664499282836914 - response_length/mean:289.6796875 - response_length/max:512.0 - response_length/min:95.0 - response_length/clip_ratio:0.08203125 - prompt_length/mean:101.64453125 - prompt_length/max:171.0 - prompt_length/min:67.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.953945219516754e-06 - timing_s/generate_sequences:3.577360153198242 - timing_s/reshard:0.9563911557197571 - timing_s/gen:5.104677602183074 - timing_s/reward:0.034962215926498175 - timing_s/old_log_prob:2.079614403657615 - timing_s/values:1.3519878759980202 - timing_s/adv:0.03500133799389005 - timing_s/update_critic:5.117971409112215 - timing_s/update_actor:6.838320792187005 - timing_s/step:20.569279849994928 - timing_s/stop_profile:2.1173618733882904e-06 - timing_per_token_ms/values:0.013495721418640834 - timing_per_token_ms/adv:0.000349387975462822 - timing_per_token_ms/update_actor:0.06826102069482631 - timing_per_token_ms/update_critic:0.051088266094812436 - timing_per_token_ms/gen:0.06883515739614167 - perf/total_num_tokens:100179 - perf/time_per_step:20.569279849994928 - perf/throughput:1217.5803033768427
[36m(TaskRunner pid=2914832)[0m Training Progress:  17%|█▋        | 76/435 [28:14<2:08:52, 21.54s/it]
[36m(TaskRunner pid=2914832)[0m step:77 - global_seqlen/min:24807 - global_seqlen/max:28030 - global_seqlen/minmax_diff:3223 - global_seqlen/balanced_min:26410 - global_seqlen/balanced_max:26411 - global_seqlen/mean:26410.5 - actor/entropy:0.20211434364318848 - critic/vf_loss:0.11275510489940643 - critic/vf_clipfrac:0.060038778465241194 - critic/vpred_mean:0.49660523200873286 - critic/grad_norm:42.38383150100708 - perf/mfu/critic:0.1067490956178467 - critic/lr:1e-05 - actor/pg_loss:-0.0029732664115726948 - actor/pg_clipfrac:0.003255011237342842 - actor/ppo_kl:0.0002918118993875396 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.2635079622268677 - perf/mfu/actor:0.07921208492457418 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.77082443237305 - actor/lr:1e-06 - training/global_step:77 - training/epoch:2 - critic/score/mean:0.59765625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.59765625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.2482080258280348e-08 - critic/advantages/max:2.407520294189453 - critic/advantages/min:-2.8156940937042236 - critic/returns/mean:0.5568512082099915 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.27734375 - critic/values/max:1.2421875 - critic/values/min:-0.62109375 - critic/vf_explained_var:0.2854509949684143 - response_length/mean:309.1953125 - response_length/max:512.0 - response_length/min:133.0 - response_length/clip_ratio:0.12109375 - prompt_length/mean:103.46875 - prompt_length/max:180.0 - prompt_length/min:65.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.948822945356369e-06 - timing_s/generate_sequences:3.6220860481262207 - timing_s/reshard:0.7816987633705139 - timing_s/gen:5.224380685016513 - timing_s/reward:0.03792367596179247 - timing_s/old_log_prob:2.096227388828993 - timing_s/values:1.639738701749593 - timing_s/adv:0.03595344303175807 - timing_s/update_critic:5.337761382106692 - timing_s/update_actor:7.18754842504859 - timing_s/step:21.57011076528579 - timing_s/stop_profile:1.953914761543274e-06 - timing_per_token_ms/values:0.015521655229450341 - timing_per_token_ms/adv:0.0003403328508714154 - timing_per_token_ms/update_actor:0.06803684543125452 - timing_per_token_ms/update_critic:0.05052688686418935 - timing_per_token_ms/gen:0.0660027375118947 - perf/total_num_tokens:105642 - perf/time_per_step:21.57011076528579 - perf/throughput:1224.4026137549636
[36m(TaskRunner pid=2914832)[0m Training Progress:  18%|█▊        | 77/435 [28:35<2:08:36, 21.55s/it]
[36m(TaskRunner pid=2914832)[0m step:78 - global_seqlen/min:24847 - global_seqlen/max:26901 - global_seqlen/minmax_diff:2054 - global_seqlen/balanced_min:25952 - global_seqlen/balanced_max:25952 - global_seqlen/mean:25952.0 - actor/entropy:0.22485649585723877 - critic/vf_loss:0.11515138379763812 - critic/vf_clipfrac:0.016432059230282903 - critic/vpred_mean:0.8754192348569632 - critic/grad_norm:62.68072420358658 - perf/mfu/critic:0.10848980140189073 - critic/lr:1e-05 - actor/pg_loss:-0.11221924237906933 - actor/pg_clipfrac:0.003073793021030724 - actor/ppo_kl:0.0003565899569366593 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.3137773871421814 - perf/mfu/actor:0.08237334116325239 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.78491592407227 - actor/lr:1e-06 - training/global_step:78 - training/epoch:2 - critic/score/mean:0.6171875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.6171875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:2.6441849598768385e-08 - critic/advantages/max:2.505401849746704 - critic/advantages/min:-2.5999836921691895 - critic/returns/mean:0.5866981148719788 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:1.03125 - critic/values/max:1.90625 - critic/values/min:-0.1083984375 - critic/vf_explained_var:0.2723843455314636 - response_length/mean:301.35546875 - response_length/max:512.0 - response_length/min:124.0 - response_length/clip_ratio:0.06640625 - prompt_length/mean:104.14453125 - prompt_length/max:180.0 - prompt_length/min:69.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.7872384786605835e-06 - timing_s/generate_sequences:3.7346739768981934 - timing_s/reshard:0.5884430408477783 - timing_s/gen:4.988322881050408 - timing_s/reward:0.03674348024651408 - timing_s/old_log_prob:2.080365307163447 - timing_s/values:1.4002445139922202 - timing_s/adv:0.03516942588612437 - timing_s/update_critic:5.157278749160469 - timing_s/update_actor:6.78701612027362 - timing_s/step:20.493157864082605 - timing_s/stop_profile:1.9408762454986572e-06 - timing_per_token_ms/values:0.013488791942742565 - timing_per_token_ms/adv:0.00033879302063544593 - timing_per_token_ms/update_actor:0.06538047279856678 - timing_per_token_ms/update_critic:0.049680937395580965 - timing_per_token_ms/gen:0.06465997227436462 - perf/total_num_tokens:103808 - perf/time_per_step:20.493157864082605 - perf/throughput:1266.3738879152856
[36m(TaskRunner pid=2914832)[0m Training Progress:  18%|█▊        | 78/435 [28:56<2:06:22, 21.24s/it]
[36m(TaskRunner pid=2914832)[0m step:79 - global_seqlen/min:25480 - global_seqlen/max:27858 - global_seqlen/minmax_diff:2378 - global_seqlen/balanced_min:26793 - global_seqlen/balanced_max:26793 - global_seqlen/mean:26793.0 - actor/entropy:0.22290052473545074 - critic/vf_loss:0.16546370496507734 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.2534784182207659 - critic/grad_norm:82.5070161819458 - perf/mfu/critic:0.10544294648843994 - critic/lr:1e-05 - actor/pg_loss:0.046963642816990614 - actor/pg_clipfrac:0.0031449899724975694 - actor/ppo_kl:0.00017263163363168132 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.32219135761261 - perf/mfu/actor:0.08113699747089184 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.90226745605469 - actor/lr:1e-06 - training/global_step:79 - training/epoch:2 - critic/score/mean:0.625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:5.273960113072462e-08 - critic/advantages/max:2.7950406074523926 - critic/advantages/min:-3.088731050491333 - critic/returns/mean:0.5676147937774658 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.2890625 - critic/values/max:1.265625 - critic/values/min:-0.72265625 - critic/vf_explained_var:0.22365939617156982 - response_length/mean:315.17578125 - response_length/max:512.0 - response_length/min:109.0 - response_length/clip_ratio:0.109375 - prompt_length/mean:103.46484375 - prompt_length/max:199.0 - prompt_length/min:66.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.251021891832352e-06 - timing_s/generate_sequences:3.665839195251465 - timing_s/reshard:0.8905314803123474 - timing_s/gen:5.449404479004443 - timing_s/reward:0.03861571801826358 - timing_s/old_log_prob:2.1195266619324684 - timing_s/values:1.6265249089337885 - timing_s/adv:0.03339699702337384 - timing_s/update_critic:5.482367604970932 - timing_s/update_actor:7.1221332480199635 - timing_s/step:21.879593119956553 - timing_s/stop_profile:2.35019251704216e-06 - timing_per_token_ms/values:0.01517677106831811 - timing_per_token_ms/adv:0.0003116205447633136 - timing_per_token_ms/update_actor:0.06645516784253316 - timing_per_token_ms/update_critic:0.05115485019380932 - timing_per_token_ms/gen:0.0675392511495872 - perf/total_num_tokens:107172 - perf/time_per_step:21.879593119956553 - perf/throughput:1224.5657336087247
[36m(TaskRunner pid=2914832)[0m Training Progress:  18%|█▊        | 79/435 [29:18<2:07:10, 21.43s/it]
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 80}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and bakes muffins for her friends every day with four. She sells the remainder at the farmers' market daily for $2 per fresh duck egg. How much in dollars does she make every day at the farmers' market? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much money Janet makes every day at the farmers' market, we need to follow these steps:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. Calculate the number of eggs laid by the ducks in a day.
[36m(TaskRunner pid=2914832)[0m 2. Determine the number of eggs eaten in a day.
[36m(TaskRunner pid=2914832)[0m 3. Calculate the number of eggs sold in a day.
[36m(TaskRunner pid=2914832)[0m 4. Find the total revenue from selling the eggs.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Let's start with the first step:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. Janet's ducks lay 16 eggs per day.
[36m(TaskRunner pid=2914832)[0m 2. Janet eats 3 eggs for breakfast every morning. Therefore, the number of eggs eaten in a day is:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    16 - 3 = 13 \text{ eggs}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m 3. Janet bakes 4 muffins every day. Therefore, the number of eggs baked in a day is:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    4 \text{ eggs}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m 4. The number of eggs sold in a day is the remainder after subtracting the number of eggs eaten and the number of eggs baked from the total number of eggs laid. So, the number of eggs sold is:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    16 - 13 - 4 = 0 \text{ eggs}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m 5. Janet sells each egg for $2. Therefore, the total revenue from selling the eggs is:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    0 \times 2 = 0 \text{ dollars}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m So, the final answer is:
[36m(TaskRunner pid=2914832)[0m #### 0
[36m(TaskRunner pid=2914832)[0m [ground_truth] 18
[36m(TaskRunner pid=2914832)[0m [score] 0.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1312
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 80}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Tom's restaurant gets 6 reservations a night.  They normally order 2 meals that cost $5 each and a $5 bottle of wine.  How much do they make a week if they are open 2 days a week? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much Tom's restaurant makes a week, we need to follow these steps:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. Calculate the number of reservations per night.
[36m(TaskRunner pid=2914832)[0m 2. Calculate the total number of meals ordered per night.
[36m(TaskRunner pid=2914832)[0m 3. Calculate the total revenue from meals ordered per night.
[36m(TaskRunner pid=2914832)[0m 4. Calculate the total revenue from wine ordered per night.
[36m(TaskRunner pid=2914832)[0m 5. Find the total revenue per week by multiplying the revenue from meals and wine by the number of nights the restaurant is open.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Let's start with the first step:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. The restaurant gets 6 reservations a night.
[36m(TaskRunner pid=2914832)[0m 2. They normally order 2 meals that cost $5 each and a $5 bottle of wine. Therefore, the cost of the meals is:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    2 \times 5 = 10 \text{ dollars}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m    The cost of the wine is:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    5 \text{ dollars}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m    So, the total revenue from meals ordered per night is:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    10 + 5 = 15 \text{ dollars}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m 3. The restaurant is open 2 days a week, so the total revenue per week is:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    15 \times 2 = 30 \text{ dollars}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Therefore, the final answer is:
[36m(TaskRunner pid=2914832)[0m #### 30
[36m(TaskRunner pid=2914832)[0m [ground_truth] 180
[36m(TaskRunner pid=2914832)[0m [score] 0.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1319
[36m(TaskRunner pid=2914832)[0m step:80 - global_seqlen/min:26727 - global_seqlen/max:28308 - global_seqlen/minmax_diff:1581 - global_seqlen/balanced_min:27733 - global_seqlen/balanced_max:27733 - global_seqlen/mean:27733.0 - actor/entropy:0.2939286231994629 - critic/vf_loss:0.1585548777366057 - critic/vf_clipfrac:0.04546590003883466 - critic/vpred_mean:0.8962712343782187 - critic/grad_norm:60.649285316467285 - perf/mfu/critic:0.11579853500869305 - critic/lr:1e-05 - actor/pg_loss:0.03906349318276625 - actor/pg_clipfrac:0.0036908606343786232 - actor/ppo_kl:-9.18307792971973e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.309327393770218 - perf/mfu/actor:0.08699197452532727 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.10269927978516 - actor/lr:1e-06 - val-core/openai/gsm8k/reward/mean@1:0.5072024260803639 - training/global_step:80 - training/epoch:2 - critic/score/mean:0.65625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.65625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:7.985933692111757e-09 - critic/advantages/max:2.9576361179351807 - critic/advantages/min:-2.8419952392578125 - critic/returns/mean:0.6303878426551819 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.50390625 - critic/values/max:1.3828125 - critic/values/min:-0.73828125 - critic/vf_explained_var:0.14807552099227905 - response_length/mean:329.3359375 - response_length/max:512.0 - response_length/min:102.0 - response_length/clip_ratio:0.125 - prompt_length/mean:103.9921875 - prompt_length/max:174.0 - prompt_length/min:67.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.501082003116608e-06 - timing_s/generate_sequences:3.6179521083831787 - timing_s/reshard:0.9648901224136353 - timing_s/gen:5.199712228029966 - timing_s/reward:0.040987757965922356 - timing_s/old_log_prob:2.087250758893788 - timing_s/values:1.3646301981061697 - timing_s/adv:0.039882049895823 - timing_s/update_critic:5.172338818199933 - timing_s/update_actor:6.882008803077042 - timing_s/testing:14.790815248154104 - timing_s/step:35.58480630302802 - timing_s/stop_profile:2.1248124539852142e-06 - timing_per_token_ms/values:0.012301501803863355 - timing_per_token_ms/adv:0.0003595179920656168 - timing_per_token_ms/update_actor:0.062038084620100985 - timing_per_token_ms/update_critic:0.04662621081563419 - timing_per_token_ms/gen:0.061673730613568574 - perf/total_num_tokens:110932 - perf/time_per_step:35.58480630302802 - perf/throughput:779.3494719020043
[36m(TaskRunner pid=2914832)[0m Training Progress:  18%|█▊        | 80/435 [29:53<2:31:56, 25.68s/it]
[36m(TaskRunner pid=2914832)[0m step:81 - global_seqlen/min:27394 - global_seqlen/max:29444 - global_seqlen/minmax_diff:2050 - global_seqlen/balanced_min:28008 - global_seqlen/balanced_max:28009 - global_seqlen/mean:28008.25 - actor/entropy:0.24595293402671814 - critic/vf_loss:0.1594820790924132 - critic/vf_clipfrac:0.20201943814754486 - critic/vpred_mean:0.5220408872701228 - critic/grad_norm:59.82139277458191 - perf/mfu/critic:0.10941879067066826 - critic/lr:1e-05 - actor/pg_loss:0.1375549635849893 - actor/pg_clipfrac:0.003212739567970857 - actor/ppo_kl:0.00014560521140083438 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.27005934715271 - perf/mfu/actor:0.08444065714779642 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.72941207885742 - actor/lr:1e-06 - training/global_step:81 - training/epoch:2 - critic/score/mean:0.6171875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.6171875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-5.7678303022612454e-08 - critic/advantages/max:2.614380121231079 - critic/advantages/min:-2.4087836742401123 - critic/returns/mean:0.5858112573623657 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.921875 - critic/values/max:1.4453125 - critic/values/min:-0.09619140625 - critic/vf_explained_var:0.24747371673583984 - response_length/mean:332.625 - response_length/max:512.0 - response_length/min:134.0 - response_length/clip_ratio:0.12890625 - prompt_length/mean:105.00390625 - prompt_length/max:238.0 - prompt_length/min:63.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.873370587825775e-06 - timing_s/generate_sequences:3.6779510974884033 - timing_s/reshard:0.40008845925331116 - timing_s/gen:4.612350947689265 - timing_s/reward:0.039807918947190046 - timing_s/old_log_prob:2.4431777708232403 - timing_s/values:1.7316197669133544 - timing_s/adv:0.03365376219153404 - timing_s/update_critic:5.528983130119741 - timing_s/update_actor:7.160604042001069 - timing_s/step:21.564225242007524 - timing_s/stop_profile:2.6212073862552643e-06 - timing_per_token_ms/values:0.015456336676812675 - timing_per_token_ms/adv:0.00030039151135410143 - timing_per_token_ms/update_actor:0.06391513252346245 - timing_per_token_ms/update_critic:0.04935137977310026 - timing_per_token_ms/gen:0.05416609061078149 - perf/total_num_tokens:112033 - perf/time_per_step:21.564225242007524 - perf/throughput:1298.8294124028807
[36m(TaskRunner pid=2914832)[0m Training Progress:  19%|█▊        | 81/435 [30:15<2:24:15, 24.45s/it]
[36m(TaskRunner pid=2914832)[0m step:82 - global_seqlen/min:26421 - global_seqlen/max:27899 - global_seqlen/minmax_diff:1478 - global_seqlen/balanced_min:27287 - global_seqlen/balanced_max:27288 - global_seqlen/mean:27287.75 - actor/entropy:0.2556678354740143 - critic/vf_loss:0.14137938991189003 - critic/vf_clipfrac:0.14220175333321095 - critic/vpred_mean:0.37479144101962447 - critic/grad_norm:71.66338443756104 - perf/mfu/critic:0.1135431900595997 - critic/lr:1e-05 - actor/pg_loss:0.05282268486917019 - actor/pg_clipfrac:0.0033633042039582506 - actor/ppo_kl:0.000368144810636295 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.462891697883606 - perf/mfu/actor:0.08593885705633832 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.28876113891602 - actor/lr:1e-06 - training/global_step:82 - training/epoch:2 - critic/score/mean:0.63671875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.63671875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:7.741613217149279e-08 - critic/advantages/max:2.2074599266052246 - critic/advantages/min:-2.2876510620117188 - critic/returns/mean:0.6178083419799805 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.1376953125 - critic/values/max:0.5390625 - critic/values/min:-0.625 - critic/vf_explained_var:0.2477467656135559 - response_length/mean:324.06640625 - response_length/max:512.0 - response_length/min:126.0 - response_length/clip_ratio:0.15234375 - prompt_length/mean:102.3046875 - prompt_length/max:172.0 - prompt_length/min:56.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.136243999004364e-06 - timing_s/generate_sequences:3.6139590740203857 - timing_s/reshard:0.9593358039855957 - timing_s/gen:5.140131758991629 - timing_s/reward:0.03816627664491534 - timing_s/old_log_prob:2.090694047976285 - timing_s/values:1.3455943199805915 - timing_s/adv:0.03427973296493292 - timing_s/update_critic:5.1892614252865314 - timing_s/update_actor:6.8520357413217425 - timing_s/step:20.697506388183683 - timing_s/stop_profile:2.2533349692821503e-06 - timing_per_token_ms/values:0.01232782402342252 - timing_per_token_ms/adv:0.0003140578919563991 - timing_per_token_ms/update_actor:0.06277574865389912 - timing_per_token_ms/update_critic:0.0475420419903302 - timing_per_token_ms/gen:0.061958411289541215 - perf/total_num_tokens:109151 - perf/time_per_step:20.697506388183683 - perf/throughput:1318.4076133721462
[36m(TaskRunner pid=2914832)[0m Training Progress:  19%|█▉        | 82/435 [30:36<2:17:14, 23.33s/it]
[36m(TaskRunner pid=2914832)[0m step:83 - global_seqlen/min:26187 - global_seqlen/max:28510 - global_seqlen/minmax_diff:2323 - global_seqlen/balanced_min:27082 - global_seqlen/balanced_max:27083 - global_seqlen/mean:27082.75 - actor/entropy:0.21425260603427887 - critic/vf_loss:0.10367131954990327 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.7153201904147863 - critic/grad_norm:32.41844844818115 - perf/mfu/critic:0.11020658530310753 - critic/lr:1e-05 - actor/pg_loss:-0.11981657894648379 - actor/pg_clipfrac:0.004244203286361881 - actor/ppo_kl:-0.0005216966783336829 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.594018340110779 - perf/mfu/actor:0.08128035228814677 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:87.1867904663086 - actor/lr:1e-06 - training/global_step:83 - training/epoch:2 - critic/score/mean:0.65234375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.65234375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:5.215651910361885e-08 - critic/advantages/max:2.0987985134124756 - critic/advantages/min:-2.2649028301239014 - critic/returns/mean:0.6381281018257141 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.8046875 - critic/values/max:1.25 - critic/values/min:0.10400390625 - critic/vf_explained_var:0.16004997491836548 - response_length/mean:320.19921875 - response_length/max:512.0 - response_length/min:126.0 - response_length/clip_ratio:0.125 - prompt_length/mean:102.96875 - prompt_length/max:173.0 - prompt_length/min:65.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.852190613746643e-06 - timing_s/generate_sequences:3.573106527328491 - timing_s/reshard:0.5865048170089722 - timing_s/gen:5.021299629937857 - timing_s/reward:0.03674048697575927 - timing_s/old_log_prob:2.1127467579208314 - timing_s/values:1.619498603977263 - timing_s/adv:0.03398030810058117 - timing_s/update_critic:5.304616956040263 - timing_s/update_actor:7.189193214289844 - timing_s/step:21.3257147539407 - timing_s/stop_profile:1.8118880689144135e-06 - timing_per_token_ms/values:0.014949539872956615 - timing_per_token_ms/adv:0.0003136711384606546 - timing_per_token_ms/update_actor:0.06636321287802978 - timing_per_token_ms/update_critic:0.04896674964728714 - timing_per_token_ms/gen:0.06125702541066789 - perf/total_num_tokens:108331 - perf/time_per_step:21.3257147539407 - perf/throughput:1269.9574346034744
[36m(TaskRunner pid=2914832)[0m Training Progress:  19%|█▉        | 83/435 [30:57<2:13:21, 22.73s/it]
[36m(TaskRunner pid=2914832)[0m step:84 - global_seqlen/min:27406 - global_seqlen/max:28750 - global_seqlen/minmax_diff:1344 - global_seqlen/balanced_min:28015 - global_seqlen/balanced_max:28016 - global_seqlen/mean:28015.5 - actor/entropy:0.2086208313703537 - critic/vf_loss:0.10636801761575043 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.559888195246458 - critic/grad_norm:22.421442210674286 - perf/mfu/critic:0.11293491181826307 - critic/lr:1e-05 - actor/pg_loss:-0.028992435429245234 - actor/pg_clipfrac:0.0030807905495748855 - actor/ppo_kl:3.784765794989653e-06 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.3447380661964417 - perf/mfu/actor:0.08913786498180863 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:87.11795806884766 - actor/lr:1e-06 - training/global_step:84 - training/epoch:2 - critic/score/mean:0.65234375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.65234375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-2.6570829092520398e-08 - critic/advantages/max:1.9615398645401 - critic/advantages/min:-2.3073890209198 - critic/returns/mean:0.6179089546203613 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.4296875 - critic/values/max:0.82421875 - critic/values/min:-0.265625 - critic/vf_explained_var:0.19671940803527832 - response_length/mean:334.2421875 - response_length/max:512.0 - response_length/min:117.0 - response_length/clip_ratio:0.1796875 - prompt_length/mean:103.5 - prompt_length/max:185.0 - prompt_length/min:67.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.02471050620079e-06 - timing_s/generate_sequences:3.612853765487671 - timing_s/reshard:0.5815997123718262 - timing_s/gen:4.728832931257784 - timing_s/reward:0.03897009417414665 - timing_s/old_log_prob:2.0784818562678993 - timing_s/values:1.430172296706587 - timing_s/adv:0.054574099369347095 - timing_s/update_critic:5.360780444927514 - timing_s/update_actor:6.7885704091750085 - timing_s/step:20.48789028218016 - timing_s/stop_profile:7.1749091148376465e-06 - timing_per_token_ms/values:0.012762330644701924 - timing_per_token_ms/adv:0.0004869991555509191 - timing_per_token_ms/update_actor:0.06057870115806436 - timing_per_token_ms/update_critic:0.047837629570483424 - timing_per_token_ms/gen:0.055265326546265856 - perf/total_num_tokens:112062 - perf/time_per_step:20.48789028218016 - perf/throughput:1367.4175141579688
[36m(TaskRunner pid=2914832)[0m Training Progress:  19%|█▉        | 84/435 [31:18<2:09:04, 22.06s/it]
[36m(TaskRunner pid=2914832)[0m step:85 - global_seqlen/min:26884 - global_seqlen/max:29662 - global_seqlen/minmax_diff:2778 - global_seqlen/balanced_min:28227 - global_seqlen/balanced_max:28228 - global_seqlen/mean:28227.25 - actor/entropy:0.23655733466148376 - critic/vf_loss:0.13231339189223945 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.4130249531008303 - critic/grad_norm:56.87985301017761 - perf/mfu/critic:0.10638848895676256 - critic/lr:1e-05 - actor/pg_loss:-0.09053308836882934 - actor/pg_clipfrac:0.003761428175494075 - actor/ppo_kl:0.0004106913197574613 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.3957464694976807 - perf/mfu/actor:0.08743975474725406 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.84739685058594 - actor/lr:1e-06 - training/global_step:85 - training/epoch:2 - critic/score/mean:0.68359375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.68359375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:2.7183221007476277e-08 - critic/advantages/max:2.1038215160369873 - critic/advantages/min:-2.2563164234161377 - critic/returns/mean:0.6391568779945374 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.5703125 - critic/values/max:1.1015625 - critic/values/min:-0.263671875 - critic/vf_explained_var:0.20031201839447021 - response_length/mean:339.3203125 - response_length/max:512.0 - response_length/min:117.0 - response_length/clip_ratio:0.171875 - prompt_length/mean:101.73046875 - prompt_length/max:196.0 - prompt_length/min:64.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:6.844755262136459e-06 - timing_s/generate_sequences:3.6203606128692627 - timing_s/reshard:0.8961253762245178 - timing_s/gen:5.465089045930654 - timing_s/reward:0.03685028199106455 - timing_s/old_log_prob:2.125535818748176 - timing_s/values:1.6171900951303542 - timing_s/adv:0.03372579626739025 - timing_s/update_critic:5.732747117057443 - timing_s/update_actor:6.971698911860585 - timing_s/step:21.990088224876672 - timing_s/stop_profile:1.776963472366333e-06 - timing_per_token_ms/values:0.014322951183079774 - timing_per_token_ms/adv:0.0002986989191950177 - timing_per_token_ms/update_actor:0.0617461753435119 - timing_per_token_ms/update_critic:0.05077316349500432 - timing_per_token_ms/gen:0.0629140175204413 - perf/total_num_tokens:112909 - perf/time_per_step:21.990088224876672 - perf/throughput:1283.6351410390173
[36m(TaskRunner pid=2914832)[0m Training Progress:  20%|█▉        | 85/435 [31:40<2:08:35, 22.05s/it]
[36m(TaskRunner pid=2914832)[0m step:86 - global_seqlen/min:25390 - global_seqlen/max:27322 - global_seqlen/minmax_diff:1932 - global_seqlen/balanced_min:26715 - global_seqlen/balanced_max:26716 - global_seqlen/mean:26715.75 - actor/entropy:0.2059941440820694 - critic/vf_loss:0.11592259875033051 - critic/vf_clipfrac:0.00834076409228146 - critic/vpred_mean:0.8093653433024883 - critic/grad_norm:46.528005599975586 - perf/mfu/critic:0.10474774042567617 - critic/lr:1e-05 - actor/pg_loss:-0.108558997977525 - actor/pg_clipfrac:0.003911829320713878 - actor/ppo_kl:0.0006680920905637322 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.4146944880485535 - perf/mfu/actor:0.08072083531560481 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.1698989868164 - actor/lr:1e-06 - training/global_step:86 - training/epoch:2 - critic/score/mean:0.62890625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.62890625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:8.513786120545319e-09 - critic/advantages/max:2.3375749588012695 - critic/advantages/min:-2.5411365032196045 - critic/returns/mean:0.5919740796089172 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.494140625 - critic/values/max:1.09375 - critic/values/min:-0.388671875 - critic/vf_explained_var:0.19352072477340698 - response_length/mean:314.60546875 - response_length/max:512.0 - response_length/min:95.0 - response_length/clip_ratio:0.13671875 - prompt_length/mean:102.828125 - prompt_length/max:184.0 - prompt_length/min:63.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.09386882185936e-06 - timing_s/generate_sequences:3.630066156387329 - timing_s/reshard:0.9541885852813721 - timing_s/gen:5.26473899371922 - timing_s/reward:0.03683603834360838 - timing_s/old_log_prob:2.4519992996938527 - timing_s/values:1.7385121476836503 - timing_s/adv:0.03356963815167546 - timing_s/update_critic:5.503223008010536 - timing_s/update_actor:7.138278812170029 - timing_s/step:22.173982750158757 - timing_s/stop_profile:1.7639249563217163e-06 - timing_per_token_ms/values:0.016268606979812004 - timing_per_token_ms/adv:0.00031413714898211227 - timing_per_token_ms/update_actor:0.06679841303510128 - timing_per_token_ms/update_critic:0.051497927327611395 - timing_per_token_ms/gen:0.06536881503022411 - perf/total_num_tokens:106863 - perf/time_per_step:22.173982750158757 - perf/throughput:1204.8241536495614
[36m(TaskRunner pid=2914832)[0m Training Progress:  20%|█▉        | 86/435 [32:02<2:08:28, 22.09s/it]
[36m(TaskRunner pid=2914832)[0m step:87 - global_seqlen/min:25311 - global_seqlen/max:28874 - global_seqlen/minmax_diff:3563 - global_seqlen/balanced_min:27021 - global_seqlen/balanced_max:27021 - global_seqlen/mean:27021.0 - actor/entropy:0.2426546812057495 - critic/vf_loss:0.09680102963466197 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6188721805810928 - critic/grad_norm:19.96888840198517 - perf/mfu/critic:0.1065964817896774 - critic/lr:1e-05 - actor/pg_loss:-0.25444883975433186 - actor/pg_clipfrac:0.00367023867147509 - actor/ppo_kl:0.0003202097213943489 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.4947192668914795 - perf/mfu/actor:0.08589734046607464 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.25989532470703 - actor/lr:1e-06 - training/global_step:87 - training/epoch:2 - critic/score/mean:0.63671875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.63671875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:1.134923444112701e-08 - critic/advantages/max:2.7640578746795654 - critic/advantages/min:-3.340435028076172 - critic/returns/mean:0.589823305606842 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.79296875 - critic/values/max:1.6171875 - critic/values/min:-0.20703125 - critic/vf_explained_var:0.2613908052444458 - response_length/mean:319.05078125 - response_length/max:512.0 - response_length/min:127.0 - response_length/clip_ratio:0.15234375 - prompt_length/mean:103.15234375 - prompt_length/max:195.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:1.3716984540224075e-05 - timing_s/generate_sequences:3.6467695236206055 - timing_s/reshard:0.917811930179596 - timing_s/gen:5.290631602052599 - timing_s/reward:0.0375277828425169 - timing_s/old_log_prob:2.088640431407839 - timing_s/values:1.3440928012132645 - timing_s/adv:0.03411839809268713 - timing_s/update_critic:5.4726729658432305 - timing_s/update_actor:6.790246864315122 - timing_s/step:21.065396010875702 - timing_s/stop_profile:3.7550926208496094e-06 - timing_per_token_ms/values:0.01243563155705992 - timing_per_token_ms/adv:0.00031566557578075507 - timing_per_token_ms/update_actor:0.06282379320079866 - timing_per_token_ms/update_critic:0.0506335162081643 - timing_per_token_ms/gen:0.06477504808027473 - perf/total_num_tokens:108084 - perf/time_per_step:21.065396010875702 - perf/throughput:1282.7197735114746
[36m(TaskRunner pid=2914832)[0m Training Progress:  20%|██        | 87/435 [32:23<2:06:20, 21.78s/it]
[36m(TaskRunner pid=2914832)[0m step:88 - global_seqlen/min:26540 - global_seqlen/max:29189 - global_seqlen/minmax_diff:2649 - global_seqlen/balanced_min:27370 - global_seqlen/balanced_max:27371 - global_seqlen/mean:27370.75 - actor/entropy:0.19255177676677704 - critic/vf_loss:0.08387472631875426 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6458335593342781 - critic/grad_norm:19.30541491508484 - perf/mfu/critic:0.1065732624457507 - critic/lr:1e-05 - actor/pg_loss:-0.07593136059585959 - actor/pg_clipfrac:0.0034535906597739086 - actor/ppo_kl:0.0004100895403098548 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.309060573577881 - perf/mfu/actor:0.0860743000154513 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.86371994018555 - actor/lr:1e-06 - training/global_step:88 - training/epoch:3 - critic/score/mean:0.625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-2.5134445635899283e-08 - critic/advantages/max:2.6241369247436523 - critic/advantages/min:-2.6528592109680176 - critic/returns/mean:0.5937180519104004 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.6953125 - critic/values/max:1.5 - critic/values/min:-0.1455078125 - critic/vf_explained_var:0.25553756952285767 - response_length/mean:324.58984375 - response_length/max:512.0 - response_length/min:130.0 - response_length/clip_ratio:0.125 - prompt_length/mean:103.078125 - prompt_length/max:172.0 - prompt_length/min:70.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:1.2446194887161255e-05 - timing_s/generate_sequences:3.653308868408203 - timing_s/reshard:0.5897072553634644 - timing_s/gen:4.913480130955577 - timing_s/reward:0.036762760020792484 - timing_s/old_log_prob:2.0911185648292303 - timing_s/values:1.3448564768768847 - timing_s/adv:0.03779636695981026 - timing_s/update_critic:5.543628588784486 - timing_s/update_actor:6.864122080150992 - timing_s/step:20.843373915646225 - timing_s/stop_profile:1.7671845853328705e-06 - timing_per_token_ms/values:0.01228370136803782 - timing_per_token_ms/adv:0.00034522589771754755 - timing_per_token_ms/update_actor:0.06269577998548626 - timing_per_token_ms/update_critic:0.05063460618346671 - timing_per_token_ms/gen:0.059130875876473636 - perf/total_num_tokens:109483 - perf/time_per_step:20.843373915646225 - perf/throughput:1313.1631237231682
[36m(TaskRunner pid=2914832)[0m Training Progress:  20%|██        | 88/435 [32:44<2:05:09, 21.64s/it]
[36m(TaskRunner pid=2914832)[0m step:89 - global_seqlen/min:25552 - global_seqlen/max:27381 - global_seqlen/minmax_diff:1829 - global_seqlen/balanced_min:26190 - global_seqlen/balanced_max:26190 - global_seqlen/mean:26190.0 - actor/entropy:0.2548358738422394 - critic/vf_loss:0.07983042718842626 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6611059885472059 - critic/grad_norm:14.777971982955933 - perf/mfu/critic:0.10978759304758964 - critic/lr:1e-05 - actor/pg_loss:-0.021405885461717844 - actor/pg_clipfrac:0.0029828174447175115 - actor/ppo_kl:0.0003504612623146386 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.435959219932556 - perf/mfu/actor:0.08241796510622812 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.77363204956055 - actor/lr:1e-06 - training/global_step:89 - training/epoch:3 - critic/score/mean:0.6328125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.6328125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:3.5727097724702617e-08 - critic/advantages/max:2.68121337890625 - critic/advantages/min:-2.7984063625335693 - critic/returns/mean:0.605158805847168 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.51171875 - critic/values/max:1.4453125 - critic/values/min:-0.37109375 - critic/vf_explained_var:0.3413814902305603 - response_length/mean:305.3046875 - response_length/max:512.0 - response_length/min:116.0 - response_length/clip_ratio:0.09765625 - prompt_length/mean:103.9140625 - prompt_length/max:211.0 - prompt_length/min:66.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.759298801422119e-06 - timing_s/generate_sequences:3.5752062797546387 - timing_s/reshard:0.9516445398330688 - timing_s/gen:5.090824980288744 - timing_s/reward:0.03839569306001067 - timing_s/old_log_prob:2.0750336591154337 - timing_s/values:1.3371468661352992 - timing_s/adv:0.03499719314277172 - timing_s/update_critic:5.145335723180324 - timing_s/update_actor:6.8513083276338875 - timing_s/step:20.580163093749434 - timing_s/stop_profile:5.6908465921878815e-06 - timing_per_token_ms/values:0.012763906702322443 - timing_per_token_ms/adv:0.00033407019036628215 - timing_per_token_ms/update_actor:0.06540004130998366 - timing_per_token_ms/update_critic:0.049115461275108095 - timing_per_token_ms/gen:0.06513504670396816 - perf/total_num_tokens:104760 - perf/time_per_step:20.580163093749434 - perf/throughput:1272.584667123186
[36m(TaskRunner pid=2914832)[0m Training Progress:  20%|██        | 89/435 [33:05<2:03:00, 21.33s/it]
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 90}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and bakes muffins for her friends every day with four. She sells the remainder at the farmers' market daily for $2 per fresh duck egg. How much in dollars does she make every day at the farmers' market? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much money Janet makes every day at the farmers' market, we need to follow these steps:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. Calculate the number of eggs laid by the ducks in a day.
[36m(TaskRunner pid=2914832)[0m 2. Determine the number of eggs eaten in a day.
[36m(TaskRunner pid=2914832)[0m 3. Calculate the number of eggs sold in a day.
[36m(TaskRunner pid=2914832)[0m 4. Find the total revenue from selling the eggs.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Let's start with the first step:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. Janet's ducks lay 16 eggs per day.
[36m(TaskRunner pid=2914832)[0m 2. Janet eats 3 eggs for breakfast every morning. Therefore, the number of eggs eaten in a day is:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    16 - 3 = 13 \text{ eggs}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m 3. Janet bakes 4 muffins every day. Therefore, the number of eggs baked in a day is:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    4 \text{ eggs}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m 4. The number of eggs sold at the farmers' market is the remainder after subtracting the number of eggs eaten and the number of eggs baked from the total number of eggs laid. So, the number of eggs sold is:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    16 - 13 - 4 = 0 \text{ eggs}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m 5. Since the number of eggs sold is 0, the total revenue is:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    0 \text{ dollars}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Therefore, the final answer is:
[36m(TaskRunner pid=2914832)[0m #### 0
[36m(TaskRunner pid=2914832)[0m [ground_truth] 18
[36m(TaskRunner pid=2914832)[0m [score] 0.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1312
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 90}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Tom's restaurant gets 6 reservations a night.  They normally order 2 meals that cost $5 each and a $5 bottle of wine.  How much do they make a week if they are open 2 days a week? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much Tom's restaurant makes a week, we need to follow these steps:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. Calculate the number of reservations per day.
[36m(TaskRunner pid=2914832)[0m 2. Determine the total number of meals ordered per day.
[36m(TaskRunner pid=2914832)[0m 3. Calculate the total revenue from meals ordered per day.
[36m(TaskRunner pid=2914832)[0m 4. Calculate the total revenue from wine ordered per day.
[36m(TaskRunner pid=2914832)[0m 5. Find the total revenue per day by adding the revenue from meals and wine.
[36m(TaskRunner pid=2914832)[0m 6. Calculate the total revenue for the week by multiplying the daily revenue by the number of days the restaurant is open.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Let's start with the first step:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. The restaurant gets 6 reservations a night. Since they are open 2 days a week, the number of reservations per day is:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    \frac{6}{2} = 3 \text{ reservations per day}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 2. The normal order consists of 2 meals that cost $5 each and 1 bottle of wine that costs $5. Therefore, the total cost of the meals is:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    2 \times 5 = 10 \text{ dollars}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m    The total cost of the wine is:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    1 \times 5 = 5 \text{ dollars}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m    So, the total cost of the meals and wine per day is:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    10 + 5 = 15 \text{ dollars}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 3. The total revenue per day is the sum of the revenue from meals and the revenue from wine:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    15 + 15 = 30 \text{ dollars}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 4. Since the restaurant is open for 2 days a week, the total revenue for the week is:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    30 \times 2 = 60 \text{ dollars}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Therefore, the final answer is:
[36m(TaskRunner pid=2914832)[0m #### 60
[36m(TaskRunner pid=2914832)[0m [ground_truth] 180
[36m(TaskRunner pid=2914832)[0m [score] 0.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1319
[36m(TaskRunner pid=2914832)[0m step:90 - global_seqlen/min:24924 - global_seqlen/max:26998 - global_seqlen/minmax_diff:2074 - global_seqlen/balanced_min:25917 - global_seqlen/balanced_max:25917 - global_seqlen/mean:25917.0 - actor/entropy:0.22793716192245483 - critic/vf_loss:0.09657493326812983 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.7400089874863625 - critic/grad_norm:24.379546880722046 - perf/mfu/critic:0.10566075635082842 - critic/lr:1e-05 - actor/pg_loss:-0.036273428704589605 - actor/pg_clipfrac:0.003926438592316117 - actor/ppo_kl:0.0008945442914409796 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.4169614911079407 - perf/mfu/actor:0.07773989436059754 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.80301666259766 - actor/lr:1e-06 - val-core/openai/gsm8k/reward/mean@1:0.5223654283548143 - training/global_step:90 - training/epoch:3 - critic/score/mean:0.6953125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.6953125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:7.050606321001851e-09 - critic/advantages/max:2.498260974884033 - critic/advantages/min:-3.0383360385894775 - critic/returns/mean:0.6557959914207458 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.59765625 - critic/values/max:1.3203125 - critic/values/min:-0.361328125 - critic/vf_explained_var:0.2177051305770874 - response_length/mean:303.28125 - response_length/max:512.0 - response_length/min:126.0 - response_length/clip_ratio:0.09765625 - prompt_length/mean:101.671875 - prompt_length/max:183.0 - prompt_length/min:69.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.802139639854431e-06 - timing_s/generate_sequences:3.5825438499450684 - timing_s/reshard:0.6820772290229797 - timing_s/gen:5.126384316943586 - timing_s/reward:0.03699422813951969 - timing_s/old_log_prob:2.108195533975959 - timing_s/values:1.6122620073147118 - timing_s/adv:0.03376682195812464 - timing_s/update_critic:5.289170250762254 - timing_s/update_actor:7.184173624962568 - timing_s/testing:13.899324188008904 - timing_s/step:35.29749769717455 - timing_s/stop_profile:2.2943131625652313e-06 - timing_per_token_ms/values:0.015552166602179186 - timing_per_token_ms/adv:0.00032572078132234286 - timing_per_token_ms/update_actor:0.06929981889264351 - timing_per_token_ms/update_critic:0.05102027868544058 - timing_per_token_ms/gen:0.0660276187138535 - perf/total_num_tokens:103668 - perf/time_per_step:35.29749769717455 - perf/throughput:734.2446827916239
[36m(TaskRunner pid=2914832)[0m Training Progress:  21%|██        | 90/435 [33:40<2:26:45, 25.52s/it]
[36m(TaskRunner pid=2914832)[0m step:91 - global_seqlen/min:24771 - global_seqlen/max:27039 - global_seqlen/minmax_diff:2268 - global_seqlen/balanced_min:25651 - global_seqlen/balanced_max:25652 - global_seqlen/mean:25651.5 - actor/entropy:0.17310255765914917 - critic/vf_loss:0.10520915896631777 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.4933659164234996 - critic/grad_norm:29.888697385787964 - perf/mfu/critic:0.09714692880298557 - critic/lr:1e-05 - actor/pg_loss:-0.010157832875847816 - actor/pg_clipfrac:0.0032332858099834993 - actor/ppo_kl:0.0001522084266980528 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.585365802049637 - perf/mfu/actor:0.07930056892957249 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.07653045654297 - actor/lr:1e-06 - training/global_step:91 - training/epoch:3 - critic/score/mean:0.62109375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.62109375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.865506193965416e-09 - critic/advantages/max:2.5918233394622803 - critic/advantages/min:-2.3754477500915527 - critic/returns/mean:0.5805227756500244 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.65625 - critic/values/max:1.2265625 - critic/values/min:-0.1494140625 - critic/vf_explained_var:0.23670858144760132 - response_length/mean:297.54296875 - response_length/max:512.0 - response_length/min:129.0 - response_length/clip_ratio:0.08984375 - prompt_length/mean:103.26171875 - prompt_length/max:173.0 - prompt_length/min:65.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.6302953958511353e-06 - timing_s/generate_sequences:3.5464284420013428 - timing_s/reshard:0.3022253215312958 - timing_s/gen:4.721993883140385 - timing_s/reward:0.03630169993266463 - timing_s/old_log_prob:2.116604414768517 - timing_s/values:1.3438428253866732 - timing_s/adv:0.037441232707351446 - timing_s/update_critic:5.691065534949303 - timing_s/update_actor:6.970561802852899 - timing_s/step:20.925477140117437 - timing_s/stop_profile:3.2172538340091705e-06 - timing_per_token_ms/values:0.013097117375072347 - timing_per_token_ms/adv:0.0003649029560391346 - timing_per_token_ms/update_actor:0.06793522603797925 - timing_per_token_ms/update_critic:0.05546523141872115 - timing_per_token_ms/gen:0.0619920164254163 - perf/total_num_tokens:102606 - perf/time_per_step:20.925477140117437 - perf/throughput:1225.8501838804923
[36m(TaskRunner pid=2914832)[0m Training Progress:  21%|██        | 91/435 [34:01<2:18:26, 24.15s/it]
[36m(TaskRunner pid=2914832)[0m step:92 - global_seqlen/min:23571 - global_seqlen/max:26447 - global_seqlen/minmax_diff:2876 - global_seqlen/balanced_min:25111 - global_seqlen/balanced_max:25112 - global_seqlen/mean:25111.5 - actor/entropy:0.14323623478412628 - critic/vf_loss:0.1359367131954059 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.803465586155653 - critic/grad_norm:57.213542103767395 - perf/mfu/critic:0.10352303670562187 - critic/lr:1e-05 - actor/pg_loss:0.003928295103833079 - actor/pg_clipfrac:0.0032639888449921273 - actor/ppo_kl:0.00017523621727377758 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.5105408430099487 - perf/mfu/actor:0.07950111982544651 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.1024169921875 - actor/lr:1e-06 - training/global_step:92 - training/epoch:3 - critic/score/mean:0.5859375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.5859375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-5.315730966515275e-09 - critic/advantages/max:2.596590042114258 - critic/advantages/min:-2.1789562702178955 - critic/returns/mean:0.5334909558296204 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.5703125 - critic/values/max:1.046875 - critic/values/min:-0.2294921875 - critic/vf_explained_var:0.2615293264389038 - response_length/mean:289.08203125 - response_length/max:512.0 - response_length/min:121.0 - response_length/clip_ratio:0.0546875 - prompt_length/mean:103.28515625 - prompt_length/max:190.0 - prompt_length/min:66.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:6.402842700481415e-06 - timing_s/generate_sequences:3.5392587184906006 - timing_s/reshard:0.9483157396316528 - timing_s/gen:5.0404166132211685 - timing_s/reward:0.03637464391067624 - timing_s/old_log_prob:2.0798006230033934 - timing_s/values:1.3421275583095849 - timing_s/adv:0.03466172516345978 - timing_s/update_critic:5.224665764719248 - timing_s/update_actor:6.800785866100341 - timing_s/step:20.56621801527217 - timing_s/stop_profile:9.92603600025177e-06 - timing_per_token_ms/values:0.013361682479238446 - timing_per_token_ms/adv:0.0003450782028498873 - timing_per_token_ms/update_actor:0.06770589038986462 - timing_per_token_ms/update_critic:0.05201467220913972 - timing_per_token_ms/gen:0.06810913604785039 - perf/total_num_tokens:100446 - perf/time_per_step:20.56621801527217 - perf/throughput:1221.007186705527
[36m(TaskRunner pid=2914832)[0m Training Progress:  21%|██        | 92/435 [34:22<2:11:55, 23.08s/it]
[36m(TaskRunner pid=2914832)[0m step:93 - global_seqlen/min:24814 - global_seqlen/max:25755 - global_seqlen/minmax_diff:941 - global_seqlen/balanced_min:25282 - global_seqlen/balanced_max:25282 - global_seqlen/mean:25282.0 - actor/entropy:0.12804335355758667 - critic/vf_loss:0.10224050271790475 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.5621886504814029 - critic/grad_norm:30.240138053894043 - perf/mfu/critic:0.10072201732243947 - critic/lr:1e-05 - actor/pg_loss:-0.15452273120172322 - actor/pg_clipfrac:0.0033886692981468514 - actor/ppo_kl:8.390963125748385e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.603001117706299 - perf/mfu/actor:0.07606888797238348 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.64361190795898 - actor/lr:1e-06 - training/global_step:93 - training/epoch:3 - critic/score/mean:0.625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:1.9303891818367447e-08 - critic/advantages/max:2.6677770614624023 - critic/advantages/min:-2.340614080429077 - critic/returns/mean:0.586152195930481 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.75390625 - critic/values/max:1.2265625 - critic/values/min:-0.1513671875 - critic/vf_explained_var:0.3012676239013672 - response_length/mean:288.12109375 - response_length/max:512.0 - response_length/min:122.0 - response_length/clip_ratio:0.078125 - prompt_length/mean:106.91015625 - prompt_length/max:222.0 - prompt_length/min:69.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:6.204936653375626e-06 - timing_s/generate_sequences:3.621018409729004 - timing_s/reshard:0.6870520114898682 - timing_s/gen:5.1094484170898795 - timing_s/reward:0.035501295235008 - timing_s/old_log_prob:2.1308239973150194 - timing_s/values:1.6350262151099741 - timing_s/adv:0.034330046735703945 - timing_s/update_critic:5.408294124063104 - timing_s/update_actor:7.157412016764283 - timing_s/step:21.5176052977331 - timing_s/stop_profile:1.9632279872894287e-06 - timing_per_token_ms/values:0.01616788837028295 - timing_per_token_ms/adv:0.0003394712318616402 - timing_per_token_ms/update_actor:0.07077576948782022 - timing_per_token_ms/update_critic:0.05347969033366728 - timing_per_token_ms/gen:0.06927220294594394 - perf/total_num_tokens:101128 - perf/time_per_step:21.5176052977331 - perf/throughput:1174.9448718935041
[36m(TaskRunner pid=2914832)[0m Training Progress:  21%|██▏       | 93/435 [34:43<2:08:53, 22.61s/it]
[36m(TaskRunner pid=2914832)[0m step:94 - global_seqlen/min:24297 - global_seqlen/max:25538 - global_seqlen/minmax_diff:1241 - global_seqlen/balanced_min:24915 - global_seqlen/balanced_max:24916 - global_seqlen/mean:24915.75 - actor/entropy:0.15279680490493774 - critic/vf_loss:0.08291724929586053 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.5519152712076902 - critic/grad_norm:16.650075674057007 - perf/mfu/critic:0.09523007925821982 - critic/lr:1e-05 - actor/pg_loss:-0.04281753348186612 - actor/pg_clipfrac:0.003469486466201488 - actor/ppo_kl:0.00011063359761465108 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.5997544527053833 - perf/mfu/actor:0.07784813316847686 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.09091186523438 - actor/lr:1e-06 - training/global_step:94 - training/epoch:3 - critic/score/mean:0.66015625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.66015625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.1575625791238053e-08 - critic/advantages/max:2.37300443649292 - critic/advantages/min:-2.3805408477783203 - critic/returns/mean:0.5918386578559875 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.59765625 - critic/values/max:1.2109375 - critic/values/min:-0.32421875 - critic/vf_explained_var:0.3128353953361511 - response_length/mean:288.99609375 - response_length/max:512.0 - response_length/min:118.0 - response_length/clip_ratio:0.0703125 - prompt_length/mean:100.3125 - prompt_length/max:173.0 - prompt_length/min:67.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.014721632003784e-06 - timing_s/generate_sequences:3.6012582778930664 - timing_s/reshard:0.5845620632171631 - timing_s/gen:4.689007306937128 - timing_s/reward:0.03597059706225991 - timing_s/old_log_prob:2.074432765133679 - timing_s/values:1.347068001050502 - timing_s/adv:0.0339540122076869 - timing_s/update_critic:5.634169769939035 - timing_s/update_actor:6.889902213122696 - timing_s/step:20.71122841211036 - timing_s/stop_profile:1.9166618585586548e-06 - timing_per_token_ms/values:0.013516229704609554 - timing_per_token_ms/adv:0.00034068824145055737 - timing_per_token_ms/update_actor:0.06913199696098547 - timing_per_token_ms/update_critic:0.05653221125130726 - timing_per_token_ms/gen:0.06337952376812414 - perf/total_num_tokens:99663 - perf/time_per_step:20.71122841211036 - perf/throughput:1203.006866817767
[36m(TaskRunner pid=2914832)[0m Training Progress:  22%|██▏       | 94/435 [35:04<2:05:17, 22.05s/it]
[36m(TaskRunner pid=2914832)[0m step:95 - global_seqlen/min:25181 - global_seqlen/max:26904 - global_seqlen/minmax_diff:1723 - global_seqlen/balanced_min:25821 - global_seqlen/balanced_max:25822 - global_seqlen/mean:25821.5 - actor/entropy:0.1556883454322815 - critic/vf_loss:0.11270394432358444 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.616384657099843 - critic/grad_norm:18.741037130355835 - perf/mfu/critic:0.10151033734757245 - critic/lr:1e-05 - actor/pg_loss:0.11386191187193617 - actor/pg_clipfrac:0.0030739207759324927 - actor/ppo_kl:0.00019266074468760053 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.5251054763793945 - perf/mfu/actor:0.07856176518423756 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.95393753051758 - actor/lr:1e-06 - training/global_step:95 - training/epoch:3 - critic/score/mean:0.625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:5.56060042455897e-09 - critic/advantages/max:2.307295322418213 - critic/advantages/min:-2.4655680656433105 - critic/returns/mean:0.5885728597640991 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.6328125 - critic/values/max:1.265625 - critic/values/min:-0.373046875 - critic/vf_explained_var:0.14867597818374634 - response_length/mean:296.78515625 - response_length/max:512.0 - response_length/min:122.0 - response_length/clip_ratio:0.0625 - prompt_length/mean:106.67578125 - prompt_length/max:256.0 - prompt_length/min:71.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:6.151851266622543e-06 - timing_s/generate_sequences:3.547804355621338 - timing_s/reshard:0.7766653895378113 - timing_s/gen:5.109507065732032 - timing_s/reward:0.03573979623615742 - timing_s/old_log_prob:2.081495559774339 - timing_s/values:1.754909096751362 - timing_s/adv:0.0348009611479938 - timing_s/update_critic:5.482893902808428 - timing_s/update_actor:7.08245948003605 - timing_s/step:21.589559051208198 - timing_s/stop_profile:1.6521662473678589e-06 - timing_per_token_ms/values:0.01699077412961449 - timing_per_token_ms/adv:0.0003369378342465949 - timing_per_token_ms/update_actor:0.06857134054989109 - timing_per_token_ms/update_critic:0.053084579737896986 - timing_per_token_ms/gen:0.06725070831609609 - perf/total_num_tokens:103286 - perf/time_per_step:21.589559051208198 - perf/throughput:1196.0179426895231
[36m(TaskRunner pid=2914832)[0m Training Progress:  22%|██▏       | 95/435 [35:25<2:04:10, 21.91s/it]
[36m(TaskRunner pid=2914832)[0m step:96 - global_seqlen/min:23944 - global_seqlen/max:25274 - global_seqlen/minmax_diff:1330 - global_seqlen/balanced_min:24702 - global_seqlen/balanced_max:24703 - global_seqlen/mean:24702.5 - actor/entropy:0.17194096744060516 - critic/vf_loss:0.10105230705812573 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6330902148038149 - critic/grad_norm:14.623015344142914 - perf/mfu/critic:0.09861796945269084 - critic/lr:1e-05 - actor/pg_loss:0.0066862128442153335 - actor/pg_clipfrac:0.003343455304275267 - actor/ppo_kl:6.205498584677116e-05 - actor/pg_clipfrac_lower:5.3236795793054625e-05 - actor/grad_norm:2.6521589159965515 - perf/mfu/actor:0.07802690059416931 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:87.55459213256836 - actor/lr:1e-06 - training/global_step:96 - training/epoch:3 - critic/score/mean:0.64453125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.64453125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:1.4961763383780635e-08 - critic/advantages/max:2.958218574523926 - critic/advantages/min:-2.556739568710327 - critic/returns/mean:0.5895060300827026 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.71875 - critic/values/max:1.375 - critic/values/min:-0.341796875 - critic/vf_explained_var:0.28293925523757935 - response_length/mean:283.34765625 - response_length/max:512.0 - response_length/min:109.0 - response_length/clip_ratio:0.0546875 - prompt_length/mean:102.62890625 - prompt_length/max:195.0 - prompt_length/min:62.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.06499782204628e-06 - timing_s/generate_sequences:3.5357112884521484 - timing_s/reshard:0.954063355922699 - timing_s/gen:4.99682239908725 - timing_s/reward:0.035353259183466434 - timing_s/old_log_prob:2.089436477050185 - timing_s/values:1.34453390724957 - timing_s/adv:0.034707925748080015 - timing_s/update_critic:5.392084202263504 - timing_s/update_actor:6.815379666630179 - timing_s/step:20.716226644814014 - timing_s/stop_profile:1.8998980522155762e-06 - timing_per_token_ms/values:0.013607265532330432 - timing_per_token_ms/adv:0.0003512592424661473 - timing_per_token_ms/update_actor:0.06897459433893512 - timing_per_token_ms/update_critic:0.054570227732653624 - timing_per_token_ms/gen:0.06888653237778307 - perf/total_num_tokens:98810 - perf/time_per_step:20.716226644814014 - perf/throughput:1192.422752634051
[36m(TaskRunner pid=2914832)[0m Training Progress:  22%|██▏       | 96/435 [35:46<2:01:48, 21.56s/it]
[36m(TaskRunner pid=2914832)[0m step:97 - global_seqlen/min:22823 - global_seqlen/max:24225 - global_seqlen/minmax_diff:1402 - global_seqlen/balanced_min:23525 - global_seqlen/balanced_max:23526 - global_seqlen/mean:23525.75 - actor/entropy:0.11955349147319794 - critic/vf_loss:0.10692092252429575 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.5604688543826342 - critic/grad_norm:36.871063232421875 - perf/mfu/critic:0.09554403100938016 - critic/lr:1e-05 - actor/pg_loss:-0.2114745860453695 - actor/pg_clipfrac:0.0035665976429299917 - actor/ppo_kl:4.469599025469506e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.5253217220306396 - perf/mfu/actor:0.07045448681888866 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:87.00749969482422 - actor/lr:1e-06 - training/global_step:97 - training/epoch:3 - critic/score/mean:0.69140625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.69140625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.0523749871538257e-08 - critic/advantages/max:2.6943182945251465 - critic/advantages/min:-2.633810043334961 - critic/returns/mean:0.6486542224884033 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.4453125 - critic/values/max:1.0546875 - critic/values/min:-0.40625 - critic/vf_explained_var:0.2709677219390869 - response_length/mean:264.4296875 - response_length/max:512.0 - response_length/min:125.0 - response_length/clip_ratio:0.015625 - prompt_length/mean:103.16015625 - prompt_length/max:184.0 - prompt_length/min:64.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.268026143312454e-06 - timing_s/generate_sequences:3.482886791229248 - timing_s/reshard:0.6902480125427246 - timing_s/gen:5.126869200728834 - timing_s/reward:0.0340807125903666 - timing_s/old_log_prob:2.1306723919697106 - timing_s/values:1.6225075917318463 - timing_s/adv:0.03415408590808511 - timing_s/update_critic:5.293735978193581 - timing_s/update_actor:7.174074651207775 - timing_s/step:21.42336941184476 - timing_s/stop_profile:1.9581057131290436e-06 - timing_per_token_ms/values:0.017241826421387697 - timing_per_token_ms/adv:0.00036294364587829406 - timing_per_token_ms/update_actor:0.07623640745999356 - timing_per_token_ms/update_critic:0.056254699405901845 - timing_per_token_ms/gen:0.07573594706663565 - perf/total_num_tokens:94103 - perf/time_per_step:21.42336941184476 - perf/throughput:1098.1349174230668
[36m(TaskRunner pid=2914832)[0m Training Progress:  22%|██▏       | 97/435 [36:08<2:01:14, 21.52s/it]
[36m(TaskRunner pid=2914832)[0m step:98 - global_seqlen/min:23843 - global_seqlen/max:26088 - global_seqlen/minmax_diff:2245 - global_seqlen/balanced_min:24790 - global_seqlen/balanced_max:24791 - global_seqlen/mean:24790.75 - actor/entropy:0.11126331239938736 - critic/vf_loss:0.1023100505117327 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.7328028287738562 - critic/grad_norm:21.685452342033386 - perf/mfu/critic:0.0969142445555866 - critic/lr:1e-05 - actor/pg_loss:-0.06129174231318757 - actor/pg_clipfrac:0.002597648555820342 - actor/ppo_kl:0.000188998450823874 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.546753406524658 - perf/mfu/actor:0.07864290215002184 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.78551864624023 - actor/lr:1e-06 - training/global_step:98 - training/epoch:3 - critic/score/mean:0.66015625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.66015625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:9.18428266771798e-09 - critic/advantages/max:2.346622943878174 - critic/advantages/min:-2.777235507965088 - critic/returns/mean:0.6137731671333313 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.80078125 - critic/values/max:1.5078125 - critic/values/min:-0.0034027099609375 - critic/vf_explained_var:0.2495982050895691 - response_length/mean:282.30859375 - response_length/max:512.0 - response_length/min:125.0 - response_length/clip_ratio:0.03515625 - prompt_length/mean:105.046875 - prompt_length/max:212.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.658941179513931e-06 - timing_s/generate_sequences:3.5456089973449707 - timing_s/reshard:0.5785075426101685 - timing_s/gen:4.629493487998843 - timing_s/reward:0.035316784866154194 - timing_s/old_log_prob:2.070055653806776 - timing_s/values:1.339613408781588 - timing_s/adv:0.03409286495298147 - timing_s/update_critic:5.506744447629899 - timing_s/update_actor:6.782502870075405 - timing_s/step:20.404632307123393 - timing_s/stop_profile:1.914799213409424e-06 - timing_per_token_ms/values:0.013509206143234755 - timing_per_token_ms/adv:0.0003438063083305414 - timing_per_token_ms/update_actor:0.06839751590891163 - timing_per_token_ms/update_critic:0.05553224940380887 - timing_per_token_ms/gen:0.0640574156715535 - perf/total_num_tokens:99163 - perf/time_per_step:20.404632307123393 - perf/throughput:1214.9569581484388
[36m(TaskRunner pid=2914832)[0m Training Progress:  23%|██▎       | 98/435 [36:28<1:59:01, 21.19s/it]
[36m(TaskRunner pid=2914832)[0m step:99 - global_seqlen/min:24591 - global_seqlen/max:26658 - global_seqlen/minmax_diff:2067 - global_seqlen/balanced_min:25512 - global_seqlen/balanced_max:25513 - global_seqlen/mean:25512.5 - actor/entropy:0.13699781894683838 - critic/vf_loss:0.09884214005433023 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6052617412060499 - critic/grad_norm:12.554108738899231 - perf/mfu/critic:0.09994249745347122 - critic/lr:1e-05 - actor/pg_loss:0.08267651265487075 - actor/pg_clipfrac:0.00351537398819346 - actor/ppo_kl:0.00013424159806163516 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.4965453147888184 - perf/mfu/actor:0.0770258868042894 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.26453018188477 - actor/lr:1e-06 - training/global_step:99 - training/epoch:3 - critic/score/mean:0.609375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.609375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:1.3103029772310038e-08 - critic/advantages/max:2.104297399520874 - critic/advantages/min:-2.338894844055176 - critic/returns/mean:0.5512866377830505 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.65625 - critic/values/max:1.3515625 - critic/values/min:0.041015625 - critic/vf_explained_var:0.22825676202774048 - response_length/mean:293.12109375 - response_length/max:512.0 - response_length/min:131.0 - response_length/clip_ratio:0.0703125 - prompt_length/mean:105.51171875 - prompt_length/max:194.0 - prompt_length/min:66.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.135072231292725e-06 - timing_s/generate_sequences:3.609455108642578 - timing_s/reshard:0.8527413010597229 - timing_s/gen:5.48996384581551 - timing_s/reward:0.03605602402240038 - timing_s/old_log_prob:2.1266694460064173 - timing_s/values:1.6272727428004146 - timing_s/adv:0.03401237493380904 - timing_s/update_critic:5.499703350011259 - timing_s/update_actor:7.131520602852106 - timing_s/step:21.95211096527055 - timing_s/stop_profile:2.391170710325241e-06 - timing_per_token_ms/values:0.015945837754046198 - timing_per_token_ms/adv:0.0003332912781362963 - timing_per_token_ms/update_actor:0.06988261247282808 - timing_per_token_ms/update_critic:0.05389224252828279 - timing_per_token_ms/gen:0.07316147397773837 - perf/total_num_tokens:102050 - perf/time_per_step:21.95211096527055 - perf/throughput:1162.1889138753982
[36m(TaskRunner pid=2914832)[0m Training Progress:  23%|██▎       | 99/435 [36:50<1:59:57, 21.42s/it]
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 100}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and bakes muffins for her friends every day with four. She sells the remainder at the farmers' market daily for $2 per fresh duck egg. How much in dollars does she make every day at the farmers' market? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much money Janet makes every day from selling the eggs, we need to follow these steps:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. Calculate the number of eggs laid by the ducks in a day.
[36m(TaskRunner pid=2914832)[0m 2. Determine the number of eggs eaten in a day.
[36m(TaskRunner pid=2914832)[0m 3. Calculate the number of eggs sold in a day.
[36m(TaskRunner pid=2914832)[0m 4. Find the total revenue from selling the eggs.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m First, the ducks lay 16 eggs per day. Janet eats 3 eggs for breakfast and bakes 4 muffins for her friends, so the total number of eggs eaten in a day is:
[36m(TaskRunner pid=2914832)[0m \[ 3 + 4 = 7 \text{ eggs} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Therefore, the number of eggs sold in a day is the total number of eggs laid minus the number of eggs eaten:
[36m(TaskRunner pid=2914832)[0m \[ 16 - 7 = 9 \text{ eggs} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Since Janet sells each egg for $2, the total revenue from selling the eggs is:
[36m(TaskRunner pid=2914832)[0m \[ 9 \times 2 = 18 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Therefore, the final answer is:
[36m(TaskRunner pid=2914832)[0m #### 18
[36m(TaskRunner pid=2914832)[0m [ground_truth] 18
[36m(TaskRunner pid=2914832)[0m [score] 1.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1312
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 100}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Tom's restaurant gets 6 reservations a night.  They normally order 2 meals that cost $5 each and a $5 bottle of wine.  How much do they make a week if they are open 2 days a week? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much Tom's restaurant makes in a week, we need to follow these steps:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. Calculate the number of reservations per day.
[36m(TaskRunner pid=2914832)[0m 2. Determine the total number of meals ordered per day.
[36m(TaskRunner pid=2914832)[0m 3. Calculate the total revenue from meals and wine.
[36m(TaskRunner pid=2914832)[0m 4. Find the total revenue for the week.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m First, Tom's restaurant gets 6 reservations a night. Since they are open 2 days a week, the total number of reservations per week is:
[36m(TaskRunner pid=2914832)[0m \[ 6 \text{ reservations/day} \times 2 \text{ days/week} = 12 \text{ reservations/week} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Next, they order 2 meals that cost $5 each and a $5 bottle of wine per reservation. Therefore, the revenue from the meals per week is:
[36m(TaskRunner pid=2914832)[0m \[ 12 \text{ reservations/week} \times 2 \text{ meals/reservation} \times 5 \text{ dollars/meal} = 12 \times 2 \times 5 = 120 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m The revenue from the wine per week is:
[36m(TaskRunner pid=2914832)[0m \[ 12 \text{ reservations/week} \times 5 \text{ dollars/reservation} = 12 \times 5 = 60 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m The total revenue for the week is the sum of the revenue from the meals and the revenue from the wine:
[36m(TaskRunner pid=2914832)[0m \[ 120 \text{ dollars} + 60 \text{ dollars} = 180 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Therefore, the final answer is:
[36m(TaskRunner pid=2914832)[0m #### 180
[36m(TaskRunner pid=2914832)[0m [ground_truth] 180
[36m(TaskRunner pid=2914832)[0m [score] 1.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1319
[36m(TaskRunner pid=2914832)[0m step:100 - global_seqlen/min:23945 - global_seqlen/max:26115 - global_seqlen/minmax_diff:2170 - global_seqlen/balanced_min:24902 - global_seqlen/balanced_max:24903 - global_seqlen/mean:24902.5 - actor/entropy:0.1355644017457962 - critic/vf_loss:0.07998851966112852 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.5974845867604017 - critic/grad_norm:9.666303277015686 - perf/mfu/critic:0.09959173182412845 - critic/lr:1e-05 - actor/pg_loss:-0.147780935280025 - actor/pg_clipfrac:0.003574392874725163 - actor/ppo_kl:3.3484326195321046e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.4883835911750793 - perf/mfu/actor:0.07885645630893354 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.31758499145508 - actor/lr:1e-06 - val-core/openai/gsm8k/reward/mean@1:0.5269143290371494 - training/global_step:100 - training/epoch:3 - critic/score/mean:0.62890625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.62890625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.087208101324677e-08 - critic/advantages/max:1.990472435951233 - critic/advantages/min:-2.309483289718628 - critic/returns/mean:0.5772298574447632 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.6171875 - critic/values/max:1.15625 - critic/values/min:0.080078125 - critic/vf_explained_var:0.2466457486152649 - response_length/mean:284.0546875 - response_length/max:512.0 - response_length/min:128.0 - response_length/clip_ratio:0.03515625 - prompt_length/mean:105.046875 - prompt_length/max:191.0 - prompt_length/min:66.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.191882908344269e-06 - timing_s/generate_sequences:3.5846431255340576 - timing_s/reshard:0.9698731303215027 - timing_s/gen:5.276423254050314 - timing_s/reward:0.040883890353143215 - timing_s/old_log_prob:2.086425834801048 - timing_s/values:1.3445127252489328 - timing_s/adv:0.038701510056853294 - timing_s/update_critic:5.382674298249185 - timing_s/update_actor:6.796360575128347 - timing_s/testing:13.689655848778784 - timing_s/step:34.66239901492372 - timing_s/stop_profile:2.6491470634937286e-06 - timing_per_token_ms/values:0.01349776854983368 - timing_per_token_ms/adv:0.00038853036900766285 - timing_per_token_ms/update_actor:0.06822970158747461 - timing_per_token_ms/update_critic:0.05403748919033415 - timing_per_token_ms/gen:0.07256007115226373 - perf/total_num_tokens:99610 - perf/time_per_step:34.66239901492372 - perf/throughput:718.4297886963436
[36m(TaskRunner pid=2914832)[0m Training Progress:  23%|██▎       | 100/435 [37:25<2:21:48, 25.40s/it]
[36m(TaskRunner pid=2914832)[0m step:101 - global_seqlen/min:24254 - global_seqlen/max:25896 - global_seqlen/minmax_diff:1642 - global_seqlen/balanced_min:25359 - global_seqlen/balanced_max:25360 - global_seqlen/mean:25359.5 - actor/entropy:0.12499658018350601 - critic/vf_loss:0.07782853010576218 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.5547072645276785 - critic/grad_norm:17.687543869018555 - perf/mfu/critic:0.09913119609938097 - critic/lr:1e-05 - actor/pg_loss:0.18864878121530637 - actor/pg_clipfrac:0.002100675155816134 - actor/ppo_kl:0.0003302221612102585 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.4154638051986694 - perf/mfu/actor:0.08049999428823604 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:86.98035430908203 - actor/lr:1e-06 - training/global_step:101 - training/epoch:3 - critic/score/mean:0.5546875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.5546875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.4344043286484975e-08 - critic/advantages/max:2.5658881664276123 - critic/advantages/min:-2.3420333862304688 - critic/returns/mean:0.48477819561958313 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.62109375 - critic/values/max:1.234375 - critic/values/min:-0.07373046875 - critic/vf_explained_var:0.350990891456604 - response_length/mean:291.39453125 - response_length/max:512.0 - response_length/min:120.0 - response_length/clip_ratio:0.0625 - prompt_length/mean:104.84765625 - prompt_length/max:196.0 - prompt_length/min:70.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.556961357593536e-06 - timing_s/generate_sequences:3.554940938949585 - timing_s/reshard:0.30304569005966187 - timing_s/gen:4.405592334922403 - timing_s/reward:0.03490123385563493 - timing_s/old_log_prob:2.075375633314252 - timing_s/values:1.343144552782178 - timing_s/adv:0.03639107011258602 - timing_s/update_critic:5.516678075771779 - timing_s/update_actor:6.785904763266444 - timing_s/step:20.205307165626436 - timing_s/stop_profile:2.7730129659175873e-06 - timing_per_token_ms/values:0.013241039381515584 - timing_per_token_ms/adv:0.0003587518495296242 - timing_per_token_ms/update_actor:0.06689706779773304 - timing_per_token_ms/update_critic:0.05438472836384569 - timing_per_token_ms/gen:0.05905857252868618 - perf/total_num_tokens:101438 - perf/time_per_step:20.205307165626436 - perf/throughput:1255.0910407906074
[36m(TaskRunner pid=2914832)[0m Training Progress:  23%|██▎       | 101/435 [37:45<2:12:44, 23.84s/it]
[36m(TaskRunner pid=2914832)[0m step:102 - global_seqlen/min:23099 - global_seqlen/max:25496 - global_seqlen/minmax_diff:2397 - global_seqlen/balanced_min:24536 - global_seqlen/balanced_max:24537 - global_seqlen/mean:24536.25 - actor/entropy:0.12258229404687881 - critic/vf_loss:0.08729398949071765 - critic/vf_clipfrac:0.0004905166570097208 - critic/vpred_mean:0.5999092543497682 - critic/grad_norm:24.718350052833557 - perf/mfu/critic:0.10095829741486084 - critic/lr:1e-05 - actor/pg_loss:-0.15789246920030564 - actor/pg_clipfrac:0.003347186022438109 - actor/ppo_kl:0.0002842745404905145 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.7319140434265137 - perf/mfu/actor:0.0771853796965716 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:87.90998077392578 - actor/lr:1e-06 - training/global_step:102 - training/epoch:3 - critic/score/mean:0.61328125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.61328125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:3.940011694680834e-08 - critic/advantages/max:2.7405877113342285 - critic/advantages/min:-2.673739433288574 - critic/returns/mean:0.5445558428764343 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.431640625 - critic/values/max:1.15625 - critic/values/min:-0.56640625 - critic/vf_explained_var:0.32948100566864014 - response_length/mean:280.15234375 - response_length/max:512.0 - response_length/min:118.0 - response_length/clip_ratio:0.05859375 - prompt_length/mean:103.2265625 - prompt_length/max:189.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:6.0889869928359985e-06 - timing_s/generate_sequences:3.524684429168701 - timing_s/reshard:0.8626219034194946 - timing_s/gen:4.907375080976635 - timing_s/reward:0.03487269813194871 - timing_s/old_log_prob:2.0727668893523514 - timing_s/values:1.3388389851897955 - timing_s/adv:0.03273347904905677 - timing_s/update_critic:5.231387701816857 - timing_s/update_actor:6.840242890175432 - timing_s/step:20.464842508081347 - timing_s/stop_profile:1.933891326189041e-06 - timing_per_token_ms/values:0.013641438536754756 - timing_per_token_ms/adv:0.00033352161647620123 - timing_per_token_ms/update_actor:0.06969527627668685 - timing_per_token_ms/update_critic:0.05330264100888336 - timing_per_token_ms/gen:0.06842503494160035 - perf/total_num_tokens:98145 - perf/time_per_step:20.464842508081347 - perf/throughput:1198.9464365685149
[36m(TaskRunner pid=2914832)[0m Training Progress:  23%|██▎       | 102/435 [38:05<2:06:43, 22.83s/it]
[36m(TaskRunner pid=2914832)[0m step:103 - global_seqlen/min:23363 - global_seqlen/max:24311 - global_seqlen/minmax_diff:948 - global_seqlen/balanced_min:23779 - global_seqlen/balanced_max:23780 - global_seqlen/mean:23779.75 - actor/entropy:0.10419168323278427 - critic/vf_loss:0.10226608847733587 - critic/vf_clipfrac:0.04092475236393511 - critic/vpred_mean:0.7203909456729889 - critic/grad_norm:40.52528715133667 - perf/mfu/critic:0.09665411216735711 - critic/lr:1e-05 - actor/pg_loss:0.08956436906009912 - actor/pg_clipfrac:0.0028446969663491473 - actor/ppo_kl:0.0003322717529954389 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.092424690723419 - perf/mfu/actor:0.07128093887217472 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.42318344116211 - actor/lr:1e-06 - training/global_step:103 - training/epoch:3 - critic/score/mean:0.64453125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.64453125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:1.8937216239578447e-08 - critic/advantages/max:2.6097538471221924 - critic/advantages/min:-2.6330766677856445 - critic/returns/mean:0.5923724174499512 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.90234375 - critic/values/max:1.4609375 - critic/values/min:-0.0118408203125 - critic/vf_explained_var:0.28294575214385986 - response_length/mean:270.09375 - response_length/max:512.0 - response_length/min:119.0 - response_length/clip_ratio:0.01953125 - prompt_length/mean:101.46484375 - prompt_length/max:175.0 - prompt_length/min:65.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.20702451467514e-06 - timing_s/generate_sequences:3.5162792205810547 - timing_s/reshard:0.5843410491943359 - timing_s/gen:5.024027117993683 - timing_s/reward:0.033806085120886564 - timing_s/old_log_prob:2.139360758010298 - timing_s/values:1.6215809071436524 - timing_s/adv:0.0333251990377903 - timing_s/update_critic:5.290615625679493 - timing_s/update_actor:7.168803026434034 - timing_s/step:21.318221150897443 - timing_s/stop_profile:8.372124284505844e-06 - timing_per_token_ms/values:0.017047917946400325 - timing_per_token_ms/adv:0.0003503527059555956 - timing_per_token_ms/update_actor:0.07536667780815645 - timing_per_token_ms/update_critic:0.055621018152834795 - timing_per_token_ms/gen:0.07266034822968996 - perf/total_num_tokens:95119 - perf/time_per_step:21.318221150897443 - perf/throughput:1115.4659589878086
[36m(TaskRunner pid=2914832)[0m Training Progress:  24%|██▎       | 103/435 [38:27<2:03:50, 22.38s/it]
[36m(TaskRunner pid=2914832)[0m step:104 - global_seqlen/min:23854 - global_seqlen/max:25165 - global_seqlen/minmax_diff:1311 - global_seqlen/balanced_min:24550 - global_seqlen/balanced_max:24551 - global_seqlen/mean:24550.5 - actor/entropy:0.12732145190238953 - critic/vf_loss:0.12513620941899717 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.35899284202605486 - critic/grad_norm:55.634748458862305 - perf/mfu/critic:0.09334791290091908 - critic/lr:1e-05 - actor/pg_loss:0.04537315397465136 - actor/pg_clipfrac:0.0029212668450782076 - actor/ppo_kl:-0.0001636005554246367 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.797156274318695 - perf/mfu/actor:0.07677510359544652 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.51523971557617 - actor/lr:1e-06 - training/global_step:104 - training/epoch:3 - critic/score/mean:0.66796875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.66796875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:5.3520839315979174e-08 - critic/advantages/max:1.9633069038391113 - critic/advantages/min:-2.289538621902466 - critic/returns/mean:0.6179831624031067 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.271484375 - critic/values/max:0.75390625 - critic/values/min:-0.390625 - critic/vf_explained_var:0.21148335933685303 - response_length/mean:279.94921875 - response_length/max:512.0 - response_length/min:116.0 - response_length/clip_ratio:0.04296875 - prompt_length/mean:103.65234375 - prompt_length/max:186.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:6.318558007478714e-06 - timing_s/generate_sequences:3.5718281269073486 - timing_s/reshard:0.5807769298553467 - timing_s/gen:4.669123208615929 - timing_s/reward:0.03427342185750604 - timing_s/old_log_prob:2.075058857910335 - timing_s/values:1.3537992117926478 - timing_s/adv:0.03298759879544377 - timing_s/update_critic:5.658661539200693 - timing_s/update_actor:6.877552427817136 - timing_s/step:20.70790042122826 - timing_s/stop_profile:1.6111880540847778e-06 - timing_per_token_ms/values:0.013785861915161075 - timing_per_token_ms/adv:0.0003359157531969183 - timing_per_token_ms/update_actor:0.07003474906638496 - timing_per_token_ms/update_critic:0.05762267101689063 - timing_per_token_ms/gen:0.06515025337485773 - perf/total_num_tokens:98202 - perf/time_per_step:20.70790042122826 - perf/throughput:1185.562007765528
[36m(TaskRunner pid=2914832)[0m Training Progress:  24%|██▍       | 104/435 [38:47<2:00:44, 21.89s/it]
[36m(TaskRunner pid=2914832)[0m step:105 - global_seqlen/min:24089 - global_seqlen/max:25337 - global_seqlen/minmax_diff:1248 - global_seqlen/balanced_min:24586 - global_seqlen/balanced_max:24587 - global_seqlen/mean:24586.75 - actor/entropy:0.1269744485616684 - critic/vf_loss:0.14154609691468067 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.9207665957510471 - critic/grad_norm:57.218592166900635 - perf/mfu/critic:0.10296553429533813 - critic/lr:1e-05 - actor/pg_loss:0.05635568918660283 - actor/pg_clipfrac:0.0028748444747179747 - actor/ppo_kl:0.0005443331101560034 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.4393714666366577 - perf/mfu/actor:0.07628004107226097 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.09213256835938 - actor/lr:1e-06 - training/global_step:105 - training/epoch:3 - critic/score/mean:0.6953125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.6953125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-9.150562974014065e-09 - critic/advantages/max:2.04003643989563 - critic/advantages/min:-2.4980971813201904 - critic/returns/mean:0.6425214409828186 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.828125 - critic/values/max:1.265625 - critic/values/min:0.20703125 - critic/vf_explained_var:0.2660953402519226 - response_length/mean:280.90625 - response_length/max:512.0 - response_length/min:110.0 - response_length/clip_ratio:0.04296875 - prompt_length/mean:103.26171875 - prompt_length/max:180.0 - prompt_length/min:67.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:6.1141327023506165e-06 - timing_s/generate_sequences:3.5569844245910645 - timing_s/reshard:0.7722640633583069 - timing_s/gen:5.208999964874238 - timing_s/reward:0.03458740282803774 - timing_s/old_log_prob:2.127262436784804 - timing_s/values:1.623730847146362 - timing_s/adv:0.033375582192093134 - timing_s/update_critic:5.138762698043138 - timing_s/update_actor:6.932080141268671 - timing_s/step:21.105535714887083 - timing_s/stop_profile:2.2314488887786865e-06 - timing_per_token_ms/values:0.01651022244853795 - timing_per_token_ms/adv:0.0003393655342012785 - timing_per_token_ms/update_actor:0.07048593390005461 - timing_per_token_ms/update_critic:0.052251341658038755 - timing_per_token_ms/gen:0.0724357543229814 - perf/total_num_tokens:98347 - perf/time_per_step:21.105535714887083 - perf/throughput:1164.9431851501117
[36m(TaskRunner pid=2914832)[0m Training Progress:  24%|██▍       | 105/435 [39:09<1:59:06, 21.66s/it]
[36m(TaskRunner pid=2914832)[0m step:106 - global_seqlen/min:24717 - global_seqlen/max:26491 - global_seqlen/minmax_diff:1774 - global_seqlen/balanced_min:25189 - global_seqlen/balanced_max:25190 - global_seqlen/mean:25189.75 - actor/entropy:0.12256527692079544 - critic/vf_loss:0.1191713351290673 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.459478541277349 - critic/grad_norm:33.020652770996094 - perf/mfu/critic:0.10170436704218644 - critic/lr:1e-05 - actor/pg_loss:-0.16945505770854652 - actor/pg_clipfrac:0.0034733152569970116 - actor/ppo_kl:0.0005209623886912595 - actor/pg_clipfrac_lower:4.86381322843954e-05 - actor/grad_norm:2.8255914449691772 - perf/mfu/actor:0.07628305258868441 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.87044525146484 - actor/lr:1e-06 - training/global_step:106 - training/epoch:3 - critic/score/mean:0.6171875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.6171875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:4.040333934085538e-08 - critic/advantages/max:2.0667507648468018 - critic/advantages/min:-2.250992774963379 - critic/returns/mean:0.5539444088935852 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.70703125 - critic/values/max:1.140625 - critic/values/min:0.10205078125 - critic/vf_explained_var:0.22327560186386108 - response_length/mean:287.44140625 - response_length/max:512.0 - response_length/min:98.0 - response_length/clip_ratio:0.0703125 - prompt_length/mean:106.1484375 - prompt_length/max:199.0 - prompt_length/min:64.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.636123776435852e-06 - timing_s/generate_sequences:3.538412094116211 - timing_s/reshard:0.5822887420654297 - timing_s/gen:4.6442768620327115 - timing_s/reward:0.03601057780906558 - timing_s/old_log_prob:2.0770695442333817 - timing_s/values:1.3442825227975845 - timing_s/adv:0.03509004833176732 - timing_s/update_critic:5.33545245276764 - timing_s/update_actor:7.111292341724038 - timing_s/step:20.591527346055955 - timing_s/stop_profile:2.0549632608890533e-06 - timing_per_token_ms/values:0.013341562766577521 - timing_per_token_ms/adv:0.000348257211085534 - timing_per_token_ms/update_actor:0.070577242149327 - timing_per_token_ms/update_critic:0.05295261418600463 - timing_per_token_ms/gen:0.06311445079884095 - perf/total_num_tokens:100759 - perf/time_per_step:20.591527346055955 - perf/throughput:1223.3065365510527
[36m(TaskRunner pid=2914832)[0m Training Progress:  24%|██▍       | 106/435 [39:29<1:57:00, 21.34s/it]
[36m(TaskRunner pid=2914832)[0m step:107 - global_seqlen/min:24897 - global_seqlen/max:25420 - global_seqlen/minmax_diff:523 - global_seqlen/balanced_min:25205 - global_seqlen/balanced_max:25206 - global_seqlen/mean:25205.25 - actor/entropy:0.09991542249917984 - critic/vf_loss:0.08154780510812998 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.5559139177203178 - critic/grad_norm:12.65392293035984 - perf/mfu/critic:0.1019831934970372 - critic/lr:1e-05 - actor/pg_loss:-0.003282878315076232 - actor/pg_clipfrac:0.003348932212247746 - actor/ppo_kl:0.00016301121650030836 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.817279100418091 - perf/mfu/actor:0.07662790529625199 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.08614349365234 - actor/lr:1e-06 - training/global_step:107 - training/epoch:3 - critic/score/mean:0.6171875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.6171875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.4013226135034529e-08 - critic/advantages/max:2.1594104766845703 - critic/advantages/min:-2.209311008453369 - critic/returns/mean:0.5415899157524109 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.392578125 - critic/values/max:0.7890625 - critic/values/min:-0.15234375 - critic/vf_explained_var:0.27500396966934204 - response_length/mean:288.4375 - response_length/max:512.0 - response_length/min:122.0 - response_length/clip_ratio:0.05078125 - prompt_length/mean:105.39453125 - prompt_length/max:238.0 - prompt_length/min:63.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.057081580162048e-06 - timing_s/generate_sequences:3.58373761177063 - timing_s/reshard:0.9538795948028564 - timing_s/gen:5.225626226980239 - timing_s/reward:0.03788570920005441 - timing_s/old_log_prob:2.4119823738001287 - timing_s/values:1.3592897970229387 - timing_s/adv:0.033925489988178015 - timing_s/update_critic:5.322471427265555 - timing_s/update_actor:7.080804822035134 - timing_s/step:21.47939788689837 - timing_s/stop_profile:3.2801181077957153e-06 - timing_per_token_ms/values:0.013482209034059757 - timing_per_token_ms/adv:0.00033649229811426204 - timing_per_token_ms/update_actor:0.07023144803200855 - timing_per_token_ms/update_critic:0.052791297718387586 - timing_per_token_ms/gen:0.07076958595585373 - perf/total_num_tokens:100821 - perf/time_per_step:21.47939788689837 - perf/throughput:1173.4616646481632
[36m(TaskRunner pid=2914832)[0m Training Progress:  25%|██▍       | 107/435 [39:51<1:56:54, 21.38s/it]
[36m(TaskRunner pid=2914832)[0m step:108 - global_seqlen/min:22874 - global_seqlen/max:25648 - global_seqlen/minmax_diff:2774 - global_seqlen/balanced_min:23710 - global_seqlen/balanced_max:23710 - global_seqlen/mean:23710.0 - actor/entropy:0.09975340962409973 - critic/vf_loss:0.06615861973841675 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.7543181739747524 - critic/grad_norm:19.851232290267944 - perf/mfu/critic:0.09745371458522775 - critic/lr:1e-05 - actor/pg_loss:-0.0865327178617008 - actor/pg_clipfrac:0.0035939378140028566 - actor/ppo_kl:0.00021920498568306357 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.5429811477661133 - perf/mfu/actor:0.07117979371030846 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.06695938110352 - actor/lr:1e-06 - training/global_step:108 - training/epoch:3 - critic/score/mean:0.69140625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.69140625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-2.859721881520727e-08 - critic/advantages/max:2.479229688644409 - critic/advantages/min:-2.5034453868865967 - critic/returns/mean:0.6509913206100464 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.56640625 - critic/values/max:1.046875 - critic/values/min:-0.177734375 - critic/vf_explained_var:0.21196889877319336 - response_length/mean:269.1328125 - response_length/max:512.0 - response_length/min:115.0 - response_length/clip_ratio:0.03125 - prompt_length/mean:101.3359375 - prompt_length/max:170.0 - prompt_length/min:66.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.8959627747535706e-06 - timing_s/generate_sequences:3.499926805496216 - timing_s/reshard:0.5848181843757629 - timing_s/gen:4.668203935958445 - timing_s/reward:0.03545059775933623 - timing_s/old_log_prob:2.0808575730770826 - timing_s/values:1.3408231241628528 - timing_s/adv:0.03443796979263425 - timing_s/update_critic:5.230800616089255 - timing_s/update_actor:7.158375733997673 - timing_s/step:20.556645133066922 - timing_s/stop_profile:5.9623271226882935e-06 - timing_per_token_ms/values:0.014137738550852517 - timing_per_token_ms/adv:0.00036311650983376475 - timing_per_token_ms/update_actor:0.07547844510752502 - timing_per_token_ms/update_critic:0.055153949979852956 - timing_per_token_ms/gen:0.06775528949981778 - perf/total_num_tokens:94840 - perf/time_per_step:20.556645133066922 - perf/throughput:1153.3983218818457
[36m(TaskRunner pid=2914832)[0m Training Progress:  25%|██▍       | 108/435 [40:11<1:55:12, 21.14s/it]
[36m(TaskRunner pid=2914832)[0m step:109 - global_seqlen/min:23413 - global_seqlen/max:25126 - global_seqlen/minmax_diff:1713 - global_seqlen/balanced_min:24360 - global_seqlen/balanced_max:24361 - global_seqlen/mean:24360.75 - actor/entropy:0.09575288742780685 - critic/vf_loss:0.10187775688245893 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6144804013893008 - critic/grad_norm:11.88887619972229 - perf/mfu/critic:0.0976863160160132 - critic/lr:1e-05 - actor/pg_loss:0.05304065009113401 - actor/pg_clipfrac:0.0034860932719311677 - actor/ppo_kl:0.00040241975420940435 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.5961313247680664 - perf/mfu/actor:0.07721930627122865 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.20936965942383 - actor/lr:1e-06 - training/global_step:109 - training/epoch:3 - critic/score/mean:0.640625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.640625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:6.242458550076435e-09 - critic/advantages/max:2.733264207839966 - critic/advantages/min:-3.3375251293182373 - critic/returns/mean:0.5753677487373352 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.578125 - critic/values/max:1.6015625 - critic/values/min:-0.50390625 - critic/vf_explained_var:0.20952391624450684 - response_length/mean:275.109375 - response_length/max:512.0 - response_length/min:131.0 - response_length/clip_ratio:0.03515625 - prompt_length/mean:105.52734375 - prompt_length/max:215.0 - prompt_length/min:66.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:6.063841283321381e-06 - timing_s/generate_sequences:3.5692496299743652 - timing_s/reshard:0.5820761919021606 - timing_s/gen:4.718221176881343 - timing_s/reward:0.03394154878333211 - timing_s/old_log_prob:2.0750223137438297 - timing_s/values:1.3676498108543456 - timing_s/adv:0.03286082483828068 - timing_s/update_critic:5.365849842783064 - timing_s/update_actor:6.785355519037694 - timing_s/step:20.38675739429891 - timing_s/stop_profile:2.190936356782913e-06 - timing_per_token_ms/values:0.014035382847965945 - timing_per_token_ms/adv:0.00033723125148323307 - timing_per_token_ms/update_actor:0.06963409910447844 - timing_per_token_ms/update_critic:0.055066550114252065 - timing_per_token_ms/gen:0.06699354201285487 - perf/total_num_tokens:97443 - perf/time_per_step:20.38675739429891 - perf/throughput:1194.930097456911
[36m(TaskRunner pid=2914832)[0m Training Progress:  25%|██▌       | 109/435 [40:32<1:53:39, 20.92s/it]
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 110}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and bakes muffins for her friends every day with four. She sells the remainder at the farmers' market daily for $2 per fresh duck egg. How much in dollars does she make every day at the farmers' market? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much money Janet makes every day from selling the eggs at the farmers' market, we need to follow these steps:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. Calculate the total number of eggs laid by the ducks in a day.
[36m(TaskRunner pid=2914832)[0m 2. Subtract the number of eggs eaten in a day and the number of eggs baked.
[36m(TaskRunner pid=2914832)[0m 3. Determine the number of eggs sold at the farmers' market.
[36m(TaskRunner pid=2914832)[0m 4. Calculate the total revenue from selling the eggs.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Let's start with the first step:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. Janet's ducks lay 16 eggs per day.
[36m(TaskRunner pid=2914832)[0m 2. Janet eats 3 eggs for breakfast every morning, so the number of eggs eaten in a day is:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    16 - 3 = 13 \text{ eggs}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m 3. Janet bakes 4 muffins every day, so the number of eggs baked is:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    16 - 3 - 4 = 10 \text{ eggs}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m 4. The remainder of the eggs sold at the farmers' market is:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    16 - 13 - 10 = 3 \text{ eggs}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m 5. Janet sells each egg for $2, so the total revenue is:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    3 \times 2 = 6 \text{ dollars}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Therefore, the final answer is:
[36m(TaskRunner pid=2914832)[0m #### 6
[36m(TaskRunner pid=2914832)[0m [ground_truth] 18
[36m(TaskRunner pid=2914832)[0m [score] 0.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1312
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 110}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Tom's restaurant gets 6 reservations a night.  They normally order 2 meals that cost $5 each and a $5 bottle of wine.  How much do they make a week if they are open 2 days a week? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much Tom's restaurant makes a week, we need to follow these steps:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. Calculate the total number of reservations per night.
[36m(TaskRunner pid=2914832)[0m 2. Determine the total number of meals ordered per night.
[36m(TaskRunner pid=2914832)[0m 3. Calculate the total revenue from meals.
[36m(TaskRunner pid=2914832)[0m 4. Calculate the total revenue from wine.
[36m(TaskRunner pid=2914832)[0m 5. Add the revenue from meals and wine to get the total revenue for the week.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Let's start with the first step:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. The restaurant gets 6 reservations a night.
[36m(TaskRunner pid=2914832)[0m 2. They order 2 meals that cost $5 each and a $5 bottle of wine per meal.
[36m(TaskRunner pid=2914832)[0m    - The cost of the meals is \(2 \times 5 = 10\) dollars.
[36m(TaskRunner pid=2914832)[0m    - The cost of the wine is \(2 \times 5 = 10\) dollars.
[36m(TaskRunner pid=2914832)[0m    - Therefore, the total revenue from meals is \(10 + 10 = 20\) dollars.
[36m(TaskRunner pid=2914832)[0m 3. The normal price of a bottle of wine is $5.
[36m(TaskRunner pid=2914832)[0m    - Therefore, the total revenue from wine is \(5\) dollars.
[36m(TaskRunner pid=2914832)[0m 4. The total revenue per night is the sum of the revenue from meals and the revenue from wine:
[36m(TaskRunner pid=2914832)[0m    - Total revenue per night = \(20 + 5 = 25\) dollars.
[36m(TaskRunner pid=2914832)[0m 5. The restaurant is open 2 days a week, so the total revenue for the week is:
[36m(TaskRunner pid=2914832)[0m    - Total revenue for the week = \(25 \times 2 = 50\) dollars.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Therefore, the final answer is:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m #### 50
[36m(TaskRunner pid=2914832)[0m [ground_truth] 180
[36m(TaskRunner pid=2914832)[0m [score] 0.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1319
[36m(TaskRunner pid=2914832)[0m step:110 - global_seqlen/min:23693 - global_seqlen/max:24840 - global_seqlen/minmax_diff:1147 - global_seqlen/balanced_min:24265 - global_seqlen/balanced_max:24265 - global_seqlen/mean:24265.0 - actor/entropy:0.11190833896398544 - critic/vf_loss:0.10648869001306593 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.573710560798645 - critic/grad_norm:19.590378761291504 - perf/mfu/critic:0.10144153144933502 - critic/lr:1e-05 - actor/pg_loss:-0.08455047174356878 - actor/pg_clipfrac:0.004544960902421735 - actor/ppo_kl:3.962124736744954e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.7398234605789185 - perf/mfu/actor:0.07682701156343746 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.01725387573242 - actor/lr:1e-06 - val-core/openai/gsm8k/reward/mean@1:0.5223654283548143 - training/global_step:110 - training/epoch:3 - critic/score/mean:0.6328125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.6328125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.6460775853488485e-08 - critic/advantages/max:2.8518431186676025 - critic/advantages/min:-2.7361321449279785 - critic/returns/mean:0.568391740322113 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.55859375 - critic/values/max:1.4921875 - critic/values/min:-0.404296875 - critic/vf_explained_var:0.17648470401763916 - response_length/mean:276.5546875 - response_length/max:512.0 - response_length/min:119.0 - response_length/clip_ratio:0.05859375 - prompt_length/mean:102.5859375 - prompt_length/max:184.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.830995410680771e-06 - timing_s/generate_sequences:3.565166473388672 - timing_s/reshard:0.8555802702903748 - timing_s/gen:4.966615001205355 - timing_s/reward:0.0343390591442585 - timing_s/old_log_prob:2.3946699048392475 - timing_s/values:1.349564194213599 - timing_s/adv:0.038676085881888866 - timing_s/update_critic:5.150731808040291 - timing_s/update_actor:6.79353669192642 - timing_s/testing:14.466687866020948 - timing_s/step:35.20222601108253 - timing_s/stop_profile:3.0118972063064575e-06 - timing_per_token_ms/values:0.013904432250294653 - timing_per_token_ms/adv:0.0003984760548309176 - timing_per_token_ms/update_actor:0.06999316599965402 - timing_per_token_ms/update_critic:0.05306750265856471 - timing_per_token_ms/gen:0.07015191108795947 - perf/total_num_tokens:97060 - perf/time_per_step:35.20222601108253 - perf/throughput:689.3030001102992
[36m(TaskRunner pid=2914832)[0m Training Progress:  25%|██▌       | 110/435 [41:07<2:16:32, 25.21s/it]
[36m(TaskRunner pid=2914832)[0m step:111 - global_seqlen/min:23752 - global_seqlen/max:25726 - global_seqlen/minmax_diff:1974 - global_seqlen/balanced_min:24285 - global_seqlen/balanced_max:24286 - global_seqlen/mean:24285.25 - actor/entropy:0.12342241406440735 - critic/vf_loss:0.10452013101894408 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.5928621254861355 - critic/grad_norm:34.103527545928955 - perf/mfu/critic:0.10161726788176814 - critic/lr:1e-05 - actor/pg_loss:0.06503761932253838 - actor/pg_clipfrac:0.002611416919535259 - actor/ppo_kl:-9.90477292361902e-06 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.8271501064300537 - perf/mfu/actor:0.07693120588394271 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.42607879638672 - actor/lr:1e-06 - training/global_step:111 - training/epoch:3 - critic/score/mean:0.62890625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.62890625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-3.928376290929236e-09 - critic/advantages/max:2.2706518173217773 - critic/advantages/min:-2.4119791984558105 - critic/returns/mean:0.5564472675323486 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.373046875 - critic/values/max:1.203125 - critic/values/min:-0.2578125 - critic/vf_explained_var:0.23177570104599 - response_length/mean:275.0078125 - response_length/max:512.0 - response_length/min:114.0 - response_length/clip_ratio:0.04296875 - prompt_length/mean:104.44921875 - prompt_length/max:201.0 - prompt_length/min:65.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.881061613559723e-06 - timing_s/generate_sequences:3.5416464805603027 - timing_s/reshard:0.3034137189388275 - timing_s/gen:4.431062534917146 - timing_s/reward:0.034398629795759916 - timing_s/old_log_prob:2.4082799828611314 - timing_s/values:1.3451207629404962 - timing_s/adv:0.03295468678697944 - timing_s/update_critic:5.143164172768593 - timing_s/update_actor:6.78948087990284 - timing_s/step:20.194096961058676 - timing_s/stop_profile:2.032145857810974e-06 - timing_per_token_ms/values:0.013847096107107156 - timing_per_token_ms/adv:0.000339245908390684 - timing_per_token_ms/update_actor:0.06989305113085967 - timing_per_token_ms/update_critic:0.05294534926311849 - timing_per_token_ms/gen:0.06293944113685898 - perf/total_num_tokens:97141 - perf/time_per_step:20.194096961058676 - perf/throughput:1202.591531913039
[36m(TaskRunner pid=2914832)[0m Training Progress:  26%|██▌       | 111/435 [41:27<2:08:01, 23.71s/it]
[36m(TaskRunner pid=2914832)[0m step:112 - global_seqlen/min:24414 - global_seqlen/max:25903 - global_seqlen/minmax_diff:1489 - global_seqlen/balanced_min:24966 - global_seqlen/balanced_max:24966 - global_seqlen/mean:24966.0 - actor/entropy:0.12313085794448853 - critic/vf_loss:0.09494889853522182 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.569303972646594 - critic/grad_norm:15.668824672698975 - perf/mfu/critic:0.0975269893881888 - critic/lr:1e-05 - actor/pg_loss:-0.15479530033189803 - actor/pg_clipfrac:0.003163531298923772 - actor/ppo_kl:-0.00012099256036890438 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.830544412136078 - perf/mfu/actor:0.0750020180670352 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.77793502807617 - actor/lr:1e-06 - training/global_step:112 - training/epoch:3 - critic/score/mean:0.64453125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.64453125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-6.611624137065064e-09 - critic/advantages/max:1.9089363813400269 - critic/advantages/min:-2.2006242275238037 - critic/returns/mean:0.5714187622070312 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.671875 - critic/values/max:1.2421875 - critic/values/min:0.078125 - critic/vf_explained_var:0.23290783166885376 - response_length/mean:283.9765625 - response_length/max:512.0 - response_length/min:116.0 - response_length/clip_ratio:0.05859375 - prompt_length/mean:106.1171875 - prompt_length/max:232.0 - prompt_length/min:56.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.145091563463211e-06 - timing_s/generate_sequences:3.5064635276794434 - timing_s/reshard:0.5858796834945679 - timing_s/gen:4.6775053003802896 - timing_s/reward:0.03459117980673909 - timing_s/old_log_prob:2.133669420145452 - timing_s/values:1.6136226300150156 - timing_s/adv:0.03401677496731281 - timing_s/update_critic:5.513252989854664 - timing_s/update_actor:7.167167732957751 - timing_s/step:21.181003648787737 - timing_s/stop_profile:3.6689452826976776e-06 - timing_per_token_ms/values:0.01615820145412777 - timing_per_token_ms/adv:0.0003406310078437957 - timing_per_token_ms/update_actor:0.0717692835552126 - timing_per_token_ms/update_critic:0.05520761225120828 - timing_per_token_ms/gen:0.06434159537236636 - perf/total_num_tokens:99864 - perf/time_per_step:21.181003648787737 - perf/throughput:1178.6976865673166
[36m(TaskRunner pid=2914832)[0m Training Progress:  26%|██▌       | 112/435 [41:48<2:03:34, 22.95s/it]
[36m(TaskRunner pid=2914832)[0m step:113 - global_seqlen/min:22938 - global_seqlen/max:24785 - global_seqlen/minmax_diff:1847 - global_seqlen/balanced_min:23591 - global_seqlen/balanced_max:23592 - global_seqlen/mean:23591.25 - actor/entropy:0.10678625851869583 - critic/vf_loss:0.12488437630236149 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.7269648853689432 - critic/grad_norm:26.48927414417267 - perf/mfu/critic:0.09839375241663273 - critic/lr:1e-05 - actor/pg_loss:0.059757122478913516 - actor/pg_clipfrac:0.0029415875105769373 - actor/ppo_kl:-0.00015873121628828812 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.973196804523468 - perf/mfu/actor:0.07454245605385867 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.50297164916992 - actor/lr:1e-06 - training/global_step:113 - training/epoch:3 - critic/score/mean:0.64453125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.64453125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-2.1439028330405563e-08 - critic/advantages/max:2.0278820991516113 - critic/advantages/min:-2.148784875869751 - critic/returns/mean:0.5800482630729675 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.7578125 - critic/values/max:1.2734375 - critic/values/min:0.078125 - critic/vf_explained_var:0.21356236934661865 - response_length/mean:267.24609375 - response_length/max:512.0 - response_length/min:109.0 - response_length/clip_ratio:0.03515625 - prompt_length/mean:101.3671875 - prompt_length/max:186.0 - prompt_length/min:67.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.309229552745819e-06 - timing_s/generate_sequences:3.5369060039520264 - timing_s/reshard:0.9227315187454224 - timing_s/gen:5.087361486628652 - timing_s/reward:0.03332252008840442 - timing_s/old_log_prob:2.0774949472397566 - timing_s/values:1.345286631025374 - timing_s/adv:0.034182004164904356 - timing_s/update_critic:5.1565656047314405 - timing_s/update_actor:6.80162422824651 - timing_s/step:20.54326142417267 - timing_s/stop_profile:2.517830580472946e-06 - timing_per_token_ms/values:0.01425620337016239 - timing_per_token_ms/adv:0.00036223180379276593 - timing_per_token_ms/update_actor:0.07207782788371228 - timing_per_token_ms/update_critic:0.05464489593314725 - timing_per_token_ms/gen:0.07436032283313092 - perf/total_num_tokens:94365 - perf/time_per_step:20.54326142417267 - perf/throughput:1148.3692639105907
[36m(TaskRunner pid=2914832)[0m Training Progress:  26%|██▌       | 113/435 [42:09<1:59:19, 22.24s/it]
[36m(TaskRunner pid=2914832)[0m step:114 - global_seqlen/min:22768 - global_seqlen/max:24850 - global_seqlen/minmax_diff:2082 - global_seqlen/balanced_min:24163 - global_seqlen/balanced_max:24164 - global_seqlen/mean:24163.75 - actor/entropy:0.1030811071395874 - critic/vf_loss:0.1465092992875725 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.27544283820316195 - critic/grad_norm:76.92667770385742 - perf/mfu/critic:0.09465924907922292 - critic/lr:1e-05 - actor/pg_loss:0.04017950175330043 - actor/pg_clipfrac:0.0031409971707034856 - actor/ppo_kl:0.0005148255595486262 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.7676908373832703 - perf/mfu/actor:0.07285003661429684 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.09613800048828 - actor/lr:1e-06 - training/global_step:114 - training/epoch:3 - critic/score/mean:0.69921875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.69921875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-8.976744680921911e-08 - critic/advantages/max:2.425252914428711 - critic/advantages/min:-2.4165050983428955 - critic/returns/mean:0.6397101283073425 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.33203125 - critic/values/max:0.84375 - critic/values/min:-0.4375 - critic/vf_explained_var:0.20076066255569458 - response_length/mean:275.47265625 - response_length/max:512.0 - response_length/min:118.0 - response_length/clip_ratio:0.0234375 - prompt_length/mean:102.0859375 - prompt_length/max:177.0 - prompt_length/min:65.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.127621650695801e-06 - timing_s/generate_sequences:3.452906847000122 - timing_s/reshard:0.7816269993782043 - timing_s/gen:5.210055789910257 - timing_s/reward:0.03397127101197839 - timing_s/old_log_prob:2.1322027291171253 - timing_s/values:1.6219767509028316 - timing_s/adv:0.03628470888361335 - timing_s/update_critic:5.490300117991865 - timing_s/update_actor:7.131635744124651 - timing_s/step:21.663559294771403 - timing_s/stop_profile:3.3210963010787964e-06 - timing_per_token_ms/values:0.01678109514151189 - timing_per_token_ms/adv:0.00037540436484003256 - timing_per_token_ms/update_actor:0.0737844472000895 - timing_per_token_ms/update_critic:0.056803063659323 - timing_per_token_ms/gen:0.073879493908343 - perf/total_num_tokens:96655 - perf/time_per_step:21.663559294771403 - perf/throughput:1115.4099689348845
[36m(TaskRunner pid=2914832)[0m Training Progress:  26%|██▌       | 114/435 [42:30<1:58:03, 22.07s/it]
[36m(TaskRunner pid=2914832)[0m step:115 - global_seqlen/min:23330 - global_seqlen/max:24081 - global_seqlen/minmax_diff:751 - global_seqlen/balanced_min:23735 - global_seqlen/balanced_max:23736 - global_seqlen/mean:23735.5 - actor/entropy:0.07649992406368256 - critic/vf_loss:0.1042596302140737 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.8363256547600031 - critic/grad_norm:49.83186626434326 - perf/mfu/critic:0.09932836037469604 - critic/lr:1e-05 - actor/pg_loss:-0.09800348058342934 - actor/pg_clipfrac:0.0031242344120983034 - actor/ppo_kl:0.0007036677943688119 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.5845911502838135 - perf/mfu/actor:0.07406621554407891 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.43843841552734 - actor/lr:1e-06 - training/global_step:115 - training/epoch:3 - critic/score/mean:0.68359375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.68359375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:3.0231074532593993e-08 - critic/advantages/max:2.4446723461151123 - critic/advantages/min:-2.757239580154419 - critic/returns/mean:0.6182577013969421 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.515625 - critic/values/max:1.0703125 - critic/values/min:-0.31640625 - critic/vf_explained_var:0.3113858699798584 - response_length/mean:269.62109375 - response_length/max:512.0 - response_length/min:119.0 - response_length/clip_ratio:0.01953125 - prompt_length/mean:101.24609375 - prompt_length/max:194.0 - prompt_length/min:64.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.220063030719757e-06 - timing_s/generate_sequences:3.8297834396362305 - timing_s/reshard:0.5887730717658997 - timing_s/gen:5.133009759243578 - timing_s/reward:0.036423757672309875 - timing_s/old_log_prob:2.0774264270439744 - timing_s/values:1.3443197957240045 - timing_s/adv:0.034885766915977 - timing_s/update_critic:5.138134488835931 - timing_s/update_actor:6.888848756905645 - timing_s/step:20.661473243962973 - timing_s/stop_profile:2.1690502762794495e-06 - timing_per_token_ms/values:0.01415937936554954 - timing_per_token_ms/adv:0.0003674429326955089 - timing_per_token_ms/update_actor:0.07255849631254498 - timing_per_token_ms/update_critic:0.054118667068693845 - timing_per_token_ms/gen:0.07436665690050531 - perf/total_num_tokens:94942 - perf/time_per_step:20.661473243962973 - perf/throughput:1148.7806179036734
[36m(TaskRunner pid=2914832)[0m Training Progress:  26%|██▋       | 115/435 [42:51<1:55:27, 21.65s/it]
[36m(TaskRunner pid=2914832)[0m step:116 - global_seqlen/min:22184 - global_seqlen/max:23539 - global_seqlen/minmax_diff:1355 - global_seqlen/balanced_min:22717 - global_seqlen/balanced_max:22718 - global_seqlen/mean:22717.5 - actor/entropy:0.07883314788341522 - critic/vf_loss:0.105383011396043 - critic/vf_clipfrac:0.09878995692997705 - critic/vpred_mean:0.6289573428221047 - critic/grad_norm:39.6706964969635 - perf/mfu/critic:0.09257290517778306 - critic/lr:1e-05 - actor/pg_loss:-0.040545260650105774 - actor/pg_clipfrac:0.00398201250936836 - actor/ppo_kl:0.00017629740068514366 - actor/pg_clipfrac_lower:6.345177826005965e-05 - actor/grad_norm:2.9045751690864563 - perf/mfu/actor:0.06802912120842258 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.24087142944336 - actor/lr:1e-06 - training/global_step:116 - training/epoch:3 - critic/score/mean:0.66796875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.66796875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.5643934148101835e-08 - critic/advantages/max:2.6890878677368164 - critic/advantages/min:-2.5501351356506348 - critic/returns/mean:0.6343288421630859 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.92578125 - critic/values/max:1.46875 - critic/values/min:-0.0169677734375 - critic/vf_explained_var:0.2227814793586731 - response_length/mean:252.1796875 - response_length/max:512.0 - response_length/min:117.0 - response_length/clip_ratio:0.0078125 - prompt_length/mean:102.78125 - prompt_length/max:179.0 - prompt_length/min:72.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.947185516357422e-06 - timing_s/generate_sequences:3.206615447998047 - timing_s/reshard:0.7798223495483398 - timing_s/gen:4.725052143912762 - timing_s/reward:0.032702162861824036 - timing_s/old_log_prob:2.461134902201593 - timing_s/values:1.733917301055044 - timing_s/adv:0.03415496880188584 - timing_s/update_critic:5.268593567889184 - timing_s/update_actor:7.169798376969993 - timing_s/step:21.43274422781542 - timing_s/stop_profile:2.435874193906784e-06 - timing_per_token_ms/values:0.01908129526857097 - timing_per_token_ms/adv:0.00037586627932085224 - timing_per_token_ms/update_actor:0.07890170988191915 - timing_per_token_ms/update_critic:0.05797946041475937 - timing_per_token_ms/gen:0.07319080739664739 - perf/total_num_tokens:90870 - perf/time_per_step:21.43274422781542 - perf/throughput:1059.943596514217
[36m(TaskRunner pid=2914832)[0m Training Progress:  27%|██▋       | 116/435 [43:13<1:54:46, 21.59s/it]
[36m(TaskRunner pid=2914832)[0m step:117 - global_seqlen/min:23058 - global_seqlen/max:24619 - global_seqlen/minmax_diff:1561 - global_seqlen/balanced_min:23575 - global_seqlen/balanced_max:23575 - global_seqlen/mean:23575.0 - actor/entropy:0.08102719485759735 - critic/vf_loss:0.09912342112511396 - critic/vf_clipfrac:0.10864860005676746 - critic/vpred_mean:0.5760059105232358 - critic/grad_norm:39.401926040649414 - perf/mfu/critic:0.0938898297797637 - critic/lr:1e-05 - actor/pg_loss:-0.1165691486094147 - actor/pg_clipfrac:0.0038373678689822555 - actor/ppo_kl:0.0001307760826421145 - actor/pg_clipfrac_lower:6.868132186355069e-05 - actor/grad_norm:2.7246429920196533 - perf/mfu/actor:0.07347621987904997 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:87.29130935668945 - actor/lr:1e-06 - training/global_step:117 - training/epoch:4 - critic/score/mean:0.6796875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.6796875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:6.421245046794866e-08 - critic/advantages/max:2.723076343536377 - critic/advantages/min:-2.7112483978271484 - critic/returns/mean:0.6197313070297241 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.33984375 - critic/values/max:0.953125 - critic/values/min:-0.69921875 - critic/vf_explained_var:0.26503437757492065 - response_length/mean:261.99609375 - response_length/max:512.0 - response_length/min:84.0 - response_length/clip_ratio:0.01953125 - prompt_length/mean:106.36328125 - prompt_length/max:201.0 - prompt_length/min:69.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:1.2238975614309311e-05 - timing_s/generate_sequences:3.448486804962158 - timing_s/reshard:0.8829982876777649 - timing_s/gen:4.851493007037789 - timing_s/reward:0.0339612253010273 - timing_s/old_log_prob:2.08436799608171 - timing_s/values:1.3476495118811727 - timing_s/adv:0.035577368922531605 - timing_s/update_critic:5.397862550802529 - timing_s/update_actor:6.8957454562187195 - timing_s/step:20.656472004018724 - timing_s/stop_profile:6.095971912145615e-06 - timing_per_token_ms/values:0.014291087082515086 - timing_per_token_ms/adv:0.0003772785675772174 - timing_per_token_ms/update_actor:0.07312561459404793 - timing_per_token_ms/update_critic:0.05724138441996319 - timing_per_token_ms/gen:0.07233369126802625 - perf/total_num_tokens:94300 - perf/time_per_step:20.656472004018724 - perf/throughput:1141.2887929465146
[36m(TaskRunner pid=2914832)[0m Training Progress:  27%|██▋       | 117/435 [43:34<1:53:36, 21.44s/it]
[36m(TaskRunner pid=2914832)[0m step:118 - global_seqlen/min:22330 - global_seqlen/max:24942 - global_seqlen/minmax_diff:2612 - global_seqlen/balanced_min:23361 - global_seqlen/balanced_max:23362 - global_seqlen/mean:23361.5 - actor/entropy:0.07373255491256714 - critic/vf_loss:0.14906740374863148 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.9907148666679859 - critic/grad_norm:65.20480632781982 - perf/mfu/critic:0.09115269664514046 - critic/lr:1e-05 - actor/pg_loss:0.053683348814956844 - actor/pg_clipfrac:0.0036862263732473366 - actor/ppo_kl:0.00011665235001601104 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.6968095302581787 - perf/mfu/actor:0.07043060772466953 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:87.15969848632812 - actor/lr:1e-06 - training/global_step:118 - training/epoch:4 - critic/score/mean:0.71875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.71875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-8.642432192118576e-08 - critic/advantages/max:2.7645392417907715 - critic/advantages/min:-2.9148342609405518 - critic/returns/mean:0.6490556597709656 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:1.046875 - critic/values/max:1.65625 - critic/values/min:0.04345703125 - critic/vf_explained_var:0.321725070476532 - response_length/mean:260.1796875 - response_length/max:512.0 - response_length/min:124.0 - response_length/clip_ratio:0.015625 - prompt_length/mean:104.84375 - prompt_length/max:186.0 - prompt_length/min:64.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.1339309215545654e-06 - timing_s/generate_sequences:3.4538567066192627 - timing_s/reshard:0.5833544135093689 - timing_s/gen:4.895922279916704 - timing_s/reward:0.03332704026252031 - timing_s/old_log_prob:2.136657098773867 - timing_s/values:1.6118031716905534 - timing_s/adv:0.03410441428422928 - timing_s/update_critic:5.506165933329612 - timing_s/update_actor:7.123276607599109 - timing_s/step:21.349059954751283 - timing_s/stop_profile:2.2132880985736847e-06 - timing_per_token_ms/values:0.017248498295171045 - timing_per_token_ms/adv:0.00036496387522450696 - timing_per_token_ms/update_actor:0.07622880174217313 - timing_per_token_ms/update_critic:0.05892350591068223 - timing_per_token_ms/gen:0.0735057244079618 - perf/total_num_tokens:93446 - perf/time_per_step:21.349059954751283 - perf/throughput:1094.263637345814
[36m(TaskRunner pid=2914832)[0m Training Progress:  27%|██▋       | 118/435 [43:55<1:53:09, 21.42s/it]
[36m(TaskRunner pid=2914832)[0m step:119 - global_seqlen/min:22788 - global_seqlen/max:24585 - global_seqlen/minmax_diff:1797 - global_seqlen/balanced_min:23474 - global_seqlen/balanced_max:23475 - global_seqlen/mean:23474.5 - actor/entropy:0.07114799320697784 - critic/vf_loss:0.08912189962575212 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.46696680039167404 - critic/grad_norm:30.456229209899902 - perf/mfu/critic:0.09796738370319091 - critic/lr:1e-05 - actor/pg_loss:-0.08505233493633568 - actor/pg_clipfrac:0.0032590592236374505 - actor/ppo_kl:-0.00012755932914387813 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.8620046973228455 - perf/mfu/actor:0.07347578497279392 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:87.63804626464844 - actor/lr:1e-06 - training/global_step:119 - training/epoch:4 - critic/score/mean:0.68359375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.68359375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:8.538386886414173e-09 - critic/advantages/max:2.457720994949341 - critic/advantages/min:-2.607780694961548 - critic/returns/mean:0.6193210482597351 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.5625 - critic/values/max:1.15625 - critic/values/min:-0.310546875 - critic/vf_explained_var:0.30267155170440674 - response_length/mean:263.9609375 - response_length/max:512.0 - response_length/min:134.0 - response_length/clip_ratio:0.01953125 - prompt_length/mean:102.828125 - prompt_length/max:175.0 - prompt_length/min:67.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.090143531560898e-06 - timing_s/generate_sequences:3.395658254623413 - timing_s/reshard:0.8702641129493713 - timing_s/gen:5.107237786054611 - timing_s/reward:0.03359532402828336 - timing_s/old_log_prob:2.0765780149959028 - timing_s/values:1.3460049787536263 - timing_s/adv:0.03365760529413819 - timing_s/update_critic:5.148905338719487 - timing_s/update_actor:6.861960302107036 - timing_s/step:20.615428226068616 - timing_s/stop_profile:2.303626388311386e-06 - timing_per_token_ms/values:0.014334756637560186 - timing_per_token_ms/adv:0.00035844858563694853 - timing_per_token_ms/update_actor:0.07307887603683823 - timing_per_token_ms/update_critic:0.05483509061662109 - timing_per_token_ms/gen:0.07557992402484108 - perf/total_num_tokens:93898 - perf/time_per_step:20.615428226068616 - perf/throughput:1138.6860240097283
[36m(TaskRunner pid=2914832)[0m Training Progress:  27%|██▋       | 119/435 [44:16<1:51:32, 21.18s/it]
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 120}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and bakes muffins for her friends every day with four. She sells the remainder at the farmers' market daily for $2 per fresh duck egg. How much in dollars does she make every day at the farmers' market? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much money Janet makes every day from selling the eggs, we need to follow these steps:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. Calculate the number of eggs laid by the ducks in a day.
[36m(TaskRunner pid=2914832)[0m 2. Subtract the number of eggs eaten in a day.
[36m(TaskRunner pid=2914832)[0m 3. Subtract the number of eggs baked.
[36m(TaskRunner pid=2914832)[0m 4. Determine the number of ducks laid in a day.
[36m(TaskRunner pid=2914832)[0m 5. Calculate the total revenue from selling the eggs.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Let's start with the first step:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. Janet's ducks lay 16 eggs per day.
[36m(TaskRunner pid=2914832)[0m 2. Janet eats 3 eggs for breakfast every day.
[36m(TaskRunner pid=2914832)[0m 3. Janet bakes 4 muffins for her friends every day.
[36m(TaskRunner pid=2914832)[0m 4. Therefore, the number of eggs baked per day is:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    16 - 3 - 4 = 19 \text{ eggs}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m 5. Janet sells each egg for $2. Therefore, the total revenue from selling the eggs is:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    19 \text{ eggs} \times 2 \text{ dollars/egg} = 38 \text{ dollars}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m So, the final answer is:
[36m(TaskRunner pid=2914832)[0m #### 38
[36m(TaskRunner pid=2914832)[0m [ground_truth] 18
[36m(TaskRunner pid=2914832)[0m [score] 0.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1312
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 120}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Tom's restaurant gets 6 reservations a night.  They normally order 2 meals that cost $5 each and a $5 bottle of wine.  How much do they make a week if they are open 2 days a week? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much Tom's restaurant makes in a week, we need to follow these steps:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. Calculate the total number of reservations per night.
[36m(TaskRunner pid=2914832)[0m 2. Determine the total number of meals ordered per night.
[36m(TaskRunner pid=2914832)[0m 3. Calculate the total revenue from meals.
[36m(TaskRunner pid=2914832)[0m 4. Calculate the total revenue from the wine.
[36m(TaskRunner pid=2914832)[0m 5. Add the revenue from meals and the revenue from the wine to get the total revenue per night.
[36m(TaskRunner pid=2914832)[0m 6. Multiply the total revenue per night by the number of nights the restaurant is open in a week.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Let's start with the first step:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. The restaurant gets 6 reservations a night.
[36m(TaskRunner pid=2914832)[0m 2. They order 2 meals that cost $5 each. Therefore, the total number of meals ordered per night is:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    6 \text{ reservations} \times 2 \text{ meals/reservation} = 12 \text{ meals}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m 3. The cost of each meal is $5. Therefore, the total revenue from meals per night is:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    12 \text{ meals} \times 5 \text{ dollars/meal} = 60 \text{ dollars}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m 4. The cost of the wine is $5. Therefore, the total revenue from the wine per night is:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    5 \text{ dollars}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m 5. The total revenue per night is the sum of the revenue from meals and the revenue from the wine:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    60 \text{ dollars} + 5 \text{ dollars} = 65 \text{ dollars}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m 6. The restaurant is open 2 days a week, so the total revenue for the week is:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    65 \text{ dollars/day} \times 2 \text{ days/week} = 130 \text{ dollars/week}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Therefore, the final answer is:
[36m(TaskRunner pid=2914832)[0m #### 130
[36m(TaskRunner pid=2914832)[0m [ground_truth] 180
[36m(TaskRunner pid=2914832)[0m [score] 0.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1319
[36m(TaskRunner pid=2914832)[0m step:120 - global_seqlen/min:22616 - global_seqlen/max:24525 - global_seqlen/minmax_diff:1909 - global_seqlen/balanced_min:23290 - global_seqlen/balanced_max:23291 - global_seqlen/mean:23290.75 - actor/entropy:0.07395318150520325 - critic/vf_loss:0.10015808290336281 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6575256213545799 - critic/grad_norm:24.05484914779663 - perf/mfu/critic:0.0893794003322106 - critic/lr:1e-05 - actor/pg_loss:0.07882298732874915 - actor/pg_clipfrac:0.003448667215707246 - actor/ppo_kl:-1.078676632459974e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.771673023700714 - perf/mfu/actor:0.0709952593572635 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:87.36224746704102 - actor/lr:1e-06 - val-core/openai/gsm8k/reward/mean@1:0.5208491281273692 - training/global_step:120 - training/epoch:4 - critic/score/mean:0.65625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.65625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-5.445519590807635e-09 - critic/advantages/max:2.7731497287750244 - critic/advantages/min:-2.643960952758789 - critic/returns/mean:0.596980631351471 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.6640625 - critic/values/max:1.2578125 - critic/values/min:-0.23046875 - critic/vf_explained_var:0.26578259468078613 - response_length/mean:260.30078125 - response_length/max:512.0 - response_length/min:98.0 - response_length/clip_ratio:0.015625 - prompt_length/mean:103.6171875 - prompt_length/max:256.0 - prompt_length/min:64.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.692003130912781e-06 - timing_s/generate_sequences:3.4896652698516846 - timing_s/reshard:0.7874248027801514 - timing_s/gen:5.2041421490721405 - timing_s/reward:0.033434596844017506 - timing_s/old_log_prob:2.111274375580251 - timing_s/values:1.6219266979023814 - timing_s/adv:0.033268765080720186 - timing_s/update_critic:5.5985095971263945 - timing_s/update_actor:7.045770603697747 - timing_s/testing:13.583643226884305 - timing_s/step:35.238479889929295 - timing_s/stop_profile:2.2295862436294556e-06 - timing_per_token_ms/values:0.017409558493204184 - timing_per_token_ms/adv:0.0003571027669860372 - timing_per_token_ms/update_actor:0.07562842119401207 - timing_per_token_ms/update_critic:0.06009370240467132 - timing_per_token_ms/gen:0.07809688535006289 - perf/total_num_tokens:93163 - perf/time_per_step:35.238479889929295 - perf/throughput:660.9465014595081
[36m(TaskRunner pid=2914832)[0m Training Progress:  28%|██▊       | 120/435 [44:51<2:13:21, 25.40s/it]
[36m(TaskRunner pid=2914832)[0m step:121 - global_seqlen/min:23421 - global_seqlen/max:24060 - global_seqlen/minmax_diff:639 - global_seqlen/balanced_min:23740 - global_seqlen/balanced_max:23741 - global_seqlen/mean:23740.75 - actor/entropy:0.06968984007835388 - critic/vf_loss:0.08715322788339108 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6658012084662914 - critic/grad_norm:23.286646008491516 - perf/mfu/critic:0.09845982841438604 - critic/lr:1e-05 - actor/pg_loss:-0.0687444867216982 - actor/pg_clipfrac:0.0038101643149275333 - actor/ppo_kl:0.00017679889393207304 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.0890541672706604 - perf/mfu/actor:0.07468734979731162 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:86.81946563720703 - actor/lr:1e-06 - training/global_step:121 - training/epoch:4 - critic/score/mean:0.64453125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.64453125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:2.6290797094929985e-08 - critic/advantages/max:2.4199135303497314 - critic/advantages/min:-2.628187894821167 - critic/returns/mean:0.576387882232666 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.4921875 - critic/values/max:1.0625 - critic/values/min:-0.349609375 - critic/vf_explained_var:0.3385171890258789 - response_length/mean:267.8046875 - response_length/max:512.0 - response_length/min:129.0 - response_length/clip_ratio:0.0234375 - prompt_length/mean:103.14453125 - prompt_length/max:183.0 - prompt_length/min:67.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.407018423080444e-06 - timing_s/generate_sequences:3.534419059753418 - timing_s/reshard:0.30241572856903076 - timing_s/gen:4.742235119920224 - timing_s/reward:0.03393169492483139 - timing_s/old_log_prob:2.1573404972441494 - timing_s/values:1.3410692112520337 - timing_s/adv:0.03455437673255801 - timing_s/update_critic:5.1852514101192355 - timing_s/update_actor:6.831259593367577 - timing_s/step:20.3332921420224 - timing_s/stop_profile:1.9222497940063477e-06 - timing_per_token_ms/values:0.014122018167623535 - timing_per_token_ms/adv:0.0003638719999637544 - timing_per_token_ms/update_actor:0.07193601290363169 - timing_per_token_ms/update_critic:0.054602860167846795 - timing_per_token_ms/gen:0.06917114151404977 - perf/total_num_tokens:94963 - perf/time_per_step:20.3332921420224 - perf/throughput:1167.5802341390392
[36m(TaskRunner pid=2914832)[0m Training Progress:  28%|██▊       | 121/435 [45:11<2:04:59, 23.88s/it]
[36m(TaskRunner pid=2914832)[0m step:122 - global_seqlen/min:22316 - global_seqlen/max:24037 - global_seqlen/minmax_diff:1721 - global_seqlen/balanced_min:23465 - global_seqlen/balanced_max:23466 - global_seqlen/mean:23465.25 - actor/entropy:0.07416936010122299 - critic/vf_loss:0.1286939748097211 - critic/vf_clipfrac:0.017930868547409773 - critic/vpred_mean:0.43852980085648596 - critic/grad_norm:47.73911517858505 - perf/mfu/critic:0.09459160897795842 - critic/lr:1e-05 - actor/pg_loss:-0.10454713081708178 - actor/pg_clipfrac:0.0033724354652804323 - actor/ppo_kl:7.906243126853951e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.5164294242858887 - perf/mfu/actor:0.07081000596886534 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.67753219604492 - actor/lr:1e-06 - training/global_step:122 - training/epoch:4 - critic/score/mean:0.7109375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.7109375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:7.631044240952178e-09 - critic/advantages/max:2.6202547550201416 - critic/advantages/min:-2.6046111583709717 - critic/returns/mean:0.648759126663208 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.73046875 - critic/values/max:1.375 - critic/values/min:-0.1630859375 - critic/vf_explained_var:0.3356563448905945 - response_length/mean:261.90625 - response_length/max:512.0 - response_length/min:87.0 - response_length/clip_ratio:0.015625 - prompt_length/mean:104.73828125 - prompt_length/max:199.0 - prompt_length/min:56.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.3122639656066895e-06 - timing_s/generate_sequences:3.4817376136779785 - timing_s/reshard:0.5802931189537048 - timing_s/gen:4.677573021966964 - timing_s/reward:0.0343994521535933 - timing_s/old_log_prob:2.0759346587583423 - timing_s/values:1.3447460681200027 - timing_s/adv:0.03366291895508766 - timing_s/update_critic:5.332342715002596 - timing_s/update_actor:7.123646419029683 - timing_s/step:20.629102445207536 - timing_s/stop_profile:3.094784915447235e-06 - timing_per_token_ms/values:0.014326994897987479 - timing_per_token_ms/adv:0.0003586464980672235 - timing_per_token_ms/update_actor:0.07589570129265279 - timing_per_token_ms/update_critic:0.05681105800068821 - timing_per_token_ms/gen:0.06976454214841553 - perf/total_num_tokens:93861 - perf/time_per_step:20.629102445207536 - perf/throughput:1137.482838253651
[36m(TaskRunner pid=2914832)[0m Training Progress:  28%|██▊       | 122/435 [45:32<1:59:31, 22.91s/it]
[36m(TaskRunner pid=2914832)[0m step:123 - global_seqlen/min:21632 - global_seqlen/max:23294 - global_seqlen/minmax_diff:1662 - global_seqlen/balanced_min:22698 - global_seqlen/balanced_max:22699 - global_seqlen/mean:22698.25 - actor/entropy:0.06654386222362518 - critic/vf_loss:0.1587923145852983 - critic/vf_clipfrac:0.029618485874379985 - critic/vpred_mean:0.4716733653913252 - critic/grad_norm:65.37220001220703 - perf/mfu/critic:0.09419552757409598 - critic/lr:1e-05 - actor/pg_loss:0.3083430731203407 - actor/pg_clipfrac:0.004030833806609735 - actor/ppo_kl:0.00016564828001719434 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.0144999027252197 - perf/mfu/actor:0.07083369171239934 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.19866180419922 - actor/lr:1e-06 - training/global_step:123 - training/epoch:4 - critic/score/mean:0.71875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.71875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.9732208755840475e-08 - critic/advantages/max:2.382112503051758 - critic/advantages/min:-3.072262763977051 - critic/returns/mean:0.6803059577941895 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.2158203125 - critic/values/max:0.94140625 - critic/values/min:-0.6171875 - critic/vf_explained_var:0.037133216857910156 - response_length/mean:252.79296875 - response_length/max:512.0 - response_length/min:107.0 - response_length/clip_ratio:0.01171875 - prompt_length/mean:101.8671875 - prompt_length/max:176.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.783738404512405e-06 - timing_s/generate_sequences:3.4144797325134277 - timing_s/reshard:0.8573880791664124 - timing_s/gen:4.898428052198142 - timing_s/reward:0.03313452424481511 - timing_s/old_log_prob:2.073690991848707 - timing_s/values:1.3458295380696654 - timing_s/adv:0.03429133491590619 - timing_s/update_critic:5.176384333986789 - timing_s/update_actor:6.880701290909201 - timing_s/step:20.44962275121361 - timing_s/stop_profile:2.1988525986671448e-06 - timing_per_token_ms/values:0.014823053958671544 - timing_per_token_ms/adv:0.00037768699036165994 - timing_per_token_ms/update_actor:0.07578449099500183 - timing_per_token_ms/update_critic:0.057013033317401 - timing_per_token_ms/gen:0.07569231325346738 - perf/total_num_tokens:90793 - perf/time_per_step:20.44962275121361 - perf/throughput:1109.9593511402522
[36m(TaskRunner pid=2914832)[0m Training Progress:  28%|██▊       | 123/435 [45:52<1:55:18, 22.18s/it]
[36m(TaskRunner pid=2914832)[0m step:124 - global_seqlen/min:22713 - global_seqlen/max:23761 - global_seqlen/minmax_diff:1048 - global_seqlen/balanced_min:23412 - global_seqlen/balanced_max:23413 - global_seqlen/mean:23412.25 - actor/entropy:0.07402702420949936 - critic/vf_loss:0.1266116137849167 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.8334486279636621 - critic/grad_norm:37.36028718948364 - perf/mfu/critic:0.09234339974338387 - critic/lr:1e-05 - actor/pg_loss:0.060833308612927794 - actor/pg_clipfrac:0.0036467951285885647 - actor/ppo_kl:-0.0002752551718003815 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.775265336036682 - perf/mfu/actor:0.07256799671849241 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:86.81201934814453 - actor/lr:1e-06 - training/global_step:124 - training/epoch:4 - critic/score/mean:0.6953125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.6953125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:1.7868229562623128e-08 - critic/advantages/max:2.544727087020874 - critic/advantages/min:-2.784952402114868 - critic/returns/mean:0.6591464877128601 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.90625 - critic/values/max:1.59375 - critic/values/min:0.1015625 - critic/vf_explained_var:0.1635270118713379 - response_length/mean:263.52734375 - response_length/max:512.0 - response_length/min:121.0 - response_length/clip_ratio:0.01171875 - prompt_length/mean:102.2890625 - prompt_length/max:189.0 - prompt_length/min:64.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.5818818509578705e-06 - timing_s/generate_sequences:3.399446487426758 - timing_s/reshard:0.7755643725395203 - timing_s/gen:4.699586457107216 - timing_s/reward:0.03386842831969261 - timing_s/old_log_prob:2.4239682592451572 - timing_s/values:1.3431484578177333 - timing_s/adv:0.03429259080439806 - timing_s/update_critic:5.448405055794865 - timing_s/update_actor:6.930617548059672 - timing_s/step:20.920895190909505 - timing_s/stop_profile:9.973067790269852e-06 - timing_per_token_ms/values:0.01434236839493997 - timing_per_token_ms/adv:0.000366182135467523 - timing_per_token_ms/update_actor:0.07400631665110863 - timing_per_token_ms/update_critic:0.05817899876981991 - timing_per_token_ms/gen:0.06966168799352558 - perf/total_num_tokens:93649 - perf/time_per_step:20.920895190909505 - perf/throughput:1119.0845222614103
[36m(TaskRunner pid=2914832)[0m Training Progress:  29%|██▊       | 124/435 [46:13<1:53:00, 21.80s/it]
[36m(TaskRunner pid=2914832)[0m step:125 - global_seqlen/min:23214 - global_seqlen/max:23612 - global_seqlen/minmax_diff:398 - global_seqlen/balanced_min:23380 - global_seqlen/balanced_max:23380 - global_seqlen/mean:23380.0 - actor/entropy:0.07422997802495956 - critic/vf_loss:0.09698432893492281 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.514726827852428 - critic/grad_norm:19.623002231121063 - perf/mfu/critic:0.09553713996049241 - critic/lr:1e-05 - actor/pg_loss:-0.047944993712008 - actor/pg_clipfrac:0.0028478626263677143 - actor/ppo_kl:0.00011171230789841502 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.7972410321235657 - perf/mfu/actor:0.0698716944329961 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.5927505493164 - actor/lr:1e-06 - training/global_step:125 - training/epoch:4 - critic/score/mean:0.640625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.640625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-4.789129093296651e-09 - critic/advantages/max:2.3684051036834717 - critic/advantages/min:-2.8095946311950684 - critic/returns/mean:0.5911569595336914 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.5859375 - critic/values/max:1.3125 - critic/values/min:-0.193359375 - critic/vf_explained_var:0.320698082447052 - response_length/mean:262.91796875 - response_length/max:512.0 - response_length/min:122.0 - response_length/clip_ratio:0.0234375 - prompt_length/mean:102.39453125 - prompt_length/max:182.0 - prompt_length/min:69.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:6.5336935222148895e-06 - timing_s/generate_sequences:3.510336399078369 - timing_s/reshard:0.5791648626327515 - timing_s/gen:4.561317397747189 - timing_s/reward:0.03422470297664404 - timing_s/old_log_prob:2.074379486963153 - timing_s/values:1.3448826181702316 - timing_s/adv:0.03334498731419444 - timing_s/update_critic:5.259511474054307 - timing_s/update_actor:7.187408617231995 - timing_s/step:20.501801893115044 - timing_s/stop_profile:1.6959384083747864e-06 - timing_per_token_ms/values:0.014380695232786907 - timing_per_token_ms/adv:0.00035655461199951284 - timing_per_token_ms/update_actor:0.07685424098836607 - timing_per_token_ms/update_critic:0.056239429790999856 - timing_per_token_ms/gen:0.06776884124603962 - perf/total_num_tokens:93520 - perf/time_per_step:20.501801893115044 - perf/throughput:1140.3875679752578
[36m(TaskRunner pid=2914832)[0m Training Progress:  29%|██▊       | 125/435 [46:34<1:50:39, 21.42s/it]
[36m(TaskRunner pid=2914832)[0m step:126 - global_seqlen/min:22742 - global_seqlen/max:25961 - global_seqlen/minmax_diff:3219 - global_seqlen/balanced_min:24378 - global_seqlen/balanced_max:24379 - global_seqlen/mean:24378.25 - actor/entropy:0.07347150892019272 - critic/vf_loss:0.08061825711047277 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6983331311494112 - critic/grad_norm:12.88649606704712 - perf/mfu/critic:0.09475679237547904 - critic/lr:1e-05 - actor/pg_loss:0.0038935099728405476 - actor/pg_clipfrac:0.0034507011296227574 - actor/ppo_kl:0.00038962013786658645 - actor/pg_clipfrac_lower:5.199667066335678e-05 - actor/grad_norm:2.595437705516815 - perf/mfu/actor:0.07716551384467692 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.20467376708984 - actor/lr:1e-06 - training/global_step:126 - training/epoch:4 - critic/score/mean:0.68359375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.68359375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-6.037534028280334e-09 - critic/advantages/max:2.821263551712036 - critic/advantages/min:-2.6025002002716064 - critic/returns/mean:0.6332226395606995 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.6953125 - critic/values/max:1.390625 - critic/values/min:-0.034423828125 - critic/vf_explained_var:0.35164934396743774 - response_length/mean:276.42578125 - response_length/max:512.0 - response_length/min:124.0 - response_length/clip_ratio:0.03125 - prompt_length/mean:104.484375 - prompt_length/max:178.0 - prompt_length/min:72.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.199108272790909e-06 - timing_s/generate_sequences:3.4718053340911865 - timing_s/reshard:0.5811350345611572 - timing_s/gen:4.621788856107742 - timing_s/reward:0.033818150870501995 - timing_s/old_log_prob:2.0717127448879182 - timing_s/values:1.3437039242126048 - timing_s/adv:0.03377683321014047 - timing_s/update_critic:5.5346535998396575 - timing_s/update_actor:6.79515674803406 - timing_s/step:20.441534968093038 - timing_s/stop_profile:1.802109181880951e-06 - timing_per_token_ms/values:0.013779741411018067 - timing_per_token_ms/adv:0.00034638287418231893 - timing_per_token_ms/update_actor:0.06968462408124107 - timing_per_token_ms/update_critic:0.05675811019904687 - timing_per_token_ms/gen:0.06531179051943392 - perf/total_num_tokens:97513 - perf/time_per_step:20.441534968093038 - perf/throughput:1192.5841204220592
[36m(TaskRunner pid=2914832)[0m Training Progress:  29%|██▉       | 126/435 [46:54<1:48:49, 21.13s/it]
[36m(TaskRunner pid=2914832)[0m step:127 - global_seqlen/min:22101 - global_seqlen/max:25440 - global_seqlen/minmax_diff:3339 - global_seqlen/balanced_min:23436 - global_seqlen/balanced_max:23437 - global_seqlen/mean:23436.75 - actor/entropy:0.07167639583349228 - critic/vf_loss:0.0942372749268543 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.5975178889930248 - critic/grad_norm:15.708244323730469 - perf/mfu/critic:0.09843123738472914 - critic/lr:1e-05 - actor/pg_loss:0.21485100861173123 - actor/pg_clipfrac:0.002907401700213086 - actor/ppo_kl:-6.627809216297464e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.8125762939453125 - perf/mfu/actor:0.0738015103325337 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.23620986938477 - actor/lr:1e-06 - training/global_step:127 - training/epoch:4 - critic/score/mean:0.6484375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.6484375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:1.7742515012741933e-08 - critic/advantages/max:2.368528127670288 - critic/advantages/min:-2.613257646560669 - critic/returns/mean:0.5836008191108704 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.5703125 - critic/values/max:1.2109375 - critic/values/min:-0.2392578125 - critic/vf_explained_var:0.3324284553527832 - response_length/mean:262.875 - response_length/max:512.0 - response_length/min:122.0 - response_length/clip_ratio:0.03125 - prompt_length/mean:103.32421875 - prompt_length/max:199.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.2817555367946625e-06 - timing_s/generate_sequences:3.392500162124634 - timing_s/reshard:0.8767912983894348 - timing_s/gen:4.804702199995518 - timing_s/reward:0.035577474627643824 - timing_s/old_log_prob:2.0784564199857414 - timing_s/values:1.3398991604335606 - timing_s/adv:0.03598919603973627 - timing_s/update_critic:5.118323714938015 - timing_s/update_actor:6.825153268873692 - timing_s/step:20.246312609873712 - timing_s/stop_profile:7.4589625000953674e-06 - timing_per_token_ms/values:0.014292715078173814 - timing_per_token_ms/adv:0.0003838970424625457 - timing_per_token_ms/update_actor:0.07280396459485308 - timing_per_token_ms/update_critic:0.05459720006974106 - timing_per_token_ms/gen:0.07139654957197333 - perf/total_num_tokens:93747 - perf/time_per_step:20.246312609873712 - perf/throughput:1157.581158189288
[36m(TaskRunner pid=2914832)[0m Training Progress:  29%|██▉       | 127/435 [47:14<1:47:07, 20.87s/it]
[36m(TaskRunner pid=2914832)[0m step:128 - global_seqlen/min:22734 - global_seqlen/max:24454 - global_seqlen/minmax_diff:1720 - global_seqlen/balanced_min:23859 - global_seqlen/balanced_max:23859 - global_seqlen/mean:23859.0 - actor/entropy:0.07344827055931091 - critic/vf_loss:0.08072256261948496 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.5524121075868607 - critic/grad_norm:12.640548467636108 - perf/mfu/critic:0.0935773191104888 - critic/lr:1e-05 - actor/pg_loss:0.011920981109142303 - actor/pg_clipfrac:0.003109816309006419 - actor/ppo_kl:0.0002703955624383525 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.9098472595214844 - perf/mfu/actor:0.07244928058270725 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.3060188293457 - actor/lr:1e-06 - training/global_step:128 - training/epoch:4 - critic/score/mean:0.62109375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.62109375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.7119390349762398e-09 - critic/advantages/max:2.308932065963745 - critic/advantages/min:-2.7542388439178467 - critic/returns/mean:0.5629804134368896 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.50390625 - critic/values/max:1.078125 - critic/values/min:-0.345703125 - critic/vf_explained_var:0.3920416831970215 - response_length/mean:269.83203125 - response_length/max:512.0 - response_length/min:112.0 - response_length/clip_ratio:0.03125 - prompt_length/mean:102.96484375 - prompt_length/max:222.0 - prompt_length/min:69.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.02588227391243e-06 - timing_s/generate_sequences:3.531249761581421 - timing_s/reshard:0.7884579300880432 - timing_s/gen:5.216793478932232 - timing_s/reward:0.03443508595228195 - timing_s/old_log_prob:2.135378065984696 - timing_s/values:1.6350571061484516 - timing_s/adv:0.03365408396348357 - timing_s/update_critic:5.481920892838389 - timing_s/update_actor:7.08138857409358 - timing_s/step:21.62557167885825 - timing_s/stop_profile:5.647074431180954e-06 - timing_per_token_ms/values:0.017132498283126404 - timing_per_token_ms/adv:0.0003526351058665867 - timing_per_token_ms/update_actor:0.07420039161420827 - timing_per_token_ms/update_critic:0.05744080737707352 - timing_per_token_ms/gen:0.07552142506090641 - perf/total_num_tokens:95436 - perf/time_per_step:21.62557167885825 - perf/throughput:1103.2771921273743
[36m(TaskRunner pid=2914832)[0m Training Progress:  29%|██▉       | 128/435 [47:36<1:47:57, 21.10s/it]
[36m(TaskRunner pid=2914832)[0m step:129 - global_seqlen/min:23816 - global_seqlen/max:24424 - global_seqlen/minmax_diff:608 - global_seqlen/balanced_min:24260 - global_seqlen/balanced_max:24261 - global_seqlen/mean:24260.5 - actor/entropy:0.07396365702152252 - critic/vf_loss:0.0798974382923916 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.5542434528470039 - critic/grad_norm:12.173057347536087 - perf/mfu/critic:0.10183218498043567 - critic/lr:1e-05 - actor/pg_loss:-0.07821501244325191 - actor/pg_clipfrac:0.003833469370874809 - actor/ppo_kl:-0.00035367829514143523 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.692673921585083 - perf/mfu/actor:0.07687799722261074 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.32538223266602 - actor/lr:1e-06 - training/global_step:129 - training/epoch:4 - critic/score/mean:0.6484375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.6484375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-2.0530393385342904e-08 - critic/advantages/max:2.723153591156006 - critic/advantages/min:-2.7770981788635254 - critic/returns/mean:0.5899442434310913 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.45703125 - critic/values/max:1.0859375 - critic/values/min:-0.474609375 - critic/vf_explained_var:0.3450199365615845 - response_length/mean:273.0859375 - response_length/max:512.0 - response_length/min:123.0 - response_length/clip_ratio:0.03515625 - prompt_length/mean:105.984375 - prompt_length/max:189.0 - prompt_length/min:63.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:1.553306356072426e-05 - timing_s/generate_sequences:3.6599268913269043 - timing_s/reshard:0.5888394117355347 - timing_s/gen:4.945052903611213 - timing_s/reward:0.0353801348246634 - timing_s/old_log_prob:2.073252479080111 - timing_s/values:1.4305631699971855 - timing_s/adv:0.03337430767714977 - timing_s/update_critic:5.124726907815784 - timing_s/update_actor:6.785604943986982 - timing_s/step:20.4348678519018 - timing_s/stop_profile:1.7439015209674835e-06 - timing_per_token_ms/values:0.014741690917305759 - timing_per_token_ms/adv:0.0003439161154670119 - timing_per_token_ms/update_actor:0.06992441359397975 - timing_per_token_ms/update_critic:0.0528093702501575 - timing_per_token_ms/gen:0.07073455733959681 - perf/total_num_tokens:97042 - perf/time_per_step:20.4348678519018 - perf/throughput:1187.21100502454
[36m(TaskRunner pid=2914832)[0m Training Progress:  30%|██▉       | 129/435 [47:57<1:46:36, 20.90s/it]
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 130}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and bakes muffins for her friends every day with four. She sells the remainder at the farmers' market daily for $2 per fresh duck egg. How much in dollars does she make every day at the farmers' market? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much money Janet makes every day from selling the eggs, we need to follow these steps:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. Calculate the total number of eggs laid by the ducks in a day.
[36m(TaskRunner pid=2914832)[0m 2. Subtract the number of eggs eaten in a day and the number of eggs baked.
[36m(TaskRunner pid=2914832)[0m 3. Determine the number of eggs sold.
[36m(TaskRunner pid=2914832)[0m 4. Calculate the total revenue from selling the eggs.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m First, the ducks lay 16 eggs per day. Janet eats 3 eggs for breakfast and bakes 4 eggs for her friends, so the total number of eggs eaten in a day is:
[36m(TaskRunner pid=2914832)[0m \[ 3 + 4 = 7 \text{ eggs} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m The number of eggs baked is given as 4 eggs. Therefore, the number of eggs sold is the total number of eggs laid minus the number of eggs eaten and the number of eggs baked:
[36m(TaskRunner pid=2914832)[0m \[ 16 - 7 - 4 = 7 \text{ eggs} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Each egg is sold for $2, so the total revenue is:
[36m(TaskRunner pid=2914832)[0m \[ 7 \text{ eggs} \times 2 \text{ dollars/egg} = 14 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Therefore, the final answer is:
[36m(TaskRunner pid=2914832)[0m #### 14
[36m(TaskRunner pid=2914832)[0m [ground_truth] 18
[36m(TaskRunner pid=2914832)[0m [score] 0.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1312
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 130}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Tom's restaurant gets 6 reservations a night.  They normally order 2 meals that cost $5 each and a $5 bottle of wine.  How much do they make a week if they are open 2 days a week? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much Tom's restaurant makes in a week, we need to follow these steps:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. Calculate the total number of reservations per night.
[36m(TaskRunner pid=2914832)[0m 2. Determine the total number of meals ordered per night.
[36m(TaskRunner pid=2914832)[0m 3. Calculate the total revenue from meals.
[36m(TaskRunner pid=2914832)[0m 4. Calculate the total revenue from the wine.
[36m(TaskRunner pid=2914832)[0m 5. Add the revenue from meals and the revenue from the wine to get the total revenue for the week.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Let's start with the first step:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. The restaurant gets 6 reservations a night.
[36m(TaskRunner pid=2914832)[0m 2. They order 2 meals that cost $5 each and a $5 bottle of wine.
[36m(TaskRunner pid=2914832)[0m 3. The total number of meals ordered per night is:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    2 \text{ meals} + 1 \text{ bottle of wine} = 3 \text{ meals}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m 4. The total revenue from meals is:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    3 \text{ meals} \times 5 \text{ dollars per meal} = 15 \text{ dollars}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m 5. The total revenue from the wine is:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    1 \text{ bottle of wine} \times 5 \text{ dollars per bottle} = 5 \text{ dollars}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m 6. The total revenue for the week is the sum of the revenue from meals and the revenue from the wine:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    15 \text{ dollars} + 5 \text{ dollars} = 20 \text{ dollars}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Therefore, the final answer is:
[36m(TaskRunner pid=2914832)[0m #### 20
[36m(TaskRunner pid=2914832)[0m [ground_truth] 180
[36m(TaskRunner pid=2914832)[0m [score] 0.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1319
[36m(TaskRunner pid=2914832)[0m step:130 - global_seqlen/min:22585 - global_seqlen/max:24395 - global_seqlen/minmax_diff:1810 - global_seqlen/balanced_min:23613 - global_seqlen/balanced_max:23614 - global_seqlen/mean:23613.5 - actor/entropy:0.07364092022180557 - critic/vf_loss:0.07154875749256462 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.682974636554718 - critic/grad_norm:14.170820146799088 - perf/mfu/critic:0.09470883497453944 - critic/lr:1e-05 - actor/pg_loss:0.028734139632433653 - actor/pg_clipfrac:0.004230589132930618 - actor/ppo_kl:0.00037120872025298013 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.6928083896636963 - perf/mfu/actor:0.07087168317092624 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.57513809204102 - actor/lr:1e-06 - val-core/openai/gsm8k/reward/mean@1:0.5253980288097043 - training/global_step:130 - training/epoch:4 - critic/score/mean:0.671875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.671875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.475287980667872e-08 - critic/advantages/max:3.0112459659576416 - critic/advantages/min:-2.7133429050445557 - critic/returns/mean:0.6158892512321472 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.703125 - critic/values/max:1.3203125 - critic/values/min:-0.38671875 - critic/vf_explained_var:0.30382806062698364 - response_length/mean:266.1484375 - response_length/max:512.0 - response_length/min:109.0 - response_length/clip_ratio:0.01171875 - prompt_length/mean:102.8125 - prompt_length/max:201.0 - prompt_length/min:69.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.437752068042755e-06 - timing_s/generate_sequences:3.439682960510254 - timing_s/reshard:0.8632210493087769 - timing_s/gen:4.890871818643063 - timing_s/reward:0.034437724854797125 - timing_s/old_log_prob:2.4095379798673093 - timing_s/values:1.3403869988396764 - timing_s/adv:0.03453999012708664 - timing_s/update_critic:5.359274368733168 - timing_s/update_actor:7.161718152929097 - timing_s/testing:13.572538701817393 - timing_s/step:34.81143991323188 - timing_s/stop_profile:2.101995050907135e-06 - timing_per_token_ms/values:0.01419089714400318 - timing_per_token_ms/adv:0.0003656805442552633 - timing_per_token_ms/update_actor:0.0758222854821299 - timing_per_token_ms/update_critic:0.056739517317775504 - timing_per_token_ms/gen:0.07178313057567534 - perf/total_num_tokens:94454 - perf/time_per_step:34.81143991323188 - perf/throughput:678.3258623848097
[36m(TaskRunner pid=2914832)[0m Training Progress:  30%|██▉       | 130/435 [48:31<2:07:29, 25.08s/it]
[36m(TaskRunner pid=2914832)[0m step:131 - global_seqlen/min:23285 - global_seqlen/max:23996 - global_seqlen/minmax_diff:711 - global_seqlen/balanced_min:23596 - global_seqlen/balanced_max:23597 - global_seqlen/mean:23596.5 - actor/entropy:0.07016663253307343 - critic/vf_loss:0.10089684405829757 - critic/vf_clipfrac:6.332320481305942e-05 - critic/vpred_mean:0.618181997910142 - critic/grad_norm:24.96140718460083 - perf/mfu/critic:0.09449054130968502 - critic/lr:1e-05 - actor/pg_loss:0.061255402921233326 - actor/pg_clipfrac:0.0037675623752875254 - actor/ppo_kl:0.00012790436994691845 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.9982038140296936 - perf/mfu/actor:0.07400205490856017 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:87.86031341552734 - actor/lr:1e-06 - training/global_step:131 - training/epoch:4 - critic/score/mean:0.671875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.671875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:7.357273901220651e-09 - critic/advantages/max:2.52457857131958 - critic/advantages/min:-2.727705717086792 - critic/returns/mean:0.6163320541381836 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.490234375 - critic/values/max:1.0859375 - critic/values/min:-0.46484375 - critic/vf_explained_var:0.3001527786254883 - response_length/mean:264.81640625 - response_length/max:512.0 - response_length/min:116.0 - response_length/clip_ratio:0.02734375 - prompt_length/mean:103.87890625 - prompt_length/max:238.0 - prompt_length/min:65.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:6.3297338783741e-06 - timing_s/generate_sequences:3.4426259994506836 - timing_s/reshard:0.4013378620147705 - timing_s/gen:4.324082471895963 - timing_s/reward:0.03315822407603264 - timing_s/old_log_prob:2.0730985910631716 - timing_s/values:1.3383915172889829 - timing_s/adv:0.038715038914233446 - timing_s/update_critic:5.370937313884497 - timing_s/update_actor:6.8539976961910725 - timing_s/step:20.041283601894975 - timing_s/stop_profile:4.787929356098175e-06 - timing_per_token_ms/values:0.0141799792054858 - timing_per_token_ms/adv:0.0004101777690995852 - timing_per_token_ms/update_actor:0.07261667722110347 - timing_per_token_ms/update_critic:0.05690396153968276 - timing_per_token_ms/gen:0.0637836129378544 - perf/total_num_tokens:94386 - perf/time_per_step:20.041283601894975 - perf/throughput:1177.3946454092825
[36m(TaskRunner pid=2914832)[0m Training Progress:  30%|███       | 131/435 [48:51<1:59:25, 23.57s/it]
[36m(TaskRunner pid=2914832)[0m step:132 - global_seqlen/min:22986 - global_seqlen/max:24706 - global_seqlen/minmax_diff:1720 - global_seqlen/balanced_min:23527 - global_seqlen/balanced_max:23528 - global_seqlen/mean:23527.25 - actor/entropy:0.07138821482658386 - critic/vf_loss:0.1132639228599146 - critic/vf_clipfrac:0.007867452863138169 - critic/vpred_mean:0.739567069336772 - critic/grad_norm:39.94043970108032 - perf/mfu/critic:0.0984186102557105 - critic/lr:1e-05 - actor/pg_loss:0.11428973861620761 - actor/pg_clipfrac:0.0035985092545161024 - actor/ppo_kl:-0.0001041719824570464 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.0301044583320618 - perf/mfu/actor:0.07328447140375942 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.96123123168945 - actor/lr:1e-06 - training/global_step:132 - training/epoch:4 - critic/score/mean:0.65234375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.65234375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:1.8910542465278013e-08 - critic/advantages/max:2.8213419914245605 - critic/advantages/min:-2.7148630619049072 - critic/returns/mean:0.6099473834037781 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.93359375 - critic/values/max:1.6484375 - critic/values/min:0.029541015625 - critic/vf_explained_var:0.3135868310928345 - response_length/mean:262.00390625 - response_length/max:512.0 - response_length/min:120.0 - response_length/clip_ratio:0.01171875 - prompt_length/mean:105.609375 - prompt_length/max:202.0 - prompt_length/min:70.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.7031790018081665e-06 - timing_s/generate_sequences:3.536710262298584 - timing_s/reshard:0.5855389833450317 - timing_s/gen:5.033773358911276 - timing_s/reward:0.03357607685029507 - timing_s/old_log_prob:2.1429578899405897 - timing_s/values:1.621725784149021 - timing_s/adv:0.03769040713086724 - timing_s/update_critic:5.138952156994492 - timing_s/update_actor:6.8964941799640656 - timing_s/step:20.912297700997442 - timing_s/stop_profile:2.0922161638736725e-06 - timing_per_token_ms/values:0.01723241968514192 - timing_per_token_ms/adv:0.00040049737146146747 - timing_per_token_ms/update_actor:0.07328198344434715 - timing_per_token_ms/update_critic:0.05460638362956244 - timing_per_token_ms/gen:0.07504917565803343 - perf/total_num_tokens:94109 - perf/time_per_step:20.912297700997442 - perf/throughput:1125.0437582895463
[36m(TaskRunner pid=2914832)[0m Training Progress:  30%|███       | 132/435 [49:12<1:55:01, 22.78s/it]
[36m(TaskRunner pid=2914832)[0m step:133 - global_seqlen/min:22959 - global_seqlen/max:25024 - global_seqlen/minmax_diff:2065 - global_seqlen/balanced_min:23888 - global_seqlen/balanced_max:23888 - global_seqlen/mean:23888.0 - actor/entropy:0.07304669916629791 - critic/vf_loss:0.12078761239536107 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.508223676122725 - critic/grad_norm:28.89566993713379 - perf/mfu/critic:0.09252950612911685 - critic/lr:1e-05 - actor/pg_loss:-0.1515058611985296 - actor/pg_clipfrac:0.004191050276858732 - actor/ppo_kl:5.6351727835135534e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.943485736846924 - perf/mfu/actor:0.07583242186557998 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:87.02923202514648 - actor/lr:1e-06 - training/global_step:133 - training/epoch:4 - critic/score/mean:0.63671875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.63671875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-7.480989161479101e-09 - critic/advantages/max:2.766047716140747 - critic/advantages/min:-3.0742690563201904 - critic/returns/mean:0.5737690925598145 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.3515625 - critic/values/max:1.15625 - critic/values/min:-0.65625 - critic/vf_explained_var:0.24257749319076538 - response_length/mean:269.8984375 - response_length/max:512.0 - response_length/min:123.0 - response_length/clip_ratio:0.0234375 - prompt_length/mean:103.3515625 - prompt_length/max:195.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.584901034832001e-06 - timing_s/generate_sequences:3.461738348007202 - timing_s/reshard:0.5818517208099365 - timing_s/gen:4.83577266195789 - timing_s/reward:0.03415523236617446 - timing_s/old_log_prob:2.091915724799037 - timing_s/values:1.352828762959689 - timing_s/adv:0.0333719071932137 - timing_s/update_critic:5.551013259217143 - timing_s/update_actor:6.771655675955117 - timing_s/step:20.678373109083623 - timing_s/stop_profile:2.7008354663848877e-06 - timing_per_token_ms/values:0.014158037120726817 - timing_per_token_ms/adv:0.0003492538847246913 - timing_per_token_ms/update_actor:0.07086880102933603 - timing_per_token_ms/update_critic:0.05809416086756052 - timing_per_token_ms/gen:0.06998831536686094 - perf/total_num_tokens:95552 - perf/time_per_step:20.678373109083623 - perf/throughput:1155.2166059672484
[36m(TaskRunner pid=2914832)[0m Training Progress:  31%|███       | 133/435 [49:33<1:51:29, 22.15s/it]
[36m(TaskRunner pid=2914832)[0m step:134 - global_seqlen/min:22105 - global_seqlen/max:23494 - global_seqlen/minmax_diff:1389 - global_seqlen/balanced_min:22728 - global_seqlen/balanced_max:22729 - global_seqlen/mean:22728.25 - actor/entropy:0.06995416432619095 - critic/vf_loss:0.08921474637463689 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6371873468160629 - critic/grad_norm:19.768143475055695 - perf/mfu/critic:0.09524590796198446 - critic/lr:1e-05 - actor/pg_loss:-0.10557649028487504 - actor/pg_clipfrac:0.0025654448763816617 - actor/ppo_kl:-2.546935957070673e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.9639907479286194 - perf/mfu/actor:0.07119556661943974 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.13665008544922 - actor/lr:1e-06 - training/global_step:134 - training/epoch:4 - critic/score/mean:0.65234375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.65234375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:5.931345725684878e-08 - critic/advantages/max:2.632730007171631 - critic/advantages/min:-2.7755069732666016 - critic/returns/mean:0.61701500415802 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.78125 - critic/values/max:1.4140625 - critic/values/min:-0.05517578125 - critic/vf_explained_var:0.22421616315841675 - response_length/mean:252.671875 - response_length/max:512.0 - response_length/min:108.0 - response_length/clip_ratio:0.0078125 - prompt_length/mean:102.45703125 - prompt_length/max:178.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.2889809012413025e-06 - timing_s/generate_sequences:3.303300619125366 - timing_s/reshard:0.8867596983909607 - timing_s/gen:4.8792032091878355 - timing_s/reward:0.032868179958313704 - timing_s/old_log_prob:2.077714813873172 - timing_s/values:1.341212891973555 - timing_s/adv:0.035268573090434074 - timing_s/update_critic:5.123256632126868 - timing_s/update_actor:6.852675272151828 - timing_s/step:20.349196094088256 - timing_s/stop_profile:4.493165761232376e-06 - timing_per_token_ms/values:0.014752707445288959 - timing_per_token_ms/adv:0.00038793762267699973 - timing_per_token_ms/update_actor:0.07537618681763694 - timing_per_token_ms/update_critic:0.056353399757205984 - timing_per_token_ms/gen:0.07543137729868028 - perf/total_num_tokens:90913 - perf/time_per_step:20.349196094088256 - perf/throughput:1116.9114443102198
[36m(TaskRunner pid=2914832)[0m Training Progress:  31%|███       | 134/435 [49:53<1:48:27, 21.62s/it]
[36m(TaskRunner pid=2914832)[0m step:135 - global_seqlen/min:21324 - global_seqlen/max:25120 - global_seqlen/minmax_diff:3796 - global_seqlen/balanced_min:22814 - global_seqlen/balanced_max:22814 - global_seqlen/mean:22814.0 - actor/entropy:0.06751599162817001 - critic/vf_loss:0.10160170320887119 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6629466526210308 - critic/grad_norm:15.408581495285034 - perf/mfu/critic:0.09224815840672339 - critic/lr:1e-05 - actor/pg_loss:0.043685585958883166 - actor/pg_clipfrac:0.003433506062719971 - actor/ppo_kl:0.0001585684367455542 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.0208550691604614 - perf/mfu/actor:0.06827322363348064 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.89464950561523 - actor/lr:1e-06 - training/global_step:135 - training/epoch:4 - critic/score/mean:0.70703125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.70703125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.9789423433280717e-08 - critic/advantages/max:2.145195722579956 - critic/advantages/min:-2.5119757652282715 - critic/returns/mean:0.6492207050323486 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.5625 - critic/values/max:1.046875 - critic/values/min:-0.06689453125 - critic/vf_explained_var:0.2617231607437134 - response_length/mean:254.1328125 - response_length/max:512.0 - response_length/min:110.0 - response_length/clip_ratio:0.01171875 - prompt_length/mean:102.3359375 - prompt_length/max:177.0 - prompt_length/min:66.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.854293704032898e-06 - timing_s/generate_sequences:3.317620277404785 - timing_s/reshard:0.7695989608764648 - timing_s/gen:5.194205563981086 - timing_s/reward:0.03275249898433685 - timing_s/old_log_prob:2.1362641351297498 - timing_s/values:1.6030229260213673 - timing_s/adv:0.033540119882673025 - timing_s/update_critic:5.311051221098751 - timing_s/update_actor:7.17195553239435 - timing_s/step:21.489902678877115 - timing_s/stop_profile:1.6149133443832397e-06 - timing_per_token_ms/values:0.017566219492651084 - timing_per_token_ms/adv:0.00036753879068415253 - timing_per_token_ms/update_actor:0.07859160529054911 - timing_per_token_ms/update_critic:0.05819947423839255 - timing_per_token_ms/gen:0.07983961332935359 - perf/total_num_tokens:91256 - perf/time_per_step:21.489902678877115 - perf/throughput:1061.6148588901879
[36m(TaskRunner pid=2914832)[0m Training Progress:  31%|███       | 135/435 [50:15<1:47:54, 21.58s/it]
[36m(TaskRunner pid=2914832)[0m step:136 - global_seqlen/min:22109 - global_seqlen/max:24073 - global_seqlen/minmax_diff:1964 - global_seqlen/balanced_min:23326 - global_seqlen/balanced_max:23327 - global_seqlen/mean:23326.25 - actor/entropy:0.07293045520782471 - critic/vf_loss:0.07846806338056922 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6123431641608477 - critic/grad_norm:19.80440652370453 - perf/mfu/critic:0.09121496863615323 - critic/lr:1e-05 - actor/pg_loss:-0.01918521663174033 - actor/pg_clipfrac:0.0025939074039342813 - actor/ppo_kl:0.0006290254368650494 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.7128116488456726 - perf/mfu/actor:0.07391311030236257 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:87.15715789794922 - actor/lr:1e-06 - training/global_step:136 - training/epoch:4 - critic/score/mean:0.66796875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.66796875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:2.4884780458478417e-08 - critic/advantages/max:2.3244271278381348 - critic/advantages/min:-2.5215277671813965 - critic/returns/mean:0.606220006942749 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.51953125 - critic/values/max:1.09375 - critic/values/min:-0.1279296875 - critic/vf_explained_var:0.3185344934463501 - response_length/mean:261.37890625 - response_length/max:512.0 - response_length/min:112.0 - response_length/clip_ratio:0.03515625 - prompt_length/mean:103.09375 - prompt_length/max:212.0 - prompt_length/min:66.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.832858055830002e-06 - timing_s/generate_sequences:3.4695377349853516 - timing_s/reshard:0.58143550157547 - timing_s/gen:4.6048050206154585 - timing_s/reward:0.03350260015577078 - timing_s/old_log_prob:2.0755118620581925 - timing_s/values:1.3430888829752803 - timing_s/adv:0.03313735593110323 - timing_s/update_critic:5.495954275131226 - timing_s/update_actor:6.77931444067508 - timing_s/step:20.37288781395182 - timing_s/stop_profile:2.2221356630325317e-06 - timing_per_token_ms/values:0.01439460782353872 - timing_per_token_ms/adv:0.0003551509129318175 - timing_per_token_ms/update_actor:0.07265756862628026 - timing_per_token_ms/update_critic:0.05890310567634345 - timing_per_token_ms/gen:0.06881779356202021 - perf/total_num_tokens:93305 - perf/time_per_step:20.37288781395182 - perf/throughput:1144.9653192526614
[36m(TaskRunner pid=2914832)[0m Training Progress:  31%|███▏      | 136/435 [50:35<1:45:45, 21.22s/it]
[36m(TaskRunner pid=2914832)[0m step:137 - global_seqlen/min:22417 - global_seqlen/max:25111 - global_seqlen/minmax_diff:2694 - global_seqlen/balanced_min:23485 - global_seqlen/balanced_max:23486 - global_seqlen/mean:23485.25 - actor/entropy:0.06851889938116074 - critic/vf_loss:0.12124581215903163 - critic/vf_clipfrac:6.634819874307141e-05 - critic/vpred_mean:0.5507106278091669 - critic/grad_norm:33.286455035209656 - perf/mfu/critic:0.09825137285516779 - critic/lr:1e-05 - actor/pg_loss:0.12358199642039835 - actor/pg_clipfrac:0.00330744034727104 - actor/ppo_kl:-0.0003862885646412906 - actor/pg_clipfrac_lower:6.0386471886886284e-05 - actor/grad_norm:2.9966270327568054 - perf/mfu/actor:0.07439155280566916 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.007080078125 - actor/lr:1e-06 - training/global_step:137 - training/epoch:4 - critic/score/mean:0.58203125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.58203125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-3.829105921226983e-10 - critic/advantages/max:1.9925931692123413 - critic/advantages/min:-2.261190891265869 - critic/returns/mean:0.5198822021484375 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.73828125 - critic/values/max:1.2578125 - critic/values/min:0.07470703125 - critic/vf_explained_var:0.2758067846298218 - response_length/mean:262.6796875 - response_length/max:512.0 - response_length/min:86.0 - response_length/clip_ratio:0.01953125 - prompt_length/mean:104.27734375 - prompt_length/max:215.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.183966666460037e-06 - timing_s/generate_sequences:3.438466787338257 - timing_s/reshard:0.8678867816925049 - timing_s/gen:5.027592707891017 - timing_s/reward:0.0372431674040854 - timing_s/old_log_prob:2.4399688909761608 - timing_s/values:1.344991453923285 - timing_s/adv:0.04362528817728162 - timing_s/update_critic:5.1380086448043585 - timing_s/update_actor:6.783954033628106 - timing_s/step:20.822357130236924 - timing_s/stop_profile:2.1881423890590668e-06 - timing_per_token_ms/values:0.01431740617965835 - timing_per_token_ms/adv:0.00046439028940804995 - timing_per_token_ms/update_actor:0.0722150502296985 - timing_per_token_ms/update_critic:0.05469399564412087 - timing_per_token_ms/gen:0.0747641898089257 - perf/total_num_tokens:93941 - perf/time_per_step:20.822357130236924 - perf/throughput:1127.8862356027978
[36m(TaskRunner pid=2914832)[0m Training Progress:  31%|███▏      | 137/435 [50:56<1:44:49, 21.10s/it]
[36m(TaskRunner pid=2914832)[0m step:138 - global_seqlen/min:23782 - global_seqlen/max:24366 - global_seqlen/minmax_diff:584 - global_seqlen/balanced_min:23955 - global_seqlen/balanced_max:23956 - global_seqlen/mean:23955.5 - actor/entropy:0.06854617595672607 - critic/vf_loss:0.1166298808529973 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.3200192376971245 - critic/grad_norm:54.182007789611816 - perf/mfu/critic:0.09370003262115421 - critic/lr:1e-05 - actor/pg_loss:0.11654218984767795 - actor/pg_clipfrac:0.004066288820467889 - actor/ppo_kl:-0.00019036954176954168 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.6788256764411926 - perf/mfu/actor:0.07259222992747735 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.86955261230469 - actor/lr:1e-06 - training/global_step:138 - training/epoch:4 - critic/score/mean:0.6328125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.6328125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.8718139926932054e-08 - critic/advantages/max:2.214569330215454 - critic/advantages/min:-2.633385181427002 - critic/returns/mean:0.568997859954834 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.1962890625 - critic/values/max:0.84765625 - critic/values/min:-0.578125 - critic/vf_explained_var:0.22234416007995605 - response_length/mean:268.37890625 - response_length/max:512.0 - response_length/min:124.0 - response_length/clip_ratio:0.015625 - prompt_length/mean:105.92578125 - prompt_length/max:217.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.3869949877262115e-06 - timing_s/generate_sequences:3.4701828956604004 - timing_s/reshard:0.5836849212646484 - timing_s/gen:4.704068423714489 - timing_s/reward:0.03443326614797115 - timing_s/old_log_prob:2.13434404367581 - timing_s/values:1.6227684090845287 - timing_s/adv:0.0347399078309536 - timing_s/update_critic:5.4991375603713095 - timing_s/update_actor:7.095691700000316 - timing_s/step:21.132770993746817 - timing_s/stop_profile:6.451737135648727e-06 - timing_per_token_ms/values:0.016935238349069407 - timing_per_token_ms/adv:0.0003625462610982196 - timing_per_token_ms/update_actor:0.07405075765482161 - timing_per_token_ms/update_critic:0.0573890918616947 - timing_per_token_ms/gen:0.0684676286109379 - perf/total_num_tokens:95822 - perf/time_per_step:21.132770993746817 - perf/throughput:1133.5711728049496
[36m(TaskRunner pid=2914832)[0m Training Progress:  32%|███▏      | 138/435 [51:17<1:44:31, 21.12s/it]
[36m(TaskRunner pid=2914832)[0m step:139 - global_seqlen/min:21948 - global_seqlen/max:23419 - global_seqlen/minmax_diff:1471 - global_seqlen/balanced_min:22757 - global_seqlen/balanced_max:22758 - global_seqlen/mean:22757.25 - actor/entropy:0.07464002817869186 - critic/vf_loss:0.13164760661311448 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.9030169099569321 - critic/grad_norm:55.72377109527588 - perf/mfu/critic:0.08830674703843568 - critic/lr:1e-05 - actor/pg_loss:0.13448121675173752 - actor/pg_clipfrac:0.0033261523421970196 - actor/ppo_kl:-4.3208748820688925e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.8924686908721924 - perf/mfu/actor:0.07198998853872908 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.26280212402344 - actor/lr:1e-06 - training/global_step:139 - training/epoch:4 - critic/score/mean:0.65234375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.65234375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-5.3985754533414365e-08 - critic/advantages/max:2.4800808429718018 - critic/advantages/min:-2.6456785202026367 - critic/returns/mean:0.5880855917930603 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.7734375 - critic/values/max:1.3984375 - critic/values/min:0.038818359375 - critic/vf_explained_var:0.3112509846687317 - response_length/mean:251.73046875 - response_length/max:512.0 - response_length/min:114.0 - response_length/clip_ratio:0.02734375 - prompt_length/mean:103.8515625 - prompt_length/max:184.0 - prompt_length/min:66.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:6.759073585271835e-06 - timing_s/generate_sequences:3.3774518966674805 - timing_s/reshard:0.5790606141090393 - timing_s/gen:4.647341241128743 - timing_s/reward:0.03341721696779132 - timing_s/old_log_prob:2.075748775154352 - timing_s/values:1.340535477269441 - timing_s/adv:0.03411264484748244 - timing_s/update_critic:5.534324980806559 - timing_s/update_actor:6.78709332505241 - timing_s/step:20.45982691925019 - timing_s/stop_profile:2.3031607270240784e-06 - timing_per_token_ms/values:0.014726466041255434 - timing_per_token_ms/adv:0.00037474480492461133 - timing_per_token_ms/update_actor:0.07455968235455086 - timing_per_token_ms/update_critic:0.06079738304064155 - timing_per_token_ms/gen:0.07211553219323655 - perf/total_num_tokens:91029 - perf/time_per_step:20.45982691925019 - perf/throughput:1112.289468030065
[36m(TaskRunner pid=2914832)[0m Training Progress:  32%|███▏      | 139/435 [51:38<1:43:13, 20.92s/it]
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 140}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and bakes muffins for her friends every day with four. She sells the remainder at the farmers' market daily for $2 per fresh duck egg. How much in dollars does she make every day at the farmers' market? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much money Janet makes every day from selling the eggs, we need to follow these steps:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. Calculate the total number of eggs laid by the ducks in a day.
[36m(TaskRunner pid=2914832)[0m 2. Subtract the number of eggs eaten in a day and the number of eggs baked.
[36m(TaskRunner pid=2914832)[0m 3. Determine the number of eggs sold.
[36m(TaskRunner pid=2914832)[0m 4. Calculate the total revenue from selling the eggs.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m First, the ducks lay 16 eggs per day. Janet eats 3 eggs for breakfast and bakes 4 eggs for her friends, so the total number of eggs eaten in a day is:
[36m(TaskRunner pid=2914832)[0m \[ 3 + 4 = 7 \text{ eggs} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m The number of eggs baked is 16 - 7 = 9 eggs. Janet sells each egg for $2, so the total revenue is:
[36m(TaskRunner pid=2914832)[0m \[ 9 \times 2 = 18 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Therefore, the final answer is:
[36m(TaskRunner pid=2914832)[0m #### 18
[36m(TaskRunner pid=2914832)[0m [ground_truth] 18
[36m(TaskRunner pid=2914832)[0m [score] 1.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1312
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 140}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Tom's restaurant gets 6 reservations a night.  They normally order 2 meals that cost $5 each and a $5 bottle of wine.  How much do they make a week if they are open 2 days a week? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much Tom's restaurant makes in a week, we need to follow these steps:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. Calculate the total number of reservations per night.
[36m(TaskRunner pid=2914832)[0m 2. Determine the total number of meals ordered per night.
[36m(TaskRunner pid=2914832)[0m 3. Calculate the total revenue from meals.
[36m(TaskRunner pid=2914832)[0m 4. Calculate the total revenue from the wine.
[36m(TaskRunner pid=2914832)[0m 5. Add the revenue from meals and the revenue from the wine to get the total revenue for the week.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m First, the restaurant gets 6 reservations a night. Since they normally order 2 meals and a $5 bottle of wine per meal, the total number of meals ordered per night is:
[36m(TaskRunner pid=2914832)[0m \[ 6 \text{ reservations} \times 2 \text{ meals/reservation} = 12 \text{ meals} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Next, the cost of each meal is $5, so the total revenue from meals per night is:
[36m(TaskRunner pid=2914832)[0m \[ 12 \text{ meals} \times 5 \text{ dollars/meal} = 60 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m The cost of the wine is $5 per meal, so the total revenue from the wine per night is:
[36m(TaskRunner pid=2914832)[0m \[ 12 \text{ meals} \times 5 \text{ dollars/meal} = 60 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m The total revenue per night is the sum of the revenue from meals and the revenue from the wine:
[36m(TaskRunner pid=2914832)[0m \[ 60 \text{ dollars} + 60 \text{ dollars} = 120 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Since the restaurant is open 2 days a week, the total revenue for the week is:
[36m(TaskRunner pid=2914832)[0m \[ 120 \text{ dollars/day} \times 2 \text{ days/week} = 240 \text{ dollars/week} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Therefore, the final answer is:
[36m(TaskRunner pid=2914832)[0m #### 240
[36m(TaskRunner pid=2914832)[0m [ground_truth] 180
[36m(TaskRunner pid=2914832)[0m [score] 0.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1319
[36m(TaskRunner pid=2914832)[0m step:140 - global_seqlen/min:21347 - global_seqlen/max:23433 - global_seqlen/minmax_diff:2086 - global_seqlen/balanced_min:22638 - global_seqlen/balanced_max:22639 - global_seqlen/mean:22638.25 - actor/entropy:0.07622554898262024 - critic/vf_loss:0.08997642004396766 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.4589626044034958 - critic/grad_norm:28.462340593338013 - perf/mfu/critic:0.09066956234939844 - critic/lr:1e-05 - actor/pg_loss:-0.12620182102546096 - actor/pg_clipfrac:0.004123508726479486 - actor/ppo_kl:-0.0003698934210660809 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.04410457611084 - perf/mfu/actor:0.06893494455733809 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.26495361328125 - actor/lr:1e-06 - val-core/openai/gsm8k/reward/mean@1:0.5094768764215315 - training/global_step:140 - training/epoch:4 - critic/score/mean:0.6484375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.6484375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:3.6445204631974093e-09 - critic/advantages/max:2.4261133670806885 - critic/advantages/min:-2.861406087875366 - critic/returns/mean:0.5922632813453674 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.71875 - critic/values/max:1.2890625 - critic/values/min:-0.033447265625 - critic/vf_explained_var:0.334885835647583 - response_length/mean:250.4296875 - response_length/max:512.0 - response_length/min:81.0 - response_length/clip_ratio:0.0234375 - prompt_length/mean:103.29296875 - prompt_length/max:189.0 - prompt_length/min:66.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:6.861984729766846e-06 - timing_s/generate_sequences:3.3685643672943115 - timing_s/reshard:0.8570758700370789 - timing_s/gen:4.89082066481933 - timing_s/reward:0.03406968479976058 - timing_s/old_log_prob:2.4381282250396907 - timing_s/values:1.344740056898445 - timing_s/adv:0.03567556105554104 - timing_s/update_critic:5.362581611145288 - timing_s/update_actor:7.048828501719981 - timing_s/testing:13.111282161902636 - timing_s/step:34.27494117617607 - timing_s/stop_profile:2.522021532058716e-06 - timing_per_token_ms/values:0.01485030928736149 - timing_per_token_ms/adv:0.00039397436921516723 - timing_per_token_ms/update_actor:0.07784202071405676 - timing_per_token_ms/update_critic:0.059220363887947255 - timing_per_token_ms/gen:0.07628795296863719 - perf/total_num_tokens:90553 - perf/time_per_step:34.27494117617607 - perf/throughput:660.4898279369029
[36m(TaskRunner pid=2914832)[0m Training Progress:  32%|███▏      | 140/435 [52:12<2:02:34, 24.93s/it]
[36m(TaskRunner pid=2914832)[0m step:141 - global_seqlen/min:21844 - global_seqlen/max:25295 - global_seqlen/minmax_diff:3451 - global_seqlen/balanced_min:23361 - global_seqlen/balanced_max:23362 - global_seqlen/mean:23361.5 - actor/entropy:0.06834185123443604 - critic/vf_loss:0.12343845667783171 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6186251528561115 - critic/grad_norm:22.09217667579651 - perf/mfu/critic:0.09090103022657256 - critic/lr:1e-05 - actor/pg_loss:0.08507139253197238 - actor/pg_clipfrac:0.0032824049558257684 - actor/ppo_kl:-4.1703106035129167e-07 - actor/pg_clipfrac_lower:5.208333459449932e-05 - actor/grad_norm:2.788865327835083 - perf/mfu/actor:0.07385220417742913 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.33271026611328 - actor/lr:1e-06 - training/global_step:141 - training/epoch:4 - critic/score/mean:0.640625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.640625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:4.7635058564310384e-08 - critic/advantages/max:2.6079044342041016 - critic/advantages/min:-2.477520704269409 - critic/returns/mean:0.5851766467094421 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.421875 - critic/values/max:0.9765625 - critic/values/min:-0.39453125 - critic/vf_explained_var:0.2486531138420105 - response_length/mean:260.3046875 - response_length/max:512.0 - response_length/min:113.0 - response_length/clip_ratio:0.0234375 - prompt_length/mean:104.71875 - prompt_length/max:164.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.657799869775772e-06 - timing_s/generate_sequences:3.289790153503418 - timing_s/reshard:0.3009129762649536 - timing_s/gen:4.191713738255203 - timing_s/reward:0.03391531389206648 - timing_s/old_log_prob:2.0783120873384178 - timing_s/values:1.3455258943140507 - timing_s/adv:0.03481768071651459 - timing_s/update_critic:5.523548759054393 - timing_s/update_actor:6.795523259788752 - timing_s/step:20.012857703026384 - timing_s/stop_profile:2.0670704543590546e-06 - timing_per_token_ms/values:0.014398967257175809 - timing_per_token_ms/adv:0.0003725968015379426 - timing_per_token_ms/update_actor:0.07272139267372335 - timing_per_token_ms/update_critic:0.059109525919294484 - timing_per_token_ms/gen:0.06290275425815905 - perf/total_num_tokens:93446 - perf/time_per_step:20.012857703026384 - perf/throughput:1167.3245443836454
[36m(TaskRunner pid=2914832)[0m Training Progress:  32%|███▏      | 141/435 [52:32<1:54:57, 23.46s/it]
[36m(TaskRunner pid=2914832)[0m step:142 - global_seqlen/min:21637 - global_seqlen/max:23792 - global_seqlen/minmax_diff:2155 - global_seqlen/balanced_min:22969 - global_seqlen/balanced_max:22970 - global_seqlen/mean:22969.75 - actor/entropy:0.07313165813684464 - critic/vf_loss:0.09657638310454786 - critic/vf_clipfrac:5.374032843974419e-05 - critic/vpred_mean:0.6633035652339458 - critic/grad_norm:26.591832637786865 - perf/mfu/critic:0.09634209020139342 - critic/lr:1e-05 - actor/pg_loss:-0.08619405195349827 - actor/pg_clipfrac:0.002784698412142461 - actor/ppo_kl:-7.135192390705924e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.9642696380615234 - perf/mfu/actor:0.0721862161300586 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.08592987060547 - actor/lr:1e-06 - training/global_step:142 - training/epoch:4 - critic/score/mean:0.6796875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.6796875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.808061966812602e-08 - critic/advantages/max:2.528745412826538 - critic/advantages/min:-2.618638277053833 - critic/returns/mean:0.6149073243141174 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.81640625 - critic/values/max:1.359375 - critic/values/min:0.053955078125 - critic/vf_explained_var:0.34493905305862427 - response_length/mean:255.58984375 - response_length/max:512.0 - response_length/min:112.0 - response_length/clip_ratio:0.01171875 - prompt_length/mean:103.3125 - prompt_length/max:232.0 - prompt_length/min:63.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.020294338464737e-06 - timing_s/generate_sequences:3.1993751525878906 - timing_s/reshard:0.864948570728302 - timing_s/gen:4.83165321405977 - timing_s/reward:0.033659580163657665 - timing_s/old_log_prob:2.0802920409478247 - timing_s/values:1.335979111958295 - timing_s/adv:0.040388358291238546 - timing_s/update_critic:5.124196853023022 - timing_s/update_actor:6.831631944980472 - timing_s/step:20.28536552703008 - timing_s/stop_profile:1.85379758477211e-06 - timing_per_token_ms/values:0.014540636184093157 - timing_per_token_ms/adv:0.00043958204041444235 - timing_per_token_ms/update_actor:0.07435466151112302 - timing_per_token_ms/update_critic:0.055771143057967786 - timing_per_token_ms/gen:0.07384348724702007 - perf/total_num_tokens:91879 - perf/time_per_step:20.28536552703008 - perf/throughput:1132.3310871274664
[36m(TaskRunner pid=2914832)[0m Training Progress:  33%|███▎      | 142/435 [52:52<1:49:56, 22.51s/it]
[36m(TaskRunner pid=2914832)[0m step:143 - global_seqlen/min:22499 - global_seqlen/max:24191 - global_seqlen/minmax_diff:1692 - global_seqlen/balanced_min:23241 - global_seqlen/balanced_max:23242 - global_seqlen/mean:23241.5 - actor/entropy:0.07102993875741959 - critic/vf_loss:0.08840635942760855 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.4775471482425928 - critic/grad_norm:28.269145756959915 - perf/mfu/critic:0.08726197625143002 - critic/lr:1e-05 - actor/pg_loss:-0.0556128661846742 - actor/pg_clipfrac:0.003854981332551688 - actor/ppo_kl:0.0003432384810366784 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.81238454580307 - perf/mfu/actor:0.0718106221197372 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.05274200439453 - actor/lr:1e-06 - training/global_step:143 - training/epoch:4 - critic/score/mean:0.64453125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.64453125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:8.750030922044516e-09 - critic/advantages/max:2.7740304470062256 - critic/advantages/min:-2.5423364639282227 - critic/returns/mean:0.5754889249801636 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.361328125 - critic/values/max:0.94921875 - critic/values/min:-0.439453125 - critic/vf_explained_var:0.302068829536438 - response_length/mean:259.06640625 - response_length/max:512.0 - response_length/min:111.0 - response_length/clip_ratio:0.01171875 - prompt_length/mean:104.08203125 - prompt_length/max:216.0 - prompt_length/min:65.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.857778549194336e-06 - timing_s/generate_sequences:3.4698259830474854 - timing_s/reshard:0.7872980833053589 - timing_s/gen:5.2162561267614365 - timing_s/reward:0.0331284049898386 - timing_s/old_log_prob:2.122307810932398 - timing_s/values:1.6140616009943187 - timing_s/adv:0.034674006048589945 - timing_s/update_critic:5.723782737739384 - timing_s/update_actor:6.9532525930553675 - timing_s/step:21.706419792957604 - timing_s/stop_profile:5.612615495920181e-06 - timing_per_token_ms/values:0.017361848428396606 - timing_per_token_ms/adv:0.0003729751312156051 - timing_per_token_ms/update_actor:0.07479350077507226 - timing_per_token_ms/update_critic:0.06156855987930409 - timing_per_token_ms/gen:0.07865165071035474 - perf/total_num_tokens:92966 - perf/time_per_step:21.706419792957604 - perf/throughput:1070.7201013195383
[36m(TaskRunner pid=2914832)[0m Training Progress:  33%|███▎      | 143/435 [53:14<1:48:24, 22.27s/it]
[36m(TaskRunner pid=2914832)[0m step:144 - global_seqlen/min:22146 - global_seqlen/max:23326 - global_seqlen/minmax_diff:1180 - global_seqlen/balanced_min:22531 - global_seqlen/balanced_max:22532 - global_seqlen/mean:22531.75 - actor/entropy:0.06767784059047699 - critic/vf_loss:0.11114450133754872 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.8790227919816971 - critic/grad_norm:43.99925422668457 - perf/mfu/critic:0.08735577161612078 - critic/lr:1e-05 - actor/pg_loss:0.08302882919088006 - actor/pg_clipfrac:0.0034602727537276223 - actor/ppo_kl:-1.385569476042292e-06 - actor/pg_clipfrac_lower:6.275100167840719e-05 - actor/grad_norm:2.915944278240204 - perf/mfu/actor:0.07082085575046887 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:87.20953369140625 - actor/lr:1e-06 - training/global_step:144 - training/epoch:4 - critic/score/mean:0.69921875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.69921875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:7.237415111660539e-09 - critic/advantages/max:3.10166335105896 - critic/advantages/min:-2.5863351821899414 - critic/returns/mean:0.6440348029136658 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.703125 - critic/values/max:1.21875 - critic/values/min:-0.330078125 - critic/vf_explained_var:0.2893696427345276 - response_length/mean:250.671875 - response_length/max:512.0 - response_length/min:132.0 - response_length/clip_ratio:0.01171875 - prompt_length/mean:101.38671875 - prompt_length/max:181.0 - prompt_length/min:67.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:6.96815550327301e-06 - timing_s/generate_sequences:3.1942992210388184 - timing_s/reshard:0.875602126121521 - timing_s/gen:4.8409088482148945 - timing_s/reward:0.03329237690195441 - timing_s/old_log_prob:2.080910321790725 - timing_s/values:1.363574564922601 - timing_s/adv:0.034076028037816286 - timing_s/update_critic:5.53817353118211 - timing_s/update_actor:6.828972002957016 - timing_s/step:20.727559634950012 - timing_s/stop_profile:1.8118880689144135e-06 - timing_per_token_ms/values:0.01512947912304416 - timing_per_token_ms/adv:0.00037808900815312045 - timing_per_token_ms/update_actor:0.07577054604011024 - timing_per_token_ms/update_critic:0.06144855072488944 - timing_per_token_ms/gen:0.07543646525299032 - perf/total_num_tokens:90127 - perf/time_per_step:20.727559634950012 - perf/throughput:1087.0430671446643
[36m(TaskRunner pid=2914832)[0m Training Progress:  33%|███▎      | 144/435 [53:35<1:45:47, 21.81s/it]
[36m(TaskRunner pid=2914832)[0m step:145 - global_seqlen/min:22815 - global_seqlen/max:23838 - global_seqlen/minmax_diff:1023 - global_seqlen/balanced_min:23283 - global_seqlen/balanced_max:23284 - global_seqlen/mean:23283.25 - actor/entropy:0.07622526586055756 - critic/vf_loss:0.1389418172184378 - critic/vf_clipfrac:0.09105741884559393 - critic/vpred_mean:0.4179342489223927 - critic/grad_norm:45.802918910980225 - perf/mfu/critic:0.09711387692381085 - critic/lr:1e-05 - actor/pg_loss:-0.12586829671636224 - actor/pg_clipfrac:0.003871102861012332 - actor/ppo_kl:0.00045243306431075325 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.8518362641334534 - perf/mfu/actor:0.0726123176889445 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.25380325317383 - actor/lr:1e-06 - training/global_step:145 - training/epoch:4 - critic/score/mean:0.58203125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.58203125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:1.959029383158395e-08 - critic/advantages/max:2.679955005645752 - critic/advantages/min:-2.1351687908172607 - critic/returns/mean:0.5172053575515747 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.73046875 - critic/values/max:1.1796875 - critic/values/min:-0.1845703125 - critic/vf_explained_var:0.2597002387046814 - response_length/mean:261.66015625 - response_length/max:512.0 - response_length/min:93.0 - response_length/clip_ratio:0.0390625 - prompt_length/mean:102.140625 - prompt_length/max:211.0 - prompt_length/min:62.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:6.236135959625244e-06 - timing_s/generate_sequences:3.496410846710205 - timing_s/reshard:0.5856257677078247 - timing_s/gen:5.022891299799085 - timing_s/reward:0.039414570201188326 - timing_s/old_log_prob:2.1204979340545833 - timing_s/values:1.616080543026328 - timing_s/adv:0.039392739068716764 - timing_s/update_critic:5.155247202143073 - timing_s/update_actor:6.89306991128251 - timing_s/step:20.89432302583009 - timing_s/stop_profile:1.9399449229240417e-06 - timing_per_token_ms/values:0.017352394350298263 - timing_per_token_ms/adv:0.00042297294265960253 - timing_per_token_ms/update_actor:0.07401318449188268 - timing_per_token_ms/update_critic:0.055353604008708764 - timing_per_token_ms/gen:0.0749853146196773 - perf/total_num_tokens:93133 - perf/time_per_step:20.89432302583009 - perf/throughput:1114.3337820142178
[36m(TaskRunner pid=2914832)[0m Training Progress:  33%|███▎      | 145/435 [53:56<1:44:06, 21.54s/it]
[36m(TaskRunner pid=2914832)[0m step:146 - global_seqlen/min:22114 - global_seqlen/max:23172 - global_seqlen/minmax_diff:1058 - global_seqlen/balanced_min:22755 - global_seqlen/balanced_max:22756 - global_seqlen/mean:22755.25 - actor/entropy:0.06638085097074509 - critic/vf_loss:0.20936112123308703 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.19351480314071523 - critic/grad_norm:83.02414035797119 - perf/mfu/critic:0.08756248146775146 - critic/lr:1e-05 - actor/pg_loss:-0.20887256204150617 - actor/pg_clipfrac:0.0044797889568144456 - actor/ppo_kl:0.00029969395200168947 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.9716734290122986 - perf/mfu/actor:0.07197519413897178 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:87.8759536743164 - actor/lr:1e-06 - training/global_step:146 - training/epoch:5 - critic/score/mean:0.6640625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.6640625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:3.5089453120917824e-08 - critic/advantages/max:2.485466241836548 - critic/advantages/min:-2.3566837310791016 - critic/returns/mean:0.6081451177597046 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.050048828125 - critic/values/max:0.5 - critic/values/min:-0.7578125 - critic/vf_explained_var:0.3200339674949646 - response_length/mean:252.35546875 - response_length/max:512.0 - response_length/min:118.0 - response_length/clip_ratio:0.015625 - prompt_length/mean:103.1953125 - prompt_length/max:189.0 - prompt_length/min:66.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:1.2500211596488953e-05 - timing_s/generate_sequences:3.3912346363067627 - timing_s/reshard:0.5822744965553284 - timing_s/gen:4.568711718078703 - timing_s/reward:0.03582412004470825 - timing_s/old_log_prob:2.08743281615898 - timing_s/values:1.3518786006607115 - timing_s/adv:0.03732297709211707 - timing_s/update_critic:5.579475427046418 - timing_s/update_actor:6.787355889100581 - timing_s/step:20.459794525057077 - timing_s/stop_profile:2.2598542273044586e-06 - timing_per_token_ms/values:0.014852381325855698 - timing_per_token_ms/adv:0.00041004797895119883 - timing_per_token_ms/update_actor:0.07456912019314862 - timing_per_token_ms/update_critic:0.06129877091051975 - timing_per_token_ms/gen:0.07071980740954294 - perf/total_num_tokens:91021 - perf/time_per_step:20.459794525057077 - perf/throughput:1112.1934764365146
[36m(TaskRunner pid=2914832)[0m Training Progress:  34%|███▎      | 146/435 [54:17<1:42:52, 21.36s/it]
[36m(TaskRunner pid=2914832)[0m step:147 - global_seqlen/min:20884 - global_seqlen/max:22354 - global_seqlen/minmax_diff:1470 - global_seqlen/balanced_min:21551 - global_seqlen/balanced_max:21552 - global_seqlen/mean:21551.5 - actor/entropy:0.06493592262268066 - critic/vf_loss:0.13137454917887226 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.8398216068744659 - critic/grad_norm:37.98523283004761 - perf/mfu/critic:0.08647791746903816 - critic/lr:1e-05 - actor/pg_loss:0.12434883398236707 - actor/pg_clipfrac:0.0035745062632486224 - actor/ppo_kl:0.00036833207832387416 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.851169764995575 - perf/mfu/actor:0.06736667995237802 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:87.60548782348633 - actor/lr:1e-06 - training/global_step:147 - training/epoch:5 - critic/score/mean:0.66796875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.66796875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:1.6406152880676927e-08 - critic/advantages/max:2.625405788421631 - critic/advantages/min:-2.3868308067321777 - critic/returns/mean:0.6246731281280518 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.70703125 - critic/values/max:1.0703125 - critic/values/min:-0.12158203125 - critic/vf_explained_var:0.31279128789901733 - response_length/mean:237.51171875 - response_length/max:512.0 - response_length/min:117.0 - response_length/clip_ratio:0.00390625 - prompt_length/mean:99.23046875 - prompt_length/max:190.0 - prompt_length/min:65.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.007946699857712e-06 - timing_s/generate_sequences:3.0981125831604004 - timing_s/reshard:0.9119181632995605 - timing_s/gen:4.81455428339541 - timing_s/reward:0.03201259206980467 - timing_s/old_log_prob:2.0757098612375557 - timing_s/values:1.3408652269281447 - timing_s/adv:0.033939958084374666 - timing_s/update_critic:5.342329332139343 - timing_s/update_actor:6.856122666969895 - timing_s/step:20.50340313790366 - timing_s/stop_profile:2.192799001932144e-06 - timing_per_token_ms/values:0.015554198396029797 - timing_per_token_ms/adv:0.00039370760833787284 - timing_per_token_ms/update_actor:0.07953185006809149 - timing_per_token_ms/update_critic:0.06197166475812986 - timing_per_token_ms/gen:0.079182841034084 - perf/total_num_tokens:86206 - perf/time_per_step:20.50340313790366 - perf/throughput:1051.1181902363696
[36m(TaskRunner pid=2914832)[0m Training Progress:  34%|███▍      | 147/435 [54:37<1:41:18, 21.10s/it]
[36m(TaskRunner pid=2914832)[0m step:148 - global_seqlen/min:22247 - global_seqlen/max:23699 - global_seqlen/minmax_diff:1452 - global_seqlen/balanced_min:23049 - global_seqlen/balanced_max:23049 - global_seqlen/mean:23049.0 - actor/entropy:0.067581906914711 - critic/vf_loss:0.09243774123024195 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.4710757089778781 - critic/grad_norm:39.35257077217102 - perf/mfu/critic:0.08649690243389423 - critic/lr:1e-05 - actor/pg_loss:0.08701012950041331 - actor/pg_clipfrac:0.003782221865549218 - actor/ppo_kl:-0.00018958773944177665 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.7980366349220276 - perf/mfu/actor:0.0712676056800287 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.86941909790039 - actor/lr:1e-06 - training/global_step:148 - training/epoch:5 - critic/score/mean:0.68359375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.68359375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-2.4874813320252542e-09 - critic/advantages/max:2.2295875549316406 - critic/advantages/min:-2.5305988788604736 - critic/returns/mean:0.6276329755783081 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.6640625 - critic/values/max:1.09375 - critic/values/min:-0.020263671875 - critic/vf_explained_var:0.2757387161254883 - response_length/mean:257.58984375 - response_length/max:512.0 - response_length/min:109.0 - response_length/clip_ratio:0.015625 - prompt_length/mean:102.55078125 - prompt_length/max:191.0 - prompt_length/min:66.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.968846380710602e-06 - timing_s/generate_sequences:3.3981919288635254 - timing_s/reshard:0.5860781669616699 - timing_s/gen:5.016261727083474 - timing_s/reward:0.033253887202590704 - timing_s/old_log_prob:2.134891693945974 - timing_s/values:1.6293861460871994 - timing_s/adv:0.03439794294536114 - timing_s/update_critic:5.724214355926961 - timing_s/update_actor:6.944845975376666 - timing_s/step:21.523980075027794 - timing_s/stop_profile:2.0801089704036713e-06 - timing_per_token_ms/values:0.017673067661147984 - timing_per_token_ms/adv:0.00037309582785978934 - timing_per_token_ms/update_actor:0.07532697704213485 - timing_per_token_ms/update_critic:0.062087448001290305 - timing_per_token_ms/gen:0.07606966208821975 - perf/total_num_tokens:92196 - perf/time_per_step:21.523980075027794 - perf/throughput:1070.8521342082797
[36m(TaskRunner pid=2914832)[0m Training Progress:  34%|███▍      | 148/435 [54:59<1:41:34, 21.23s/it]
[36m(TaskRunner pid=2914832)[0m step:149 - global_seqlen/min:21467 - global_seqlen/max:23186 - global_seqlen/minmax_diff:1719 - global_seqlen/balanced_min:22216 - global_seqlen/balanced_max:22217 - global_seqlen/mean:22216.5 - actor/entropy:0.0652984008193016 - critic/vf_loss:0.09724732596077956 - critic/vf_clipfrac:0.07583786942996085 - critic/vpred_mean:0.7254255469888449 - critic/grad_norm:35.328307151794434 - perf/mfu/critic:0.08761221913191938 - critic/lr:1e-05 - actor/pg_loss:0.11557326768524945 - actor/pg_clipfrac:0.0029232605957076885 - actor/ppo_kl:-8.96379506230005e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.9962435960769653 - perf/mfu/actor:0.06995284843965874 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:87.29098510742188 - actor/lr:1e-06 - training/global_step:149 - training/epoch:5 - critic/score/mean:0.75 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.75 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-4.2877463357626766e-08 - critic/advantages/max:2.2504825592041016 - critic/advantages/min:-2.9921693801879883 - critic/returns/mean:0.7162598967552185 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.455078125 - critic/values/max:0.88671875 - critic/values/min:-0.2470703125 - critic/vf_explained_var:0.3099406361579895 - response_length/mean:245.35546875 - response_length/max:512.0 - response_length/min:119.0 - response_length/clip_ratio:0.0078125 - prompt_length/mean:101.77734375 - prompt_length/max:222.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.991198122501373e-06 - timing_s/generate_sequences:3.3297929763793945 - timing_s/reshard:0.9643586874008179 - timing_s/gen:4.826412335969508 - timing_s/reward:0.03706122189760208 - timing_s/old_log_prob:2.0880494071170688 - timing_s/values:1.342480197083205 - timing_s/adv:0.03509659320116043 - timing_s/update_critic:5.440816184040159 - timing_s/update_actor:6.811152300331742 - timing_s/step:20.587846944108605 - timing_s/stop_profile:2.1141022443771362e-06 - timing_per_token_ms/values:0.015106792216181723 - timing_per_token_ms/adv:0.00039493837014336675 - timing_per_token_ms/update_actor:0.07664519951760787 - timing_per_token_ms/update_critic:0.0612249474944316 - timing_per_token_ms/gen:0.07684024033958237 - perf/total_num_tokens:88866 - perf/time_per_step:20.587846944108605 - perf/throughput:1079.1074977540304
[36m(TaskRunner pid=2914832)[0m Training Progress:  34%|███▍      | 149/435 [55:19<1:40:18, 21.04s/it]
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 150}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and bakes muffins for her friends every day with four. She sells the remainder at the farmers' market daily for $2 per fresh duck egg. How much in dollars does she make every day at the farmers' market? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much money Janet makes every day from selling the eggs, we need to follow these steps:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. Calculate the total number of eggs laid by the ducks in a day.
[36m(TaskRunner pid=2914832)[0m 2. Subtract the number of eggs eaten in a day and the number of eggs baked.
[36m(TaskRunner pid=2914832)[0m 3. Determine the number of eggs sold.
[36m(TaskRunner pid=2914832)[0m 4. Calculate the total revenue from selling the eggs.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m First, the ducks lay 16 eggs per day. Janet eats 3 eggs for breakfast and bakes 4 eggs for her friends. Therefore, the total number of eggs eaten in a day is:
[36m(TaskRunner pid=2914832)[0m \[ 3 + 4 = 7 \text{ eggs} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m The number of eggs baked is 16 - 7 = 9 eggs. Janet sells each egg for $2. Therefore, the total revenue is:
[36m(TaskRunner pid=2914832)[0m \[ 9 \times 2 = 18 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m So, the final answer is:
[36m(TaskRunner pid=2914832)[0m #### 18
[36m(TaskRunner pid=2914832)[0m [ground_truth] 18
[36m(TaskRunner pid=2914832)[0m [score] 1.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1312
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 150}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Tom's restaurant gets 6 reservations a night.  They normally order 2 meals that cost $5 each and a $5 bottle of wine.  How much do they make a week if they are open 2 days a week? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much Tom's restaurant makes in a week, we need to calculate the daily revenue and then multiply by the number of days the restaurant is open.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m First, let's find the daily revenue from reservations:
[36m(TaskRunner pid=2914832)[0m \[ \text{Number of reservations per night} = 6 \]
[36m(TaskRunner pid=2914832)[0m \[ \text{Price of a reservation} = $5 \]
[36m(TaskRunner pid=2914832)[0m \[ \text{Total revenue from reservations per night} = 6 \times 5 = $30 \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Next, let's calculate the daily revenue from the meals:
[36m(TaskRunner pid=2914832)[0m \[ \text{Number of meals per reservation} = 2 \]
[36m(TaskRunner pid=2914832)[0m \[ \text{Price of a meal} = $5 \]
[36m(TaskRunner pid=2914832)[0m \[ \text{Total revenue from meals per reservation} = 2 \times 5 = $10 \]
[36m(TaskRunner pid=2914832)[0m \[ \text{Total revenue from meals per night} = 6 \times 10 = $60 \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Then, the daily revenue from the wine is:
[36m(TaskRunner pid=2914832)[0m \[ \text{Price of the wine} = $5 \]
[36m(TaskRunner pid=2914832)[0m \[ \text{Total revenue from wine per night} = 1 \times 5 = $5 \]
[36m(TaskRunner pid=2914832)[0m \[ \text{Total revenue per night} = 60 + 5 = $65 \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m The total daily revenue is the sum of the revenue from reservations and the revenue from the wine:
[36m(TaskRunner pid=2914832)[0m \[ \text{Total daily revenue} = 65 \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Since the restaurant is open for 2 days a week, the total weekly revenue is:
[36m(TaskRunner pid=2914832)[0m \[ \text{Total weekly revenue} = 2 \times 65 = $130 \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Therefore, the final answer is:
[36m(TaskRunner pid=2914832)[0m #### 130
[36m(TaskRunner pid=2914832)[0m [ground_truth] 180
[36m(TaskRunner pid=2914832)[0m [score] 0.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1319
[36m(TaskRunner pid=2914832)[0m step:150 - global_seqlen/min:22055 - global_seqlen/max:23302 - global_seqlen/minmax_diff:1247 - global_seqlen/balanced_min:22608 - global_seqlen/balanced_max:22608 - global_seqlen/mean:22608.0 - actor/entropy:0.06239684671163559 - critic/vf_loss:0.0849603045207914 - critic/vf_clipfrac:4.650297705666162e-05 - critic/vpred_mean:0.8496097326278687 - critic/grad_norm:40.67910146713257 - perf/mfu/critic:0.0885203811117497 - critic/lr:1e-05 - actor/pg_loss:0.06185886124148965 - actor/pg_clipfrac:0.0032036288830568083 - actor/ppo_kl:0.00025786437436181586 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.948906183242798 - perf/mfu/actor:0.06846358699561872 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.17940521240234 - actor/lr:1e-06 - val-core/openai/gsm8k/reward/mean@1:0.5072024260803639 - training/global_step:150 - training/epoch:5 - critic/score/mean:0.703125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.703125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:3.643008739118159e-08 - critic/advantages/max:2.3535046577453613 - critic/advantages/min:-2.7033426761627197 - critic/returns/mean:0.6699895262718201 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.98828125 - critic/values/max:1.4140625 - critic/values/min:0.1875 - critic/vf_explained_var:0.2576150894165039 - response_length/mean:249.61328125 - response_length/max:512.0 - response_length/min:104.0 - response_length/clip_ratio:0.00390625 - prompt_length/mean:103.63671875 - prompt_length/max:180.0 - prompt_length/min:64.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:6.103888154029846e-06 - timing_s/generate_sequences:3.3817179203033447 - timing_s/reshard:0.6864385604858398 - timing_s/gen:4.656692047137767 - timing_s/reward:0.03367719380185008 - timing_s/old_log_prob:2.447754492983222 - timing_s/values:1.7462503942660987 - timing_s/adv:0.036919618025422096 - timing_s/update_critic:5.484928843099624 - timing_s/update_actor:7.084885855671018 - timing_s/testing:13.122546026017517 - timing_s/step:34.620473308023065 - timing_s/stop_profile:2.4260953068733215e-06 - timing_per_token_ms/values:0.0193100937087104 - timing_per_token_ms/adv:0.00040825833803766475 - timing_per_token_ms/update_actor:0.07834489843939113 - timing_per_token_ms/update_critic:0.06065252170801955 - timing_per_token_ms/gen:0.07287353949293074 - perf/total_num_tokens:90432 - perf/time_per_step:34.620473308023065 - perf/throughput:653.0240011121034
[36m(TaskRunner pid=2914832)[0m Training Progress:  34%|███▍      | 150/435 [55:54<1:59:19, 25.12s/it]
[36m(TaskRunner pid=2914832)[0m step:151 - global_seqlen/min:21497 - global_seqlen/max:23008 - global_seqlen/minmax_diff:1511 - global_seqlen/balanced_min:22586 - global_seqlen/balanced_max:22587 - global_seqlen/mean:22586.25 - actor/entropy:0.07419096678495407 - critic/vf_loss:0.1150036680046469 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.48579139821231365 - critic/grad_norm:26.365975379943848 - perf/mfu/critic:0.0940752737778188 - critic/lr:1e-05 - actor/pg_loss:-0.03242971794679761 - actor/pg_clipfrac:0.0034037344048556406 - actor/ppo_kl:0.0002660011259649764 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.1185158491134644 - perf/mfu/actor:0.07068746456671259 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.40884017944336 - actor/lr:1e-06 - training/global_step:151 - training/epoch:5 - critic/score/mean:0.62109375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.62109375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:1.0179661558140651e-08 - critic/advantages/max:2.5524423122406006 - critic/advantages/min:-2.23958158493042 - critic/returns/mean:0.5510430932044983 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.4296875 - critic/values/max:0.89453125 - critic/values/min:-0.35546875 - critic/vf_explained_var:0.24414527416229248 - response_length/mean:249.21484375 - response_length/max:512.0 - response_length/min:118.0 - response_length/clip_ratio:0.01953125 - prompt_length/mean:103.6953125 - prompt_length/max:193.0 - prompt_length/min:63.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:6.717164069414139e-06 - timing_s/generate_sequences:3.332482099533081 - timing_s/reshard:0.39910784363746643 - timing_s/gen:4.353369393851608 - timing_s/reward:0.03376745106652379 - timing_s/old_log_prob:2.083313941024244 - timing_s/values:1.3405201686546206 - timing_s/adv:0.03448987705633044 - timing_s/update_critic:5.15721287811175 - timing_s/update_actor:6.85941953305155 - timing_s/step:19.87068854831159 - timing_s/stop_profile:2.1741725504398346e-06 - timing_per_token_ms/values:0.014837790344287128 - timing_per_token_ms/adv:0.00038175745261309916 - timing_per_token_ms/update_actor:0.07592472779956334 - timing_per_token_ms/update_critic:0.057083545056303614 - timing_per_token_ms/gen:0.068235699522745 - perf/total_num_tokens:90345 - perf/time_per_step:19.87068854831159 - perf/throughput:1136.661668521756
[36m(TaskRunner pid=2914832)[0m Training Progress:  35%|███▍      | 151/435 [56:14<1:51:28, 23.55s/it]
[36m(TaskRunner pid=2914832)[0m step:152 - global_seqlen/min:21220 - global_seqlen/max:24643 - global_seqlen/minmax_diff:3423 - global_seqlen/balanced_min:22530 - global_seqlen/balanced_max:22531 - global_seqlen/mean:22530.75 - actor/entropy:0.07292100042104721 - critic/vf_loss:0.07610391825437546 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.5714213363826275 - critic/grad_norm:21.985585719347 - perf/mfu/critic:0.09150316649043914 - critic/lr:1e-05 - actor/pg_loss:-0.04145926330238581 - actor/pg_clipfrac:0.0033410361829737667 - actor/ppo_kl:0.00015548240403973068 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.0392088294029236 - perf/mfu/actor:0.06732067967183224 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:86.14952087402344 - actor/lr:1e-06 - training/global_step:152 - training/epoch:5 - critic/score/mean:0.65234375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.65234375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:1.8239301624589643e-08 - critic/advantages/max:2.4284279346466064 - critic/advantages/min:-2.4811248779296875 - critic/returns/mean:0.5808873772621155 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.7109375 - critic/values/max:1.1484375 - critic/values/min:-0.08740234375 - critic/vf_explained_var:0.3896538019180298 - response_length/mean:247.13671875 - response_length/max:512.0 - response_length/min:98.0 - response_length/clip_ratio:0.02734375 - prompt_length/mean:104.90625 - prompt_length/max:196.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.346722900867462e-06 - timing_s/generate_sequences:3.3224551677703857 - timing_s/reshard:0.6846208572387695 - timing_s/gen:5.117342869285494 - timing_s/reward:0.03417657408863306 - timing_s/old_log_prob:2.114346847869456 - timing_s/values:1.617879340890795 - timing_s/adv:0.03578868694603443 - timing_s/update_critic:5.287971878889948 - timing_s/update_actor:7.1826602490618825 - timing_s/step:21.398254355881363 - timing_s/stop_profile:3.544008359313011e-05 - timing_per_token_ms/values:0.01795190285377534 - timing_per_token_ms/adv:0.0003971093610513901 - timing_per_token_ms/update_actor:0.07969841493361164 - timing_per_token_ms/update_critic:0.05867505385850391 - timing_per_token_ms/gen:0.08088486682291707 - perf/total_num_tokens:90123 - perf/time_per_step:21.398254355881363 - perf/throughput:1052.9246743815515
[36m(TaskRunner pid=2914832)[0m Training Progress:  35%|███▍      | 152/435 [56:35<1:48:03, 22.91s/it]
[36m(TaskRunner pid=2914832)[0m step:153 - global_seqlen/min:22056 - global_seqlen/max:23703 - global_seqlen/minmax_diff:1647 - global_seqlen/balanced_min:23111 - global_seqlen/balanced_max:23112 - global_seqlen/mean:23111.5 - actor/entropy:0.07297354936599731 - critic/vf_loss:0.1009185291477479 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.39952487125992775 - critic/grad_norm:31.929523587226868 - perf/mfu/critic:0.09042728255539872 - critic/lr:1e-05 - actor/pg_loss:0.031087783485418186 - actor/pg_clipfrac:0.0033289057173533365 - actor/ppo_kl:5.6211620176327415e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.9647151231765747 - perf/mfu/actor:0.07322699561610543 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.04325103759766 - actor/lr:1e-06 - training/global_step:153 - training/epoch:5 - critic/score/mean:0.62109375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.62109375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:6.102629868109943e-08 - critic/advantages/max:3.1096231937408447 - critic/advantages/min:-2.5401840209960938 - critic/returns/mean:0.5670389533042908 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.291015625 - critic/values/max:0.80859375 - critic/values/min:-0.59375 - critic/vf_explained_var:0.33596283197402954 - response_length/mean:255.65234375 - response_length/max:512.0 - response_length/min:109.0 - response_length/clip_ratio:0.015625 - prompt_length/mean:105.46484375 - prompt_length/max:201.0 - prompt_length/min:65.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:6.0140155255794525e-06 - timing_s/generate_sequences:3.408784866333008 - timing_s/reshard:0.5882032513618469 - timing_s/gen:4.655395266134292 - timing_s/reward:0.03349744575098157 - timing_s/old_log_prob:2.0824621017090976 - timing_s/values:1.3403146117925644 - timing_s/adv:0.035247950814664364 - timing_s/update_critic:5.492300495039672 - timing_s/update_actor:6.7786411982961 - timing_s/step:20.42571561411023 - timing_s/stop_profile:1.964159309864044e-06 - timing_per_token_ms/values:0.01449835159760903 - timing_per_token_ms/adv:0.00038128151369085046 - timing_per_token_ms/update_actor:0.07332541373662571 - timing_per_token_ms/update_critic:0.059410904690734824 - timing_per_token_ms/gen:0.0711322943165354 - perf/total_num_tokens:92446 - perf/time_per_step:20.42571561411023 - perf/throughput:1131.490344653306
[36m(TaskRunner pid=2914832)[0m Training Progress:  35%|███▌      | 153/435 [56:56<1:44:11, 22.17s/it]
[36m(TaskRunner pid=2914832)[0m step:154 - global_seqlen/min:21862 - global_seqlen/max:22817 - global_seqlen/minmax_diff:955 - global_seqlen/balanced_min:22258 - global_seqlen/balanced_max:22259 - global_seqlen/mean:22258.75 - actor/entropy:0.06946396082639694 - critic/vf_loss:0.12235422153025866 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.967365138232708 - critic/grad_norm:69.06686496734619 - perf/mfu/critic:0.08868062311847552 - critic/lr:1e-05 - actor/pg_loss:-0.10140802327077836 - actor/pg_clipfrac:0.003186052737873979 - actor/ppo_kl:-1.8981418179464526e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.0101487040519714 - perf/mfu/actor:0.07022830993222441 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.06587219238281 - actor/lr:1e-06 - training/global_step:154 - training/epoch:5 - critic/score/mean:0.65234375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.65234375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:4.1682842066848025e-08 - critic/advantages/max:3.0923142433166504 - critic/advantages/min:-2.409956693649292 - critic/returns/mean:0.592316746711731 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.875 - critic/values/max:1.3359375 - critic/values/min:-0.08740234375 - critic/vf_explained_var:0.24301379919052124 - response_length/mean:245.4609375 - response_length/max:512.0 - response_length/min:111.0 - response_length/clip_ratio:0.01953125 - prompt_length/mean:102.33203125 - prompt_length/max:206.0 - prompt_length/min:72.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.417262971401215e-06 - timing_s/generate_sequences:3.3906707763671875 - timing_s/reshard:0.8696135878562927 - timing_s/gen:4.876198293175548 - timing_s/reward:0.03214352112263441 - timing_s/old_log_prob:2.075934504158795 - timing_s/values:1.3442527800798416 - timing_s/adv:0.035964183043688536 - timing_s/update_critic:5.387862918898463 - timing_s/update_actor:6.804070932790637 - timing_s/step:20.564346647355705 - timing_s/stop_profile:5.6247226893901825e-06 - timing_per_token_ms/values:0.015098026395011418 - timing_per_token_ms/adv:0.0004039330942178754 - timing_per_token_ms/update_actor:0.07642018231920747 - timing_per_token_ms/update_critic:0.060513987969882214 - timing_per_token_ms/gen:0.0775995145163046 - perf/total_num_tokens:89035 - perf/time_per_step:20.564346647355705 - perf/throughput:1082.3951950285846
[36m(TaskRunner pid=2914832)[0m Training Progress:  35%|███▌      | 154/435 [57:16<1:41:35, 21.69s/it]
[36m(TaskRunner pid=2914832)[0m step:155 - global_seqlen/min:22044 - global_seqlen/max:24462 - global_seqlen/minmax_diff:2418 - global_seqlen/balanced_min:23102 - global_seqlen/balanced_max:23103 - global_seqlen/mean:23102.5 - actor/entropy:0.06645335257053375 - critic/vf_loss:0.09789793967502192 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.5398480296134949 - critic/grad_norm:32.665194034576416 - perf/mfu/critic:0.0905121295466161 - critic/lr:1e-05 - actor/pg_loss:0.06837446172721684 - actor/pg_clipfrac:0.0037413797981571406 - actor/ppo_kl:0.00035480646420182893 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.8691030740737915 - perf/mfu/actor:0.06961543553068739 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.02832794189453 - actor/lr:1e-06 - training/global_step:155 - training/epoch:5 - critic/score/mean:0.6796875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.6796875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-2.5205645570736124e-08 - critic/advantages/max:2.7262449264526367 - critic/advantages/min:-2.5613462924957275 - critic/returns/mean:0.62933748960495 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.79296875 - critic/values/max:1.2265625 - critic/values/min:-0.004486083984375 - critic/vf_explained_var:0.3241136074066162 - response_length/mean:255.5390625 - response_length/max:512.0 - response_length/min:99.0 - response_length/clip_ratio:0.0234375 - prompt_length/mean:105.4375 - prompt_length/max:256.0 - prompt_length/min:69.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.045665264129639e-06 - timing_s/generate_sequences:3.3479418754577637 - timing_s/reshard:0.5819119215011597 - timing_s/gen:4.925203041173518 - timing_s/reward:0.0345020592212677 - timing_s/old_log_prob:2.1166239008307457 - timing_s/values:1.6105726948007941 - timing_s/adv:0.03419215697795153 - timing_s/update_critic:5.48753511114046 - timing_s/update_actor:7.12737828399986 - timing_s/step:21.34444270702079 - timing_s/stop_profile:5.936715751886368e-06 - timing_per_token_ms/values:0.01742855421275613 - timing_per_token_ms/adv:0.00037000494511364056 - timing_per_token_ms/update_actor:0.07712778145222228 - timing_per_token_ms/update_critic:0.059382481453743745 - timing_per_token_ms/gen:0.07528819348151147 - perf/total_num_tokens:92410 - perf/time_per_step:21.34444270702079 - perf/throughput:1082.3660433355299
[36m(TaskRunner pid=2914832)[0m Training Progress:  36%|███▌      | 155/435 [57:38<1:40:45, 21.59s/it]
[36m(TaskRunner pid=2914832)[0m step:156 - global_seqlen/min:20747 - global_seqlen/max:22508 - global_seqlen/minmax_diff:1761 - global_seqlen/balanced_min:21630 - global_seqlen/balanced_max:21631 - global_seqlen/mean:21630.5 - actor/entropy:0.07219542562961578 - critic/vf_loss:0.09491931134834886 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6331428568810225 - critic/grad_norm:16.33166217803955 - perf/mfu/critic:0.09082332065825528 - critic/lr:1e-05 - actor/pg_loss:0.18805907014757395 - actor/pg_clipfrac:0.003839315628283657 - actor/ppo_kl:-0.0003289006864406474 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.210534155368805 - perf/mfu/actor:0.06841660391671471 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:86.55925369262695 - actor/lr:1e-06 - training/global_step:156 - training/epoch:5 - critic/score/mean:0.65625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.65625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:4.684637566754191e-09 - critic/advantages/max:2.7980146408081055 - critic/advantages/min:-2.459510564804077 - critic/returns/mean:0.6065562963485718 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.50390625 - critic/values/max:0.92578125 - critic/values/min:-0.26953125 - critic/vf_explained_var:0.27204614877700806 - response_length/mean:233.79296875 - response_length/max:512.0 - response_length/min:82.0 - response_length/clip_ratio:0.0078125 - prompt_length/mean:104.18359375 - prompt_length/max:212.0 - prompt_length/min:70.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.0980750024318695e-06 - timing_s/generate_sequences:3.3015871047973633 - timing_s/reshard:0.9510083794593811 - timing_s/gen:4.943827485665679 - timing_s/reward:0.03277221787720919 - timing_s/old_log_prob:2.0789286782965064 - timing_s/values:1.345395516604185 - timing_s/adv:0.034093908965587616 - timing_s/update_critic:5.108803049195558 - timing_s/update_actor:6.7782349633052945 - timing_s/step:20.328955130651593 - timing_s/stop_profile:2.6081688702106476e-06 - timing_per_token_ms/values:0.015549750544418588 - timing_per_token_ms/adv:0.00039404901603739645 - timing_per_token_ms/update_actor:0.07834117291908757 - timing_per_token_ms/update_critic:0.05904628937374954 - timing_per_token_ms/gen:0.0826022536910942 - perf/total_num_tokens:86522 - perf/time_per_step:20.328955130651593 - perf/throughput:1064.0241891914043
[36m(TaskRunner pid=2914832)[0m Training Progress:  36%|███▌      | 156/435 [57:58<1:38:39, 21.22s/it]
[36m(TaskRunner pid=2914832)[0m step:157 - global_seqlen/min:21516 - global_seqlen/max:23060 - global_seqlen/minmax_diff:1544 - global_seqlen/balanced_min:22347 - global_seqlen/balanced_max:22348 - global_seqlen/mean:22347.75 - actor/entropy:0.06732583045959473 - critic/vf_loss:0.07232103298883885 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6053867749869823 - critic/grad_norm:13.149732828140259 - perf/mfu/critic:0.09344804659593538 - critic/lr:1e-05 - actor/pg_loss:-0.11975857807556167 - actor/pg_clipfrac:0.0038271829689620063 - actor/ppo_kl:0.00020500261780398432 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.9991169571876526 - perf/mfu/actor:0.07068543337827965 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.92136001586914 - actor/lr:1e-06 - training/global_step:157 - training/epoch:5 - critic/score/mean:0.66796875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.66796875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.1207466066309735e-08 - critic/advantages/max:2.430506706237793 - critic/advantages/min:-2.632323741912842 - critic/returns/mean:0.6152341365814209 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.53515625 - critic/values/max:0.99609375 - critic/values/min:-0.21875 - critic/vf_explained_var:0.3640174865722656 - response_length/mean:243.64453125 - response_length/max:512.0 - response_length/min:115.0 - response_length/clip_ratio:0.015625 - prompt_length/mean:105.5390625 - prompt_length/max:184.0 - prompt_length/min:67.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.916917532682419e-06 - timing_s/generate_sequences:3.438354969024658 - timing_s/reshard:0.8704749345779419 - timing_s/gen:4.8844348839484155 - timing_s/reward:0.0366240362636745 - timing_s/old_log_prob:2.4484456651844084 - timing_s/values:1.3434982099570334 - timing_s/adv:0.03698321059346199 - timing_s/update_critic:5.133328264579177 - timing_s/update_actor:6.78201796207577 - timing_s/step:20.671993013005704 - timing_s/stop_profile:2.5299377739429474e-06 - timing_per_token_ms/values:0.015029457215570174 - timing_per_token_ms/adv:0.00041372409519372185 - timing_per_token_ms/update_actor:0.07586913628973577 - timing_per_token_ms/update_critic:0.05742556034253087 - timing_per_token_ms/gen:0.07831008423433883 - perf/total_num_tokens:89391 - perf/time_per_step:20.671993013005704 - perf/throughput:1081.064123132201
[36m(TaskRunner pid=2914832)[0m Training Progress:  36%|███▌      | 157/435 [58:19<1:37:33, 21.06s/it]
[36m(TaskRunner pid=2914832)[0m step:158 - global_seqlen/min:22187 - global_seqlen/max:23216 - global_seqlen/minmax_diff:1029 - global_seqlen/balanced_min:22857 - global_seqlen/balanced_max:22858 - global_seqlen/mean:22857.75 - actor/entropy:0.07225987315177917 - critic/vf_loss:0.0999255571514368 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.611376415938139 - critic/grad_norm:20.584996342658997 - perf/mfu/critic:0.09239055729671387 - critic/lr:1e-05 - actor/pg_loss:-0.03317329008132219 - actor/pg_clipfrac:0.0037753676442662254 - actor/ppo_kl:8.82486951923056e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.0701217651367188 - perf/mfu/actor:0.06820155214960785 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.1026496887207 - actor/lr:1e-06 - training/global_step:158 - training/epoch:5 - critic/score/mean:0.63671875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.63671875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:8.617139890532144e-09 - critic/advantages/max:2.620605230331421 - critic/advantages/min:-2.6010053157806396 - critic/returns/mean:0.5703936815261841 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.7109375 - critic/values/max:1.2421875 - critic/values/min:-0.007171630859375 - critic/vf_explained_var:0.3657470941543579 - response_length/mean:252.90234375 - response_length/max:512.0 - response_length/min:111.0 - response_length/clip_ratio:0.01171875 - prompt_length/mean:104.25 - prompt_length/max:182.0 - prompt_length/min:69.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.7280842661857605e-06 - timing_s/generate_sequences:3.54768705368042 - timing_s/reshard:0.5811268091201782 - timing_s/gen:5.090188486035913 - timing_s/reward:0.03328931890428066 - timing_s/old_log_prob:2.090184684842825 - timing_s/values:1.348076966125518 - timing_s/adv:0.03453365806490183 - timing_s/update_critic:5.3160244738683105 - timing_s/update_actor:7.19629723392427 - timing_s/step:21.11627979017794 - timing_s/stop_profile:3.145076334476471e-05 - timing_per_token_ms/values:0.014744200174180728 - timing_per_token_ms/adv:0.00037770185237940993 - timing_per_token_ms/update_actor:0.07870741033045979 - timing_per_token_ms/update_critic:0.058142473273488315 - timing_per_token_ms/gen:0.07862144920741877 - perf/total_num_tokens:91431 - perf/time_per_step:21.11627979017794 - perf/throughput:1082.4705027176278
[36m(TaskRunner pid=2914832)[0m Training Progress:  36%|███▋      | 158/435 [58:40<1:37:18, 21.08s/it]
[36m(TaskRunner pid=2914832)[0m step:159 - global_seqlen/min:20640 - global_seqlen/max:22952 - global_seqlen/minmax_diff:2312 - global_seqlen/balanced_min:21960 - global_seqlen/balanced_max:21961 - global_seqlen/mean:21960.5 - actor/entropy:0.06885506212711334 - critic/vf_loss:0.06599626704701222 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.7204977981746197 - critic/grad_norm:24.655358254909515 - perf/mfu/critic:0.09177191171762572 - critic/lr:1e-05 - actor/pg_loss:-0.07363341469317675 - actor/pg_clipfrac:0.004738653762615286 - actor/ppo_kl:4.970047939423239e-06 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.8372510075569153 - perf/mfu/actor:0.06952183676957742 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.58356857299805 - actor/lr:1e-06 - training/global_step:159 - training/epoch:5 - critic/score/mean:0.65234375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.65234375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:7.945360813721436e-09 - critic/advantages/max:2.6881730556488037 - critic/advantages/min:-2.7455074787139893 - critic/returns/mean:0.6133365631103516 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.6015625 - critic/values/max:1.1796875 - critic/values/min:-0.14453125 - critic/vf_explained_var:0.2785993218421936 - response_length/mean:241.93359375 - response_length/max:512.0 - response_length/min:98.0 - response_length/clip_ratio:0.015625 - prompt_length/mean:101.19921875 - prompt_length/max:195.0 - prompt_length/min:64.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.974899977445602e-06 - timing_s/generate_sequences:3.1835665702819824 - timing_s/reshard:0.9166209101676941 - timing_s/gen:4.954381952062249 - timing_s/reward:0.03295553009957075 - timing_s/old_log_prob:2.07659017900005 - timing_s/values:1.3500939849764109 - timing_s/adv:0.035313085187226534 - timing_s/update_critic:5.135693162679672 - timing_s/update_actor:6.775389678776264 - timing_s/step:20.36783966096118 - timing_s/stop_profile:2.0577572286128998e-06 - timing_per_token_ms/values:0.015369572470758985 - timing_per_token_ms/adv:0.00040200684396104975 - timing_per_token_ms/update_actor:0.07713155072489543 - timing_per_token_ms/update_critic:0.05846512104323299 - timing_per_token_ms/gen:0.07999325021493904 - perf/total_num_tokens:87842 - perf/time_per_step:20.36783966096118 - perf/throughput:1078.194858441048
[36m(TaskRunner pid=2914832)[0m Training Progress:  37%|███▋      | 159/435 [59:00<1:35:59, 20.87s/it]
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 160}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and bakes muffins for her friends every day with four. She sells the remainder at the farmers' market daily for $2 per fresh duck egg. How much in dollars does she make every day at the farmers' market? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much Janet makes every day from selling the eggs, we need to follow these steps:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. Calculate the total number of eggs laid by the ducks in a day.
[36m(TaskRunner pid=2914832)[0m 2. Subtract the number of eggs eaten in a day and the number of eggs baked.
[36m(TaskRunner pid=2914832)[0m 3. Determine the number of eggs sold.
[36m(TaskRunner pid=2914832)[0m 4. Calculate the total revenue from selling the eggs.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m First, the ducks lay 16 eggs per day. Janet eats 3 eggs for breakfast and bakes 4 muffins, so the total number of eggs eaten in a day is:
[36m(TaskRunner pid=2914832)[0m \[ 3 + 4 = 7 \text{ eggs} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m The number of eggs baked is 16. Therefore, the number of eggs sold is the total number of eggs laid minus the number of eggs eaten and the number of eggs baked:
[36m(TaskRunner pid=2914832)[0m \[ 16 - 7 - 16 = 1 \text{ egg} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Since each egg is sold for $2, the total revenue is:
[36m(TaskRunner pid=2914832)[0m \[ 1 \times 2 = 2 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Therefore, the final answer is:
[36m(TaskRunner pid=2914832)[0m #### 2
[36m(TaskRunner pid=2914832)[0m [ground_truth] 18
[36m(TaskRunner pid=2914832)[0m [score] 0.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1312
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 160}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Tom's restaurant gets 6 reservations a night.  They normally order 2 meals that cost $5 each and a $5 bottle of wine.  How much do they make a week if they are open 2 days a week? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much Tom's restaurant makes in a week, we need to calculate the daily revenue and then multiply by the number of days the restaurant is open.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m First, let's find the daily revenue from reservations. The restaurant gets 6 reservations a night, and each reservation costs $5. Therefore, the daily revenue from reservations is:
[36m(TaskRunner pid=2914832)[0m \[ 6 \times 5 = 30 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Next, the restaurant orders 2 meals that cost $5 each. They also order a $5 bottle of wine. Therefore, the total revenue from meals and wine is:
[36m(TaskRunner pid=2914832)[0m \[ 2 \times 5 + 5 = 10 + 5 = 15 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m The total daily revenue is the sum of the revenue from reservations and the revenue from meals and wine:
[36m(TaskRunner pid=2914832)[0m \[ 30 + 15 = 45 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Since the restaurant is open for 2 days a week, the total weekly revenue is:
[36m(TaskRunner pid=2914832)[0m \[ 45 \times 2 = 90 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Therefore, the final answer is:
[36m(TaskRunner pid=2914832)[0m #### 90
[36m(TaskRunner pid=2914832)[0m [ground_truth] 180
[36m(TaskRunner pid=2914832)[0m [score] 0.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1319
[36m(TaskRunner pid=2914832)[0m step:160 - global_seqlen/min:21721 - global_seqlen/max:22648 - global_seqlen/minmax_diff:927 - global_seqlen/balanced_min:22313 - global_seqlen/balanced_max:22313 - global_seqlen/mean:22313.0 - actor/entropy:0.07052817195653915 - critic/vf_loss:0.10940771288005635 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.5180840706452727 - critic/grad_norm:35.48904073238373 - perf/mfu/critic:0.09014539765663541 - critic/lr:1e-05 - actor/pg_loss:-0.18107967567630112 - actor/pg_clipfrac:0.002892353673814796 - actor/ppo_kl:0.0006621671341235924 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.080000579357147 - perf/mfu/actor:0.07027649611203189 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.26395034790039 - actor/lr:1e-06 - val-core/openai/gsm8k/reward/mean@1:0.5329795299469295 - training/global_step:160 - training/epoch:5 - critic/score/mean:0.703125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.703125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.8589553230086153e-09 - critic/advantages/max:3.0453689098358154 - critic/advantages/min:-2.8006343841552734 - critic/returns/mean:0.6634126305580139 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.69921875 - critic/values/max:1.171875 - critic/values/min:-0.2099609375 - critic/vf_explained_var:0.32101738452911377 - response_length/mean:246.48828125 - response_length/max:512.0 - response_length/min:121.0 - response_length/clip_ratio:0.01953125 - prompt_length/mean:102.15234375 - prompt_length/max:189.0 - prompt_length/min:67.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.854053258895874e-06 - timing_s/generate_sequences:3.3081257343292236 - timing_s/reshard:0.8657209873199463 - timing_s/gen:4.87049360293895 - timing_s/reward:0.03752047615125775 - timing_s/old_log_prob:2.0880014118738472 - timing_s/values:1.342576403170824 - timing_s/adv:0.03515055309981108 - timing_s/update_critic:5.311706776265055 - timing_s/update_actor:6.8118509338237345 - timing_s/testing:13.727237109094858 - timing_s/step:34.23208384029567 - timing_s/stop_profile:2.299901098012924e-06 - timing_per_token_ms/values:0.015042535777022633 - timing_per_token_ms/adv:0.0003938349067786837 - timing_per_token_ms/update_actor:0.07632154947590793 - timing_per_token_ms/update_critic:0.0595135882250824 - timing_per_token_ms/gen:0.07718568014673223 - perf/total_num_tokens:89252 - perf/time_per_step:34.23208384029567 - perf/throughput:651.8154169082356
[36m(TaskRunner pid=2914832)[0m Training Progress:  37%|███▋      | 160/435 [59:34<1:54:02, 24.88s/it]
[36m(TaskRunner pid=2914832)[0m step:161 - global_seqlen/min:22418 - global_seqlen/max:22995 - global_seqlen/minmax_diff:577 - global_seqlen/balanced_min:22762 - global_seqlen/balanced_max:22763 - global_seqlen/mean:22762.25 - actor/entropy:0.06407900154590607 - critic/vf_loss:0.1068955291993916 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6432350035756826 - critic/grad_norm:12.775037109851837 - perf/mfu/critic:0.08844283626800425 - critic/lr:1e-05 - actor/pg_loss:-0.002155089874577243 - actor/pg_clipfrac:0.0036183566990075633 - actor/ppo_kl:0.0008857723387336591 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.86176997423172 - perf/mfu/actor:0.07207785021198788 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.10637283325195 - actor/lr:1e-06 - training/global_step:161 - training/epoch:5 - critic/score/mean:0.73046875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.73046875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:2.207296212475285e-08 - critic/advantages/max:3.0619397163391113 - critic/advantages/min:-2.5730645656585693 - critic/returns/mean:0.6785026788711548 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.48828125 - critic/values/max:0.98046875 - critic/values/min:-0.4921875 - critic/vf_explained_var:0.1722545623779297 - response_length/mean:249.61328125 - response_length/max:512.0 - response_length/min:120.0 - response_length/clip_ratio:0.0078125 - prompt_length/mean:106.046875 - prompt_length/max:189.0 - prompt_length/min:73.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.462672561407089e-06 - timing_s/generate_sequences:3.4309513568878174 - timing_s/reshard:0.30120930075645447 - timing_s/gen:4.494705838616937 - timing_s/reward:0.03342106193304062 - timing_s/old_log_prob:2.0861299908719957 - timing_s/values:1.3370880489237607 - timing_s/adv:0.033611537888646126 - timing_s/update_critic:5.523933870252222 - timing_s/update_actor:6.776667579077184 - timing_s/step:20.293416189029813 - timing_s/stop_profile:6.579328328371048e-06 - timing_per_token_ms/values:0.014685367757183062 - timing_per_token_ms/adv:0.0003691587814105166 - timing_per_token_ms/update_actor:0.0744287974505726 - timing_per_token_ms/update_critic:0.060669901594220935 - timing_per_token_ms/gen:0.0703385837250894 - perf/total_num_tokens:91049 - perf/time_per_step:20.293416189029813 - perf/throughput:1121.656885561968
[36m(TaskRunner pid=2914832)[0m Training Progress:  37%|███▋      | 161/435 [59:55<1:47:21, 23.51s/it]
[36m(TaskRunner pid=2914832)[0m step:162 - global_seqlen/min:21569 - global_seqlen/max:24635 - global_seqlen/minmax_diff:3066 - global_seqlen/balanced_min:23113 - global_seqlen/balanced_max:23114 - global_seqlen/mean:23113.5 - actor/entropy:0.06674949079751968 - critic/vf_loss:0.0952766858972609 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.5588664319366217 - critic/grad_norm:13.263034462928772 - perf/mfu/critic:0.09676636906359398 - critic/lr:1e-05 - actor/pg_loss:-0.11169479519594461 - actor/pg_clipfrac:0.0044522685202537104 - actor/ppo_kl:0.00041354431050422136 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.980921685695648 - perf/mfu/actor:0.07198230741407076 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.04712677001953 - actor/lr:1e-06 - training/global_step:162 - training/epoch:5 - critic/score/mean:0.62109375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.62109375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-6.644851335835256e-09 - critic/advantages/max:2.4062719345092773 - critic/advantages/min:-2.136451482772827 - critic/returns/mean:0.5548796057701111 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.671875 - critic/values/max:1.0859375 - critic/values/min:-0.10009765625 - critic/vf_explained_var:0.2845444083213806 - response_length/mean:256.20703125 - response_length/max:512.0 - response_length/min:98.0 - response_length/clip_ratio:0.01171875 - prompt_length/mean:104.94140625 - prompt_length/max:184.0 - prompt_length/min:70.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.920673280954361e-06 - timing_s/generate_sequences:3.392376184463501 - timing_s/reshard:0.8669437170028687 - timing_s/gen:4.827942306175828 - timing_s/reward:0.03395323175936937 - timing_s/old_log_prob:2.0766196162439883 - timing_s/values:1.3408605703152716 - timing_s/adv:0.03477316116914153 - timing_s/update_critic:5.132936059962958 - timing_s/update_actor:6.896585319656879 - timing_s/step:20.350996578112245 - timing_s/stop_profile:2.239830791950226e-06 - timing_per_token_ms/values:0.01450300225317749 - timing_per_token_ms/adv:0.00037611310672487435 - timing_per_token_ms/update_actor:0.07459477491138164 - timing_per_token_ms/update_critic:0.05551881000241156 - timing_per_token_ms/gen:0.07360902447324746 - perf/total_num_tokens:92454 - perf/time_per_step:20.350996578112245 - perf/throughput:1135.7429063134364
[36m(TaskRunner pid=2914832)[0m Training Progress:  37%|███▋      | 162/435 [1:00:15<1:42:40, 22.57s/it]
[36m(TaskRunner pid=2914832)[0m step:163 - global_seqlen/min:21685 - global_seqlen/max:22503 - global_seqlen/minmax_diff:818 - global_seqlen/balanced_min:22217 - global_seqlen/balanced_max:22217 - global_seqlen/mean:22217.0 - actor/entropy:0.06850824505090714 - critic/vf_loss:0.12783810659311712 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.38209711387753487 - critic/grad_norm:50.15668749809265 - perf/mfu/critic:0.088992817983634 - critic/lr:1e-05 - actor/pg_loss:0.13989356442471035 - actor/pg_clipfrac:0.004573806902044453 - actor/ppo_kl:-8.396612133765302e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.308967888355255 - perf/mfu/actor:0.06614491815410345 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.35179901123047 - actor/lr:1e-06 - training/global_step:163 - training/epoch:5 - critic/score/mean:0.71484375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.71484375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-3.7250192264082216e-08 - critic/advantages/max:2.3980398178100586 - critic/advantages/min:-2.575798988342285 - critic/returns/mean:0.6675262451171875 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.322265625 - critic/values/max:0.7578125 - critic/values/min:-0.33984375 - critic/vf_explained_var:0.29829174280166626 - response_length/mean:246.91796875 - response_length/max:512.0 - response_length/min:105.0 - response_length/clip_ratio:0.0078125 - prompt_length/mean:100.22265625 - prompt_length/max:201.0 - prompt_length/min:62.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.490837454795837e-06 - timing_s/generate_sequences:3.296630620956421 - timing_s/reshard:0.6842498779296875 - timing_s/gen:4.676284804008901 - timing_s/reward:0.032857314217835665 - timing_s/old_log_prob:2.4321684278547764 - timing_s/values:1.7421642187982798 - timing_s/adv:0.03417280409485102 - timing_s/update_critic:5.359747844282538 - timing_s/update_actor:7.205409651156515 - timing_s/step:21.490098867099732 - timing_s/stop_profile:2.3744069039821625e-06 - timing_per_token_ms/values:0.019603954390762478 - timing_per_token_ms/adv:0.00038453441165381256 - timing_per_token_ms/update_actor:0.0810799123549142 - timing_per_token_ms/update_critic:0.060311336412235426 - timing_per_token_ms/gen:0.07397897207778553 - perf/total_num_tokens:88868 - perf/time_per_step:21.490098867099732 - perf/throughput:1033.824932002203
[36m(TaskRunner pid=2914832)[0m Training Progress:  37%|███▋      | 163/435 [1:00:37<1:40:51, 22.25s/it]
[36m(TaskRunner pid=2914832)[0m step:164 - global_seqlen/min:22229 - global_seqlen/max:23387 - global_seqlen/minmax_diff:1158 - global_seqlen/balanced_min:22764 - global_seqlen/balanced_max:22765 - global_seqlen/mean:22764.75 - actor/entropy:0.06651083379983902 - critic/vf_loss:0.10771135985851288 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.8371083289384842 - critic/grad_norm:51.70202159881592 - perf/mfu/critic:0.08685615313467303 - critic/lr:1e-05 - actor/pg_loss:-0.15912455404759385 - actor/pg_clipfrac:0.003513342533551622 - actor/ppo_kl:0.00023961759734447696 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.9134321808815002 - perf/mfu/actor:0.07097456344301879 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.3575553894043 - actor/lr:1e-06 - training/global_step:164 - training/epoch:5 - critic/score/mean:0.65234375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.65234375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:6.159977061770405e-08 - critic/advantages/max:2.409482955932617 - critic/advantages/min:-2.78568434715271 - critic/returns/mean:0.6127429008483887 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.78515625 - critic/values/max:1.4375 - critic/values/min:-0.00101470947265625 - critic/vf_explained_var:0.25487303733825684 - response_length/mean:251.48828125 - response_length/max:512.0 - response_length/min:109.0 - response_length/clip_ratio:0.01171875 - prompt_length/mean:104.2109375 - prompt_length/max:183.0 - prompt_length/min:56.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.993285983800888e-06 - timing_s/generate_sequences:3.4266128540039062 - timing_s/reshard:0.5803852081298828 - timing_s/gen:4.610520113259554 - timing_s/reward:0.0368725061416626 - timing_s/old_log_prob:2.086634339299053 - timing_s/values:1.3512829970568419 - timing_s/adv:0.0447083180770278 - timing_s/update_critic:5.6331735998392105 - timing_s/update_actor:6.886262350715697 - timing_s/step:20.659654701128602 - timing_s/stop_profile:6.9481320679187775e-06 - timing_per_token_ms/values:0.014839642397312093 - timing_per_token_ms/adv:0.0004909818697440977 - timing_per_token_ms/update_actor:0.07562418158244322 - timing_per_token_ms/update_critic:0.06186289767995707 - timing_per_token_ms/gen:0.07161305529984861 - perf/total_num_tokens:91059 - perf/time_per_step:20.659654701128602 - perf/throughput:1101.894021430881
[36m(TaskRunner pid=2914832)[0m Training Progress:  38%|███▊      | 164/435 [1:00:57<1:38:21, 21.78s/it]
[36m(TaskRunner pid=2914832)[0m step:165 - global_seqlen/min:21979 - global_seqlen/max:23349 - global_seqlen/minmax_diff:1370 - global_seqlen/balanced_min:22814 - global_seqlen/balanced_max:22814 - global_seqlen/mean:22814.0 - actor/entropy:0.07035727798938751 - critic/vf_loss:0.09885478881187737 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.5258798766881227 - critic/grad_norm:28.8360812664032 - perf/mfu/critic:0.09500541685035159 - critic/lr:1e-05 - actor/pg_loss:-0.03630425967276096 - actor/pg_clipfrac:0.003517326316796243 - actor/ppo_kl:0.0008021778398870083 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.8639509677886963 - perf/mfu/actor:0.07097705530713326 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.28123474121094 - actor/lr:1e-06 - training/global_step:165 - training/epoch:5 - critic/score/mean:0.64453125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.64453125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:3.3913963193299423e-08 - critic/advantages/max:2.3854377269744873 - critic/advantages/min:-2.8755855560302734 - critic/returns/mean:0.5999968647956848 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.7109375 - critic/values/max:1.4296875 - critic/values/min:-0.003570556640625 - critic/vf_explained_var:0.23197788000106812 - response_length/mean:250.88671875 - response_length/max:511.0 - response_length/min:102.0 - response_length/clip_ratio:0.0 - prompt_length/mean:105.58203125 - prompt_length/max:217.0 - prompt_length/min:70.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.823785275220871e-06 - timing_s/generate_sequences:3.3269777297973633 - timing_s/reshard:0.7785147428512573 - timing_s/gen:4.800289351027459 - timing_s/reward:0.033368029166013 - timing_s/old_log_prob:2.3944872729480267 - timing_s/values:1.74525760486722 - timing_s/adv:0.03380906768143177 - timing_s/update_critic:5.157039454672486 - timing_s/update_actor:6.898974611889571 - timing_s/step:21.07243874296546 - timing_s/stop_profile:5.699228495359421e-06 - timing_per_token_ms/values:0.019124853213676032 - timing_per_token_ms/adv:0.00037048597003409937 - timing_per_token_ms/update_actor:0.0756002302521431 - timing_per_token_ms/update_critic:0.05651178502972391 - timing_per_token_ms/gen:0.07473942969510422 - perf/total_num_tokens:91256 - perf/time_per_step:21.07243874296546 - perf/throughput:1082.646402643639
[36m(TaskRunner pid=2914832)[0m Training Progress:  38%|███▊      | 165/435 [1:01:18<1:37:03, 21.57s/it]
[36m(TaskRunner pid=2914832)[0m step:166 - global_seqlen/min:23067 - global_seqlen/max:24412 - global_seqlen/minmax_diff:1345 - global_seqlen/balanced_min:23665 - global_seqlen/balanced_max:23666 - global_seqlen/mean:23665.5 - actor/entropy:0.06655311584472656 - critic/vf_loss:0.14120821561664343 - critic/vf_clipfrac:0.05955777713097632 - critic/vpred_mean:0.743637427687645 - critic/grad_norm:50.045395612716675 - perf/mfu/critic:0.09649193766370359 - critic/lr:1e-05 - actor/pg_loss:0.09244798682630062 - actor/pg_clipfrac:0.0033768241046345793 - actor/ppo_kl:0.0003379623176442692 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.8749362230300903 - perf/mfu/actor:0.07124743111029036 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.14078521728516 - actor/lr:1e-06 - training/global_step:166 - training/epoch:5 - critic/score/mean:0.7109375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.7109375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:3.797774539293641e-08 - critic/advantages/max:2.1682963371276855 - critic/advantages/min:-2.661381721496582 - critic/returns/mean:0.6581332683563232 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.46875 - critic/values/max:1.234375 - critic/values/min:-0.2197265625 - critic/vf_explained_var:0.22929030656814575 - response_length/mean:265.04296875 - response_length/max:512.0 - response_length/min:83.0 - response_length/clip_ratio:0.015625 - prompt_length/mean:104.73046875 - prompt_length/max:180.0 - prompt_length/min:71.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.740221917629242e-06 - timing_s/generate_sequences:3.4934535026550293 - timing_s/reshard:0.5793571472167969 - timing_s/gen:4.641336840111762 - timing_s/reward:0.03424769127741456 - timing_s/old_log_prob:2.079822665080428 - timing_s/values:1.3471826282329857 - timing_s/adv:0.03478810517117381 - timing_s/update_critic:5.2736243340186775 - timing_s/update_actor:7.135756385978311 - timing_s/step:20.55374223412946 - timing_s/stop_profile:2.291053533554077e-06 - timing_per_token_ms/values:0.014231503963924128 - timing_per_token_ms/adv:0.0003674981003060765 - timing_per_token_ms/update_actor:0.07538142428829214 - timing_per_token_ms/update_critic:0.05571004557286638 - timing_per_token_ms/gen:0.06840484060827051 - perf/total_num_tokens:94662 - perf/time_per_step:20.55374223412946 - perf/throughput:1151.3961657407317
[36m(TaskRunner pid=2914832)[0m Training Progress:  38%|███▊      | 166/435 [1:01:39<1:35:20, 21.27s/it]
[36m(TaskRunner pid=2914832)[0m step:167 - global_seqlen/min:21779 - global_seqlen/max:24016 - global_seqlen/minmax_diff:2237 - global_seqlen/balanced_min:22587 - global_seqlen/balanced_max:22588 - global_seqlen/mean:22587.25 - actor/entropy:0.06213155761361122 - critic/vf_loss:0.11339300899999216 - critic/vf_clipfrac:0.00037193106254562736 - critic/vpred_mean:0.9203238822519779 - critic/grad_norm:47.6032549738884 - perf/mfu/critic:0.09416311383638926 - critic/lr:1e-05 - actor/pg_loss:-0.21079200971871614 - actor/pg_clipfrac:0.0036923578081768937 - actor/ppo_kl:0.0004003439789812546 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.895095109939575 - perf/mfu/actor:0.0712897326206452 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.6117935180664 - actor/lr:1e-06 - training/global_step:167 - training/epoch:5 - critic/score/mean:0.703125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.703125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:1.0578006026662479e-08 - critic/advantages/max:2.0461459159851074 - critic/advantages/min:-2.7265942096710205 - critic/returns/mean:0.6479823589324951 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:1.078125 - critic/values/max:1.734375 - critic/values/min:0.44921875 - critic/vf_explained_var:0.2540801167488098 - response_length/mean:250.04296875 - response_length/max:512.0 - response_length/min:109.0 - response_length/clip_ratio:0.02734375 - prompt_length/mean:102.8828125 - prompt_length/max:186.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.654750227928162e-06 - timing_s/generate_sequences:3.499300718307495 - timing_s/reshard:0.8924784064292908 - timing_s/gen:4.94600536627695 - timing_s/reward:0.03285493329167366 - timing_s/old_log_prob:2.076929561793804 - timing_s/values:1.3422982022166252 - timing_s/adv:0.03443960240110755 - timing_s/update_critic:5.15044751483947 - timing_s/update_actor:6.7989854868501425 - timing_s/step:20.389779978897423 - timing_s/stop_profile:2.259388566017151e-06 - timing_per_token_ms/values:0.014856813049581348 - timing_per_token_ms/adv:0.00038118410166252585 - timing_per_token_ms/update_actor:0.07525247082812364 - timing_per_token_ms/update_critic:0.0570061374762252 - timing_per_token_ms/gen:0.07726805340139897 - perf/total_num_tokens:90349 - perf/time_per_step:20.389779978897423 - perf/throughput:1107.7731110084007
[36m(TaskRunner pid=2914832)[0m Training Progress:  38%|███▊      | 167/435 [1:01:59<1:33:50, 21.01s/it]
[36m(TaskRunner pid=2914832)[0m step:168 - global_seqlen/min:22849 - global_seqlen/max:23983 - global_seqlen/minmax_diff:1134 - global_seqlen/balanced_min:23278 - global_seqlen/balanced_max:23279 - global_seqlen/mean:23278.5 - actor/entropy:0.06861323863267899 - critic/vf_loss:0.1404689538758248 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.3198659038171172 - critic/grad_norm:68.14747524261475 - perf/mfu/critic:0.09454172980308248 - critic/lr:1e-05 - actor/pg_loss:0.028135510918218642 - actor/pg_clipfrac:0.004116924770642072 - actor/ppo_kl:3.347167643141802e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.0510502457618713 - perf/mfu/actor:0.06981174266122937 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.18821716308594 - actor/lr:1e-06 - training/global_step:168 - training/epoch:5 - critic/score/mean:0.69140625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.69140625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:1.590906428816652e-08 - critic/advantages/max:2.1626837253570557 - critic/advantages/min:-2.700456142425537 - critic/returns/mean:0.6507869958877563 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.41015625 - critic/values/max:1.0546875 - critic/values/min:-0.205078125 - critic/vf_explained_var:0.26993459463119507 - response_length/mean:261.32421875 - response_length/max:512.0 - response_length/min:121.0 - response_length/clip_ratio:0.01171875 - prompt_length/mean:102.40234375 - prompt_length/max:174.0 - prompt_length/min:67.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.982110112905502e-06 - timing_s/generate_sequences:3.4211363792419434 - timing_s/reshard:0.9342918992042542 - timing_s/gen:5.340987935196608 - timing_s/reward:0.03513854090124369 - timing_s/old_log_prob:2.121208460070193 - timing_s/values:1.6267794431187212 - timing_s/adv:0.035937500186264515 - timing_s/update_critic:5.289130951743573 - timing_s/update_actor:7.158195438794792 - timing_s/step:21.61675285222009 - timing_s/stop_profile:1.8463470041751862e-06 - timing_per_token_ms/values:0.017470836212800666 - timing_per_token_ms/adv:0.0003859516311861215 - timing_per_token_ms/update_actor:0.07687560881064923 - timing_per_token_ms/update_critic:0.0568027466518845 - timing_per_token_ms/gen:0.0798365885169675 - perf/total_num_tokens:93114 - perf/time_per_step:21.61675285222009 - perf/throughput:1076.8731159180204
[36m(TaskRunner pid=2914832)[0m Training Progress:  39%|███▊      | 168/435 [1:02:21<1:34:18, 21.19s/it]
[36m(TaskRunner pid=2914832)[0m step:169 - global_seqlen/min:22003 - global_seqlen/max:23249 - global_seqlen/minmax_diff:1246 - global_seqlen/balanced_min:22923 - global_seqlen/balanced_max:22924 - global_seqlen/mean:22923.75 - actor/entropy:0.08048924803733826 - critic/vf_loss:0.12046257546171546 - critic/vf_clipfrac:0.10757280704274308 - critic/vpred_mean:0.695693377405405 - critic/grad_norm:40.850818157196045 - perf/mfu/critic:0.08960305271171742 - critic/lr:1e-05 - actor/pg_loss:-0.1293700411915779 - actor/pg_clipfrac:0.004152310561039485 - actor/ppo_kl:0.0007321333923755446 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.064968168735504 - perf/mfu/actor:0.0725063495733572 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.96964263916016 - actor/lr:1e-06 - training/global_step:169 - training/epoch:5 - critic/score/mean:0.6796875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.6796875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-6.160013299449929e-08 - critic/advantages/max:2.3267953395843506 - critic/advantages/min:-2.9069771766662598 - critic/returns/mean:0.6309376358985901 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.3515625 - critic/values/max:0.97265625 - critic/values/min:-0.28125 - critic/vf_explained_var:0.2036014199256897 - response_length/mean:255.17578125 - response_length/max:512.0 - response_length/min:101.0 - response_length/clip_ratio:0.0234375 - prompt_length/mean:103.0078125 - prompt_length/max:238.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.709232598543167e-06 - timing_s/generate_sequences:3.454493522644043 - timing_s/reshard:0.5834610462188721 - timing_s/gen:4.71797675313428 - timing_s/reward:0.03388834185898304 - timing_s/old_log_prob:2.0768666537478566 - timing_s/values:1.354748914949596 - timing_s/adv:0.03349470719695091 - timing_s/update_critic:5.494543421082199 - timing_s/update_actor:6.7892462448216975 - timing_s/step:20.50759655609727 - timing_s/stop_profile:2.5653280317783356e-06 - timing_per_token_ms/values:0.014774512404706864 - timing_per_token_ms/adv:0.0003652838998522374 - timing_per_token_ms/update_actor:0.07404161889766833 - timing_per_token_ms/update_critic:0.059921952353805534 - timing_per_token_ms/gen:0.07222314203037551 - perf/total_num_tokens:91695 - perf/time_per_step:20.50759655609727 - perf/throughput:1117.8174847205273
[36m(TaskRunner pid=2914832)[0m Training Progress:  39%|███▉      | 169/435 [1:02:41<1:33:04, 20.99s/it]
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 170}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and bakes muffins for her friends every day with four. She sells the remainder at the farmers' market daily for $2 per fresh duck egg. How much in dollars does she make every day at the farmers' market? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much money Janet makes every day from selling the eggs, we need to follow these steps:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. Calculate the number of eggs laid by the ducks in a day.
[36m(TaskRunner pid=2914832)[0m 2. Subtract the number of eggs eaten in a day from the total number of eggs.
[36m(TaskRunner pid=2914832)[0m 3. Determine the number of ducks laid in a day.
[36m(TaskRunner pid=2914832)[0m 4. Calculate the total revenue from selling the eggs.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m First, the ducks lay 16 eggs per day. Janet eats 3 eggs for breakfast and bakes 4 muffins, so the total number of eggs eaten in a day is:
[36m(TaskRunner pid=2914832)[0m \[ 3 + 4 = 7 \text{ eggs} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Therefore, the number of eggs sold each day is the total number of eggs laid minus the number of eggs eaten:
[36m(TaskRunner pid=2914832)[0m \[ 16 - 7 = 9 \text{ eggs} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Next, Janet sells each egg for $2. Therefore, the total revenue from selling the eggs is:
[36m(TaskRunner pid=2914832)[0m \[ 9 \times 2 = 18 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m So, the final answer is:
[36m(TaskRunner pid=2914832)[0m #### 18
[36m(TaskRunner pid=2914832)[0m [ground_truth] 18
[36m(TaskRunner pid=2914832)[0m [score] 1.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1312
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 170}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Tom's restaurant gets 6 reservations a night.  They normally order 2 meals that cost $5 each and a $5 bottle of wine.  How much do they make a week if they are open 2 days a week? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much Tom's restaurant makes in a week, we need to calculate the daily revenue and then multiply by the number of days the restaurant is open.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. First, calculate the number of meals ordered per night:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    \text{Number of meals per night} = 6 \text{ reservations} \times 2 \text{ meals per reservation} = 12 \text{ meals per night}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 2. Next, calculate the cost of the meals per night:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    \text{Cost of meals per night} = 12 \text{ meals} \times 5 \text{ dollars per meal} = 60 \text{ dollars per night}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 3. Then, calculate the cost of the wine per night:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    \text{Cost of wine per night} = 1 \text{ bottle} \times 5 \text{ dollars per bottle} = 5 \text{ dollars per night}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 4. The total revenue per night is the sum of the cost of the meals and the cost of the wine:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    \text{Total revenue per night} = 60 \text{ dollars} + 5 \text{ dollars} = 65 \text{ dollars per night}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 5. Since the restaurant is open 2 days a week, the weekly revenue is:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    \text{Weekly revenue} = 65 \text{ dollars per night} \times 2 \text{ nights per week} = 130 \text{ dollars per week}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Therefore, the final answer is:
[36m(TaskRunner pid=2914832)[0m #### 130
[36m(TaskRunner pid=2914832)[0m [ground_truth] 180
[36m(TaskRunner pid=2914832)[0m [score] 0.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1319
[36m(TaskRunner pid=2914832)[0m step:170 - global_seqlen/min:23204 - global_seqlen/max:26079 - global_seqlen/minmax_diff:2875 - global_seqlen/balanced_min:24274 - global_seqlen/balanced_max:24274 - global_seqlen/mean:24274.0 - actor/entropy:0.06818382441997528 - critic/vf_loss:0.13441613130271435 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.8506984375417233 - critic/grad_norm:49.242385268211365 - perf/mfu/critic:0.10189849779853846 - critic/lr:1e-05 - actor/pg_loss:0.05251066549681127 - actor/pg_clipfrac:0.0030172507649695035 - actor/ppo_kl:0.0002700263712540618 - actor/pg_clipfrac_lower:0.00010093936361954547 - actor/grad_norm:2.763281464576721 - perf/mfu/actor:0.07675463706513637 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.12092971801758 - actor/lr:1e-06 - val-core/openai/gsm8k/reward/mean@1:0.5125094768764216 - training/global_step:170 - training/epoch:5 - critic/score/mean:0.6640625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.6640625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:4.053760704891829e-08 - critic/advantages/max:2.4629502296447754 - critic/advantages/min:-2.627870798110962 - critic/returns/mean:0.5877681374549866 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.984375 - critic/values/max:1.5390625 - critic/values/min:0.3046875 - critic/vf_explained_var:0.3123050332069397 - response_length/mean:272.98046875 - response_length/max:512.0 - response_length/min:113.0 - response_length/clip_ratio:0.03125 - prompt_length/mean:106.30078125 - prompt_length/max:232.0 - prompt_length/min:66.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.536937922239304e-06 - timing_s/generate_sequences:3.5048718452453613 - timing_s/reshard:0.8673294186592102 - timing_s/gen:4.899560694117099 - timing_s/reward:0.03615734213963151 - timing_s/old_log_prob:2.4646027269773185 - timing_s/values:1.344995257910341 - timing_s/adv:0.03411762788891792 - timing_s/update_critic:5.127346694003791 - timing_s/update_actor:6.806764690205455 - timing_s/testing:13.218991151079535 - timing_s/step:33.94170327531174 - timing_s/stop_profile:2.359040081501007e-06 - timing_per_token_ms/values:0.013852221079244676 - timing_per_token_ms/adv:0.00035138036467947107 - timing_per_token_ms/update_actor:0.0701034511226565 - timing_per_token_ms/update_critic:0.05280698168826513 - timing_per_token_ms/gen:0.07011090957911222 - perf/total_num_tokens:97096 - perf/time_per_step:33.94170327531174 - perf/throughput:715.1674093402448
[36m(TaskRunner pid=2914832)[0m Training Progress:  39%|███▉      | 170/435 [1:03:15<1:49:53, 24.88s/it]
[36m(TaskRunner pid=2914832)[0m step:171 - global_seqlen/min:22281 - global_seqlen/max:24369 - global_seqlen/minmax_diff:2088 - global_seqlen/balanced_min:23465 - global_seqlen/balanced_max:23466 - global_seqlen/mean:23465.25 - actor/entropy:0.07228102535009384 - critic/vf_loss:0.07355373067548499 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.5840972512960434 - critic/grad_norm:14.867065906524658 - perf/mfu/critic:0.09269149909663583 - critic/lr:1e-05 - actor/pg_loss:-0.08936886908486485 - actor/pg_clipfrac:0.0032857104342838284 - actor/ppo_kl:0.00040824805091688177 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.0245929956436157 - perf/mfu/actor:0.07356178595241532 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.72995376586914 - actor/lr:1e-06 - training/global_step:171 - training/epoch:5 - critic/score/mean:0.6328125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.6328125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:2.2873294369674113e-08 - critic/advantages/max:2.1640796661376953 - critic/advantages/min:-2.593764305114746 - critic/returns/mean:0.5627690553665161 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.53125 - critic/values/max:1.0703125 - critic/values/min:-0.11962890625 - critic/vf_explained_var:0.2996881604194641 - response_length/mean:262.21484375 - response_length/max:512.0 - response_length/min:109.0 - response_length/clip_ratio:0.0234375 - prompt_length/mean:104.4296875 - prompt_length/max:215.0 - prompt_length/min:65.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.81888821721077e-06 - timing_s/generate_sequences:3.5275521278381348 - timing_s/reshard:0.30218327045440674 - timing_s/gen:4.513373512309045 - timing_s/reward:0.03363172709941864 - timing_s/old_log_prob:2.0942832939326763 - timing_s/values:1.3447958347387612 - timing_s/adv:0.03392209438607097 - timing_s/update_critic:5.441563123837113 - timing_s/update_actor:6.853262927848846 - timing_s/step:20.324584912043065 - timing_s/stop_profile:1.8561258912086487e-06 - timing_per_token_ms/values:0.014327525114144972 - timing_per_token_ms/adv:0.0003614077666557033 - timing_per_token_ms/update_actor:0.07301502144499682 - timing_per_token_ms/update_critic:0.05797469794522873 - timing_per_token_ms/gen:0.06723633578603311 - perf/total_num_tokens:93861 - perf/time_per_step:20.324584912043065 - perf/throughput:1154.5254233505145
[36m(TaskRunner pid=2914832)[0m Training Progress:  39%|███▉      | 171/435 [1:03:36<1:43:28, 23.52s/it]
[36m(TaskRunner pid=2914832)[0m step:172 - global_seqlen/min:21538 - global_seqlen/max:23106 - global_seqlen/minmax_diff:1568 - global_seqlen/balanced_min:22381 - global_seqlen/balanced_max:22382 - global_seqlen/mean:22381.25 - actor/entropy:0.07138263434171677 - critic/vf_loss:0.08761424160911702 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6702833324670792 - critic/grad_norm:17.55276334285736 - perf/mfu/critic:0.0902353281379643 - critic/lr:1e-05 - actor/pg_loss:0.10120850533712655 - actor/pg_clipfrac:0.003952092767576687 - actor/ppo_kl:-0.00019320255946553289 - actor/pg_clipfrac_lower:4.803996853297576e-05 - actor/grad_norm:3.208097457885742 - perf/mfu/actor:0.07041632560490543 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.92404174804688 - actor/lr:1e-06 - training/global_step:172 - training/epoch:5 - critic/score/mean:0.68359375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.68359375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-7.692993797547842e-09 - critic/advantages/max:2.110335350036621 - critic/advantages/min:-2.516850471496582 - critic/returns/mean:0.6396773457527161 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.59375 - critic/values/max:1.0546875 - critic/values/min:-0.08349609375 - critic/vf_explained_var:0.2798425555229187 - response_length/mean:246.48046875 - response_length/max:512.0 - response_length/min:115.0 - response_length/clip_ratio:0.0078125 - prompt_length/mean:103.2265625 - prompt_length/max:199.0 - prompt_length/min:70.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.098750650882721e-06 - timing_s/generate_sequences:3.2679505348205566 - timing_s/reshard:0.8549060821533203 - timing_s/gen:4.943030323833227 - timing_s/reward:0.03546460112556815 - timing_s/old_log_prob:2.0778447603806853 - timing_s/values:1.3410460017621517 - timing_s/adv:0.03495272807776928 - timing_s/update_critic:5.323431948199868 - timing_s/update_actor:6.817411610390991 - timing_s/step:20.58141030697152 - timing_s/stop_profile:2.6426278054714203e-06 - timing_per_token_ms/values:0.014979569972210574 - timing_per_token_ms/adv:0.0003904242175679339 - timing_per_token_ms/update_actor:0.07615092555588931 - timing_per_token_ms/update_critic:0.05946307677408398 - timing_per_token_ms/gen:0.0783376966961953 - perf/total_num_tokens:89525 - perf/time_per_step:20.58141030697152 - perf/throughput:1087.4497746356487
[36m(TaskRunner pid=2914832)[0m Training Progress:  40%|███▉      | 172/435 [1:03:56<1:39:14, 22.64s/it]
[36m(TaskRunner pid=2914832)[0m step:173 - global_seqlen/min:21939 - global_seqlen/max:24254 - global_seqlen/minmax_diff:2315 - global_seqlen/balanced_min:22833 - global_seqlen/balanced_max:22834 - global_seqlen/mean:22833.25 - actor/entropy:0.07414757460355759 - critic/vf_loss:0.08838852828193922 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.7705915458500385 - critic/grad_norm:38.86140954494476 - perf/mfu/critic:0.08949527461736498 - critic/lr:1e-05 - actor/pg_loss:-0.16869242186658084 - actor/pg_clipfrac:0.0050212888745591044 - actor/ppo_kl:8.62210727063939e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.3277538418769836 - perf/mfu/actor:0.06924475038083067 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:87.9324951171875 - actor/lr:1e-06 - training/global_step:173 - training/epoch:5 - critic/score/mean:0.64453125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.64453125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-5.033838945678326e-08 - critic/advantages/max:2.3903889656066895 - critic/advantages/min:-2.287468910217285 - critic/returns/mean:0.5835856199264526 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.91015625 - critic/values/max:1.3359375 - critic/values/min:0.09521484375 - critic/vf_explained_var:0.3153001666069031 - response_length/mean:254.20703125 - response_length/max:512.0 - response_length/min:97.0 - response_length/clip_ratio:0.03125 - prompt_length/mean:102.5625 - prompt_length/max:211.0 - prompt_length/min:63.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.973262548446655e-06 - timing_s/generate_sequences:3.4697182178497314 - timing_s/reshard:0.6774888038635254 - timing_s/gen:5.123847391922027 - timing_s/reward:0.03355081006884575 - timing_s/old_log_prob:2.12660708790645 - timing_s/values:1.6153250481002033 - timing_s/adv:0.03455308498814702 - timing_s/update_critic:5.478503751102835 - timing_s/update_actor:7.079539479222149 - timing_s/step:21.49983917409554 - timing_s/stop_profile:2.2710300981998444e-06 - timing_per_token_ms/values:0.017686105220459235 - timing_per_token_ms/adv:0.0003783198295046371 - timing_per_token_ms/update_actor:0.07751348887282963 - timing_per_token_ms/update_critic:0.05998383663191656 - timing_per_token_ms/gen:0.07873515054354115 - perf/total_num_tokens:91333 - perf/time_per_step:21.49983917409554 - perf/throughput:1062.0195721050343
[36m(TaskRunner pid=2914832)[0m Training Progress:  40%|███▉      | 173/435 [1:04:18<1:37:23, 22.30s/it]
[36m(TaskRunner pid=2914832)[0m step:174 - global_seqlen/min:21231 - global_seqlen/max:23861 - global_seqlen/minmax_diff:2630 - global_seqlen/balanced_min:22654 - global_seqlen/balanced_max:22655 - global_seqlen/mean:22654.25 - actor/entropy:0.07390841841697693 - critic/vf_loss:0.11678750533610582 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.48577603697776794 - critic/grad_norm:22.757909923791885 - perf/mfu/critic:0.08827659244777163 - critic/lr:1e-05 - actor/pg_loss:-0.026561150327324867 - actor/pg_clipfrac:0.004019747524580453 - actor/ppo_kl:-3.160934764379064e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.1552640199661255 - perf/mfu/actor:0.07176136852809917 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.4351577758789 - actor/lr:1e-06 - training/global_step:174 - training/epoch:5 - critic/score/mean:0.6328125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.6328125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:1.64245417266784e-08 - critic/advantages/max:2.186406373977661 - critic/advantages/min:-2.2209019660949707 - critic/returns/mean:0.57860267162323 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.50390625 - critic/values/max:0.9296875 - critic/values/min:-0.333984375 - critic/vf_explained_var:0.2278660535812378 - response_length/mean:248.1328125 - response_length/max:512.0 - response_length/min:89.0 - response_length/clip_ratio:0.01171875 - prompt_length/mean:105.83984375 - prompt_length/max:183.0 - prompt_length/min:64.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.9781443774700165e-06 - timing_s/generate_sequences:3.2858104705810547 - timing_s/reshard:0.5881730318069458 - timing_s/gen:4.4836207162588835 - timing_s/reward:0.03287513321265578 - timing_s/old_log_prob:2.0756056690588593 - timing_s/values:1.3407738381065428 - timing_s/adv:0.03468299191445112 - timing_s/update_critic:5.508140190970153 - timing_s/update_actor:6.7738606608472764 - timing_s/step:20.256713462993503 - timing_s/stop_profile:2.1383166313171387e-06 - timing_per_token_ms/values:0.014796051934036028 - timing_per_token_ms/adv:0.0003827426632359394 - timing_per_token_ms/update_actor:0.0747526475258205 - timing_per_token_ms/update_critic:0.06078484380381333 - timing_per_token_ms/gen:0.07058374604481728 - perf/total_num_tokens:90617 - perf/time_per_step:20.256713462993503 - perf/throughput:1118.3576270349333
[36m(TaskRunner pid=2914832)[0m Training Progress:  40%|████      | 174/435 [1:04:38<1:34:21, 21.69s/it]
[36m(TaskRunner pid=2914832)[0m step:175 - global_seqlen/min:22967 - global_seqlen/max:24080 - global_seqlen/minmax_diff:1113 - global_seqlen/balanced_min:23397 - global_seqlen/balanced_max:23398 - global_seqlen/mean:23397.5 - actor/entropy:0.08185208588838577 - critic/vf_loss:0.108830276876688 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.7152043990790844 - critic/grad_norm:22.4317524433136 - perf/mfu/critic:0.0951674544791314 - critic/lr:1e-05 - actor/pg_loss:0.11551450793922413 - actor/pg_clipfrac:0.0037547128304140642 - actor/ppo_kl:0.00013984147585688333 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.3700401186943054 - perf/mfu/actor:0.0698721818001267 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.55566787719727 - actor/lr:1e-06 - training/global_step:175 - training/epoch:6 - critic/score/mean:0.71484375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.71484375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-3.606289666890916e-08 - critic/advantages/max:2.6392791271209717 - critic/advantages/min:-2.744431972503662 - critic/returns/mean:0.6829624772071838 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.53515625 - critic/values/max:1.03125 - critic/values/min:-0.373046875 - critic/vf_explained_var:0.2638901472091675 - response_length/mean:261.76171875 - response_length/max:512.0 - response_length/min:116.0 - response_length/clip_ratio:0.0234375 - prompt_length/mean:103.82421875 - prompt_length/max:202.0 - prompt_length/min:69.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:1.6705133020877838e-05 - timing_s/generate_sequences:3.4143128395080566 - timing_s/reshard:0.7768157720565796 - timing_s/gen:5.219574990216643 - timing_s/reward:0.036388949025422335 - timing_s/old_log_prob:2.1083331210538745 - timing_s/values:1.6261799009516835 - timing_s/adv:0.03779130708426237 - timing_s/update_critic:5.283338787034154 - timing_s/update_actor:7.19584262277931 - timing_s/step:21.517858596052974 - timing_s/stop_profile:1.56499445438385e-05 - timing_per_token_ms/values:0.017375573255173454 - timing_per_token_ms/adv:0.0004037964214580871 - timing_per_token_ms/update_actor:0.0768868749094915 - timing_per_token_ms/update_critic:0.05645195840404054 - timing_per_token_ms/gen:0.07789131620505055 - perf/total_num_tokens:93590 - perf/time_per_step:21.517858596052974 - perf/throughput:1087.3526236617156
[36m(TaskRunner pid=2914832)[0m Training Progress:  40%|████      | 175/435 [1:05:00<1:34:19, 21.77s/it]
[36m(TaskRunner pid=2914832)[0m step:176 - global_seqlen/min:22808 - global_seqlen/max:24121 - global_seqlen/minmax_diff:1313 - global_seqlen/balanced_min:23173 - global_seqlen/balanced_max:23174 - global_seqlen/mean:23173.5 - actor/entropy:0.08114302158355713 - critic/vf_loss:0.0974344271235168 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.4695719685405493 - critic/grad_norm:30.221495032310486 - perf/mfu/critic:0.09033632159801595 - critic/lr:1e-05 - actor/pg_loss:0.07643382856622338 - actor/pg_clipfrac:0.0036918413134117145 - actor/ppo_kl:-0.00038946868107814225 - actor/pg_clipfrac_lower:8.322236681124195e-05 - actor/grad_norm:3.11078017950058 - perf/mfu/actor:0.07325116677724967 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.66041946411133 - actor/lr:1e-06 - training/global_step:176 - training/epoch:6 - critic/score/mean:0.66796875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.66796875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:8.874212475973309e-09 - critic/advantages/max:2.877753496170044 - critic/advantages/min:-2.5551321506500244 - critic/returns/mean:0.6094659566879272 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.625 - critic/values/max:1.109375 - critic/values/min:-0.30859375 - critic/vf_explained_var:0.30301177501678467 - response_length/mean:257.75 - response_length/max:512.0 - response_length/min:117.0 - response_length/clip_ratio:0.01171875 - prompt_length/mean:104.3359375 - prompt_length/max:166.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:6.8140216171741486e-06 - timing_s/generate_sequences:3.4671871662139893 - timing_s/reshard:0.5819316506385803 - timing_s/gen:4.5342822801321745 - timing_s/reward:0.03373823268339038 - timing_s/old_log_prob:2.075721482746303 - timing_s/values:1.3405153839848936 - timing_s/adv:0.035223813727498055 - timing_s/update_critic:5.510452746879309 - timing_s/update_actor:6.794678094796836 - timing_s/step:20.33272319799289 - timing_s/stop_profile:2.394896000623703e-06 - timing_per_token_ms/values:0.014461727662900442 - timing_per_token_ms/adv:0.00038000101114956796 - timing_per_token_ms/update_actor:0.07330224280748308 - timing_per_token_ms/update_critic:0.05944778245495188 - timing_per_token_ms/gen:0.06871790555486443 - perf/total_num_tokens:92694 - perf/time_per_step:20.33272319799289 - perf/throughput:1139.7145268906986
[36m(TaskRunner pid=2914832)[0m Training Progress:  40%|████      | 176/435 [1:05:20<1:32:08, 21.35s/it]
[36m(TaskRunner pid=2914832)[0m step:177 - global_seqlen/min:21846 - global_seqlen/max:23797 - global_seqlen/minmax_diff:1951 - global_seqlen/balanced_min:22695 - global_seqlen/balanced_max:22696 - global_seqlen/mean:22695.25 - actor/entropy:0.06730179488658905 - critic/vf_loss:0.0902475155889988 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6660732477903366 - critic/grad_norm:15.822415947914124 - perf/mfu/critic:0.0936949699579468 - critic/lr:1e-05 - actor/pg_loss:0.08555484440876171 - actor/pg_clipfrac:0.0040098425597534515 - actor/ppo_kl:-3.107465090579353e-05 - actor/pg_clipfrac_lower:7.458234176738188e-05 - actor/grad_norm:3.0038450360298157 - perf/mfu/actor:0.07125973976716063 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.5197982788086 - actor/lr:1e-06 - training/global_step:177 - training/epoch:6 - critic/score/mean:0.734375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.734375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.8700935910942462e-08 - critic/advantages/max:2.8995108604431152 - critic/advantages/min:-2.9872045516967773 - critic/returns/mean:0.6837876439094543 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.515625 - critic/values/max:1.0078125 - critic/values/min:-0.359375 - critic/vf_explained_var:0.3750191926956177 - response_length/mean:253.78515625 - response_length/max:512.0 - response_length/min:113.0 - response_length/clip_ratio:0.0234375 - prompt_length/mean:100.828125 - prompt_length/max:189.0 - prompt_length/min:65.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.652887582778931e-06 - timing_s/generate_sequences:3.4222702980041504 - timing_s/reshard:0.8744767904281616 - timing_s/gen:4.999631244223565 - timing_s/reward:0.03342803195118904 - timing_s/old_log_prob:2.0805466030724347 - timing_s/values:1.3422109209932387 - timing_s/adv:0.03336641984060407 - timing_s/update_critic:5.202129689976573 - timing_s/update_actor:6.836532209999859 - timing_s/step:20.534941607154906 - timing_s/stop_profile:1.9329600036144257e-06 - timing_per_token_ms/values:0.014785152410672263 - timing_per_token_ms/adv:0.00036754849407479614 - timing_per_token_ms/update_actor:0.07530796323018979 - timing_per_token_ms/update_critic:0.05730416816268352 - timing_per_token_ms/gen:0.07695410494579823 - perf/total_num_tokens:90781 - perf/time_per_step:20.534941607154906 - perf/throughput:1105.2015844102712
[36m(TaskRunner pid=2914832)[0m Training Progress:  41%|████      | 177/435 [1:05:41<1:30:45, 21.11s/it]
[36m(TaskRunner pid=2914832)[0m step:178 - global_seqlen/min:21755 - global_seqlen/max:24148 - global_seqlen/minmax_diff:2393 - global_seqlen/balanced_min:23017 - global_seqlen/balanced_max:23018 - global_seqlen/mean:23017.5 - actor/entropy:0.06983297318220139 - critic/vf_loss:0.07888743196963333 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.5945773161947727 - critic/grad_norm:7.761413097381592 - perf/mfu/critic:0.09340225395219894 - critic/lr:1e-05 - actor/pg_loss:0.10482627572491765 - actor/pg_clipfrac:0.004272185560694197 - actor/ppo_kl:-0.0005906520062239906 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.8471524715423584 - perf/mfu/actor:0.068982123541082 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.39104461669922 - actor/lr:1e-06 - training/global_step:178 - training/epoch:6 - critic/score/mean:0.70703125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.70703125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:5.857914597839908e-09 - critic/advantages/max:2.734848976135254 - critic/advantages/min:-3.227508306503296 - critic/returns/mean:0.650505781173706 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.6015625 - critic/values/max:1.15625 - critic/values/min:-0.341796875 - critic/vf_explained_var:0.41954272985458374 - response_length/mean:255.6484375 - response_length/max:512.0 - response_length/min:119.0 - response_length/clip_ratio:0.015625 - prompt_length/mean:104.0 - prompt_length/max:212.0 - prompt_length/min:64.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.2442774176597595e-06 - timing_s/generate_sequences:3.452965497970581 - timing_s/reshard:0.58896803855896 - timing_s/gen:5.016140697989613 - timing_s/reward:0.03295542439445853 - timing_s/old_log_prob:2.120062897913158 - timing_s/values:1.6175568480975926 - timing_s/adv:0.03764298604801297 - timing_s/update_critic:5.293469349853694 - timing_s/update_actor:7.1634327080100775 - timing_s/step:21.28788415528834 - timing_s/stop_profile:2.318061888217926e-06 - timing_per_token_ms/values:0.01756877210923854 - timing_per_token_ms/adv:0.0004088518089281305 - timing_per_token_ms/update_actor:0.07780420015216767 - timing_per_token_ms/update_critic:0.05749396491640811 - timing_per_token_ms/gen:0.0766454893803993 - perf/total_num_tokens:92070 - perf/time_per_step:21.28788415528834 - perf/throughput:1081.248837700105
[36m(TaskRunner pid=2914832)[0m Training Progress:  41%|████      | 178/435 [1:06:02<1:30:39, 21.17s/it]
[36m(TaskRunner pid=2914832)[0m step:179 - global_seqlen/min:22364 - global_seqlen/max:23640 - global_seqlen/minmax_diff:1276 - global_seqlen/balanced_min:23110 - global_seqlen/balanced_max:23110 - global_seqlen/mean:23110.0 - actor/entropy:0.06860589236021042 - critic/vf_loss:0.07016791740898043 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6762186978012323 - critic/grad_norm:11.312886238098145 - perf/mfu/critic:0.09050157538931963 - critic/lr:1e-05 - actor/pg_loss:0.024364931043237448 - actor/pg_clipfrac:0.003380159949301742 - actor/ppo_kl:-2.2383764871847234e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.0898802280426025 - perf/mfu/actor:0.07305703954787197 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.60110473632812 - actor/lr:1e-06 - training/global_step:179 - training/epoch:6 - critic/score/mean:0.71875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.71875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:2.803521148564414e-08 - critic/advantages/max:2.712428092956543 - critic/advantages/min:-2.9983599185943604 - critic/returns/mean:0.6628511548042297 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.7265625 - critic/values/max:1.3046875 - critic/values/min:-0.283203125 - critic/vf_explained_var:0.29765671491622925 - response_length/mean:257.65234375 - response_length/max:512.0 - response_length/min:108.0 - response_length/clip_ratio:0.0078125 - prompt_length/mean:103.44140625 - prompt_length/max:194.0 - prompt_length/min:66.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.078967660665512e-06 - timing_s/generate_sequences:3.472846508026123 - timing_s/reshard:0.5896937847137451 - timing_s/gen:4.639965348411351 - timing_s/reward:0.03378932410851121 - timing_s/old_log_prob:2.0818625786341727 - timing_s/values:1.3515376099385321 - timing_s/adv:0.037770047318190336 - timing_s/update_critic:5.486575522925705 - timing_s/update_actor:6.7967538852244616 - timing_s/step:20.441755360923707 - timing_s/stop_profile:2.954155206680298e-06 - timing_per_token_ms/values:0.014620701102753484 - timing_per_token_ms/adv:0.00040858986713749825 - timing_per_token_ms/update_actor:0.07352611299463935 - timing_per_token_ms/update_critic:0.05935282910997084 - timing_per_token_ms/gen:0.07034620519430784 - perf/total_num_tokens:92440 - perf/time_per_step:20.441755360923707 - perf/throughput:1130.5291347032205
[36m(TaskRunner pid=2914832)[0m Training Progress:  41%|████      | 179/435 [1:06:23<1:29:23, 20.95s/it]
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 180}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and bakes muffins for her friends every day with four. She sells the remainder at the farmers' market daily for $2 per fresh duck egg. How much in dollars does she make every day at the farmers' market? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much money Janet makes every day from selling the eggs, we need to follow these steps:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. Calculate the number of eggs laid by the ducks per day.
[36m(TaskRunner pid=2914832)[0m 2. Determine the total number of eggs sold per day.
[36m(TaskRunner pid=2914832)[0m 3. Find the total revenue from selling the eggs.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m First, the ducks lay 16 eggs per day. Janet eats 3 eggs for breakfast and bakes 4 muffins for her friends, so the total number of eggs eaten and baked per day is:
[36m(TaskRunner pid=2914832)[0m \[ 3 + 4 = 7 \text{ eggs} \]
[36m(TaskRunner pid=2914832)[0m Therefore, the number of eggs sold per day is the total number of eggs laid minus the number of eggs eaten and baked:
[36m(TaskRunner pid=2914832)[0m \[ 16 - 7 = 9 \text{ eggs} \]
[36m(TaskRunner pid=2914832)[0m Next, Janet sells each egg for $2, so the total revenue per day is:
[36m(TaskRunner pid=2914832)[0m \[ 9 \times 2 = 18 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m Therefore, the final answer is:
[36m(TaskRunner pid=2914832)[0m #### 18
[36m(TaskRunner pid=2914832)[0m [ground_truth] 18
[36m(TaskRunner pid=2914832)[0m [score] 1.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1312
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 180}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Tom's restaurant gets 6 reservations a night.  They normally order 2 meals that cost $5 each and a $5 bottle of wine.  How much do they make a week if they are open 2 days a week? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much Tom's restaurant makes a week, we need to calculate the daily revenue and then multiply by the number of days the restaurant is open in a week.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. First, calculate the number of reservations per day. Since they get 6 reservations a night and the restaurant is open 2 days a week, the number of reservations per day is:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    6 \times 2 = 12 \text{ reservations per day}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 2. Next, calculate the total revenue from the meals. The normal price of each meal is $5 and there are 2 meals per reservation. Therefore, the revenue from the meals per day is:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    12 \times 2 \times 5 = 120 \text{ dollars per day}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 3. Then, calculate the total revenue from the wine. The price of the wine is $5. Therefore, the revenue from the wine per day is:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    12 \times 5 = 60 \text{ dollars per day}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 4. The total revenue per day is the sum of the revenue from the meals and the revenue from the wine:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    120 + 60 = 180 \text{ dollars per day}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 5. Since the restaurant is open 2 days a week, the total weekly revenue is:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    180 \times 2 = 360 \text{ dollars per week}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Therefore, the final answer is:
[36m(TaskRunner pid=2914832)[0m #### 360
[36m(TaskRunner pid=2914832)[0m [ground_truth] 180
[36m(TaskRunner pid=2914832)[0m [score] 0.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1319
[36m(TaskRunner pid=2914832)[0m step:180 - global_seqlen/min:21676 - global_seqlen/max:22870 - global_seqlen/minmax_diff:1194 - global_seqlen/balanced_min:22174 - global_seqlen/balanced_max:22175 - global_seqlen/mean:22174.75 - actor/entropy:0.06940895318984985 - critic/vf_loss:0.05802219873294234 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.7549012172967196 - critic/grad_norm:16.004060685634613 - perf/mfu/critic:0.09255271040719948 - critic/lr:1e-05 - actor/pg_loss:-0.36032995372079313 - actor/pg_clipfrac:0.0038974631170276552 - actor/ppo_kl:0.0007058178266561299 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.910702109336853 - perf/mfu/actor:0.06920611361747661 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:87.39153671264648 - actor/lr:1e-06 - val-core/openai/gsm8k/reward/mean@1:0.5276724791508719 - training/global_step:180 - training/epoch:6 - critic/score/mean:0.75 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.75 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-7.545913227602341e-09 - critic/advantages/max:2.9832475185394287 - critic/advantages/min:-3.105087995529175 - critic/returns/mean:0.6995036602020264 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.671875 - critic/values/max:1.203125 - critic/values/min:-0.2490234375 - critic/vf_explained_var:0.3726658225059509 - response_length/mean:242.3984375 - response_length/max:512.0 - response_length/min:109.0 - response_length/clip_ratio:0.01171875 - prompt_length/mean:104.08203125 - prompt_length/max:183.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:1.2516975402832031e-05 - timing_s/generate_sequences:3.142636299133301 - timing_s/reshard:0.8648585677146912 - timing_s/gen:4.767304782290012 - timing_s/reward:0.03254510601982474 - timing_s/old_log_prob:2.083938980009407 - timing_s/values:1.345335892867297 - timing_s/adv:0.03461093083024025 - timing_s/update_critic:5.142032437026501 - timing_s/update_actor:6.873825162649155 - timing_s/testing:13.128770073875785 - timing_s/step:33.41589739266783 - timing_s/stop_profile:2.1960586309432983e-06 - timing_per_token_ms/values:0.015167430217559352 - timing_per_token_ms/adv:0.00039020655058388766 - timing_per_token_ms/update_actor:0.07749608408943906 - timing_per_token_ms/update_critic:0.0579717069755747 - timing_per_token_ms/gen:0.07682510043333245 - perf/total_num_tokens:88699 - perf/time_per_step:33.41589739266783 - perf/throughput:663.5988176353935
[36m(TaskRunner pid=2914832)[0m Training Progress:  41%|████▏     | 180/435 [1:06:56<1:44:57, 24.69s/it]
[36m(TaskRunner pid=2914832)[0m step:181 - global_seqlen/min:22014 - global_seqlen/max:23530 - global_seqlen/minmax_diff:1516 - global_seqlen/balanced_min:23113 - global_seqlen/balanced_max:23113 - global_seqlen/mean:23113.0 - actor/entropy:0.06949875503778458 - critic/vf_loss:0.08122626796830446 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.4744371105916798 - critic/grad_norm:30.29080557823181 - perf/mfu/critic:0.08898837902982284 - critic/lr:1e-05 - actor/pg_loss:-0.09545353706926107 - actor/pg_clipfrac:0.0033984712208621204 - actor/ppo_kl:9.71766939983354e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.7626291513442993 - perf/mfu/actor:0.07054683264147764 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.67197799682617 - actor/lr:1e-06 - training/global_step:181 - training/epoch:6 - critic/score/mean:0.66015625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.66015625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-2.5648322576898863e-08 - critic/advantages/max:2.696438789367676 - critic/advantages/min:-2.8214714527130127 - critic/returns/mean:0.5766192674636841 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.640625 - critic/values/max:1.21875 - critic/values/min:-0.640625 - critic/vf_explained_var:0.36921048164367676 - response_length/mean:257.15625 - response_length/max:512.0 - response_length/min:96.0 - response_length/clip_ratio:0.03515625 - prompt_length/mean:103.984375 - prompt_length/max:201.0 - prompt_length/min:67.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.344860255718231e-06 - timing_s/generate_sequences:3.5671706199645996 - timing_s/reshard:0.3000803589820862 - timing_s/gen:4.684600540902466 - timing_s/reward:0.034060841891914606 - timing_s/old_log_prob:2.0823875670321286 - timing_s/values:1.351466684602201 - timing_s/adv:0.03415265306830406 - timing_s/update_critic:5.580733017995954 - timing_s/update_actor:7.037453277036548 - timing_s/step:20.813589927274734 - timing_s/stop_profile:1.7350539565086365e-06 - timing_per_token_ms/values:0.014618036219900066 - timing_per_token_ms/adv:0.0003694095646206038 - timing_per_token_ms/update_actor:0.07612007611556859 - timing_per_token_ms/update_critic:0.060363572643057514 - timing_per_token_ms/gen:0.07115993044267933 - perf/total_num_tokens:92452 - perf/time_per_step:20.813589927274734 - perf/throughput:1110.476380132389
[36m(TaskRunner pid=2914832)[0m Training Progress:  42%|████▏     | 181/435 [1:07:17<1:39:37, 23.53s/it]
[36m(TaskRunner pid=2914832)[0m step:182 - global_seqlen/min:22072 - global_seqlen/max:23390 - global_seqlen/minmax_diff:1318 - global_seqlen/balanced_min:22692 - global_seqlen/balanced_max:22693 - global_seqlen/mean:22692.75 - actor/entropy:0.07763826102018356 - critic/vf_loss:0.1203910932817962 - critic/vf_clipfrac:0.01861016603652388 - critic/vpred_mean:0.7604273688048124 - critic/grad_norm:41.590017795562744 - perf/mfu/critic:0.09063213706505736 - critic/lr:1e-05 - actor/pg_loss:-0.015673332614824176 - actor/pg_clipfrac:0.004265711439074948 - actor/ppo_kl:0.0001485312159275054 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.955526113510132 - perf/mfu/actor:0.07153782343653804 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.61177062988281 - actor/lr:1e-06 - training/global_step:182 - training/epoch:6 - critic/score/mean:0.68359375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.68359375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:5.02321846340692e-08 - critic/advantages/max:2.740244150161743 - critic/advantages/min:-2.8391337394714355 - critic/returns/mean:0.6188952326774597 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.466796875 - critic/values/max:0.99609375 - critic/values/min:-0.41796875 - critic/vf_explained_var:0.441863477230072 - response_length/mean:252.66796875 - response_length/max:512.0 - response_length/min:127.0 - response_length/clip_ratio:0.015625 - prompt_length/mean:101.90625 - prompt_length/max:163.0 - prompt_length/min:64.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.208646714687347e-06 - timing_s/generate_sequences:3.352933883666992 - timing_s/reshard:0.8762385845184326 - timing_s/gen:4.922496187966317 - timing_s/reward:0.03316615801304579 - timing_s/old_log_prob:2.0761608560569584 - timing_s/values:1.3448999673128128 - timing_s/adv:0.033927629701793194 - timing_s/update_critic:5.376358828973025 - timing_s/update_actor:6.8126604608260095 - timing_s/step:20.606976143084466 - timing_s/stop_profile:2.054031938314438e-06 - timing_per_token_ms/values:0.014816405760791584 - timing_per_token_ms/adv:0.0003737716859106234 - timing_per_token_ms/update_actor:0.07505327098771644 - timing_per_token_ms/update_critic:0.059229917363177946 - timing_per_token_ms/gen:0.0761018534694791 - perf/total_num_tokens:90771 - perf/time_per_step:20.606976143084466 - perf/throughput:1101.2168812363818
[36m(TaskRunner pid=2914832)[0m Training Progress:  42%|████▏     | 182/435 [1:07:38<1:35:32, 22.66s/it]
[36m(TaskRunner pid=2914832)[0m step:183 - global_seqlen/min:22186 - global_seqlen/max:23584 - global_seqlen/minmax_diff:1398 - global_seqlen/balanced_min:23208 - global_seqlen/balanced_max:23209 - global_seqlen/mean:23208.75 - actor/entropy:0.07179959118366241 - critic/vf_loss:0.19113544875290245 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.9041314981877804 - critic/grad_norm:58.19983530044556 - perf/mfu/critic:0.09073999699615048 - critic/lr:1e-05 - actor/pg_loss:0.1760222484008409 - actor/pg_clipfrac:0.003460527674178593 - actor/ppo_kl:0.0009216324547196564 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.9896101355552673 - perf/mfu/actor:0.06956763706899824 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.75935745239258 - actor/lr:1e-06 - training/global_step:183 - training/epoch:6 - critic/score/mean:0.6328125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.6328125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-5.095969513035925e-08 - critic/advantages/max:2.723923921585083 - critic/advantages/min:-2.217557907104492 - critic/returns/mean:0.5636889338493347 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:1.046875 - critic/values/max:1.453125 - critic/values/min:0.1318359375 - critic/vf_explained_var:0.27415966987609863 - response_length/mean:257.90625 - response_length/max:512.0 - response_length/min:108.0 - response_length/clip_ratio:0.02734375 - prompt_length/mean:104.73046875 - prompt_length/max:193.0 - prompt_length/min:56.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:6.095971912145615e-06 - timing_s/generate_sequences:3.5006635189056396 - timing_s/reshard:0.6911618709564209 - timing_s/gen:5.109160882886499 - timing_s/reward:0.034104540944099426 - timing_s/old_log_prob:2.122023681178689 - timing_s/values:1.6287667630240321 - timing_s/adv:0.034802593756467104 - timing_s/update_critic:5.495602624025196 - timing_s/update_actor:7.169119376689196 - timing_s/step:21.60465677920729 - timing_s/stop_profile:1.423293724656105e-05 - timing_per_token_ms/values:0.017544748888070578 - timing_per_token_ms/adv:0.00037488655955692467 - timing_per_token_ms/update_actor:0.07722431600893193 - timing_per_token_ms/update_critic:0.059197529208005556 - timing_per_token_ms/gen:0.07738338911435992 - perf/total_num_tokens:92835 - perf/time_per_step:21.60465677920729 - perf/throughput:1074.2475678825188
[36m(TaskRunner pid=2914832)[0m Training Progress:  42%|████▏     | 183/435 [1:07:59<1:33:51, 22.35s/it]
[36m(TaskRunner pid=2914832)[0m step:184 - global_seqlen/min:22202 - global_seqlen/max:24853 - global_seqlen/minmax_diff:2651 - global_seqlen/balanced_min:23537 - global_seqlen/balanced_max:23538 - global_seqlen/mean:23537.25 - actor/entropy:0.06714502722024918 - critic/vf_loss:0.15009009465575218 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.23301412840373814 - critic/grad_norm:70.98505210876465 - perf/mfu/critic:0.09500471717455558 - critic/lr:1e-05 - actor/pg_loss:0.10439308418426663 - actor/pg_clipfrac:0.004456817994650919 - actor/ppo_kl:0.0010859868320949317 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.1420644521713257 - perf/mfu/actor:0.07435803521891689 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.13873672485352 - actor/lr:1e-06 - training/global_step:184 - training/epoch:6 - critic/score/mean:0.6875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.6875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:4.6297614630930184e-08 - critic/advantages/max:2.949932813644409 - critic/advantages/min:-2.4156875610351562 - critic/returns/mean:0.6355820298194885 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.39453125 - critic/values/max:0.7734375 - critic/values/min:-0.4921875 - critic/vf_explained_var:0.266978919506073 - response_length/mean:263.51953125 - response_length/max:512.0 - response_length/min:113.0 - response_length/clip_ratio:0.01953125 - prompt_length/mean:104.25 - prompt_length/max:238.0 - prompt_length/min:62.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.418900400400162e-06 - timing_s/generate_sequences:3.489612102508545 - timing_s/reshard:0.9558277130126953 - timing_s/gen:4.9905932899564505 - timing_s/reward:0.03271456994116306 - timing_s/old_log_prob:2.0849676546640694 - timing_s/values:1.3446470811031759 - timing_s/adv:0.03391479421406984 - timing_s/update_critic:5.326305552385747 - timing_s/update_actor:6.803835184779018 - timing_s/step:20.626177669968456 - timing_s/stop_profile:5.288049578666687e-06 - timing_per_token_ms/values:0.014282117506326948 - timing_per_token_ms/adv:0.0003602246886750772 - timing_per_token_ms/update_actor:0.07226667500216698 - timing_per_token_ms/update_critic:0.05657315056331716 - timing_per_token_ms/gen:0.0739774579380153 - perf/total_num_tokens:94149 - perf/time_per_step:20.626177669968456 - perf/throughput:1141.134842170493
[36m(TaskRunner pid=2914832)[0m Training Progress:  42%|████▏     | 184/435 [1:08:20<1:31:21, 21.84s/it]
[36m(TaskRunner pid=2914832)[0m step:185 - global_seqlen/min:22343 - global_seqlen/max:23347 - global_seqlen/minmax_diff:1004 - global_seqlen/balanced_min:22783 - global_seqlen/balanced_max:22784 - global_seqlen/mean:22783.75 - actor/entropy:0.07520131766796112 - critic/vf_loss:0.10356222189147957 - critic/vf_clipfrac:0.09359935577958822 - critic/vpred_mean:0.5951194851659238 - critic/grad_norm:31.80313491821289 - perf/mfu/critic:0.0920889749729646 - critic/lr:1e-05 - actor/pg_loss:-0.0755940000526607 - actor/pg_clipfrac:0.0033551858068676665 - actor/ppo_kl:1.0258487236569636e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.2129384875297546 - perf/mfu/actor:0.06786486325384816 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.87125396728516 - actor/lr:1e-06 - training/global_step:185 - training/epoch:6 - critic/score/mean:0.6640625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.6640625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:2.3914202174069032e-08 - critic/advantages/max:2.586278200149536 - critic/advantages/min:-2.227937936782837 - critic/returns/mean:0.6056405305862427 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.294921875 - critic/values/max:0.66015625 - critic/values/min:-0.75 - critic/vf_explained_var:0.23737972974777222 - response_length/mean:253.60546875 - response_length/max:512.0 - response_length/min:103.0 - response_length/clip_ratio:0.0078125 - prompt_length/mean:102.390625 - prompt_length/max:216.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.4892304837703705e-06 - timing_s/generate_sequences:3.3057689666748047 - timing_s/reshard:0.5821971893310547 - timing_s/gen:4.56299440190196 - timing_s/reward:0.035620823968201876 - timing_s/old_log_prob:2.446394951082766 - timing_s/values:1.7411942407488823 - timing_s/adv:0.03487451793625951 - timing_s/update_critic:5.3139182343147695 - timing_s/update_actor:7.205289294011891 - timing_s/step:21.347782880999148 - timing_s/stop_profile:1.7997808754444122e-06 - timing_per_token_ms/values:0.01910565908541046 - timing_per_token_ms/adv:0.0003826687654167939 - timing_per_token_ms/update_actor:0.07906171387515105 - timing_per_token_ms/update_critic:0.05830820468881077 - timing_per_token_ms/gen:0.07028317240272261 - perf/total_num_tokens:91135 - perf/time_per_step:21.347782880999148 - perf/throughput:1067.2653983322527
[36m(TaskRunner pid=2914832)[0m Training Progress:  43%|████▎     | 185/435 [1:08:41<1:30:23, 21.69s/it]
[36m(TaskRunner pid=2914832)[0m step:186 - global_seqlen/min:21950 - global_seqlen/max:25331 - global_seqlen/minmax_diff:3381 - global_seqlen/balanced_min:23621 - global_seqlen/balanced_max:23622 - global_seqlen/mean:23621.75 - actor/entropy:0.0833955854177475 - critic/vf_loss:0.07277033364516683 - critic/vf_clipfrac:0.00045525495079346 - critic/vpred_mean:0.6774294450879097 - critic/grad_norm:28.340394258499146 - perf/mfu/critic:0.09518596997643314 - critic/lr:1e-05 - actor/pg_loss:-0.1729986579157412 - actor/pg_clipfrac:0.003082205483224243 - actor/ppo_kl:0.00023024178858577216 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.1663082242012024 - perf/mfu/actor:0.07495403651175803 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:87.55344009399414 - actor/lr:1e-06 - training/global_step:186 - training/epoch:6 - critic/score/mean:0.65234375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.65234375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:3.051127350772731e-08 - critic/advantages/max:2.65756893157959 - critic/advantages/min:-2.332644462585449 - critic/returns/mean:0.5919219851493835 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.8203125 - critic/values/max:1.2109375 - critic/values/min:-0.00885009765625 - critic/vf_explained_var:0.36648738384246826 - response_length/mean:264.703125 - response_length/max:512.0 - response_length/min:115.0 - response_length/clip_ratio:0.01953125 - prompt_length/mean:104.38671875 - prompt_length/max:180.0 - prompt_length/min:70.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.987007170915604e-06 - timing_s/generate_sequences:3.342442035675049 - timing_s/reshard:0.5812982320785522 - timing_s/gen:4.7938517881557345 - timing_s/reward:0.034711893647909164 - timing_s/old_log_prob:2.074528311379254 - timing_s/values:1.3423359841108322 - timing_s/adv:0.03305991366505623 - timing_s/update_critic:5.334801316726953 - timing_s/update_actor:6.77229452971369 - timing_s/step:20.393899497576058 - timing_s/stop_profile:2.161134034395218e-06 - timing_per_token_ms/values:0.014206567931152774 - timing_per_token_ms/adv:0.000349888489051999 - timing_per_token_ms/update_actor:0.07167435234173686 - timing_per_token_ms/update_critic:0.05646069106572283 - timing_per_token_ms/gen:0.07074334142252131 - perf/total_num_tokens:94487 - perf/time_per_step:20.393899497576058 - perf/throughput:1158.2752971204743
[36m(TaskRunner pid=2914832)[0m Training Progress:  43%|████▎     | 186/435 [1:09:02<1:28:26, 21.31s/it]
[36m(TaskRunner pid=2914832)[0m step:187 - global_seqlen/min:22354 - global_seqlen/max:24670 - global_seqlen/minmax_diff:2316 - global_seqlen/balanced_min:23498 - global_seqlen/balanced_max:23499 - global_seqlen/mean:23498.25 - actor/entropy:0.07946179807186127 - critic/vf_loss:0.10499108524527401 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.3735798504203558 - critic/grad_norm:42.926960945129395 - perf/mfu/critic:0.09776466385678531 - critic/lr:1e-05 - actor/pg_loss:-0.06591711868532002 - actor/pg_clipfrac:0.00421415941673331 - actor/ppo_kl:0.00031034965604703757 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.9275732040405273 - perf/mfu/actor:0.07346255973410423 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.08464813232422 - actor/lr:1e-06 - training/global_step:187 - training/epoch:6 - critic/score/mean:0.6953125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.6953125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:1.0137258499298696e-07 - critic/advantages/max:2.7006750106811523 - critic/advantages/min:-2.772226095199585 - critic/returns/mean:0.6281028985977173 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.3359375 - critic/values/max:0.79296875 - critic/values/min:-0.494140625 - critic/vf_explained_var:0.40007466077804565 - response_length/mean:261.5390625 - response_length/max:512.0 - response_length/min:123.0 - response_length/clip_ratio:0.02734375 - prompt_length/mean:105.62109375 - prompt_length/max:256.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.740897566080093e-06 - timing_s/generate_sequences:3.5159125328063965 - timing_s/reshard:0.8624475002288818 - timing_s/gen:4.965617774985731 - timing_s/reward:0.03401912469416857 - timing_s/old_log_prob:2.0769710149616003 - timing_s/values:1.3460891051217914 - timing_s/adv:0.03336692275479436 - timing_s/update_critic:5.165454049129039 - timing_s/update_actor:6.871681896969676 - timing_s/step:20.500811559148133 - timing_s/stop_profile:2.3939646780490875e-06 - timing_per_token_ms/values:0.014321163332607656 - timing_per_token_ms/adv:0.0003549936990498692 - timing_per_token_ms/update_actor:0.07310844314969919 - timing_per_token_ms/update_critic:0.05495573126859488 - timing_per_token_ms/gen:0.07416461712497731 - perf/total_num_tokens:93993 - perf/time_per_step:20.500811559148133 - perf/throughput:1146.2107210831032
[36m(TaskRunner pid=2914832)[0m Training Progress:  43%|████▎     | 187/435 [1:09:22<1:27:05, 21.07s/it]
[36m(TaskRunner pid=2914832)[0m step:188 - global_seqlen/min:22854 - global_seqlen/max:24408 - global_seqlen/minmax_diff:1554 - global_seqlen/balanced_min:23639 - global_seqlen/balanced_max:23640 - global_seqlen/mean:23639.25 - actor/entropy:0.07654037326574326 - critic/vf_loss:0.10529887123266235 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.8249336592853069 - critic/grad_norm:41.912306785583496 - perf/mfu/critic:0.0924517932492251 - critic/lr:1e-05 - actor/pg_loss:0.1007969172205776 - actor/pg_clipfrac:0.004455378570128232 - actor/ppo_kl:0.00010467216634424403 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.0130526423454285 - perf/mfu/actor:0.07149102794644832 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.62071228027344 - actor/lr:1e-06 - training/global_step:188 - training/epoch:6 - critic/score/mean:0.65625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.65625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.6915503664449716e-08 - critic/advantages/max:2.885622024536133 - critic/advantages/min:-2.5318949222564697 - critic/returns/mean:0.5954398512840271 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.75390625 - critic/values/max:1.1953125 - critic/values/min:-0.1328125 - critic/vf_explained_var:0.373168408870697 - response_length/mean:266.91796875 - response_length/max:512.0 - response_length/min:120.0 - response_length/clip_ratio:0.02734375 - prompt_length/mean:102.4453125 - prompt_length/max:199.0 - prompt_length/min:65.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.4959597289562225e-06 - timing_s/generate_sequences:3.404848098754883 - timing_s/reshard:0.586316704750061 - timing_s/gen:4.713583891279995 - timing_s/reward:0.03307132422924042 - timing_s/old_log_prob:2.291454852093011 - timing_s/values:1.7249883636832237 - timing_s/adv:0.033217262011021376 - timing_s/update_critic:5.494772095698863 - timing_s/update_actor:7.105477734003216 - timing_s/step:21.403046404011548 - timing_s/stop_profile:1.8263235688209534e-06 - timing_per_token_ms/values:0.018242841499658657 - timing_per_token_ms/adv:0.00035129352677243755 - timing_per_token_ms/update_actor:0.0751449150671364 - timing_per_token_ms/update_critic:0.05811068557271131 - timing_per_token_ms/gen:0.06898163192811455 - perf/total_num_tokens:94557 - perf/time_per_step:21.403046404011548 - perf/throughput:1104.4806217665034
[36m(TaskRunner pid=2914832)[0m Training Progress:  43%|████▎     | 188/435 [1:09:44<1:27:09, 21.17s/it]
[36m(TaskRunner pid=2914832)[0m step:189 - global_seqlen/min:23161 - global_seqlen/max:24210 - global_seqlen/minmax_diff:1049 - global_seqlen/balanced_min:23726 - global_seqlen/balanced_max:23727 - global_seqlen/mean:23726.5 - actor/entropy:0.0819980725646019 - critic/vf_loss:0.10256552888313308 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.4571040919981897 - critic/grad_norm:30.630013465881348 - perf/mfu/critic:0.09994849524737624 - critic/lr:1e-05 - actor/pg_loss:-0.13181900436029537 - actor/pg_clipfrac:0.0044534104818012565 - actor/ppo_kl:0.0003303983339719707 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.919806957244873 - perf/mfu/actor:0.07523066533395219 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.67911911010742 - actor/lr:1e-06 - training/global_step:189 - training/epoch:6 - critic/score/mean:0.63671875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.63671875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-2.2579213165840883e-08 - critic/advantages/max:3.0661838054656982 - critic/advantages/min:-2.5434722900390625 - critic/returns/mean:0.5699272155761719 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.65234375 - critic/values/max:1.125 - critic/values/min:-0.12158203125 - critic/vf_explained_var:0.3727051019668579 - response_length/mean:266.125 - response_length/max:512.0 - response_length/min:119.0 - response_length/clip_ratio:0.04296875 - prompt_length/mean:104.6015625 - prompt_length/max:206.0 - prompt_length/min:64.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.815162926912308e-06 - timing_s/generate_sequences:3.4994451999664307 - timing_s/reshard:0.5810166001319885 - timing_s/gen:4.959801652934402 - timing_s/reward:0.036213855259120464 - timing_s/old_log_prob:2.084136353805661 - timing_s/values:1.4344360530376434 - timing_s/adv:0.03585579013451934 - timing_s/update_critic:5.106244950089604 - timing_s/update_actor:6.780356770846993 - timing_s/step:20.443663608282804 - timing_s/stop_profile:2.0442530512809753e-06 - timing_per_token_ms/values:0.015114282058433012 - timing_per_token_ms/adv:0.0003778031961574541 - timing_per_token_ms/update_actor:0.07144286737242106 - timing_per_token_ms/update_critic:0.05380318367742402 - timing_per_token_ms/gen:0.07280122200760925 - perf/total_num_tokens:94906 - perf/time_per_step:20.443663608282804 - perf/throughput:1160.5796521904786
[36m(TaskRunner pid=2914832)[0m Training Progress:  43%|████▎     | 189/435 [1:10:04<1:25:55, 20.96s/it]
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 190}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and bakes muffins for her friends every day with four. She sells the remainder at the farmers' market daily for $2 per fresh duck egg. How much in dollars does she make every day at the farmers' market? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much money Janet makes every day from selling the eggs, we need to follow these steps:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. Calculate the number of eggs laid by the ducks per day.
[36m(TaskRunner pid=2914832)[0m 2. Subtract the number of eggs eaten per day and the number of eggs baked per day.
[36m(TaskRunner pid=2914832)[0m 3. Determine the number of ducks laid per day.
[36m(TaskRunner pid=2914832)[0m 4. Calculate the total revenue from selling the eggs.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m First, the ducks lay 16 eggs per day. Janet eats 3 eggs for breakfast and bakes 4 muffins, so the total number of eggs eaten per day is:
[36m(TaskRunner pid=2914832)[0m \[ 3 + 4 = 7 \text{ eggs} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Therefore, the number of eggs baked per day is:
[36m(TaskRunner pid=2914832)[0m \[ 16 - 7 = 9 \text{ eggs} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Next, Janet sells each egg for $2. Therefore, the total revenue from selling the eggs per day is:
[36m(TaskRunner pid=2914832)[0m \[ 9 \times 2 = 18 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m So, the final answer is:
[36m(TaskRunner pid=2914832)[0m #### 18
[36m(TaskRunner pid=2914832)[0m [ground_truth] 18
[36m(TaskRunner pid=2914832)[0m [score] 1.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1312
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 190}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Tom's restaurant gets 6 reservations a night.  They normally order 2 meals that cost $5 each and a $5 bottle of wine.  How much do they make a week if they are open 2 days a week? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much Tom's restaurant makes a week, we need to calculate the daily revenue and then multiply by the number of days the restaurant is open in a week.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m First, let's find out how many meals are ordered per night. They get 6 reservations a night, and each reservation costs $5. Therefore, the total number of meals ordered per night is:
[36m(TaskRunner pid=2914832)[0m \[ 6 \text{ reservations/night} \times 5 \text{ dollars/meal} = 30 \text{ meals/night} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Next, the normal cost of each meal is $5, and they order a $5 bottle of wine. Therefore, the total cost of the meals ordered per night is:
[36m(TaskRunner pid=2914832)[0m \[ 30 \text{ meals/night} \times 5 \text{ dollars/meal} + 5 \text{ dollars/bottle} = 150 \text{ dollars/night} + 5 \text{ dollars} = 155 \text{ dollars/night} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m They are open 2 days a week, so the total daily revenue is:
[36m(TaskRunner pid=2914832)[0m \[ 155 \text{ dollars/night} \times 2 \text{ nights/week} = 310 \text{ dollars/week} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Therefore, the final answer is:
[36m(TaskRunner pid=2914832)[0m #### 310
[36m(TaskRunner pid=2914832)[0m [ground_truth] 180
[36m(TaskRunner pid=2914832)[0m [score] 0.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1319
[36m(TaskRunner pid=2914832)[0m step:190 - global_seqlen/min:22265 - global_seqlen/max:23603 - global_seqlen/minmax_diff:1338 - global_seqlen/balanced_min:22784 - global_seqlen/balanced_max:22785 - global_seqlen/mean:22784.5 - actor/entropy:0.07836475223302841 - critic/vf_loss:0.08599382970714942 - critic/vf_clipfrac:0.00014952152559999377 - critic/vpred_mean:0.657324330881238 - critic/grad_norm:27.7331600189209 - perf/mfu/critic:0.0922894510200059 - critic/lr:1e-05 - actor/pg_loss:-0.11777197878109291 - actor/pg_clipfrac:0.0036824397611781023 - actor/ppo_kl:-0.00011265549221661786 - actor/pg_clipfrac_lower:9.370315092382953e-05 - actor/grad_norm:2.8283491730690002 - perf/mfu/actor:0.07156354538342491 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.43169021606445 - actor/lr:1e-06 - val-core/openai/gsm8k/reward/mean@1:0.5223654283548143 - training/global_step:190 - training/epoch:6 - critic/score/mean:0.68359375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.68359375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.7685024999991583e-08 - critic/advantages/max:2.365022659301758 - critic/advantages/min:-2.4837446212768555 - critic/returns/mean:0.6290260553359985 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.4375 - critic/values/max:0.89453125 - critic/values/min:-0.2392578125 - critic/vf_explained_var:0.28299880027770996 - response_length/mean:254.56640625 - response_length/max:512.0 - response_length/min:118.0 - response_length/clip_ratio:0.01953125 - prompt_length/mean:101.44140625 - prompt_length/max:181.0 - prompt_length/min:70.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.476176738739014e-06 - timing_s/generate_sequences:3.362003803253174 - timing_s/reshard:0.8523087501525879 - timing_s/gen:4.857432424090803 - timing_s/reward:0.038710270542651415 - timing_s/old_log_prob:2.0919268913567066 - timing_s/values:1.3550416957587004 - timing_s/adv:0.03481096960604191 - timing_s/update_critic:5.304426234215498 - timing_s/update_actor:6.8377374350093305 - timing_s/testing:14.041213757824153 - timing_s/step:34.56986194802448 - timing_s/stop_profile:2.284068614244461e-06 - timing_per_token_ms/values:0.01486802097652681 - timing_per_token_ms/adv:0.00038195889317345024 - timing_per_token_ms/update_actor:0.07502619582401776 - timing_per_token_ms/update_critic:0.058202135598932364 - timing_per_token_ms/gen:0.07453593616736183 - perf/total_num_tokens:91138 - perf/time_per_step:34.56986194802448 - perf/throughput:659.0856519547668
[36m(TaskRunner pid=2914832)[0m Training Progress:  44%|████▎     | 190/435 [1:10:39<1:42:15, 25.04s/it]
[36m(TaskRunner pid=2914832)[0m step:191 - global_seqlen/min:22311 - global_seqlen/max:24665 - global_seqlen/minmax_diff:2354 - global_seqlen/balanced_min:23791 - global_seqlen/balanced_max:23791 - global_seqlen/mean:23791.0 - actor/entropy:0.08312497287988663 - critic/vf_loss:0.08376048051286489 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.7769055105745792 - critic/grad_norm:20.387861788272858 - perf/mfu/critic:0.09913516940408905 - critic/lr:1e-05 - actor/pg_loss:0.025492370128631592 - actor/pg_clipfrac:0.0030416987247008365 - actor/ppo_kl:-0.0002273653188851199 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.82659512758255 - perf/mfu/actor:0.07552852622171982 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.50249099731445 - actor/lr:1e-06 - training/global_step:191 - training/epoch:6 - critic/score/mean:0.71875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.71875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-3.2454956055971707e-08 - critic/advantages/max:2.6093151569366455 - critic/advantages/min:-2.6996803283691406 - critic/returns/mean:0.6704471111297607 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.87109375 - critic/values/max:1.296875 - critic/values/min:0.1376953125 - critic/vf_explained_var:0.3770238161087036 - response_length/mean:269.68359375 - response_length/max:512.0 - response_length/min:107.0 - response_length/clip_ratio:0.02734375 - prompt_length/mean:102.05078125 - prompt_length/max:186.0 - prompt_length/min:65.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.282927304506302e-06 - timing_s/generate_sequences:3.532538890838623 - timing_s/reshard:0.6182954907417297 - timing_s/gen:4.6222774758934975 - timing_s/reward:0.033164292108267546 - timing_s/old_log_prob:2.0854041860438883 - timing_s/values:1.345799112226814 - timing_s/adv:0.0344572807662189 - timing_s/update_critic:5.16092678392306 - timing_s/update_actor:6.769267330877483 - timing_s/step:20.059277062304318 - timing_s/stop_profile:1.884065568447113e-06 - timing_per_token_ms/values:0.014141893071190934 - timing_per_token_ms/adv:0.0003620831487350143 - timing_per_token_ms/update_actor:0.07113264817449333 - timing_per_token_ms/update_critic:0.05423192366780568 - timing_per_token_ms/gen:0.0669516863786193 - perf/total_num_tokens:95164 - perf/time_per_step:20.059277062304318 - perf/throughput:1186.0347671605966
[36m(TaskRunner pid=2914832)[0m Training Progress:  44%|████▍     | 191/435 [1:10:59<1:35:46, 23.55s/it]
[36m(TaskRunner pid=2914832)[0m step:192 - global_seqlen/min:22909 - global_seqlen/max:23883 - global_seqlen/minmax_diff:974 - global_seqlen/balanced_min:23551 - global_seqlen/balanced_max:23551 - global_seqlen/mean:23551.0 - actor/entropy:0.08396393805742264 - critic/vf_loss:0.08964218234177679 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.5014836974442005 - critic/grad_norm:11.42086660861969 - perf/mfu/critic:0.0905585993052886 - critic/lr:1e-05 - actor/pg_loss:-0.06466853013262153 - actor/pg_clipfrac:0.004829237615922466 - actor/ppo_kl:-2.8779627427866217e-06 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.116028845310211 - perf/mfu/actor:0.07187445395342756 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.80760192871094 - actor/lr:1e-06 - training/global_step:192 - training/epoch:6 - critic/score/mean:0.63671875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.63671875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:1.3166794765595569e-08 - critic/advantages/max:2.5179123878479004 - critic/advantages/min:-2.650515556335449 - critic/returns/mean:0.5947855710983276 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.515625 - critic/values/max:1.0078125 - critic/values/min:-0.1572265625 - critic/vf_explained_var:0.3364863395690918 - response_length/mean:263.69140625 - response_length/max:512.0 - response_length/min:115.0 - response_length/clip_ratio:0.0234375 - prompt_length/mean:104.29296875 - prompt_length/max:217.0 - prompt_length/min:63.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:6.517861038446426e-06 - timing_s/generate_sequences:3.527707576751709 - timing_s/reshard:0.8777946829795837 - timing_s/gen:5.325228814035654 - timing_s/reward:0.03459383174777031 - timing_s/old_log_prob:2.1169217792339623 - timing_s/values:1.6028899871744215 - timing_s/adv:0.03471886599436402 - timing_s/update_critic:5.58930693520233 - timing_s/update_actor:7.042673389893025 - timing_s/step:21.75521281082183 - timing_s/stop_profile:1.7955899238586426e-06 - timing_per_token_ms/values:0.017015094764282 - timing_per_token_ms/adv:0.00036854980674243156 - timing_per_token_ms/update_actor:0.07475981263951663 - timing_per_token_ms/update_critic:0.05933194912320422 - timing_per_token_ms/gen:0.07888643528680327 - perf/total_num_tokens:94204 - perf/time_per_step:21.75521281082183 - perf/throughput:1082.5451446875702
[36m(TaskRunner pid=2914832)[0m Training Progress:  44%|████▍     | 192/435 [1:11:20<1:33:13, 23.02s/it]
[36m(TaskRunner pid=2914832)[0m step:193 - global_seqlen/min:22991 - global_seqlen/max:24661 - global_seqlen/minmax_diff:1670 - global_seqlen/balanced_min:23896 - global_seqlen/balanced_max:23897 - global_seqlen/mean:23896.5 - actor/entropy:0.07280980795621872 - critic/vf_loss:0.13380070170387626 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.8126046024262905 - critic/grad_norm:34.49240070581436 - perf/mfu/critic:0.0974522547738366 - critic/lr:1e-05 - actor/pg_loss:0.04541313770459965 - actor/pg_clipfrac:0.003450323587458115 - actor/ppo_kl:-5.616540875053033e-05 - actor/pg_clipfrac_lower:6.69164874125272e-05 - actor/grad_norm:2.870227634906769 - perf/mfu/actor:0.0753055694080342 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.05597686767578 - actor/lr:1e-06 - training/global_step:193 - training/epoch:6 - critic/score/mean:0.6875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.6875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-7.963531167831661e-09 - critic/advantages/max:2.6821630001068115 - critic/advantages/min:-2.965717077255249 - critic/returns/mean:0.6231461763381958 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.71484375 - critic/values/max:1.328125 - critic/values/min:-0.05810546875 - critic/vf_explained_var:0.33371710777282715 - response_length/mean:269.44921875 - response_length/max:512.0 - response_length/min:115.0 - response_length/clip_ratio:0.0234375 - prompt_length/mean:103.93359375 - prompt_length/max:232.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.48198989033699e-06 - timing_s/generate_sequences:3.3796257972717285 - timing_s/reshard:0.9149307608604431 - timing_s/gen:4.939268941059709 - timing_s/reward:0.034500616136938334 - timing_s/old_log_prob:2.0735055622644722 - timing_s/values:1.3415761687792838 - timing_s/adv:0.034238182939589024 - timing_s/update_critic:5.2721961797215044 - timing_s/update_actor:6.819566438905895 - timing_s/step:20.52254630578682 - timing_s/stop_profile:2.1918676793575287e-06 - timing_per_token_ms/values:0.014035278898366746 - timing_per_token_ms/adv:0.00035819244386823407 - timing_per_token_ms/update_actor:0.07134482496292234 - timing_per_token_ms/update_critic:0.05515657292617648 - timing_per_token_ms/gen:0.07160540078951143 - perf/total_num_tokens:95586 - perf/time_per_step:20.52254630578682 - perf/throughput:1164.4022941374392
[36m(TaskRunner pid=2914832)[0m Training Progress:  44%|████▍     | 193/435 [1:11:41<1:29:50, 22.27s/it]
[36m(TaskRunner pid=2914832)[0m step:194 - global_seqlen/min:22930 - global_seqlen/max:23875 - global_seqlen/minmax_diff:945 - global_seqlen/balanced_min:23480 - global_seqlen/balanced_max:23480 - global_seqlen/mean:23480.0 - actor/entropy:0.07607033103704453 - critic/vf_loss:0.08995140844490379 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.4943088302388787 - critic/grad_norm:26.799269676208496 - perf/mfu/critic:0.08984195864897629 - critic/lr:1e-05 - actor/pg_loss:0.07078466698294505 - actor/pg_clipfrac:0.004282634952687658 - actor/ppo_kl:0.0005414960269263247 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.214722156524658 - perf/mfu/actor:0.0714003977788242 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.62394714355469 - actor/lr:1e-06 - training/global_step:194 - training/epoch:6 - critic/score/mean:0.66015625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.66015625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:2.061298687294766e-08 - critic/advantages/max:2.865199089050293 - critic/advantages/min:-2.648355722427368 - critic/returns/mean:0.5899103283882141 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.6875 - critic/values/max:1.234375 - critic/values/min:-0.02685546875 - critic/vf_explained_var:0.3612107038497925 - response_length/mean:261.87109375 - response_length/max:512.0 - response_length/min:118.0 - response_length/clip_ratio:0.01953125 - prompt_length/mean:105.00390625 - prompt_length/max:215.0 - prompt_length/min:66.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.536006599664688e-06 - timing_s/generate_sequences:3.4897637367248535 - timing_s/reshard:0.7937225103378296 - timing_s/gen:5.21957134315744 - timing_s/reward:0.033871125895529985 - timing_s/old_log_prob:2.1155850384384394 - timing_s/values:1.6156702917069197 - timing_s/adv:0.03444489696994424 - timing_s/update_critic:5.617365474812686 - timing_s/update_actor:7.064684598706663 - timing_s/step:21.70787693792954 - timing_s/stop_profile:2.0740553736686707e-06 - timing_per_token_ms/values:0.017202622356334324 - timing_per_token_ms/adv:0.00036674719942444886 - timing_per_token_ms/update_actor:0.07522023635760927 - timing_per_token_ms/update_critic:0.059810109399624 - timing_per_token_ms/gen:0.0778587291450863 - perf/total_num_tokens:93920 - perf/time_per_step:21.70787693792954 - perf/throughput:1081.635024334143
[36m(TaskRunner pid=2914832)[0m Training Progress:  45%|████▍     | 194/435 [1:12:03<1:28:48, 22.11s/it]
[36m(TaskRunner pid=2914832)[0m step:195 - global_seqlen/min:23165 - global_seqlen/max:23703 - global_seqlen/minmax_diff:538 - global_seqlen/balanced_min:23425 - global_seqlen/balanced_max:23426 - global_seqlen/mean:23425.25 - actor/entropy:0.0858602300286293 - critic/vf_loss:0.09965454443590716 - critic/vf_clipfrac:0.020618632435798645 - critic/vpred_mean:0.6790435295552015 - critic/grad_norm:25.444721281528473 - perf/mfu/critic:0.09779009931110075 - critic/lr:1e-05 - actor/pg_loss:0.19297074479982257 - actor/pg_clipfrac:0.004104497405933216 - actor/ppo_kl:-0.00033545693804626353 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.981979191303253 - perf/mfu/actor:0.07426071207513148 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.7039566040039 - actor/lr:1e-06 - training/global_step:195 - training/epoch:6 - critic/score/mean:0.6640625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.6640625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-2.5795587887955662e-08 - critic/advantages/max:2.570589303970337 - critic/advantages/min:-2.5186517238616943 - critic/returns/mean:0.5987712144851685 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.47265625 - critic/values/max:0.9609375 - critic/values/min:-0.283203125 - critic/vf_explained_var:0.2789995074272156 - response_length/mean:263.84765625 - response_length/max:512.0 - response_length/min:101.0 - response_length/clip_ratio:0.02734375 - prompt_length/mean:102.171875 - prompt_length/max:170.0 - prompt_length/min:66.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.8691796362400055e-06 - timing_s/generate_sequences:3.4110031127929688 - timing_s/reshard:0.8889943361282349 - timing_s/gen:4.968027598690242 - timing_s/reward:0.03299142373725772 - timing_s/old_log_prob:2.0756417298689485 - timing_s/values:1.3458759170025587 - timing_s/adv:0.034270071890205145 - timing_s/update_critic:5.14979893527925 - timing_s/update_actor:6.7763748480938375 - timing_s/step:20.390251707751304 - timing_s/stop_profile:2.319924533367157e-06 - timing_per_token_ms/values:0.014363517112971673 - timing_per_token_ms/adv:0.0003657385928667266 - timing_per_token_ms/update_actor:0.07231913051188181 - timing_per_token_ms/update_critic:0.054959914358216566 - timing_per_token_ms/gen:0.07355137461973857 - perf/total_num_tokens:93701 - perf/time_per_step:20.390251707751304 - perf/throughput:1148.8455530490066
[36m(TaskRunner pid=2914832)[0m Training Progress:  45%|████▍     | 195/435 [1:12:23<1:26:23, 21.60s/it]
[36m(TaskRunner pid=2914832)[0m step:196 - global_seqlen/min:22364 - global_seqlen/max:24300 - global_seqlen/minmax_diff:1936 - global_seqlen/balanced_min:23504 - global_seqlen/balanced_max:23505 - global_seqlen/mean:23504.25 - actor/entropy:0.08434513211250305 - critic/vf_loss:0.10628941596951336 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.7572013232856989 - critic/grad_norm:38.905479431152344 - perf/mfu/critic:0.09796959822970432 - critic/lr:1e-05 - actor/pg_loss:-0.1635355366161093 - actor/pg_clipfrac:0.00349057067069225 - actor/ppo_kl:0.00033317199086013716 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.087588369846344 - perf/mfu/actor:0.07352123521759224 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.54920196533203 - actor/lr:1e-06 - training/global_step:196 - training/epoch:6 - critic/score/mean:0.640625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.640625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-7.459172479684639e-08 - critic/advantages/max:2.5287179946899414 - critic/advantages/min:-2.008352279663086 - critic/returns/mean:0.5918629169464111 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.91015625 - critic/values/max:1.2421875 - critic/values/min:0.10546875 - critic/vf_explained_var:0.2221132516860962 - response_length/mean:264.89453125 - response_length/max:512.0 - response_length/min:125.0 - response_length/clip_ratio:0.0234375 - prompt_length/mean:102.359375 - prompt_length/max:175.0 - prompt_length/min:67.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.398861736059189e-06 - timing_s/generate_sequences:3.5154738426208496 - timing_s/reshard:0.8839921951293945 - timing_s/gen:5.333035464398563 - timing_s/reward:0.03439956717193127 - timing_s/old_log_prob:2.1409856118261814 - timing_s/values:1.6244272561743855 - timing_s/adv:0.03614772204309702 - timing_s/update_critic:5.157594542019069 - timing_s/update_actor:6.872307450976223 - timing_s/step:21.20641274098307 - timing_s/stop_profile:1.8300488591194153e-06 - timing_per_token_ms/values:0.017278016275507468 - timing_per_token_ms/adv:0.00038448070075727814 - timing_per_token_ms/update_actor:0.07309643416590854 - timing_per_token_ms/update_critic:0.054858105895945086 - timing_per_token_ms/gen:0.07864326109150993 - perf/total_num_tokens:94017 - perf/time_per_step:21.20641274098307 - perf/throughput:1108.3557736559649
[36m(TaskRunner pid=2914832)[0m Training Progress:  45%|████▌     | 196/435 [1:12:44<1:25:34, 21.48s/it]
[36m(TaskRunner pid=2914832)[0m step:197 - global_seqlen/min:23003 - global_seqlen/max:24188 - global_seqlen/minmax_diff:1185 - global_seqlen/balanced_min:23493 - global_seqlen/balanced_max:23494 - global_seqlen/mean:23493.75 - actor/entropy:0.08438297361135483 - critic/vf_loss:0.12544148182496428 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.46239472925662994 - critic/grad_norm:31.603001296520233 - perf/mfu/critic:0.0904589525561996 - critic/lr:1e-05 - actor/pg_loss:-0.14349565445445478 - actor/pg_clipfrac:0.0034447916550561786 - actor/ppo_kl:0.0002713026206038194 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.902750074863434 - perf/mfu/actor:0.07255757220266663 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.61352920532227 - actor/lr:1e-06 - training/global_step:197 - training/epoch:6 - critic/score/mean:0.66015625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.66015625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-9.108664045243131e-09 - critic/advantages/max:2.689649820327759 - critic/advantages/min:-2.0604567527770996 - critic/returns/mean:0.5823525786399841 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.392578125 - critic/values/max:0.67578125 - critic/values/min:-0.337890625 - critic/vf_explained_var:0.27542275190353394 - response_length/mean:264.203125 - response_length/max:512.0 - response_length/min:110.0 - response_length/clip_ratio:0.0390625 - prompt_length/mean:102.88671875 - prompt_length/max:190.0 - prompt_length/min:71.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.9907172322273254e-06 - timing_s/generate_sequences:3.467430591583252 - timing_s/reshard:0.5835179090499878 - timing_s/gen:4.527377387974411 - timing_s/reward:0.03474799124523997 - timing_s/old_log_prob:2.0802676109597087 - timing_s/values:1.3540655081160367 - timing_s/adv:0.034047408029437065 - timing_s/update_critic:5.584622579626739 - timing_s/update_actor:6.959963624831289 - timing_s/step:20.58482477022335 - timing_s/stop_profile:2.5639310479164124e-06 - timing_per_token_ms/values:0.014408784337494405 - timing_per_token_ms/adv:0.00036230282553271684 - timing_per_token_ms/update_actor:0.07406186352573864 - timing_per_token_ms/update_critic:0.05942668347567692 - timing_per_token_ms/gen:0.06693739115226227 - perf/total_num_tokens:93975 - perf/time_per_step:20.58482477022335 - perf/throughput:1141.3140632600628
[36m(TaskRunner pid=2914832)[0m Training Progress:  45%|████▌     | 197/435 [1:13:05<1:24:09, 21.22s/it]
[36m(TaskRunner pid=2914832)[0m step:198 - global_seqlen/min:22714 - global_seqlen/max:25149 - global_seqlen/minmax_diff:2435 - global_seqlen/balanced_min:23825 - global_seqlen/balanced_max:23825 - global_seqlen/mean:23825.0 - actor/entropy:0.08762064576148987 - critic/vf_loss:0.08866214458248578 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.7137147821485996 - critic/grad_norm:27.98562788963318 - perf/mfu/critic:0.09931871010678744 - critic/lr:1e-05 - actor/pg_loss:-0.11920565529726446 - actor/pg_clipfrac:0.0036704248195746914 - actor/ppo_kl:0.00024586150766481296 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.97189062833786 - perf/mfu/actor:0.07562027798318699 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.81947708129883 - actor/lr:1e-06 - training/global_step:198 - training/epoch:6 - critic/score/mean:0.6328125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.6328125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:1.2850920327878157e-08 - critic/advantages/max:2.459566831588745 - critic/advantages/min:-1.9963778257369995 - critic/returns/mean:0.5657364726066589 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.6796875 - critic/values/max:1.0078125 - critic/values/min:-0.038818359375 - critic/vf_explained_var:0.2740740180015564 - response_length/mean:265.6796875 - response_length/max:512.0 - response_length/min:112.0 - response_length/clip_ratio:0.03515625 - prompt_length/mean:106.5859375 - prompt_length/max:196.0 - prompt_length/min:69.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:6.146728992462158e-06 - timing_s/generate_sequences:3.5945944786071777 - timing_s/reshard:0.9580376148223877 - timing_s/gen:5.235604811925441 - timing_s/reward:0.033735408913344145 - timing_s/old_log_prob:2.3987313457764685 - timing_s/values:1.3460118547081947 - timing_s/adv:0.036496378015726805 - timing_s/update_critic:5.1612926931120455 - timing_s/update_actor:6.7714650090783834 - timing_s/step:20.991656022612005 - timing_s/stop_profile:4.983041435480118e-06 - timing_per_token_ms/values:0.014123943910893964 - timing_per_token_ms/adv:0.0003829630431870599 - timing_per_token_ms/update_actor:0.07105419736703446 - timing_per_token_ms/update_critic:0.05415837033695745 - timing_per_token_ms/gen:0.07697833992891819 - perf/total_num_tokens:95300 - perf/time_per_step:20.991656022612005 - perf/throughput:1134.974771610965
[36m(TaskRunner pid=2914832)[0m Training Progress:  46%|████▌     | 198/435 [1:13:26<1:23:32, 21.15s/it]
[36m(TaskRunner pid=2914832)[0m step:199 - global_seqlen/min:22576 - global_seqlen/max:23920 - global_seqlen/minmax_diff:1344 - global_seqlen/balanced_min:22969 - global_seqlen/balanced_max:22970 - global_seqlen/mean:22969.75 - actor/entropy:0.08451122045516968 - critic/vf_loss:0.06811000825837255 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6270296853035688 - critic/grad_norm:10.91712474822998 - perf/mfu/critic:0.09103097308814152 - critic/lr:1e-05 - actor/pg_loss:-0.016310514272845467 - actor/pg_clipfrac:0.004373089876025915 - actor/ppo_kl:-0.00023397075926823163 - actor/pg_clipfrac_lower:0.00013185668649384752 - actor/grad_norm:2.9047333002090454 - perf/mfu/actor:0.06875672164226698 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.90708541870117 - actor/lr:1e-06 - training/global_step:199 - training/epoch:6 - critic/score/mean:0.65625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.65625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:4.6972196798833465e-08 - critic/advantages/max:2.4106476306915283 - critic/advantages/min:-2.2525475025177 - critic/returns/mean:0.6033457517623901 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.7109375 - critic/values/max:1.0625 - critic/values/min:-0.040283203125 - critic/vf_explained_var:0.29963696002960205 - response_length/mean:256.15625 - response_length/max:512.0 - response_length/min:108.0 - response_length/clip_ratio:0.01953125 - prompt_length/mean:102.74609375 - prompt_length/max:189.0 - prompt_length/min:65.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:6.658025085926056e-06 - timing_s/generate_sequences:3.5072078704833984 - timing_s/reshard:0.5846049785614014 - timing_s/gen:4.9877751362510026 - timing_s/reward:0.033436990808695555 - timing_s/old_log_prob:2.0797496289014816 - timing_s/values:1.3988169888034463 - timing_s/adv:0.033884483855217695 - timing_s/update_critic:5.421899953857064 - timing_s/update_actor:7.173007952049375 - timing_s/step:21.135721390135586 - timing_s/stop_profile:2.1131709218025208e-06 - timing_per_token_ms/values:0.015224556087935723 - timing_per_token_ms/adv:0.00036879465226240704 - timing_per_token_ms/update_actor:0.07807015696785309 - timing_per_token_ms/update_critic:0.059011307848986866 - timing_per_token_ms/gen:0.07606098475434614 - perf/total_num_tokens:91879 - perf/time_per_step:21.135721390135586 - perf/throughput:1086.7738827556834
[36m(TaskRunner pid=2914832)[0m Training Progress:  46%|████▌     | 199/435 [1:13:47<1:23:11, 21.15s/it]
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 200}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and bakes muffins for her friends every day with four. She sells the remainder at the farmers' market daily for $2 per fresh duck egg. How much in dollars does she make every day at the farmers' market? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] 1. First, we need to determine how many eggs the ducks lay in a day. Since the ducks lay 16 eggs per day, the number of eggs laid by the ducks is:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    16 \text{ eggs/day}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 2. Next, we calculate the total number of eggs Janet eats in a day. Janet eats 3 eggs for breakfast and 4 eggs for baking muffins, so the total number of eggs eaten per day is:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    3 + 4 = 7 \text{ eggs/day}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 3. The number of eggs Janet sells each day is the total number of eggs laid minus the number of eggs eaten:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    16 - 7 = 9 \text{ eggs/day}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 4. Janet sells each egg for $2, so the total amount of money she makes every day is:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    9 \text{ eggs/day} \times 2 \text{ dollars/egg} = 18 \text{ dollars/day}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Therefore, the final answer is:
[36m(TaskRunner pid=2914832)[0m #### 18
[36m(TaskRunner pid=2914832)[0m [ground_truth] 18
[36m(TaskRunner pid=2914832)[0m [score] 1.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1312
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 200}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Tom's restaurant gets 6 reservations a night.  They normally order 2 meals that cost $5 each and a $5 bottle of wine.  How much do they make a week if they are open 2 days a week? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much Tom's restaurant makes a week, we need to calculate the daily revenue and then multiply by the number of days the restaurant is open in a week.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m First, let's find out how many meals are reserved per night. They get 6 reservations a night, and each reservation costs $5. Therefore, the total revenue from reservations per night is:
[36m(TaskRunner pid=2914832)[0m \[ 6 \times 5 = 30 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Next, the restaurant orders 2 meals that cost $5 each. Therefore, the total revenue from the meals per night is:
[36m(TaskRunner pid=2914832)[0m \[ 2 \times 5 = 10 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m The restaurant also orders a $5 bottle of wine every night. Therefore, the total revenue from the wine per night is:
[36m(TaskRunner pid=2914832)[0m \[ 5 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m The total revenue per night is the sum of the revenue from reservations and the revenue from the wine:
[36m(TaskRunner pid=2914832)[0m \[ 30 + 10 + 5 = 45 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Since the restaurant is open 2 days a week, the total revenue for the week is:
[36m(TaskRunner pid=2914832)[0m \[ 45 \times 2 = 90 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Therefore, the final answer is:
[36m(TaskRunner pid=2914832)[0m #### 90
[36m(TaskRunner pid=2914832)[0m [ground_truth] 180
[36m(TaskRunner pid=2914832)[0m [score] 0.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1319
[36m(TaskRunner pid=2914832)[0m step:200 - global_seqlen/min:21111 - global_seqlen/max:24464 - global_seqlen/minmax_diff:3353 - global_seqlen/balanced_min:22668 - global_seqlen/balanced_max:22669 - global_seqlen/mean:22668.25 - actor/entropy:0.07422716170549393 - critic/vf_loss:0.09783028572564945 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.4451469164341688 - critic/grad_norm:31.829116821289062 - perf/mfu/critic:0.0878759238046365 - critic/lr:1e-05 - actor/pg_loss:0.03417822270421311 - actor/pg_clipfrac:0.003989045791968238 - actor/ppo_kl:8.005933750609984e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.8995465636253357 - perf/mfu/actor:0.07048879013804192 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.85623168945312 - actor/lr:1e-06 - val-core/openai/gsm8k/reward/mean@1:0.530705079605762 - training/global_step:200 - training/epoch:6 - critic/score/mean:0.67578125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.67578125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:5.965751626035853e-08 - critic/advantages/max:2.438230514526367 - critic/advantages/min:-2.4162840843200684 - critic/returns/mean:0.6236403584480286 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.447265625 - critic/values/max:0.9375 - critic/values/min:-0.318359375 - critic/vf_explained_var:0.21782296895980835 - response_length/mean:251.02734375 - response_length/max:512.0 - response_length/min:109.0 - response_length/clip_ratio:0.0078125 - prompt_length/mean:103.1640625 - prompt_length/max:170.0 - prompt_length/min:70.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.3676776587963104e-06 - timing_s/generate_sequences:3.1611289978027344 - timing_s/reshard:0.9058915376663208 - timing_s/gen:4.8613150217570364 - timing_s/reward:0.033638376742601395 - timing_s/old_log_prob:2.0708861802704632 - timing_s/values:1.4501754348166287 - timing_s/adv:0.033889856189489365 - timing_s/update_critic:5.537809201981872 - timing_s/update_actor:6.901175012812018 - timing_s/testing:13.574291473720223 - timing_s/step:34.46998604433611 - timing_s/stop_profile:2.0922161638736725e-06 - timing_per_token_ms/values:0.015993464811097334 - timing_per_token_ms/adv:0.00037375907039018634 - timing_per_token_ms/update_actor:0.07611058432843314 - timing_per_token_ms/update_critic:0.06107451172876019 - timing_per_token_ms/gen:0.0756471845658783 - perf/total_num_tokens:90673 - perf/time_per_step:34.46998604433611 - perf/throughput:657.6228365988766
[36m(TaskRunner pid=2914832)[0m Training Progress:  46%|████▌     | 200/435 [1:14:22<1:38:30, 25.15s/it]
[36m(TaskRunner pid=2914832)[0m step:201 - global_seqlen/min:21596 - global_seqlen/max:24621 - global_seqlen/minmax_diff:3025 - global_seqlen/balanced_min:23255 - global_seqlen/balanced_max:23256 - global_seqlen/mean:23255.5 - actor/entropy:0.07915113866329193 - critic/vf_loss:0.06547736469656229 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6807458773255348 - critic/grad_norm:13.628622651100159 - perf/mfu/critic:0.09144689253040511 - critic/lr:1e-05 - actor/pg_loss:-0.002399585544480942 - actor/pg_clipfrac:0.0033534032918396406 - actor/ppo_kl:0.00026211599333691993 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.9517802000045776 - perf/mfu/actor:0.07200162977183586 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:87.91510391235352 - actor/lr:1e-06 - training/global_step:201 - training/epoch:6 - critic/score/mean:0.6953125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.6953125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:1.3743652438336085e-08 - critic/advantages/max:2.78255033493042 - critic/advantages/min:-2.963934898376465 - critic/returns/mean:0.6206189393997192 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.6484375 - critic/values/max:1.234375 - critic/values/min:-0.1513671875 - critic/vf_explained_var:0.4169144034385681 - response_length/mean:259.12890625 - response_length/max:512.0 - response_length/min:105.0 - response_length/clip_ratio:0.0390625 - prompt_length/mean:104.23828125 - prompt_length/max:194.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.187917172908783e-06 - timing_s/generate_sequences:3.510972023010254 - timing_s/reshard:0.30048587918281555 - timing_s/gen:4.332444831728935 - timing_s/reward:0.033536877017468214 - timing_s/old_log_prob:2.0786351612769067 - timing_s/values:1.3464425699785352 - timing_s/adv:0.033728154841810465 - timing_s/update_critic:5.466993942391127 - timing_s/update_actor:6.938891835976392 - timing_s/step:20.23918164288625 - timing_s/stop_profile:2.00001522898674e-06 - timing_per_token_ms/values:0.01447445303238519 - timing_per_token_ms/adv:0.0003625825594140146 - timing_per_token_ms/update_actor:0.07459409425701868 - timing_per_token_ms/update_critic:0.05877097828891152 - timing_per_token_ms/gen:0.06530962858930815 - perf/total_num_tokens:93022 - perf/time_per_step:20.23918164288625 - perf/throughput:1149.0336126398636
[36m(TaskRunner pid=2914832)[0m Training Progress:  46%|████▌     | 201/435 [1:14:42<1:32:21, 23.68s/it]
[36m(TaskRunner pid=2914832)[0m step:202 - global_seqlen/min:21452 - global_seqlen/max:24394 - global_seqlen/minmax_diff:2942 - global_seqlen/balanced_min:23179 - global_seqlen/balanced_max:23180 - global_seqlen/mean:23179.75 - actor/entropy:0.0785498097538948 - critic/vf_loss:0.0955225900397636 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.5847786907106638 - critic/grad_norm:6.6454578042030334 - perf/mfu/critic:0.09258433915514722 - critic/lr:1e-05 - actor/pg_loss:-0.05742967512924224 - actor/pg_clipfrac:0.003973978840804193 - actor/ppo_kl:0.0004524572013906436 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.9199599623680115 - perf/mfu/actor:0.07303453892650687 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.70137405395508 - actor/lr:1e-06 - training/global_step:202 - training/epoch:6 - critic/score/mean:0.64453125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.64453125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.3044573754505961e-10 - critic/advantages/max:2.6482555866241455 - critic/advantages/min:-2.4879233837127686 - critic/returns/mean:0.5738624334335327 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.65234375 - critic/values/max:1.25 - critic/values/min:-0.1044921875 - critic/vf_explained_var:0.24097222089767456 - response_length/mean:257.0234375 - response_length/max:512.0 - response_length/min:118.0 - response_length/clip_ratio:0.03125 - prompt_length/mean:105.16015625 - prompt_length/max:222.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.087815225124359e-06 - timing_s/generate_sequences:3.5159246921539307 - timing_s/reshard:0.889987051486969 - timing_s/gen:5.009361690841615 - timing_s/reward:0.0355557962320745 - timing_s/old_log_prob:2.0748938941396773 - timing_s/values:1.344903332181275 - timing_s/adv:0.033091815654188395 - timing_s/update_critic:5.380870126653463 - timing_s/update_actor:6.8185142911970615 - timing_s/step:20.70557258790359 - timing_s/stop_profile:2.091284841299057e-06 - timing_per_token_ms/values:0.014505153551928676 - timing_per_token_ms/adv:0.00035690436322855505 - timing_per_token_ms/update_actor:0.07353955814015532 - timing_per_token_ms/update_critic:0.058034169120174534 - timing_per_token_ms/gen:0.07613243093774302 - perf/total_num_tokens:92719 - perf/time_per_step:20.70557258790359 - perf/throughput:1119.4933103922879
[36m(TaskRunner pid=2914832)[0m Training Progress:  46%|████▋     | 202/435 [1:15:03<1:28:30, 22.79s/it]
[36m(TaskRunner pid=2914832)[0m step:203 - global_seqlen/min:21848 - global_seqlen/max:24411 - global_seqlen/minmax_diff:2563 - global_seqlen/balanced_min:23151 - global_seqlen/balanced_max:23152 - global_seqlen/mean:23151.75 - actor/entropy:0.09243912994861603 - critic/vf_loss:0.07737947127316147 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6546240691095591 - critic/grad_norm:19.204728603363037 - perf/mfu/critic:0.09031096639632274 - critic/lr:1e-05 - actor/pg_loss:-0.04550543321965961 - actor/pg_clipfrac:0.004907055088551715 - actor/ppo_kl:0.00015594725050505076 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.89167457818985 - perf/mfu/actor:0.06932039969601511 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.22604370117188 - actor/lr:1e-06 - training/global_step:203 - training/epoch:6 - critic/score/mean:0.671875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.671875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-3.926511382701392e-08 - critic/advantages/max:2.2421655654907227 - critic/advantages/min:-2.468244791030884 - critic/returns/mean:0.6040346026420593 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.51171875 - critic/values/max:1.046875 - critic/values/min:-0.15625 - critic/vf_explained_var:0.3352370858192444 - response_length/mean:257.5390625 - response_length/max:512.0 - response_length/min:106.0 - response_length/clip_ratio:0.046875 - prompt_length/mean:104.20703125 - prompt_length/max:201.0 - prompt_length/min:66.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.591195076704025e-06 - timing_s/generate_sequences:3.522740364074707 - timing_s/reshard:0.5866755247116089 - timing_s/gen:5.017923956736922 - timing_s/reward:0.03340184362605214 - timing_s/old_log_prob:2.142003610730171 - timing_s/values:1.630328921135515 - timing_s/adv:0.03312922269105911 - timing_s/update_critic:5.509831836912781 - timing_s/update_actor:7.174571922048926 - timing_s/step:21.547810974065214 - timing_s/stop_profile:1.8980354070663452e-06 - timing_per_token_ms/values:0.017604813039354638 - timing_per_token_ms/adv:0.000357739940728661 - timing_per_token_ms/update_actor:0.07747332190923932 - timing_per_token_ms/update_critic:0.05949692611695424 - timing_per_token_ms/gen:0.07610987345270624 - perf/total_num_tokens:92607 - perf/time_per_step:21.547810974065214 - perf/throughput:1074.4362862596704
[36m(TaskRunner pid=2914832)[0m Training Progress:  47%|████▋     | 203/435 [1:15:24<1:26:41, 22.42s/it]
[36m(TaskRunner pid=2914832)[0m step:204 - global_seqlen/min:22567 - global_seqlen/max:24480 - global_seqlen/minmax_diff:1913 - global_seqlen/balanced_min:23404 - global_seqlen/balanced_max:23405 - global_seqlen/mean:23404.75 - actor/entropy:0.09349782019853592 - critic/vf_loss:0.06077730673132464 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.5575822498649359 - critic/grad_norm:24.73016929626465 - perf/mfu/critic:0.0963341682236993 - critic/lr:1e-05 - actor/pg_loss:0.005487682166858576 - actor/pg_clipfrac:0.003856440423987806 - actor/ppo_kl:0.00037772142513858853 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.469900071620941 - perf/mfu/actor:0.07351351115189295 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.45580291748047 - actor/lr:1e-06 - training/global_step:204 - training/epoch:7 - critic/score/mean:0.640625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.640625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:3.286918470735145e-08 - critic/advantages/max:2.3087098598480225 - critic/advantages/min:-2.593886137008667 - critic/returns/mean:0.5579213500022888 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.72265625 - critic/values/max:1.2578125 - critic/values/min:0.1220703125 - critic/vf_explained_var:0.38832539319992065 - response_length/mean:262.71484375 - response_length/max:512.0 - response_length/min:109.0 - response_length/clip_ratio:0.04296875 - prompt_length/mean:102.984375 - prompt_length/max:183.0 - prompt_length/min:64.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:1.4233402907848358e-05 - timing_s/generate_sequences:3.5507051944732666 - timing_s/reshard:0.962552011013031 - timing_s/gen:5.343803345225751 - timing_s/reward:0.03516744216904044 - timing_s/old_log_prob:2.113001794088632 - timing_s/values:1.6312314090318978 - timing_s/adv:0.03530576825141907 - timing_s/update_critic:5.223166323266923 - timing_s/update_actor:6.84223368903622 - timing_s/step:21.233780565671623 - timing_s/stop_profile:2.086162567138672e-06 - timing_per_token_ms/values:0.01742414904059964 - timing_per_token_ms/adv:0.00037712182624701255 - timing_per_token_ms/update_actor:0.07308595145254938 - timing_per_token_ms/update_critic:0.0557917337641603 - timing_per_token_ms/gen:0.07945585228199764 - perf/total_num_tokens:93619 - perf/time_per_step:21.233780565671623 - perf/throughput:1102.2413049628174
[36m(TaskRunner pid=2914832)[0m Training Progress:  47%|████▋     | 204/435 [1:15:46<1:25:26, 22.19s/it]
[36m(TaskRunner pid=2914832)[0m step:205 - global_seqlen/min:21877 - global_seqlen/max:23866 - global_seqlen/minmax_diff:1989 - global_seqlen/balanced_min:23174 - global_seqlen/balanced_max:23175 - global_seqlen/mean:23174.5 - actor/entropy:0.08442910760641098 - critic/vf_loss:0.08748560538515449 - critic/vf_clipfrac:0.00034327290995861404 - critic/vpred_mean:0.6632126830518246 - critic/grad_norm:28.495126247406006 - perf/mfu/critic:0.08804995836349871 - critic/lr:1e-05 - actor/pg_loss:-0.25606320425868034 - actor/pg_clipfrac:0.003699301272718003 - actor/ppo_kl:0.000499832993000382 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.11783629655838 - perf/mfu/actor:0.07274473808502356 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.61257553100586 - actor/lr:1e-06 - training/global_step:205 - training/epoch:7 - critic/score/mean:0.70703125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.70703125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:6.2932676847538005e-09 - critic/advantages/max:2.2824079990386963 - critic/advantages/min:-2.826390266418457 - critic/returns/mean:0.6556332111358643 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.4375 - critic/values/max:1.015625 - critic/values/min:-0.185546875 - critic/vf_explained_var:0.3432665467262268 - response_length/mean:259.2734375 - response_length/max:512.0 - response_length/min:89.0 - response_length/clip_ratio:0.02734375 - prompt_length/mean:102.828125 - prompt_length/max:238.0 - prompt_length/min:56.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.143919795751572e-06 - timing_s/generate_sequences:3.4622604846954346 - timing_s/reshard:0.581692636013031 - timing_s/gen:4.6872237850911915 - timing_s/reward:0.03545920783653855 - timing_s/old_log_prob:2.074199505150318 - timing_s/values:1.3413153910078108 - timing_s/adv:0.03586370311677456 - timing_s/update_critic:5.6569705959409475 - timing_s/update_actor:6.841437669005245 - timing_s/step:20.678978613112122 - timing_s/stop_profile:2.054031938314438e-06 - timing_per_token_ms/values:0.014469733877837827 - timing_per_token_ms/adv:0.0003868875608618801 - timing_per_token_ms/update_actor:0.07380350891071269 - timing_per_token_ms/update_critic:0.0610258106533145 - timing_per_token_ms/gen:0.0706183714269321 - perf/total_num_tokens:92698 - perf/time_per_step:20.678978613112122 - perf/throughput:1120.6791415367836
[36m(TaskRunner pid=2914832)[0m Training Progress:  47%|████▋     | 205/435 [1:16:06<1:23:21, 21.74s/it]
[36m(TaskRunner pid=2914832)[0m step:206 - global_seqlen/min:23214 - global_seqlen/max:24733 - global_seqlen/minmax_diff:1519 - global_seqlen/balanced_min:23832 - global_seqlen/balanced_max:23833 - global_seqlen/mean:23832.75 - actor/entropy:0.08889375627040863 - critic/vf_loss:0.13449696428142488 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.962483610957861 - critic/grad_norm:70.07420825958252 - perf/mfu/critic:0.09971080111402329 - critic/lr:1e-05 - actor/pg_loss:-0.13753550872206688 - actor/pg_clipfrac:0.004080555969267152 - actor/ppo_kl:0.0009404563334101113 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.207562506198883 - perf/mfu/actor:0.07518357067414089 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.83932876586914 - actor/lr:1e-06 - training/global_step:206 - training/epoch:7 - critic/score/mean:0.65625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.65625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:4.709742995601118e-08 - critic/advantages/max:2.6740074157714844 - critic/advantages/min:-2.7590184211730957 - critic/returns/mean:0.5793077349662781 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:1.0 - critic/values/max:1.5390625 - critic/values/min:0.306640625 - critic/vf_explained_var:0.36422020196914673 - response_length/mean:268.140625 - response_length/max:512.0 - response_length/min:109.0 - response_length/clip_ratio:0.05859375 - prompt_length/mean:104.24609375 - prompt_length/max:191.0 - prompt_length/min:70.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.544854164123535e-06 - timing_s/generate_sequences:3.526228904724121 - timing_s/reshard:0.9054725766181946 - timing_s/gen:4.884064805228263 - timing_s/reward:0.034558356273919344 - timing_s/old_log_prob:2.0834713550284505 - timing_s/values:1.354798500891775 - timing_s/adv:0.034274931997060776 - timing_s/update_critic:5.145624757278711 - timing_s/update_actor:6.8161950539797544 - timing_s/step:20.360367108136415 - timing_s/stop_profile:9.953044354915619e-06 - timing_per_token_ms/values:0.014211520920705488 - timing_per_token_ms/adv:0.00035953605854402844 - timing_per_token_ms/update_actor:0.07150029952460117 - timing_per_token_ms/update_critic:0.05397640596740526 - timing_per_token_ms/gen:0.07115064397803542 - perf/total_num_tokens:95331 - perf/time_per_step:20.360367108136415 - perf/throughput:1170.546182857182
[36m(TaskRunner pid=2914832)[0m Training Progress:  47%|████▋     | 206/435 [1:16:27<1:21:25, 21.33s/it]
[36m(TaskRunner pid=2914832)[0m step:207 - global_seqlen/min:22510 - global_seqlen/max:24045 - global_seqlen/minmax_diff:1535 - global_seqlen/balanced_min:23585 - global_seqlen/balanced_max:23586 - global_seqlen/mean:23585.25 - actor/entropy:0.07781361788511276 - critic/vf_loss:0.07423958502477035 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.5102973897010088 - critic/grad_norm:26.439860582351685 - perf/mfu/critic:0.09232324584080481 - critic/lr:1e-05 - actor/pg_loss:-0.12125967239262536 - actor/pg_clipfrac:0.00403360795462504 - actor/ppo_kl:0.0005637700614897767 - actor/pg_clipfrac_lower:5.819366924697533e-05 - actor/grad_norm:3.2948861718177795 - perf/mfu/actor:0.07147726738210446 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.73395538330078 - actor/lr:1e-06 - training/global_step:207 - training/epoch:7 - critic/score/mean:0.6640625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.6640625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:1.2036010410554354e-08 - critic/advantages/max:2.439547061920166 - critic/advantages/min:-2.770965337753296 - critic/returns/mean:0.6020134091377258 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.71875 - critic/values/max:1.234375 - critic/values/min:0.0289306640625 - critic/vf_explained_var:0.39348429441452026 - response_length/mean:264.6328125 - response_length/max:512.0 - response_length/min:129.0 - response_length/clip_ratio:0.0390625 - prompt_length/mean:103.88671875 - prompt_length/max:178.0 - prompt_length/min:66.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:6.251037120819092e-06 - timing_s/generate_sequences:3.536565065383911 - timing_s/reshard:0.77811598777771 - timing_s/gen:5.210461235139519 - timing_s/reward:0.034321256913244724 - timing_s/old_log_prob:2.1045015547424555 - timing_s/values:1.6185833448544145 - timing_s/adv:0.033715336583554745 - timing_s/update_critic:5.492578186094761 - timing_s/update_actor:7.092287857085466 - timing_s/step:21.59733323380351 - timing_s/stop_profile:1.8049031496047974e-06 - timing_per_token_ms/values:0.01715673296715547 - timing_per_token_ms/adv:0.0003573773500763692 - timing_per_token_ms/update_actor:0.07517715369866194 - timing_per_token_ms/update_critic:0.05822047875361466 - timing_per_token_ms/gen:0.0769117178156573 - perf/total_num_tokens:94341 - perf/time_per_step:21.59733323380351 - perf/throughput:1092.0445475687277
[36m(TaskRunner pid=2914832)[0m Training Progress:  48%|████▊     | 207/435 [1:16:48<1:21:23, 21.42s/it]
[36m(TaskRunner pid=2914832)[0m step:208 - global_seqlen/min:22427 - global_seqlen/max:23386 - global_seqlen/minmax_diff:959 - global_seqlen/balanced_min:22857 - global_seqlen/balanced_max:22858 - global_seqlen/mean:22857.25 - actor/entropy:0.0785481408238411 - critic/vf_loss:0.06865779071813449 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6162976548075676 - critic/grad_norm:24.644697904586792 - perf/mfu/critic:0.09143262759192097 - critic/lr:1e-05 - actor/pg_loss:-0.1652533859014511 - actor/pg_clipfrac:0.005423676062491722 - actor/ppo_kl:6.102906354499282e-05 - actor/pg_clipfrac_lower:5.792400406789966e-05 - actor/grad_norm:3.151232898235321 - perf/mfu/actor:0.07225842044146293 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.51724243164062 - actor/lr:1e-06 - training/global_step:208 - training/epoch:7 - critic/score/mean:0.7109375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.7109375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-4.474275172583475e-09 - critic/advantages/max:2.581951379776001 - critic/advantages/min:-2.7017483711242676 - critic/returns/mean:0.6433761119842529 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.39453125 - critic/values/max:0.87890625 - critic/values/min:-0.4375 - critic/vf_explained_var:0.3997248411178589 - response_length/mean:256.44140625 - response_length/max:512.0 - response_length/min:119.0 - response_length/clip_ratio:0.03125 - prompt_length/mean:100.703125 - prompt_length/max:182.0 - prompt_length/min:65.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.784204065799713e-06 - timing_s/generate_sequences:3.4455082416534424 - timing_s/reshard:0.5846954584121704 - timing_s/gen:4.734841409139335 - timing_s/reward:0.03383695660158992 - timing_s/old_log_prob:2.082637400832027 - timing_s/values:1.3824585122056305 - timing_s/adv:0.03301182109862566 - timing_s/update_critic:5.369184305891395 - timing_s/update_actor:6.7918215920217335 - timing_s/step:20.43469232879579 - timing_s/stop_profile:2.009328454732895e-06 - timing_per_token_ms/values:0.01512056909958143 - timing_per_token_ms/adv:0.00036106510077355827 - timing_per_token_ms/update_actor:0.0742852004508606 - timing_per_token_ms/update_critic:0.05872517807141492 - timing_per_token_ms/gen:0.07212358770338216 - perf/total_num_tokens:91429 - perf/time_per_step:20.43469232879579 - perf/throughput:1118.551218301948
[36m(TaskRunner pid=2914832)[0m Training Progress:  48%|████▊     | 208/435 [1:17:09<1:19:55, 21.13s/it]
[36m(TaskRunner pid=2914832)[0m step:209 - global_seqlen/min:22505 - global_seqlen/max:24382 - global_seqlen/minmax_diff:1877 - global_seqlen/balanced_min:23278 - global_seqlen/balanced_max:23279 - global_seqlen/mean:23278.5 - actor/entropy:0.08623340725898743 - critic/vf_loss:0.08635296812281013 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6905601173639297 - critic/grad_norm:7.179629027843475 - perf/mfu/critic:0.0933854527301963 - critic/lr:1e-05 - actor/pg_loss:-0.012525902595371008 - actor/pg_clipfrac:0.003900151772540994 - actor/ppo_kl:0.0003651435349070198 - actor/pg_clipfrac_lower:5.615453846985474e-05 - actor/grad_norm:2.9910528659820557 - perf/mfu/actor:0.07289317525986944 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.85550308227539 - actor/lr:1e-06 - training/global_step:209 - training/epoch:7 - critic/score/mean:0.72265625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.72265625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-8.28176971445771e-10 - critic/advantages/max:2.3864662647247314 - critic/advantages/min:-2.5909109115600586 - critic/returns/mean:0.6657383441925049 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.72265625 - critic/values/max:1.1953125 - critic/values/min:-0.12890625 - critic/vf_explained_var:0.21283400058746338 - response_length/mean:260.89453125 - response_length/max:512.0 - response_length/min:127.0 - response_length/clip_ratio:0.0234375 - prompt_length/mean:102.83203125 - prompt_length/max:194.0 - prompt_length/min:66.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.244036972522736e-06 - timing_s/generate_sequences:3.5251078605651855 - timing_s/reshard:0.8640772700309753 - timing_s/gen:4.942739970982075 - timing_s/reward:0.03362056706100702 - timing_s/old_log_prob:2.4455627468414605 - timing_s/values:1.342005476821214 - timing_s/adv:0.03475005505606532 - timing_s/update_critic:5.363136275205761 - timing_s/update_actor:6.860686524305493 - timing_s/step:21.030485971830785 - timing_s/stop_profile:2.2263266146183014e-06 - timing_per_token_ms/values:0.01441249948258279 - timing_per_token_ms/adv:0.000373199036192896 - timing_per_token_ms/update_actor:0.0736805048038479 - timing_per_token_ms/update_critic:0.05759752856934254 - timing_per_token_ms/gen:0.0740052998395256 - perf/total_num_tokens:93114 - perf/time_per_step:21.030485971830785 - perf/throughput:1106.8931089457615
[36m(TaskRunner pid=2914832)[0m Training Progress:  48%|████▊     | 209/435 [1:17:30<1:19:28, 21.10s/it]
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 210}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and bakes muffins for her friends every day with four. She sells the remainder at the farmers' market daily for $2 per fresh duck egg. How much in dollars does she make every day at the farmers' market? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much money Janet makes every day from selling the eggs, we need to follow these steps:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. Calculate the number of eggs Janet lays per day.
[36m(TaskRunner pid=2914832)[0m 2. Subtract the number of eggs she eats in the morning and the number of eggs she bakes.
[36m(TaskRunner pid=2914832)[0m 3. Determine the number of ducks she has and the number of eggs per duck.
[36m(TaskRunner pid=2914832)[0m 4. Calculate the total revenue from selling the eggs.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m First, Janet's ducks lay 16 eggs per day. She eats 3 eggs for breakfast every morning, so the number of eggs she eats in the morning is:
[36m(TaskRunner pid=2914832)[0m \[ 3 \text{ eggs} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m She bakes 4 muffins every day, so the number of eggs she bakes is:
[36m(TaskRunner pid=2914832)[0m \[ 4 \text{ eggs} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m The number of eggs she sells per day is the total number of eggs laid minus the number of eggs eaten in the morning and the number of eggs baked:
[36m(TaskRunner pid=2914832)[0m \[ 16 \text{ eggs} - 3 \text{ eggs} - 4 \text{ eggs} = 7 \text{ eggs} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Each egg sells for $2, so the total revenue per day is:
[36m(TaskRunner pid=2914832)[0m \[ 7 \text{ eggs} \times 2 \text{ dollars per egg} = 14 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Therefore, the total amount of money Janet makes every day is:
[36m(TaskRunner pid=2914832)[0m \[ \boxed{14} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m #### 14
[36m(TaskRunner pid=2914832)[0m #### 14
[36m(TaskRunner pid=2914832)[0m [ground_truth] 18
[36m(TaskRunner pid=2914832)[0m [score] 0.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1312
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 210}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Tom's restaurant gets 6 reservations a night.  They normally order 2 meals that cost $5 each and a $5 bottle of wine.  How much do they make a week if they are open 2 days a week? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much Tom's restaurant makes a week, we need to calculate the daily revenue and then multiply by the number of days the restaurant is open.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m First, let's find out how many meals are ordered per night. They get 6 reservations a night, and each reservation costs $5. Therefore, the total number of meals ordered per night is:
[36m(TaskRunner pid=2914832)[0m \[ 6 \times 5 = 30 \text{ meals} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Next, the normal cost of each meal is $5, so the total cost of the meals ordered per night is:
[36m(TaskRunner pid=2914832)[0m \[ 30 \times 5 = 150 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m They also order a $5 bottle of wine every night. Therefore, the total cost of the wine ordered per night is:
[36m(TaskRunner pid=2914832)[0m \[ 5 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m The total revenue per night is the sum of the revenue from the meals and the revenue from the wine:
[36m(TaskRunner pid=2914832)[0m \[ 150 + 5 = 155 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Since the restaurant is open 2 days a week, the total revenue for the week is:
[36m(TaskRunner pid=2914832)[0m \[ 155 \times 2 = 310 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Thus, the total amount made by the restaurant in a week is:
[36m(TaskRunner pid=2914832)[0m #### 310
[36m(TaskRunner pid=2914832)[0m [ground_truth] 180
[36m(TaskRunner pid=2914832)[0m [score] 0.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1319
[36m(TaskRunner pid=2914832)[0m step:210 - global_seqlen/min:23147 - global_seqlen/max:23698 - global_seqlen/minmax_diff:551 - global_seqlen/balanced_min:23367 - global_seqlen/balanced_max:23368 - global_seqlen/mean:23367.5 - actor/entropy:0.08718616515398026 - critic/vf_loss:0.07260548719204962 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.5873082373291254 - critic/grad_norm:10.8534055352211 - perf/mfu/critic:0.09174445858028657 - critic/lr:1e-05 - actor/pg_loss:-0.10968939727172256 - actor/pg_clipfrac:0.005120946487295441 - actor/ppo_kl:0.0005556760661420412 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.978229582309723 - perf/mfu/actor:0.07035976751250882 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.93600845336914 - actor/lr:1e-06 - val-core/openai/gsm8k/reward/mean@1:0.5291887793783169 - training/global_step:210 - training/epoch:7 - critic/score/mean:0.6796875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.6796875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-9.90119275456891e-09 - critic/advantages/max:2.4392244815826416 - critic/advantages/min:-2.638831853866577 - critic/returns/mean:0.6140537858009338 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.59375 - critic/values/max:1.0234375 - critic/values/min:-0.0849609375 - critic/vf_explained_var:0.40420615673065186 - response_length/mean:260.55078125 - response_length/max:512.0 - response_length/min:126.0 - response_length/clip_ratio:0.01953125 - prompt_length/mean:104.56640625 - prompt_length/max:217.0 - prompt_length/min:65.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.628898411989212e-06 - timing_s/generate_sequences:3.6023688316345215 - timing_s/reshard:0.5804422497749329 - timing_s/gen:4.81550896493718 - timing_s/reward:0.034701168071478605 - timing_s/old_log_prob:2.0750930649228394 - timing_s/values:1.3437106790952384 - timing_s/adv:0.03517415886744857 - timing_s/update_critic:5.474797333125025 - timing_s/update_actor:7.133704439736903 - timing_s/testing:13.831218503881246 - timing_s/step:34.75183276087046 - timing_s/stop_profile:2.4428591132164e-06 - timing_per_token_ms/values:0.014375849781697212 - timing_per_token_ms/adv:0.0003763149552524721 - timing_per_token_ms/update_actor:0.076320792123001 - timing_per_token_ms/update_critic:0.05857277557638842 - timing_per_token_ms/gen:0.0721954538153428 - perf/total_num_tokens:93470 - perf/time_per_step:34.75183276087046 - perf/throughput:672.4105793439222
[36m(TaskRunner pid=2914832)[0m Training Progress:  48%|████▊     | 210/435 [1:18:05<1:34:29, 25.20s/it]
[36m(TaskRunner pid=2914832)[0m step:211 - global_seqlen/min:23192 - global_seqlen/max:24005 - global_seqlen/minmax_diff:813 - global_seqlen/balanced_min:23561 - global_seqlen/balanced_max:23562 - global_seqlen/mean:23561.25 - actor/entropy:0.0830741599202156 - critic/vf_loss:0.05832220200682059 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6195264626294374 - critic/grad_norm:12.210939407348633 - perf/mfu/critic:0.09300643501692243 - critic/lr:1e-05 - actor/pg_loss:-0.0930596909020096 - actor/pg_clipfrac:0.005266945910989307 - actor/ppo_kl:0.00037117096508154646 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.0243945121765137 - perf/mfu/actor:0.07131249415761515 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.91252136230469 - actor/lr:1e-06 - training/global_step:211 - training/epoch:7 - critic/score/mean:0.66796875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.66796875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:1.520299264257119e-08 - critic/advantages/max:2.509387731552124 - critic/advantages/min:-2.5347280502319336 - critic/returns/mean:0.6147743463516235 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.72265625 - critic/values/max:1.171875 - critic/values/min:-0.10986328125 - critic/vf_explained_var:0.35135096311569214 - response_length/mean:264.39453125 - response_length/max:512.0 - response_length/min:129.0 - response_length/clip_ratio:0.0234375 - prompt_length/mean:103.75 - prompt_length/max:189.0 - prompt_length/min:63.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.286202162504196e-06 - timing_s/generate_sequences:3.497985601425171 - timing_s/reshard:0.3022354245185852 - timing_s/gen:4.6248979000374675 - timing_s/reward:0.03556825779378414 - timing_s/old_log_prob:2.093701777048409 - timing_s/values:1.353592722211033 - timing_s/adv:0.03425804805010557 - timing_s/update_critic:5.44576003216207 - timing_s/update_actor:7.097652880009264 - timing_s/step:20.693719144910574 - timing_s/stop_profile:1.7629936337471008e-06 - timing_per_token_ms/values:0.014362488431333578 - timing_per_token_ms/adv:0.0003634998997305488 - timing_per_token_ms/update_actor:0.07531065711718674 - timing_per_token_ms/update_critic:0.05778301270265871 - timing_per_token_ms/gen:0.06832973184660512 - perf/total_num_tokens:94245 - perf/time_per_step:20.693719144910574 - perf/throughput:1138.570105982842
[36m(TaskRunner pid=2914832)[0m Training Progress:  49%|████▊     | 211/435 [1:18:25<1:29:02, 23.85s/it]
[36m(TaskRunner pid=2914832)[0m step:212 - global_seqlen/min:21726 - global_seqlen/max:24215 - global_seqlen/minmax_diff:2489 - global_seqlen/balanced_min:23002 - global_seqlen/balanced_max:23002 - global_seqlen/mean:23002.0 - actor/entropy:0.08859151601791382 - critic/vf_loss:0.1126313948770985 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.551475128158927 - critic/grad_norm:18.168994069099426 - perf/mfu/critic:0.0925639343144831 - critic/lr:1e-05 - actor/pg_loss:0.04222923796623945 - actor/pg_clipfrac:0.00432643384556286 - actor/ppo_kl:-9.267223890674359e-05 - actor/pg_clipfrac_lower:6.062075772206299e-05 - actor/grad_norm:3.42739075422287 - perf/mfu/actor:0.07187066025933878 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.25552749633789 - actor/lr:1e-06 - training/global_step:212 - training/epoch:7 - critic/score/mean:0.65625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.65625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-5.01224795002031e-09 - critic/advantages/max:2.8412437438964844 - critic/advantages/min:-2.9656503200531006 - critic/returns/mean:0.5855726003646851 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.43359375 - critic/values/max:1.1796875 - critic/values/min:-0.58984375 - critic/vf_explained_var:0.33545076847076416 - response_length/mean:257.16015625 - response_length/max:512.0 - response_length/min:123.0 - response_length/clip_ratio:0.03515625 - prompt_length/mean:102.24609375 - prompt_length/max:186.0 - prompt_length/min:69.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.504341632127762e-06 - timing_s/generate_sequences:3.477151393890381 - timing_s/reshard:0.9694181680679321 - timing_s/gen:4.9506009160541 - timing_s/reward:0.03437250712886453 - timing_s/old_log_prob:2.0729225743561983 - timing_s/values:1.3717279727570713 - timing_s/adv:0.03331442782655358 - timing_s/update_critic:5.339317900128663 - timing_s/update_actor:6.872649509925395 - timing_s/step:20.68156849965453 - timing_s/stop_profile:1.9688159227371216e-06 - timing_per_token_ms/values:0.014908790243860003 - timing_per_token_ms/adv:0.00036208186056162054 - timing_per_token_ms/update_actor:0.07469621674121159 - timing_per_token_ms/update_critic:0.05803101795635882 - timing_per_token_ms/gen:0.07519938201288259 - perf/total_num_tokens:92008 - perf/time_per_step:20.68156849965453 - perf/throughput:1112.1980424446158
[36m(TaskRunner pid=2914832)[0m Training Progress:  49%|████▊     | 212/435 [1:18:46<1:25:07, 22.90s/it]
[36m(TaskRunner pid=2914832)[0m step:213 - global_seqlen/min:23195 - global_seqlen/max:23676 - global_seqlen/minmax_diff:481 - global_seqlen/balanced_min:23469 - global_seqlen/balanced_max:23470 - global_seqlen/mean:23469.75 - actor/entropy:0.09613420069217682 - critic/vf_loss:0.08552480704383925 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6912386231124401 - critic/grad_norm:7.724529832601547 - perf/mfu/critic:0.09168643678120915 - critic/lr:1e-05 - actor/pg_loss:-0.1507741785608232 - actor/pg_clipfrac:0.0039314755267696455 - actor/ppo_kl:0.00042215413850499317 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.9051066637039185 - perf/mfu/actor:0.07086870108680787 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.25206756591797 - actor/lr:1e-06 - training/global_step:213 - training/epoch:7 - critic/score/mean:0.67578125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.67578125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:3.703507189811717e-08 - critic/advantages/max:2.912121295928955 - critic/advantages/min:-2.84208607673645 - critic/returns/mean:0.6216276288032532 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.69921875 - critic/values/max:1.2578125 - critic/values/min:-0.26171875 - critic/vf_explained_var:0.3446197509765625 - response_length/mean:262.9375 - response_length/max:512.0 - response_length/min:109.0 - response_length/clip_ratio:0.0234375 - prompt_length/mean:103.77734375 - prompt_length/max:182.0 - prompt_length/min:64.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.832632839679718e-06 - timing_s/generate_sequences:3.5028486251831055 - timing_s/reshard:0.6808114051818848 - timing_s/gen:5.102935721632093 - timing_s/reward:0.0337477452121675 - timing_s/old_log_prob:2.120533498004079 - timing_s/values:1.620853476691991 - timing_s/adv:0.03480312041938305 - timing_s/update_critic:5.5014966311864555 - timing_s/update_actor:7.11375650530681 - timing_s/step:21.535768042318523 - timing_s/stop_profile:2.398621290922165e-06 - timing_per_token_ms/values:0.017265346634412287 - timing_per_token_ms/adv:0.00037072316939233533 - timing_per_token_ms/update_actor:0.07577580188654343 - timing_per_token_ms/update_critic:0.05860199438837712 - timing_per_token_ms/gen:0.07581019315474348 - perf/total_num_tokens:93879 - perf/time_per_step:21.535768042318523 - perf/throughput:1089.803249825181
[36m(TaskRunner pid=2914832)[0m Training Progress:  49%|████▉     | 213/435 [1:19:08<1:23:15, 22.50s/it]
[36m(TaskRunner pid=2914832)[0m step:214 - global_seqlen/min:22409 - global_seqlen/max:24380 - global_seqlen/minmax_diff:1971 - global_seqlen/balanced_min:23806 - global_seqlen/balanced_max:23807 - global_seqlen/mean:23806.75 - actor/entropy:0.11528626829385757 - critic/vf_loss:0.09625748172402382 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.5475654602050781 - critic/grad_norm:10.294189050793648 - perf/mfu/critic:0.0979128543624221 - critic/lr:1e-05 - actor/pg_loss:0.09324444056983339 - actor/pg_clipfrac:0.0040132305439328775 - actor/ppo_kl:-9.873010912997415e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.2161174416542053 - perf/mfu/actor:0.07434223707879277 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.66867446899414 - actor/lr:1e-06 - training/global_step:214 - training/epoch:7 - critic/score/mean:0.6484375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.6484375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:3.6296423644444076e-08 - critic/advantages/max:2.127875804901123 - critic/advantages/min:-1.9339247941970825 - critic/returns/mean:0.5929915308952332 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.51171875 - critic/values/max:0.78125 - critic/values/min:-0.134765625 - critic/vf_explained_var:0.2437569499015808 - response_length/mean:267.98046875 - response_length/max:512.0 - response_length/min:116.0 - response_length/clip_ratio:0.03125 - prompt_length/mean:104.0 - prompt_length/max:201.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.358830094337463e-06 - timing_s/generate_sequences:3.668344020843506 - timing_s/reshard:0.5833971500396729 - timing_s/gen:4.96282111806795 - timing_s/reward:0.03457720763981342 - timing_s/old_log_prob:2.0806933492422104 - timing_s/values:1.427077456843108 - timing_s/adv:0.0361230387352407 - timing_s/update_critic:5.22917455714196 - timing_s/update_actor:6.886980657000095 - timing_s/step:20.66543057607487 - timing_s/stop_profile:3.0780211091041565e-06 - timing_per_token_ms/values:0.014986059172746258 - timing_per_token_ms/adv:0.00037933609937560456 - timing_per_token_ms/update_actor:0.07232172237915817 - timing_per_token_ms/update_critic:0.0549127301830569 - timing_per_token_ms/gen:0.07234116755926052 - perf/total_num_tokens:95227 - perf/time_per_step:20.66543057607487 - perf/throughput:1152.0084187145828
[36m(TaskRunner pid=2914832)[0m Training Progress:  49%|████▉     | 214/435 [1:19:28<1:20:52, 21.96s/it]
[36m(TaskRunner pid=2914832)[0m step:215 - global_seqlen/min:22479 - global_seqlen/max:24510 - global_seqlen/minmax_diff:2031 - global_seqlen/balanced_min:23402 - global_seqlen/balanced_max:23403 - global_seqlen/mean:23402.5 - actor/entropy:0.10390567779541016 - critic/vf_loss:0.08022859977791086 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.8227831125259399 - critic/grad_norm:24.698766827583313 - perf/mfu/critic:0.08806242751607825 - critic/lr:1e-05 - actor/pg_loss:-0.051462364790495485 - actor/pg_clipfrac:0.004927063520881347 - actor/ppo_kl:0.000577752580284141 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.091084361076355 - perf/mfu/actor:0.07232307744977567 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.11186599731445 - actor/lr:1e-06 - training/global_step:215 - training/epoch:7 - critic/score/mean:0.7265625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.7265625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-3.465042919259531e-09 - critic/advantages/max:2.12567138671875 - critic/advantages/min:-2.4777064323425293 - critic/returns/mean:0.6708055138587952 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.6796875 - critic/values/max:1.0703125 - critic/values/min:0.1220703125 - critic/vf_explained_var:0.32126981019973755 - response_length/mean:260.17578125 - response_length/max:512.0 - response_length/min:77.0 - response_length/clip_ratio:0.04296875 - prompt_length/mean:105.48828125 - prompt_length/max:215.0 - prompt_length/min:67.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.160924047231674e-06 - timing_s/generate_sequences:3.58992338180542 - timing_s/reshard:0.7827662229537964 - timing_s/gen:5.218168416060507 - timing_s/reward:0.03397960774600506 - timing_s/old_log_prob:2.1172730727121234 - timing_s/values:1.6224828278645873 - timing_s/adv:0.03427651897072792 - timing_s/update_critic:5.712520157918334 - timing_s/update_actor:6.954733269289136 - timing_s/step:21.702195317018777 - timing_s/stop_profile:1.9730068743228912e-06 - timing_per_token_ms/values:0.01733236649785907 - timing_per_token_ms/adv:0.00036616300577639057 - timing_per_token_ms/update_actor:0.07429476839321798 - timing_per_token_ms/update_critic:0.061024678537745264 - timing_per_token_ms/gen:0.07834499536161711 - perf/total_num_tokens:93610 - perf/time_per_step:21.702195317018777 - perf/throughput:1078.3471283961696
[36m(TaskRunner pid=2914832)[0m Training Progress:  49%|████▉     | 215/435 [1:19:50<1:20:14, 21.89s/it]
[36m(TaskRunner pid=2914832)[0m step:216 - global_seqlen/min:23021 - global_seqlen/max:23813 - global_seqlen/minmax_diff:792 - global_seqlen/balanced_min:23474 - global_seqlen/balanced_max:23474 - global_seqlen/mean:23474.0 - actor/entropy:0.08491940796375275 - critic/vf_loss:0.15281678782775998 - critic/vf_clipfrac:0.009207366034388542 - critic/vpred_mean:0.4352750270627439 - critic/grad_norm:49.24334478378296 - perf/mfu/critic:0.09789701991076317 - critic/lr:1e-05 - actor/pg_loss:-0.06809036992490292 - actor/pg_clipfrac:0.0038866008835611865 - actor/ppo_kl:0.00016688901916950272 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.0516330003738403 - perf/mfu/actor:0.07327223584171418 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.2401123046875 - actor/lr:1e-06 - training/global_step:216 - training/epoch:7 - critic/score/mean:0.6328125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.6328125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-3.170497819837692e-08 - critic/advantages/max:2.183318853378296 - critic/advantages/min:-2.6120591163635254 - critic/returns/mean:0.5662043690681458 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.73828125 - critic/values/max:1.3125 - critic/values/min:0.10546875 - critic/vf_explained_var:0.29460299015045166 - response_length/mean:259.671875 - response_length/max:512.0 - response_length/min:54.0 - response_length/clip_ratio:0.02734375 - prompt_length/mean:107.109375 - prompt_length/max:256.0 - prompt_length/min:69.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.81773167848587e-06 - timing_s/generate_sequences:3.5018985271453857 - timing_s/reshard:0.8709052801132202 - timing_s/gen:4.888525776099414 - timing_s/reward:0.03470646636560559 - timing_s/old_log_prob:2.077866544947028 - timing_s/values:1.3491724589839578 - timing_s/adv:0.03654509596526623 - timing_s/update_critic:5.156773270107806 - timing_s/update_actor:6.886431585997343 - timing_s/step:20.437597362324595 - timing_s/stop_profile:2.1192245185375214e-06 - timing_per_token_ms/values:0.014368795891027922 - timing_per_token_ms/adv:0.00038920823001263344 - timing_per_token_ms/update_actor:0.07334105378288046 - timing_per_token_ms/update_critic:0.0549200527190488 - timing_per_token_ms/gen:0.07353820591039494 - perf/total_num_tokens:93896 - perf/time_per_step:20.437597362324595 - perf/throughput:1148.569451870738
[36m(TaskRunner pid=2914832)[0m Training Progress:  50%|████▉     | 216/435 [1:20:11<1:18:18, 21.45s/it]
[36m(TaskRunner pid=2914832)[0m step:217 - global_seqlen/min:20932 - global_seqlen/max:23599 - global_seqlen/minmax_diff:2667 - global_seqlen/balanced_min:22478 - global_seqlen/balanced_max:22479 - global_seqlen/mean:22478.5 - actor/entropy:0.08836933970451355 - critic/vf_loss:0.13380621746182442 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.33173399046063423 - critic/grad_norm:61.64038276672363 - perf/mfu/critic:0.08300452041114471 - critic/lr:1e-05 - actor/pg_loss:0.08421284984797239 - actor/pg_clipfrac:0.004944239102769643 - actor/ppo_kl:0.000735585658162563 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.1868999004364014 - perf/mfu/actor:0.0703890957676834 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.12630844116211 - actor/lr:1e-06 - training/global_step:217 - training/epoch:7 - critic/score/mean:0.69921875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.69921875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-2.448800628940262e-08 - critic/advantages/max:1.9634085893630981 - critic/advantages/min:-2.7133703231811523 - critic/returns/mean:0.6455060243606567 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.1767578125 - critic/values/max:0.83203125 - critic/values/min:-0.3828125 - critic/vf_explained_var:0.24395066499710083 - response_length/mean:249.640625 - response_length/max:512.0 - response_length/min:111.0 - response_length/clip_ratio:0.01171875 - prompt_length/mean:101.5859375 - prompt_length/max:175.0 - prompt_length/min:67.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.2121467888355255e-06 - timing_s/generate_sequences:3.368846893310547 - timing_s/reshard:0.7728080749511719 - timing_s/gen:5.015753943938762 - timing_s/reward:0.03294236632063985 - timing_s/old_log_prob:2.195808898191899 - timing_s/values:1.7399765909649432 - timing_s/adv:0.034174437168985605 - timing_s/update_critic:5.813128273934126 - timing_s/update_actor:6.852715678978711 - timing_s/step:21.692395200952888 - timing_s/stop_profile:2.307351678609848e-06 - timing_per_token_ms/values:0.01935156472812847 - timing_per_token_ms/adv:0.0003800791552926753 - timing_per_token_ms/update_actor:0.07621411214025303 - timing_per_token_ms/update_critic:0.0646520928212973 - timing_per_token_ms/gen:0.07848397608967206 - perf/total_num_tokens:89914 - perf/time_per_step:21.692395200952888 - perf/throughput:1036.238727524777
[36m(TaskRunner pid=2914832)[0m Training Progress:  50%|████▉     | 217/435 [1:20:32<1:18:13, 21.53s/it]
[36m(TaskRunner pid=2914832)[0m step:218 - global_seqlen/min:22166 - global_seqlen/max:25136 - global_seqlen/minmax_diff:2970 - global_seqlen/balanced_min:23695 - global_seqlen/balanced_max:23696 - global_seqlen/mean:23695.25 - actor/entropy:0.08930230140686035 - critic/vf_loss:0.1293479087180458 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.8404463827610016 - critic/grad_norm:36.910037994384766 - perf/mfu/critic:0.0986345430399407 - critic/lr:1e-05 - actor/pg_loss:0.019893688149750233 - actor/pg_clipfrac:0.003643643343821168 - actor/ppo_kl:1.448254960223494e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.0726094841957092 - perf/mfu/actor:0.07375241332471001 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.24625778198242 - actor/lr:1e-06 - training/global_step:218 - training/epoch:7 - critic/score/mean:0.6953125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.6953125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:3.116128155511433e-08 - critic/advantages/max:2.0342581272125244 - critic/advantages/min:-2.952181577682495 - critic/returns/mean:0.646120548248291 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.73828125 - critic/values/max:1.453125 - critic/values/min:0.1474609375 - critic/vf_explained_var:0.1918468475341797 - response_length/mean:265.21875 - response_length/max:512.0 - response_length/min:84.0 - response_length/clip_ratio:0.03125 - prompt_length/mean:105.01953125 - prompt_length/max:199.0 - prompt_length/min:69.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.326924681663513e-06 - timing_s/generate_sequences:3.5026910305023193 - timing_s/reshard:0.9628406167030334 - timing_s/gen:5.031464560423046 - timing_s/reward:0.03405596176162362 - timing_s/old_log_prob:2.0738441813737154 - timing_s/values:1.3457383182831109 - timing_s/adv:0.034403230994939804 - timing_s/update_critic:5.165143324062228 - timing_s/update_actor:6.90367853268981 - timing_s/step:20.595460421871394 - timing_s/stop_profile:1.953914761543274e-06 - timing_per_token_ms/values:0.014198397551018779 - timing_per_token_ms/adv:0.0003629760288975618 - timing_per_token_ms/update_actor:0.0728382115897681 - timing_per_token_ms/update_critic:0.054495556325236366 - timing_per_token_ms/gen:0.07410546365651947 - perf/total_num_tokens:94781 - perf/time_per_step:20.595460421871394 - perf/throughput:1150.5083894525017
[36m(TaskRunner pid=2914832)[0m Training Progress:  50%|█████     | 218/435 [1:20:53<1:16:51, 21.25s/it]
[36m(TaskRunner pid=2914832)[0m step:219 - global_seqlen/min:22227 - global_seqlen/max:24145 - global_seqlen/minmax_diff:1918 - global_seqlen/balanced_min:23179 - global_seqlen/balanced_max:23180 - global_seqlen/mean:23179.75 - actor/entropy:0.09816297143697739 - critic/vf_loss:0.13122617558110505 - critic/vf_clipfrac:0.024363686330616474 - critic/vpred_mean:0.5086651900783181 - critic/grad_norm:43.2068612575531 - perf/mfu/critic:0.0967837223753169 - critic/lr:1e-05 - actor/pg_loss:-0.09961829660460353 - actor/pg_clipfrac:0.00500709522748366 - actor/ppo_kl:0.00035092303733108565 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.1296194195747375 - perf/mfu/actor:0.07195334378462878 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.01852035522461 - actor/lr:1e-06 - training/global_step:219 - training/epoch:7 - critic/score/mean:0.67578125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.67578125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:2.569306012389916e-08 - critic/advantages/max:2.0994656085968018 - critic/advantages/min:-3.042147636413574 - critic/returns/mean:0.6340534687042236 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.78125 - critic/values/max:1.5078125 - critic/values/min:0.1806640625 - critic/vf_explained_var:0.22411233186721802 - response_length/mean:260.55078125 - response_length/max:512.0 - response_length/min:113.0 - response_length/clip_ratio:0.01953125 - prompt_length/mean:101.6328125 - prompt_length/max:206.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.6740675568580627e-06 - timing_s/generate_sequences:3.4827022552490234 - timing_s/reshard:0.6783512830734253 - timing_s/gen:4.672106210142374 - timing_s/reward:0.03405133495107293 - timing_s/old_log_prob:2.4316363148391247 - timing_s/values:1.7412073672749102 - timing_s/adv:0.03620903193950653 - timing_s/update_critic:5.146294882055372 - timing_s/update_actor:6.918517075013369 - timing_s/step:20.986601162236184 - timing_s/stop_profile:1.9222497940063477e-06 - timing_per_token_ms/values:0.01877940192705821 - timing_per_token_ms/adv:0.0003905244010343784 - timing_per_token_ms/update_actor:0.07461811575851086 - timing_per_token_ms/update_critic:0.055504210378189714 - timing_per_token_ms/gen:0.07004551970948522 - perf/total_num_tokens:92719 - perf/time_per_step:20.986601162236184 - perf/throughput:1104.5023356002125
[36m(TaskRunner pid=2914832)[0m Training Progress:  50%|█████     | 219/435 [1:21:14<1:16:13, 21.17s/it]
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 220}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and bakes muffins for her friends every day with four. She sells the remainder at the farmers' market daily for $2 per fresh duck egg. How much in dollars does she make every day at the farmers' market? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much money Janet makes every day from selling the eggs, we need to follow these steps:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. Calculate the number of eggs Janet lays per day.
[36m(TaskRunner pid=2914832)[0m 2. Subtract the number of eggs she eats in the morning and the number of eggs she bakes.
[36m(TaskRunner pid=2914832)[0m 3. Determine how many ducks she has and then calculate the revenue from selling the eggs.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m First, Janet's ducks lay 16 eggs per day. She eats 3 eggs for breakfast every morning and bakes 4 muffins every day. Therefore, the number of eggs she eats in a day is:
[36m(TaskRunner pid=2914832)[0m \[ 3 + 4 = 7 \text{ eggs} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m The number of eggs she sells per day is the total number of eggs laid minus the number of eggs eaten:
[36m(TaskRunner pid=2914832)[0m \[ 16 - 7 = 9 \text{ eggs} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Each egg sells for $2. Therefore, the total revenue per day is:
[36m(TaskRunner pid=2914832)[0m \[ 9 \times 2 = 18 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Thus, the final answer is:
[36m(TaskRunner pid=2914832)[0m #### 18
[36m(TaskRunner pid=2914832)[0m [ground_truth] 18
[36m(TaskRunner pid=2914832)[0m [score] 1.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1312
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 220}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Tom's restaurant gets 6 reservations a night.  They normally order 2 meals that cost $5 each and a $5 bottle of wine.  How much do they make a week if they are open 2 days a week? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much Tom's restaurant makes a week, we need to follow these steps:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. Calculate the number of reservations per night and the revenue from reservations.
[36m(TaskRunner pid=2914832)[0m 2. Calculate the revenue from meals and the revenue from the wine.
[36m(TaskRunner pid=2914832)[0m 3. Add the revenues together to get the total revenue for the week.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m First, Tom's restaurant gets 6 reservations a night. Since they are open 2 days a week, the number of reservations per week is:
[36m(TaskRunner pid=2914832)[0m \[ 6 \times 2 = 12 \text{ reservations per week} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Next, the normal order amount is 2 meals per reservation, and each meal costs $5. Therefore, the revenue from the meals per week is:
[36m(TaskRunner pid=2914832)[0m \[ 12 \times 2 \times 5 = 120 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m The normal cost of the wine per reservation is $5. Therefore, the revenue from the wine per week is:
[36m(TaskRunner pid=2914832)[0m \[ 12 \times 5 = 60 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m The total revenue per week is the sum of the revenue from the meals and the revenue from the wine:
[36m(TaskRunner pid=2914832)[0m \[ 120 + 60 = 180 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Thus, the total revenue for the week is:
[36m(TaskRunner pid=2914832)[0m \[ \boxed{180} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m #### 180
[36m(TaskRunner pid=2914832)[0m #### 300
[36m(TaskRunner pid=2914832)[0m [ground_truth] 180
[36m(TaskRunner pid=2914832)[0m [score] 1.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1319
[36m(TaskRunner pid=2914832)[0m step:220 - global_seqlen/min:22925 - global_seqlen/max:24081 - global_seqlen/minmax_diff:1156 - global_seqlen/balanced_min:23457 - global_seqlen/balanced_max:23458 - global_seqlen/mean:23457.75 - actor/entropy:0.09129838645458221 - critic/vf_loss:0.12569211283698678 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.3609501672908664 - critic/grad_norm:41.83624267578125 - perf/mfu/critic:0.0923719555953675 - critic/lr:1e-05 - actor/pg_loss:0.0683430798817426 - actor/pg_clipfrac:0.004687078238930553 - actor/ppo_kl:4.4293919927440584e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.101531207561493 - perf/mfu/actor:0.07348061205020479 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.83502960205078 - actor/lr:1e-06 - val-core/openai/gsm8k/reward/mean@1:0.5238817285822593 - training/global_step:220 - training/epoch:7 - critic/score/mean:0.6484375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.6484375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:4.8453049572572127e-08 - critic/advantages/max:2.0764682292938232 - critic/advantages/min:-2.6123697757720947 - critic/returns/mean:0.5861309766769409 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.21875 - critic/values/max:0.90625 - critic/values/min:-0.322265625 - critic/vf_explained_var:0.24562311172485352 - response_length/mean:260.75390625 - response_length/max:512.0 - response_length/min:85.0 - response_length/clip_ratio:0.03125 - prompt_length/mean:105.7734375 - prompt_length/max:189.0 - prompt_length/min:62.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.151160389184952e-06 - timing_s/generate_sequences:3.573455810546875 - timing_s/reshard:0.5828372836112976 - timing_s/gen:4.715280103031546 - timing_s/reward:0.033377932384610176 - timing_s/old_log_prob:2.1024873722344637 - timing_s/values:1.3499034941196442 - timing_s/adv:0.03880638303235173 - timing_s/update_critic:5.463592739775777 - timing_s/update_actor:6.860767673701048 - timing_s/testing:13.542627049144357 - timing_s/step:34.11508992500603 - timing_s/stop_profile:2.141576260328293e-06 - timing_per_token_ms/values:0.014386540632836101 - timing_per_token_ms/adv:0.0004135774214529498 - timing_per_token_ms/update_actor:0.07311834760048436 - timing_per_token_ms/update_critic:0.05822801355389772 - timing_per_token_ms/gen:0.07063772569070373 - perf/total_num_tokens:93831 - perf/time_per_step:34.11508992500603 - perf/throughput:687.6062777957297
[36m(TaskRunner pid=2914832)[0m Training Progress:  51%|█████     | 220/435 [1:21:48<1:29:48, 25.06s/it]
[36m(TaskRunner pid=2914832)[0m step:221 - global_seqlen/min:23139 - global_seqlen/max:24841 - global_seqlen/minmax_diff:1702 - global_seqlen/balanced_min:23924 - global_seqlen/balanced_max:23925 - global_seqlen/mean:23924.25 - actor/entropy:0.08344696462154388 - critic/vf_loss:0.10770437156315893 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.9350819103419781 - critic/grad_norm:46.56371307373047 - perf/mfu/critic:0.08970638445428623 - critic/lr:1e-05 - actor/pg_loss:-0.10172484396025538 - actor/pg_clipfrac:0.0049322572886012495 - actor/ppo_kl:0.0005641464005066155 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.3069831132888794 - perf/mfu/actor:0.07398825989006715 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.06827545166016 - actor/lr:1e-06 - training/global_step:221 - training/epoch:7 - critic/score/mean:0.7109375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.7109375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:1.1075391992410033e-10 - critic/advantages/max:2.2068095207214355 - critic/advantages/min:-3.176668882369995 - critic/returns/mean:0.6430479288101196 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.7890625 - critic/values/max:1.4765625 - critic/values/min:0.140625 - critic/vf_explained_var:0.2985996603965759 - response_length/mean:269.0859375 - response_length/max:512.0 - response_length/min:111.0 - response_length/clip_ratio:0.02734375 - prompt_length/mean:104.73046875 - prompt_length/max:178.0 - prompt_length/min:70.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.8640725910663605e-06 - timing_s/generate_sequences:3.4951186180114746 - timing_s/reshard:0.3016231060028076 - timing_s/gen:4.471864617895335 - timing_s/reward:0.03372948570176959 - timing_s/old_log_prob:2.1289489162154496 - timing_s/values:1.6122238831594586 - timing_s/adv:0.034722024109214544 - timing_s/update_critic:5.735725714825094 - timing_s/update_actor:6.950076399836689 - timing_s/step:20.975654834881425 - timing_s/stop_profile:1.7327256500720978e-06 - timing_per_token_ms/values:0.016847172671655943 - timing_per_token_ms/adv:0.00036283294261277304 - timing_per_token_ms/update_actor:0.07262585451828886 - timing_per_token_ms/update_critic:0.059936316862859794 - timing_per_token_ms/gen:0.06491688612918932 - perf/total_num_tokens:95697 - perf/time_per_step:20.975654834881425 - perf/throughput:1140.5722580929971
[36m(TaskRunner pid=2914832)[0m Training Progress:  51%|█████     | 221/435 [1:22:09<1:25:02, 23.84s/it]
[36m(TaskRunner pid=2914832)[0m step:222 - global_seqlen/min:22332 - global_seqlen/max:24428 - global_seqlen/minmax_diff:2096 - global_seqlen/balanced_min:23370 - global_seqlen/balanced_max:23370 - global_seqlen/mean:23370.0 - actor/entropy:0.09785677492618561 - critic/vf_loss:0.08899823669344187 - critic/vf_clipfrac:0.023313962388783693 - critic/vpred_mean:0.6477848291397095 - critic/grad_norm:32.342379331588745 - perf/mfu/critic:0.09729564605531388 - critic/lr:1e-05 - actor/pg_loss:0.04167486680671573 - actor/pg_clipfrac:0.004377204808406532 - actor/ppo_kl:0.0005479012652358506 - actor/pg_clipfrac_lower:4.4452346628531814e-05 - actor/grad_norm:3.2287928462028503 - perf/mfu/actor:0.07352236335453927 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.30325317382812 - actor/lr:1e-06 - training/global_step:222 - training/epoch:7 - critic/score/mean:0.703125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.703125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:1.8196413265059164e-08 - critic/advantages/max:2.1733250617980957 - critic/advantages/min:-2.707988977432251 - critic/returns/mean:0.6368318796157837 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.86328125 - critic/values/max:1.515625 - critic/values/min:0.25390625 - critic/vf_explained_var:0.352735698223114 - response_length/mean:261.640625 - response_length/max:512.0 - response_length/min:111.0 - response_length/clip_ratio:0.02734375 - prompt_length/mean:103.515625 - prompt_length/max:188.0 - prompt_length/min:70.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.872214049100876e-06 - timing_s/generate_sequences:3.558366060256958 - timing_s/reshard:0.96318119764328 - timing_s/gen:5.086827310267836 - timing_s/reward:0.03368774522095919 - timing_s/old_log_prob:2.085785625036806 - timing_s/values:1.3516465588472784 - timing_s/adv:0.03453208599239588 - timing_s/update_critic:5.164775530807674 - timing_s/update_actor:6.831419097259641 - timing_s/step:20.59638816770166 - timing_s/stop_profile:1.744832843542099e-06 - timing_per_token_ms/values:0.014459205807095404 - timing_per_token_ms/adv:0.0003694061402695323 - timing_per_token_ms/update_actor:0.07307893771137827 - timing_per_token_ms/update_critic:0.05525005916567901 - timing_per_token_ms/gen:0.0759454659639868 - perf/total_num_tokens:93480 - perf/time_per_step:20.59638816770166 - perf/throughput:1134.664962114464
[36m(TaskRunner pid=2914832)[0m Training Progress:  51%|█████     | 222/435 [1:22:30<1:21:11, 22.87s/it]
[36m(TaskRunner pid=2914832)[0m step:223 - global_seqlen/min:22488 - global_seqlen/max:24216 - global_seqlen/minmax_diff:1728 - global_seqlen/balanced_min:23579 - global_seqlen/balanced_max:23580 - global_seqlen/mean:23579.75 - actor/entropy:0.08270420879125595 - critic/vf_loss:0.12331174139399081 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.4622162962332368 - critic/grad_norm:32.36445951461792 - perf/mfu/critic:0.09376829819899168 - critic/lr:1e-05 - actor/pg_loss:-0.21650076378136873 - actor/pg_clipfrac:0.004399428013130091 - actor/ppo_kl:-0.0002867773473553825 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.078640937805176 - perf/mfu/actor:0.07045465694713515 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.95507049560547 - actor/lr:1e-06 - training/global_step:223 - training/epoch:7 - critic/score/mean:0.66015625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.66015625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:8.277834240288939e-08 - critic/advantages/max:2.1603853702545166 - critic/advantages/min:-2.824772834777832 - critic/returns/mean:0.6132687330245972 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.341796875 - critic/values/max:1.046875 - critic/values/min:-0.302734375 - critic/vf_explained_var:0.2817322611808777 - response_length/mean:263.71875 - response_length/max:512.0 - response_length/min:125.0 - response_length/clip_ratio:0.0234375 - prompt_length/mean:104.71484375 - prompt_length/max:190.0 - prompt_length/min:67.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.9800222516059875e-06 - timing_s/generate_sequences:3.4749248027801514 - timing_s/reshard:0.6808710098266602 - timing_s/gen:5.112876482307911 - timing_s/reward:0.03383584273979068 - timing_s/old_log_prob:2.136847690679133 - timing_s/values:1.6106418431736529 - timing_s/adv:0.03575435886159539 - timing_s/update_critic:5.405594553332776 - timing_s/update_actor:7.18943279935047 - timing_s/step:21.53182935155928 - timing_s/stop_profile:1.7122365534305573e-06 - timing_per_token_ms/values:0.01707653646851274 - timing_per_token_ms/adv:0.0003790790706177482 - timing_per_token_ms/update_actor:0.07622465038168842 - timing_per_token_ms/update_critic:0.05731183063150347 - timing_per_token_ms/gen:0.07573285463781122 - perf/total_num_tokens:94319 - perf/time_per_step:21.53182935155928 - perf/throughput:1095.111317064772
[36m(TaskRunner pid=2914832)[0m Training Progress:  51%|█████▏    | 223/435 [1:22:51<1:19:24, 22.48s/it]
[36m(TaskRunner pid=2914832)[0m step:224 - global_seqlen/min:22675 - global_seqlen/max:24079 - global_seqlen/minmax_diff:1404 - global_seqlen/balanced_min:23324 - global_seqlen/balanced_max:23324 - global_seqlen/mean:23324.0 - actor/entropy:0.07567752152681351 - critic/vf_loss:0.058260693098418415 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.7639957685023546 - critic/grad_norm:19.16150140762329 - perf/mfu/critic:0.09581009533803536 - critic/lr:1e-05 - actor/pg_loss:-0.17018818625365384 - actor/pg_clipfrac:0.004685842031904031 - actor/ppo_kl:0.0001303237619652009 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.2963351011276245 - perf/mfu/actor:0.07393946223452831 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.71374130249023 - actor/lr:1e-06 - training/global_step:224 - training/epoch:7 - critic/score/mean:0.7109375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.7109375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:7.936124646334974e-09 - critic/advantages/max:2.5081846714019775 - critic/advantages/min:-2.767721176147461 - critic/returns/mean:0.6456061005592346 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.78515625 - critic/values/max:1.3828125 - critic/values/min:0.07958984375 - critic/vf_explained_var:0.23689883947372437 - response_length/mean:261.4609375 - response_length/max:512.0 - response_length/min:102.0 - response_length/clip_ratio:0.03125 - prompt_length/mean:102.9765625 - prompt_length/max:177.0 - prompt_length/min:65.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.040077328681946e-06 - timing_s/generate_sequences:3.5367751121520996 - timing_s/reshard:0.579835057258606 - timing_s/gen:4.748698692768812 - timing_s/reward:0.03540877718478441 - timing_s/old_log_prob:2.079420297872275 - timing_s/values:1.4205511049367487 - timing_s/adv:0.03443344822153449 - timing_s/update_critic:5.232183263171464 - timing_s/update_actor:6.775690000038594 - timing_s/step:20.333625908009708 - timing_s/stop_profile:1.3923272490501404e-06 - timing_per_token_ms/values:0.015226280922405556 - timing_per_token_ms/adv:0.00036907743334692257 - timing_per_token_ms/update_actor:0.07262572886338743 - timing_per_token_ms/update_critic:0.05608153900672552 - timing_per_token_ms/gen:0.07094598698372744 - perf/total_num_tokens:93296 - perf/time_per_step:20.333625908009708 - perf/throughput:1147.0654621816536
[36m(TaskRunner pid=2914832)[0m Training Progress:  51%|█████▏    | 224/435 [1:23:11<1:16:47, 21.84s/it]
[36m(TaskRunner pid=2914832)[0m step:225 - global_seqlen/min:22115 - global_seqlen/max:22865 - global_seqlen/minmax_diff:750 - global_seqlen/balanced_min:22384 - global_seqlen/balanced_max:22385 - global_seqlen/mean:22384.25 - actor/entropy:0.07306841760873795 - critic/vf_loss:0.10103123018052429 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6910848133265972 - critic/grad_norm:15.843842595815659 - perf/mfu/critic:0.0909190421337341 - critic/lr:1e-05 - actor/pg_loss:-0.06401446624659002 - actor/pg_clipfrac:0.0045756773761240765 - actor/ppo_kl:0.0006829425783507759 - actor/pg_clipfrac_lower:4.9800797569332644e-05 - actor/grad_norm:3.548915147781372 - perf/mfu/actor:0.07061334764962694 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.94157028198242 - actor/lr:1e-06 - training/global_step:225 - training/epoch:7 - critic/score/mean:0.68359375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.68359375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-4.46537473663966e-09 - critic/advantages/max:2.2051591873168945 - critic/advantages/min:-2.7179114818573 - critic/returns/mean:0.6361896395683289 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.5546875 - critic/values/max:1.15625 - critic/values/min:-0.2109375 - critic/vf_explained_var:0.28802603483200073 - response_length/mean:246.94140625 - response_length/max:512.0 - response_length/min:117.0 - response_length/clip_ratio:0.0078125 - prompt_length/mean:102.8125 - prompt_length/max:183.0 - prompt_length/min:64.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.40794974565506e-06 - timing_s/generate_sequences:3.394629716873169 - timing_s/reshard:0.8703410029411316 - timing_s/gen:4.945925481151789 - timing_s/reward:0.03263072110712528 - timing_s/old_log_prob:2.0767919407226145 - timing_s/values:1.3407747619785368 - timing_s/adv:0.03345361817628145 - timing_s/update_critic:5.285256410948932 - timing_s/update_actor:6.802044180687517 - timing_s/step:20.52389964601025 - timing_s/stop_profile:1.7932616174221039e-06 - timing_per_token_ms/values:0.014974533008460602 - timing_per_token_ms/adv:0.0003736289821669416 - timing_per_token_ms/update_actor:0.07596908742405394 - timing_per_token_ms/update_critic:0.05902874131307652 - timing_per_token_ms/gen:0.07823726973997168 - perf/total_num_tokens:89537 - perf/time_per_step:20.52389964601025 - perf/throughput:1090.643122704578
[36m(TaskRunner pid=2914832)[0m Training Progress:  52%|█████▏    | 225/435 [1:23:32<1:15:03, 21.44s/it]
[36m(TaskRunner pid=2914832)[0m step:226 - global_seqlen/min:22449 - global_seqlen/max:24417 - global_seqlen/minmax_diff:1968 - global_seqlen/balanced_min:23176 - global_seqlen/balanced_max:23177 - global_seqlen/mean:23176.5 - actor/entropy:0.08014019578695297 - critic/vf_loss:0.10782040579942986 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.7798751294612885 - critic/grad_norm:29.948567032814026 - perf/mfu/critic:0.09117006991933058 - critic/lr:1e-05 - actor/pg_loss:0.11153156741056591 - actor/pg_clipfrac:0.00415379814512562 - actor/ppo_kl:0.0008333127043727018 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.3635323643684387 - perf/mfu/actor:0.0701477214266276 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.84566116333008 - actor/lr:1e-06 - training/global_step:226 - training/epoch:7 - critic/score/mean:0.65234375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.65234375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:4.1034084574675944e-08 - critic/advantages/max:2.5409936904907227 - critic/advantages/min:-2.737286329269409 - critic/returns/mean:0.5847451090812683 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.875 - critic/values/max:1.390625 - critic/values/min:0.017578125 - critic/vf_explained_var:0.37241244316101074 - response_length/mean:258.01171875 - response_length/max:512.0 - response_length/min:110.0 - response_length/clip_ratio:0.0234375 - prompt_length/mean:104.12109375 - prompt_length/max:182.0 - prompt_length/min:67.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.109926521778107e-06 - timing_s/generate_sequences:3.493187189102173 - timing_s/reshard:0.5824378132820129 - timing_s/gen:4.889751594979316 - timing_s/reward:0.03936729906126857 - timing_s/old_log_prob:2.1295074983499944 - timing_s/values:1.612999823410064 - timing_s/adv:0.03634718107059598 - timing_s/update_critic:5.462334809359163 - timing_s/update_actor:7.0970175811089575 - timing_s/step:21.274233672767878 - timing_s/stop_profile:1.5022233128547668e-06 - timing_per_token_ms/values:0.017399087690225704 - timing_per_token_ms/adv:0.00039206934902375227 - timing_per_token_ms/update_actor:0.07655402650431425 - timing_per_token_ms/update_critic:0.05892104943972518 - timing_per_token_ms/gen:0.0740299404245101 - perf/total_num_tokens:92706 - perf/time_per_step:21.274233672767878 - perf/throughput:1089.4164441592611
[36m(TaskRunner pid=2914832)[0m Training Progress:  52%|█████▏    | 226/435 [1:23:53<1:14:31, 21.40s/it]
[36m(TaskRunner pid=2914832)[0m step:227 - global_seqlen/min:21577 - global_seqlen/max:23394 - global_seqlen/minmax_diff:1817 - global_seqlen/balanced_min:22807 - global_seqlen/balanced_max:22808 - global_seqlen/mean:22807.25 - actor/entropy:0.07257531583309174 - critic/vf_loss:0.09566995070781559 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.5745644476264715 - critic/grad_norm:16.610366821289062 - perf/mfu/critic:0.09321617831511222 - critic/lr:1e-05 - actor/pg_loss:0.2178657897748053 - actor/pg_clipfrac:0.0032926635176409036 - actor/ppo_kl:0.0004226733381074155 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.3294723629951477 - perf/mfu/actor:0.07223188933434484 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.31789779663086 - actor/lr:1e-06 - training/global_step:227 - training/epoch:7 - critic/score/mean:0.67578125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.67578125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.1993034121360324e-08 - critic/advantages/max:2.6876158714294434 - critic/advantages/min:-2.6931140422821045 - critic/returns/mean:0.6206486821174622 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.50390625 - critic/values/max:1.03125 - critic/values/min:-0.431640625 - critic/vf_explained_var:0.3587337136268616 - response_length/mean:253.15625 - response_length/max:512.0 - response_length/min:105.0 - response_length/clip_ratio:0.0234375 - prompt_length/mean:103.20703125 - prompt_length/max:212.0 - prompt_length/min:65.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.877095878124237e-06 - timing_s/generate_sequences:3.5310518741607666 - timing_s/reshard:0.5842103362083435 - timing_s/gen:4.850577795878053 - timing_s/reward:0.0335290040820837 - timing_s/old_log_prob:2.072012026794255 - timing_s/values:1.3522960571572185 - timing_s/adv:0.03568726684898138 - timing_s/update_critic:5.260725162923336 - timing_s/update_actor:6.7788553847931325 - timing_s/step:20.39369808137417 - timing_s/stop_profile:2.535991370677948e-06 - timing_per_token_ms/values:0.01482309416037903 - timing_per_token_ms/adv:0.00039118336109111553 - timing_per_token_ms/update_actor:0.07430592667674898 - timing_per_token_ms/update_critic:0.057665053468999285 - timing_per_token_ms/gen:0.07484535544806278 - perf/total_num_tokens:91229 - perf/time_per_step:20.39369808137417 - perf/throughput:1118.3479283156673
[36m(TaskRunner pid=2914832)[0m Training Progress:  52%|█████▏    | 227/435 [1:24:14<1:13:08, 21.10s/it]
[36m(TaskRunner pid=2914832)[0m step:228 - global_seqlen/min:21982 - global_seqlen/max:23980 - global_seqlen/minmax_diff:1998 - global_seqlen/balanced_min:22982 - global_seqlen/balanced_max:22983 - global_seqlen/mean:22982.25 - actor/entropy:0.075572170317173 - critic/vf_loss:0.09931197538389824 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6731329299509525 - critic/grad_norm:22.955690741539 - perf/mfu/critic:0.09607005027764011 - critic/lr:1e-05 - actor/pg_loss:0.0326465648249723 - actor/pg_clipfrac:0.003610821040638257 - actor/ppo_kl:0.0005216717108851299 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.2116523385047913 - perf/mfu/actor:0.07242996086146232 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.01613998413086 - actor/lr:1e-06 - training/global_step:228 - training/epoch:7 - critic/score/mean:0.65625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.65625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.315908981780467e-08 - critic/advantages/max:2.9450199604034424 - critic/advantages/min:-2.897213935852051 - critic/returns/mean:0.6031330227851868 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.71875 - critic/values/max:1.34375 - critic/values/min:-0.255859375 - critic/vf_explained_var:0.332983136177063 - response_length/mean:256.34375 - response_length/max:512.0 - response_length/min:111.0 - response_length/clip_ratio:0.03125 - prompt_length/mean:102.75390625 - prompt_length/max:189.0 - prompt_length/min:65.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.4298358261585236e-06 - timing_s/generate_sequences:3.4880096912384033 - timing_s/reshard:0.8744097948074341 - timing_s/gen:4.838795218151063 - timing_s/reward:0.035006891936063766 - timing_s/old_log_prob:2.0860986057668924 - timing_s/values:1.3431203770451248 - timing_s/adv:0.0345032662153244 - timing_s/update_critic:5.140707472804934 - timing_s/update_actor:6.8158904779702425 - timing_s/step:20.30543552385643 - timing_s/stop_profile:3.6996789276599884e-06 - timing_per_token_ms/values:0.014610409958175601 - timing_per_token_ms/adv:0.00037532515544957956 - timing_per_token_ms/update_actor:0.07414298510774883 - timing_per_token_ms/update_critic:0.05592041110862659 - timing_per_token_ms/gen:0.07373514595500218 - perf/total_num_tokens:91929 - perf/time_per_step:20.30543552385643 - perf/throughput:1131.8274839758367
[36m(TaskRunner pid=2914832)[0m Training Progress:  52%|█████▏    | 228/435 [1:24:34<1:11:58, 20.86s/it]
[36m(TaskRunner pid=2914832)[0m step:229 - global_seqlen/min:23614 - global_seqlen/max:25007 - global_seqlen/minmax_diff:1393 - global_seqlen/balanced_min:24211 - global_seqlen/balanced_max:24211 - global_seqlen/mean:24211.0 - actor/entropy:0.07175162434577942 - critic/vf_loss:0.09489441383630037 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.4050494395196438 - critic/grad_norm:35.114272356033325 - perf/mfu/critic:0.09623277256862367 - critic/lr:1e-05 - actor/pg_loss:-0.05655485764145851 - actor/pg_clipfrac:0.003455458558164537 - actor/ppo_kl:0.0005633300020235765 - actor/pg_clipfrac_lower:0.00011114691733382642 - actor/grad_norm:3.2196542620658875 - perf/mfu/actor:0.07254553838473057 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.4902458190918 - actor/lr:1e-06 - training/global_step:229 - training/epoch:7 - critic/score/mean:0.6640625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.6640625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-6.983514566627491e-08 - critic/advantages/max:2.782933235168457 - critic/advantages/min:-2.7019402980804443 - critic/returns/mean:0.6097484230995178 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.333984375 - critic/values/max:1.0546875 - critic/values/min:-0.58203125 - critic/vf_explained_var:0.2530175447463989 - response_length/mean:273.76171875 - response_length/max:512.0 - response_length/min:103.0 - response_length/clip_ratio:0.046875 - prompt_length/mean:104.53515625 - prompt_length/max:172.0 - prompt_length/min:63.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:1.2214295566082e-05 - timing_s/generate_sequences:3.534345865249634 - timing_s/reshard:0.6863329410552979 - timing_s/gen:5.110333108808845 - timing_s/reward:0.03365731192752719 - timing_s/old_log_prob:2.133954553399235 - timing_s/values:1.627526059281081 - timing_s/adv:0.03440144658088684 - timing_s/update_critic:5.4116322309710085 - timing_s/update_actor:7.174776297993958 - timing_s/step:21.532990898005664 - timing_s/stop_profile:2.366025000810623e-06 - timing_per_token_ms/values:0.016805646806008438 - timing_per_token_ms/adv:0.00035522537876261657 - timing_per_token_ms/update_actor:0.07408591443965509 - timing_per_token_ms/update_critic:0.05587989169149363 - timing_per_token_ms/gen:0.07291829842913182 - perf/total_num_tokens:96844 - perf/time_per_step:21.532990898005664 - perf/throughput:1124.3677255370208
[36m(TaskRunner pid=2914832)[0m Training Progress:  53%|█████▎    | 229/435 [1:24:56<1:12:20, 21.07s/it]
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 230}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and bakes muffins for her friends every day with four. She sells the remainder at the farmers' market daily for $2 per fresh duck egg. How much in dollars does she make every day at the farmers' market? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much money Janet makes every day from selling the eggs, we need to follow these steps:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. Calculate the number of eggs laid by the ducks per day.
[36m(TaskRunner pid=2914832)[0m 2. Subtract the number of eggs eaten in the morning and the number of muffins baked.
[36m(TaskRunner pid=2914832)[0m 3. Determine the number of eggs sold per day.
[36m(TaskRunner pid=2914832)[0m 4. Calculate the total revenue from selling the eggs.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m First, the ducks lay 16 eggs per day. Janet eats 3 eggs for breakfast every morning, so the number of eggs eaten in the morning is:
[36m(TaskRunner pid=2914832)[0m \[ 3 \times 1 = 3 \text{ eggs} \]
[36m(TaskRunner pid=2914832)[0m Janet bakes 4 muffins every day, so the number of muffins baked is:
[36m(TaskRunner pid=2914832)[0m \[ 4 \text{ muffins} \]
[36m(TaskRunner pid=2914832)[0m Therefore, the number of eggs laid per day is:
[36m(TaskRunner pid=2914832)[0m \[ 16 - 3 - 4 = 19 \text{ eggs} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Next, Janet sells each egg for $2. Therefore, the total revenue from selling the eggs per day is:
[36m(TaskRunner pid=2914832)[0m \[ 19 \times 2 = 38 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Thus, the final answer is:
[36m(TaskRunner pid=2914832)[0m #### 38
[36m(TaskRunner pid=2914832)[0m [ground_truth] 18
[36m(TaskRunner pid=2914832)[0m [score] 0.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1312
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 230}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Tom's restaurant gets 6 reservations a night.  They normally order 2 meals that cost $5 each and a $5 bottle of wine.  How much do they make a week if they are open 2 days a week? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much Tom's restaurant makes a week, we need to follow these steps:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. Calculate the number of reservations per night and the revenue from reservations.
[36m(TaskRunner pid=2914832)[0m 2. Calculate the revenue from meals and the revenue from the wine.
[36m(TaskRunner pid=2914832)[0m 3. Add the revenues together to get the total revenue for the week.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m First, Tom's restaurant gets 6 reservations a night. Since they are open 2 days a week, the total number of reservations per week is:
[36m(TaskRunner pid=2914832)[0m \[ 6 \times 2 = 12 \text{ reservations per week} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Next, the normal order amount is 2 meals per reservation, and each meal costs $5. Therefore, the revenue from meals per week is:
[36m(TaskRunner pid=2914832)[0m \[ 12 \times 2 \times 5 = 120 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m The normal cost of the wine per reservation is $5. Therefore, the revenue from the wine per week is:
[36m(TaskRunner pid=2914832)[0m \[ 12 \times 5 = 60 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m The total revenue per week is the sum of the revenue from meals and the revenue from the wine:
[36m(TaskRunner pid=2914832)[0m \[ 120 + 60 = 180 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Thus, the total revenue for the week is:
[36m(TaskRunner pid=2914832)[0m \[ \boxed{180} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m #### 180
[36m(TaskRunner pid=2914832)[0m #### #### 3
[36m(TaskRunner pid=2914832)[0m [ground_truth] 180
[36m(TaskRunner pid=2914832)[0m [score] 1.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1319
[36m(TaskRunner pid=2914832)[0m step:230 - global_seqlen/min:22267 - global_seqlen/max:23934 - global_seqlen/minmax_diff:1667 - global_seqlen/balanced_min:22821 - global_seqlen/balanced_max:22821 - global_seqlen/mean:22821.0 - actor/entropy:0.07814081013202667 - critic/vf_loss:0.10594992357073352 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.7891675867140293 - critic/grad_norm:29.524624228477478 - perf/mfu/critic:0.09356309697724448 - critic/lr:1e-05 - actor/pg_loss:-0.011417281348258257 - actor/pg_clipfrac:0.005397126362367999 - actor/ppo_kl:0.0012308861078054179 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.9329273104667664 - perf/mfu/actor:0.07185948811876217 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.49732971191406 - actor/lr:1e-06 - val-core/openai/gsm8k/reward/mean@1:0.5481425322213799 - training/global_step:230 - training/epoch:7 - critic/score/mean:0.6640625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.6640625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:2.43179631986834e-09 - critic/advantages/max:2.5616860389709473 - critic/advantages/min:-2.6669206619262695 - critic/returns/mean:0.6081873774528503 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.66796875 - critic/values/max:1.2734375 - critic/values/min:-0.2109375 - critic/vf_explained_var:0.32209014892578125 - response_length/mean:254.296875 - response_length/max:512.0 - response_length/min:93.0 - response_length/clip_ratio:0.01953125 - prompt_length/mean:102.28125 - prompt_length/max:171.0 - prompt_length/min:72.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.59026375412941e-06 - timing_s/generate_sequences:3.42238712310791 - timing_s/reshard:0.9616300463676453 - timing_s/gen:5.1373415240086615 - timing_s/reward:0.038308265153318644 - timing_s/old_log_prob:2.078832940198481 - timing_s/values:1.3536729817278683 - timing_s/adv:0.035857152193784714 - timing_s/update_critic:5.239662603009492 - timing_s/update_actor:6.817939823959023 - timing_s/testing:13.73199611576274 - timing_s/step:34.44104197435081 - timing_s/stop_profile:2.9043294489383698e-06 - timing_per_token_ms/values:0.01482924698444271 - timing_per_token_ms/adv:0.00039280873092529595 - timing_per_token_ms/update_actor:0.07468931931071188 - timing_per_token_ms/update_critic:0.057399572794898254 - timing_per_token_ms/gen:0.07891461634421908 - perf/total_num_tokens:91284 - perf/time_per_step:34.44104197435081 - perf/throughput:662.6106148877675
[36m(TaskRunner pid=2914832)[0m Training Progress:  53%|█████▎    | 230/435 [1:25:30<1:25:42, 25.09s/it]
[36m(TaskRunner pid=2914832)[0m step:231 - global_seqlen/min:22966 - global_seqlen/max:23805 - global_seqlen/minmax_diff:839 - global_seqlen/balanced_min:23396 - global_seqlen/balanced_max:23396 - global_seqlen/mean:23396.0 - actor/entropy:0.08022381365299225 - critic/vf_loss:0.096495281875832 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.5239504938945174 - critic/grad_norm:23.316303730010986 - perf/mfu/critic:0.09486674210221607 - critic/lr:1e-05 - actor/pg_loss:0.04308895114809275 - actor/pg_clipfrac:0.0036904876978951506 - actor/ppo_kl:0.00045369547478912864 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.4443665146827698 - perf/mfu/actor:0.07071777379304973 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.16268157958984 - actor/lr:1e-06 - training/global_step:231 - training/epoch:7 - critic/score/mean:0.69921875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.69921875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.7874100421977346e-08 - critic/advantages/max:2.7293808460235596 - critic/advantages/min:-3.030454635620117 - critic/returns/mean:0.635807454586029 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.68359375 - critic/values/max:1.2421875 - critic/values/min:-0.185546875 - critic/vf_explained_var:0.35652947425842285 - response_length/mean:261.7734375 - response_length/max:512.0 - response_length/min:120.0 - response_length/clip_ratio:0.03125 - prompt_length/mean:103.7890625 - prompt_length/max:232.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.882924258708954e-06 - timing_s/generate_sequences:3.5106353759765625 - timing_s/reshard:0.3012584149837494 - timing_s/gen:4.352237935177982 - timing_s/reward:0.03412219090387225 - timing_s/old_log_prob:2.0853467732667923 - timing_s/values:1.34665690921247 - timing_s/adv:0.03465236956253648 - timing_s/update_critic:5.301627772860229 - timing_s/update_actor:7.107893782202154 - timing_s/step:20.272422717884183 - timing_s/stop_profile:2.037733793258667e-06 - timing_per_token_ms/values:0.014389819939439115 - timing_per_token_ms/adv:0.0003702809194150333 - timing_per_token_ms/update_actor:0.07595201938581546 - timing_per_token_ms/update_critic:0.056651006292317375 - timing_per_token_ms/gen:0.06494520451216136 - perf/total_num_tokens:93584 - perf/time_per_step:20.272422717884183 - perf/throughput:1154.0801178815307
[36m(TaskRunner pid=2914832)[0m Training Progress:  53%|█████▎    | 231/435 [1:25:50<1:20:23, 23.65s/it]
[36m(TaskRunner pid=2914832)[0m step:232 - global_seqlen/min:22408 - global_seqlen/max:23194 - global_seqlen/minmax_diff:786 - global_seqlen/balanced_min:22941 - global_seqlen/balanced_max:22942 - global_seqlen/mean:22941.75 - actor/entropy:0.06925065070390701 - critic/vf_loss:0.08232654619496316 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6665762830525637 - critic/grad_norm:8.770739555358887 - perf/mfu/critic:0.09312398050649937 - critic/lr:1e-05 - actor/pg_loss:0.03343588812276721 - actor/pg_clipfrac:0.0038401077908929437 - actor/ppo_kl:-0.0003972033991885837 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.269201099872589 - perf/mfu/actor:0.07248538181890897 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.20401382446289 - actor/lr:1e-06 - training/global_step:232 - training/epoch:7 - critic/score/mean:0.71484375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.71484375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.3686519473310454e-08 - critic/advantages/max:2.326489210128784 - critic/advantages/min:-2.838845729827881 - critic/returns/mean:0.6593046188354492 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.52734375 - critic/values/max:1.03125 - critic/values/min:-0.2734375 - critic/vf_explained_var:0.307439923286438 - response_length/mean:255.0390625 - response_length/max:512.0 - response_length/min:113.0 - response_length/clip_ratio:0.03125 - prompt_length/mean:103.42578125 - prompt_length/max:190.0 - prompt_length/min:69.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.536937922239304e-06 - timing_s/generate_sequences:3.507514476776123 - timing_s/reshard:0.9096964597702026 - timing_s/gen:5.1334818080067635 - timing_s/reward:0.0350710516795516 - timing_s/old_log_prob:2.082348892930895 - timing_s/values:1.344940991140902 - timing_s/adv:0.034363949205726385 - timing_s/update_critic:5.29232168989256 - timing_s/update_actor:6.796334361191839 - timing_s/step:20.72736011631787 - timing_s/stop_profile:2.00001522898674e-06 - timing_per_token_ms/values:0.014656041835745988 - timing_per_token_ms/adv:0.00037446957191284867 - timing_per_token_ms/update_actor:0.07406076651946603 - timing_per_token_ms/update_critic:0.057671294581849254 - timing_per_token_ms/gen:0.07862585094205489 - perf/total_num_tokens:91767 - perf/time_per_step:20.72736011631787 - perf/throughput:1106.8341492237994
[36m(TaskRunner pid=2914832)[0m Training Progress:  53%|█████▎    | 232/435 [1:26:11<1:17:02, 22.77s/it]
[36m(TaskRunner pid=2914832)[0m step:233 - global_seqlen/min:22823 - global_seqlen/max:25036 - global_seqlen/minmax_diff:2213 - global_seqlen/balanced_min:23914 - global_seqlen/balanced_max:23915 - global_seqlen/mean:23914.5 - actor/entropy:0.08793054521083832 - critic/vf_loss:0.06543631257954985 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6474482156336308 - critic/grad_norm:9.846845805644989 - perf/mfu/critic:0.09690523363049454 - critic/lr:1e-05 - actor/pg_loss:-0.10258788685314357 - actor/pg_clipfrac:0.003361672985192854 - actor/ppo_kl:0.0002476611189194955 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.118312656879425 - perf/mfu/actor:0.07182623530543317 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.27339172363281 - actor/lr:1e-06 - training/global_step:233 - training/epoch:8 - critic/score/mean:0.63671875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.63671875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:1.9367480064147458e-08 - critic/advantages/max:2.7314834594726562 - critic/advantages/min:-2.384334087371826 - critic/returns/mean:0.5679087042808533 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.6015625 - critic/values/max:1.0390625 - critic/values/min:-0.169921875 - critic/vf_explained_var:0.3577350974082947 - response_length/mean:270.15234375 - response_length/max:512.0 - response_length/min:140.0 - response_length/clip_ratio:0.03515625 - prompt_length/mean:103.51171875 - prompt_length/max:199.0 - prompt_length/min:69.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:1.1563301086425781e-05 - timing_s/generate_sequences:3.5502309799194336 - timing_s/reshard:0.5879915952682495 - timing_s/gen:5.0356082478538156 - timing_s/reward:0.0362288230098784 - timing_s/old_log_prob:2.088262558914721 - timing_s/values:1.3475732351653278 - timing_s/adv:0.038561512250453234 - timing_s/update_critic:5.307586446870118 - timing_s/update_actor:7.158403197769076 - timing_s/step:21.02352841105312 - timing_s/stop_profile:2.0568259060382843e-06 - timing_per_token_ms/values:0.014087407589175267 - timing_per_token_ms/adv:0.0004031185290352426 - timing_per_token_ms/update_actor:0.07483329358515833 - timing_per_token_ms/update_critic:0.055485024220348726 - timing_per_token_ms/gen:0.0728120454005092 - perf/total_num_tokens:95658 - perf/time_per_step:21.02352841105312 - perf/throughput:1137.511246086882
[36m(TaskRunner pid=2914832)[0m Training Progress:  54%|█████▎    | 233/435 [1:26:32<1:15:20, 22.38s/it]
[36m(TaskRunner pid=2914832)[0m step:234 - global_seqlen/min:22204 - global_seqlen/max:25446 - global_seqlen/minmax_diff:3242 - global_seqlen/balanced_min:23729 - global_seqlen/balanced_max:23730 - global_seqlen/mean:23729.5 - actor/entropy:0.09751404821872711 - critic/vf_loss:0.07634633913403377 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.5848913919180632 - critic/grad_norm:16.85652720928192 - perf/mfu/critic:0.09831447536674154 - critic/lr:1e-05 - actor/pg_loss:0.16207205393584445 - actor/pg_clipfrac:0.0032858725753612816 - actor/ppo_kl:0.0001797667950995674 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.985264837741852 - perf/mfu/actor:0.07493529147522873 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.34490585327148 - actor/lr:1e-06 - training/global_step:234 - training/epoch:8 - critic/score/mean:0.6953125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.6953125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-7.120916745151362e-09 - critic/advantages/max:2.440978527069092 - critic/advantages/min:-2.7638189792633057 - critic/returns/mean:0.6372174620628357 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.52734375 - critic/values/max:1.0 - critic/values/min:-0.283203125 - critic/vf_explained_var:0.3701626658439636 - response_length/mean:267.8515625 - response_length/max:512.0 - response_length/min:106.0 - response_length/clip_ratio:0.02734375 - prompt_length/mean:102.921875 - prompt_length/max:211.0 - prompt_length/min:66.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.661975592374802e-06 - timing_s/generate_sequences:3.590627908706665 - timing_s/reshard:0.5873650908470154 - timing_s/gen:4.870741751976311 - timing_s/reward:0.03345677210018039 - timing_s/old_log_prob:2.077858246397227 - timing_s/values:1.4239774970337749 - timing_s/adv:0.03450041497126222 - timing_s/update_critic:5.189101425930858 - timing_s/update_actor:6.805674267932773 - timing_s/step:20.442978836596012 - timing_s/stop_profile:2.644956111907959e-06 - timing_per_token_ms/values:0.015002186066223212 - timing_per_token_ms/adv:0.0003634760000343688 - timing_per_token_ms/update_actor:0.07170056541364939 - timing_per_token_ms/update_critic:0.05466930851820369 - timing_per_token_ms/gen:0.07103313040653801 - perf/total_num_tokens:94918 - perf/time_per_step:20.442978836596012 - perf/throughput:1160.7652773929708
[36m(TaskRunner pid=2914832)[0m Training Progress:  54%|█████▍    | 234/435 [1:26:53<1:13:02, 21.80s/it]
[36m(TaskRunner pid=2914832)[0m step:235 - global_seqlen/min:21639 - global_seqlen/max:24565 - global_seqlen/minmax_diff:2926 - global_seqlen/balanced_min:23156 - global_seqlen/balanced_max:23157 - global_seqlen/mean:23156.75 - actor/entropy:0.07172451913356781 - critic/vf_loss:0.07263439119560644 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6061978312209249 - critic/grad_norm:18.447226762771606 - perf/mfu/critic:0.09656886273838933 - critic/lr:1e-05 - actor/pg_loss:-0.053148288978263736 - actor/pg_clipfrac:0.003989110351540148 - actor/ppo_kl:3.730577049054773e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.2153494358062744 - perf/mfu/actor:0.07334608488578177 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.83259582519531 - actor/lr:1e-06 - training/global_step:235 - training/epoch:8 - critic/score/mean:0.6953125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.6953125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:1.4210927545832419e-08 - critic/advantages/max:2.379696846008301 - critic/advantages/min:-2.790560007095337 - critic/returns/mean:0.6280131340026855 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.68359375 - critic/values/max:1.2265625 - critic/values/min:-0.1708984375 - critic/vf_explained_var:0.34314149618148804 - response_length/mean:258.47265625 - response_length/max:512.0 - response_length/min:117.0 - response_length/clip_ratio:0.0234375 - prompt_length/mean:103.3515625 - prompt_length/max:184.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.4961849451065063e-06 - timing_s/generate_sequences:3.5541365146636963 - timing_s/reshard:0.8661632537841797 - timing_s/gen:4.945328964851797 - timing_s/reward:0.03365561319515109 - timing_s/old_log_prob:2.397891577333212 - timing_s/values:1.343227949924767 - timing_s/adv:0.03371181013062596 - timing_s/update_critic:5.15481642074883 - timing_s/update_actor:6.781785239931196 - timing_s/step:20.697494570165873 - timing_s/stop_profile:1.9869767129421234e-06 - timing_per_token_ms/values:0.014501473111779146 - timing_per_token_ms/adv:0.0003639523047343211 - timing_per_token_ms/update_actor:0.07321607349834493 - timing_per_token_ms/update_critic:0.05565133730714403 - timing_per_token_ms/gen:0.074737852542003 - perf/total_num_tokens:92627 - perf/time_per_step:20.697494570165873 - perf/throughput:1118.8189914241595
[36m(TaskRunner pid=2914832)[0m Training Progress:  54%|█████▍    | 235/435 [1:27:14<1:11:34, 21.47s/it]
[36m(TaskRunner pid=2914832)[0m step:236 - global_seqlen/min:23327 - global_seqlen/max:24520 - global_seqlen/minmax_diff:1193 - global_seqlen/balanced_min:23905 - global_seqlen/balanced_max:23906 - global_seqlen/mean:23905.25 - actor/entropy:0.07249172031879425 - critic/vf_loss:0.07993934309342876 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6762374304234982 - critic/grad_norm:15.86086094379425 - perf/mfu/critic:0.1000515546249427 - critic/lr:1e-05 - actor/pg_loss:0.051574783865362406 - actor/pg_clipfrac:0.0029594959887617733 - actor/ppo_kl:-0.0002086760323436465 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.7176893949508667 - perf/mfu/actor:0.07503896902651268 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.86688232421875 - actor/lr:1e-06 - training/global_step:236 - training/epoch:8 - critic/score/mean:0.66796875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.66796875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.2485639189208086e-08 - critic/advantages/max:2.661156177520752 - critic/advantages/min:-2.9334471225738525 - critic/returns/mean:0.6144539713859558 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.59375 - critic/values/max:1.125 - critic/values/min:-0.3125 - critic/vf_explained_var:0.42371678352355957 - response_length/mean:267.3359375 - response_length/max:512.0 - response_length/min:127.0 - response_length/clip_ratio:0.02734375 - prompt_length/mean:106.18359375 - prompt_length/max:222.0 - prompt_length/min:62.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.478730261325836e-06 - timing_s/generate_sequences:3.5872514247894287 - timing_s/reshard:0.5847439765930176 - timing_s/gen:5.092934872955084 - timing_s/reward:0.03377765789628029 - timing_s/old_log_prob:2.076485658995807 - timing_s/values:1.3449272299185395 - timing_s/adv:0.03507445706054568 - timing_s/update_critic:5.1391530013643205 - timing_s/update_actor:6.8495827610604465 - timing_s/step:20.578581559006125 - timing_s/stop_profile:1.6279518604278564e-06 - timing_per_token_ms/values:0.01406518683049267 - timing_per_token_ms/adv:0.00036680705138563373 - timing_per_token_ms/update_actor:0.0716326200422548 - timing_per_token_ms/update_critic:0.05374502464274919 - timing_per_token_ms/gen:0.07441676952796815 - perf/total_num_tokens:95621 - perf/time_per_step:20.578581559006125 - perf/throughput:1161.6568387600055
[36m(TaskRunner pid=2914832)[0m Training Progress:  54%|█████▍    | 236/435 [1:27:34<1:10:20, 21.21s/it]
[36m(TaskRunner pid=2914832)[0m step:237 - global_seqlen/min:22579 - global_seqlen/max:25341 - global_seqlen/minmax_diff:2762 - global_seqlen/balanced_min:23911 - global_seqlen/balanced_max:23912 - global_seqlen/mean:23911.5 - actor/entropy:0.07699158787727356 - critic/vf_loss:0.08316570403985679 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.4737272718921304 - critic/grad_norm:30.65693688392639 - perf/mfu/critic:0.09338525217901929 - critic/lr:1e-05 - actor/pg_loss:0.13120498601347208 - actor/pg_clipfrac:0.004024579175165854 - actor/ppo_kl:0.0007402553312658711 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.8664283752441406 - perf/mfu/actor:0.0739663362993752 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.87539672851562 - actor/lr:1e-06 - training/global_step:237 - training/epoch:8 - critic/score/mean:0.7109375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.7109375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.5834679345516633e-08 - critic/advantages/max:2.8521504402160645 - critic/advantages/min:-3.072244644165039 - critic/returns/mean:0.6494457125663757 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.6328125 - critic/values/max:1.15625 - critic/values/min:-0.26953125 - critic/vf_explained_var:0.3926113247871399 - response_length/mean:268.4921875 - response_length/max:512.0 - response_length/min:113.0 - response_length/clip_ratio:0.046875 - prompt_length/mean:105.125 - prompt_length/max:232.0 - prompt_length/min:70.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.623310476541519e-06 - timing_s/generate_sequences:3.5341291427612305 - timing_s/reshard:0.5825541615486145 - timing_s/gen:4.599523204844445 - timing_s/reward:0.03947017900645733 - timing_s/old_log_prob:2.0895594763569534 - timing_s/values:1.3455737186595798 - timing_s/adv:0.03817983157932758 - timing_s/update_critic:5.506428820081055 - timing_s/update_actor:6.948746693786234 - timing_s/step:20.574647908098996 - timing_s/stop_profile:1.919921487569809e-06 - timing_per_token_ms/values:0.014068269647027369 - timing_per_token_ms/adv:0.0003991785498539153 - timing_per_token_ms/update_actor:0.0726506774333086 - timing_per_token_ms/update_critic:0.057570926333365274 - timing_per_token_ms/gen:0.06691772928746247 - perf/total_num_tokens:95646 - perf/time_per_step:20.574647908098996 - perf/throughput:1162.182706931645
[36m(TaskRunner pid=2914832)[0m Training Progress:  54%|█████▍    | 237/435 [1:27:55<1:09:22, 21.02s/it]
[36m(TaskRunner pid=2914832)[0m step:238 - global_seqlen/min:22314 - global_seqlen/max:23635 - global_seqlen/minmax_diff:1321 - global_seqlen/balanced_min:23256 - global_seqlen/balanced_max:23257 - global_seqlen/mean:23256.25 - actor/entropy:0.06962313503026962 - critic/vf_loss:0.07358556566759944 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6560321766883135 - critic/grad_norm:12.486709654331207 - perf/mfu/critic:0.09708037102777138 - critic/lr:1e-05 - actor/pg_loss:0.11931410117540509 - actor/pg_clipfrac:0.0037504520805669017 - actor/ppo_kl:0.00014608092578782816 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.422260880470276 - perf/mfu/actor:0.07278317088478958 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.43740463256836 - actor/lr:1e-06 - training/global_step:238 - training/epoch:8 - critic/score/mean:0.6875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.6875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.3792721631489258e-08 - critic/advantages/max:2.753507614135742 - critic/advantages/min:-3.0430374145507812 - critic/returns/mean:0.6342496275901794 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.51953125 - critic/values/max:1.015625 - critic/values/min:-0.3828125 - critic/vf_explained_var:0.4220227599143982 - response_length/mean:261.04296875 - response_length/max:512.0 - response_length/min:126.0 - response_length/clip_ratio:0.01953125 - prompt_length/mean:102.3359375 - prompt_length/max:189.0 - prompt_length/min:69.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.928784281015396e-06 - timing_s/generate_sequences:3.5096378326416016 - timing_s/reshard:0.9486807584762573 - timing_s/gen:5.059110227972269 - timing_s/reward:0.03396969614550471 - timing_s/old_log_prob:2.0729064801707864 - timing_s/values:1.3432713337242603 - timing_s/adv:0.03351629385724664 - timing_s/update_critic:5.146303860004991 - timing_s/update_actor:6.863545995205641 - timing_s/step:20.560967667028308 - timing_s/stop_profile:7.286202162504196e-06 - timing_per_token_ms/values:0.01443989608948412 - timing_per_token_ms/adv:0.0003602934034640864 - timing_per_token_ms/update_actor:0.07378173604090987 - timing_per_token_ms/update_critic:0.05532172921263092 - timing_per_token_ms/gen:0.0757045838953158 - perf/total_num_tokens:93025 - perf/time_per_step:20.560967667028308 - perf/throughput:1131.08732899249
[36m(TaskRunner pid=2914832)[0m Training Progress:  55%|█████▍    | 238/435 [1:28:15<1:08:34, 20.89s/it]
[36m(TaskRunner pid=2914832)[0m step:239 - global_seqlen/min:23556 - global_seqlen/max:23901 - global_seqlen/minmax_diff:345 - global_seqlen/balanced_min:23726 - global_seqlen/balanced_max:23727 - global_seqlen/mean:23726.25 - actor/entropy:0.07390386611223221 - critic/vf_loss:0.07296958020015154 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6882631871849298 - critic/grad_norm:15.544386744499207 - perf/mfu/critic:0.0942749586358477 - critic/lr:1e-05 - actor/pg_loss:-0.03942901105619967 - actor/pg_clipfrac:0.0034851931559387594 - actor/ppo_kl:-0.0004086894628017035 - actor/pg_clipfrac_lower:0.00012392464850563556 - actor/grad_norm:2.968725264072418 - perf/mfu/actor:0.07136524325860022 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.5829086303711 - actor/lr:1e-06 - training/global_step:239 - training/epoch:8 - critic/score/mean:0.6640625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.6640625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:7.739637375436814e-09 - critic/advantages/max:2.9364099502563477 - critic/advantages/min:-2.8382389545440674 - critic/returns/mean:0.6097768545150757 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.61328125 - critic/values/max:1.0703125 - critic/values/min:-0.2294921875 - critic/vf_explained_var:0.4217500686645508 - response_length/mean:266.4140625 - response_length/max:512.0 - response_length/min:114.0 - response_length/clip_ratio:0.02734375 - prompt_length/mean:104.30859375 - prompt_length/max:184.0 - prompt_length/min:67.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.1942112147808075e-06 - timing_s/generate_sequences:3.4118752479553223 - timing_s/reshard:0.6854867935180664 - timing_s/gen:5.117627309635282 - timing_s/reward:0.0345856212079525 - timing_s/old_log_prob:2.1300333896651864 - timing_s/values:1.6337966257706285 - timing_s/adv:0.03339762520045042 - timing_s/update_critic:5.41071140114218 - timing_s/update_actor:7.1441670511849225 - timing_s/step:21.51148292934522 - timing_s/stop_profile:2.9401853680610657e-06 - timing_per_token_ms/values:0.017215074292931124 - timing_per_token_ms/adv:0.00035190585533375924 - timing_per_token_ms/update_actor:0.07527703546899449 - timing_per_token_ms/update_critic:0.057011868722851064 - timing_per_token_ms/gen:0.07503632312300638 - perf/total_num_tokens:94905 - perf/time_per_step:21.51148292934522 - perf/throughput:1102.957433382404
[36m(TaskRunner pid=2914832)[0m Training Progress:  55%|█████▍    | 239/435 [1:28:37<1:08:51, 21.08s/it]
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 240}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and bakes muffins for her friends every day with four. She sells the remainder at the farmers' market daily for $2 per fresh duck egg. How much in dollars does she make every day at the farmers' market? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much money Janet makes every day from selling the eggs, we need to follow these steps:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. Calculate the number of eggs laid by the ducks per day.
[36m(TaskRunner pid=2914832)[0m 2. Subtract the number of eggs eaten in the morning and the number of muffins baked.
[36m(TaskRunner pid=2914832)[0m 3. Determine the number of eggs sold per day.
[36m(TaskRunner pid=2914832)[0m 4. Calculate the total revenue from selling the eggs.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m First, the ducks lay 16 eggs per day. Janet eats 3 eggs for breakfast every morning, so the number of eggs eaten in the morning is:
[36m(TaskRunner pid=2914832)[0m \[ 3 \text{ eggs} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Janet bakes 4 muffins every day, so the number of muffins baked is:
[36m(TaskRunner pid=2914832)[0m \[ 4 \text{ muffins} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m The total number of eggs laid per day is the sum of the eggs laid by the ducks and the muffins baked:
[36m(TaskRunner pid=2914832)[0m \[ 16 \text{ eggs} + 3 \text{ eggs} + 4 \text{ muffins} = 23 \text{ eggs} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Next, Janet sells the remainder of the eggs at the farmers' market. The number of eggs sold is the total number of eggs laid minus the number of eggs eaten in the morning and the number of muffins baked:
[36m(TaskRunner pid=2914832)[0m \[ 23 \text{ eggs} - 3 \text{ eggs} - 4 \text{ muffins} = 16 \text{ eggs} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Each egg is sold for $2, so the total revenue is:
[36m(TaskRunner pid=2914832)[0m \[ 16 \text{ eggs} \times 2 \text{ dollars per egg} = 32 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Therefore, the final answer is:
[36m(TaskRunner pid=2914832)[0m #### 32
[36m(TaskRunner pid=2914832)[0m [ground_truth] 18
[36m(TaskRunner pid=2914832)[0m [score] 0.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1312
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 240}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Tom's restaurant gets 6 reservations a night.  They normally order 2 meals that cost $5 each and a $5 bottle of wine.  How much do they make a week if they are open 2 days a week? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much Tom's restaurant makes a week, we need to follow these steps:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. Calculate the number of reservations per night and the number of meals ordered per reservation.
[36m(TaskRunner pid=2914832)[0m 2. Determine the total number of meals ordered per day.
[36m(TaskRunner pid=2914832)[0m 3. Find the total revenue per day.
[36m(TaskRunner pid=2914832)[0m 4. Multiply the daily revenue by the number of days the restaurant is open.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Let's start with the first step:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. Tom's restaurant gets 6 reservations a night. Since they are open 2 days a week, the number of reservations per day is:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    \frac{6}{2} = 3 \text{ reservations per day}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 2. They order 2 meals that cost $5 each and a $5 bottle of wine per reservation. Therefore, the total revenue from meals per day is:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    3 \times 2 \times 5 = 30 \text{ dollars}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m    The total revenue from the wine per day is:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    3 \times 5 = 15 \text{ dollars}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m    So, the total revenue per day is:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    30 + 15 = 45 \text{ dollars}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 3. Since the restaurant is open 2 days a week, the total revenue for the week is:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    2 \times 45 = 90 \text{ dollars}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Therefore, the final answer is:
[36m(TaskRunner pid=2914832)[0m #### 90
[36m(TaskRunner pid=2914832)[0m [ground_truth] 180
[36m(TaskRunner pid=2914832)[0m [score] 0.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1319
[36m(TaskRunner pid=2914832)[0m step:240 - global_seqlen/min:23454 - global_seqlen/max:24916 - global_seqlen/minmax_diff:1462 - global_seqlen/balanced_min:24147 - global_seqlen/balanced_max:24148 - global_seqlen/mean:24147.5 - actor/entropy:0.06865199655294418 - critic/vf_loss:0.07204535319760907 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6496512517333031 - critic/grad_norm:5.83198094367981 - perf/mfu/critic:0.09161906556609181 - critic/lr:1e-05 - actor/pg_loss:0.17491335212253034 - actor/pg_clipfrac:0.0031427644353243522 - actor/ppo_kl:-0.0002502980332792504 - actor/pg_clipfrac_lower:8.18062835605815e-05 - actor/grad_norm:3.020364224910736 - perf/mfu/actor:0.07563206604927204 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.15075302124023 - actor/lr:1e-06 - val-core/openai/gsm8k/reward/mean@1:0.5526914329037149 - training/global_step:240 - training/epoch:8 - critic/score/mean:0.69921875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.69921875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:3.5643463736079184e-09 - critic/advantages/max:2.6972270011901855 - critic/advantages/min:-2.7583954334259033 - critic/returns/mean:0.6400842070579529 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.59375 - critic/values/max:1.046875 - critic/values/min:-0.265625 - critic/vf_explained_var:0.3399701714515686 - response_length/mean:272.78515625 - response_length/max:512.0 - response_length/min:133.0 - response_length/clip_ratio:0.03515625 - prompt_length/mean:104.51953125 - prompt_length/max:164.0 - prompt_length/min:67.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.916722774505615e-06 - timing_s/generate_sequences:3.5288617610931396 - timing_s/reshard:0.5818718075752258 - timing_s/gen:4.619616197887808 - timing_s/reward:0.03412852017208934 - timing_s/old_log_prob:2.07401016401127 - timing_s/values:1.3448118478991091 - timing_s/adv:0.0332977632060647 - timing_s/update_critic:5.66864759195596 - timing_s/update_actor:6.8646416468545794 - timing_s/testing:13.582500325050205 - timing_s/step:34.22913357708603 - timing_s/stop_profile:2.073124051094055e-06 - timing_per_token_ms/values:0.013922888993675423 - timing_per_token_ms/adv:0.0003447330283265835 - timing_per_token_ms/update_actor:0.07106990006061269 - timing_per_token_ms/update_critic:0.05868772742474335 - timing_per_token_ms/gen:0.06615233768974278 - perf/total_num_tokens:96590 - perf/time_per_step:34.22913357708603 - perf/throughput:705.4662936652604
[36m(TaskRunner pid=2914832)[0m Training Progress:  55%|█████▌    | 240/435 [1:29:11<1:21:20, 25.03s/it]
[36m(TaskRunner pid=2914832)[0m step:241 - global_seqlen/min:22885 - global_seqlen/max:24372 - global_seqlen/minmax_diff:1487 - global_seqlen/balanced_min:23454 - global_seqlen/balanced_max:23455 - global_seqlen/mean:23454.25 - actor/entropy:0.0723741427063942 - critic/vf_loss:0.06310806033434346 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6830424405634403 - critic/grad_norm:11.617011308670044 - perf/mfu/critic:0.093379933420252 - critic/lr:1e-05 - actor/pg_loss:-0.1772496337071061 - actor/pg_clipfrac:0.003611096806707792 - actor/ppo_kl:0.00047274146345444024 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.0350558161735535 - perf/mfu/actor:0.07091239575187298 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:91.08865737915039 - actor/lr:1e-06 - training/global_step:241 - training/epoch:8 - critic/score/mean:0.74609375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.74609375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:7.250246181200737e-09 - critic/advantages/max:2.8344969749450684 - critic/advantages/min:-2.725611925125122 - critic/returns/mean:0.7030483484268188 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.68359375 - critic/values/max:1.0859375 - critic/values/min:-0.2392578125 - critic/vf_explained_var:0.3280864357948303 - response_length/mean:265.12890625 - response_length/max:512.0 - response_length/min:122.0 - response_length/clip_ratio:0.0234375 - prompt_length/mean:101.34375 - prompt_length/max:169.0 - prompt_length/min:63.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.97838482260704e-06 - timing_s/generate_sequences:3.5016934871673584 - timing_s/reshard:0.3016427755355835 - timing_s/gen:4.326910387258977 - timing_s/reward:0.034270577132701874 - timing_s/old_log_prob:2.0900674806907773 - timing_s/values:1.3525600382126868 - timing_s/adv:0.049084464088082314 - timing_s/update_critic:5.400068121030927 - timing_s/update_actor:7.1074050441384315 - timing_s/step:20.369084888137877 - timing_s/stop_profile:3.2498501241207123e-06 - timing_per_token_ms/values:0.01441700372227514 - timing_per_token_ms/adv:0.0005231937078363443 - timing_per_token_ms/update_actor:0.07575817862581868 - timing_per_token_ms/update_critic:0.057559590703507114 - timing_per_token_ms/gen:0.06375009778938572 - perf/total_num_tokens:93817 - perf/time_per_step:20.369084888137877 - perf/throughput:1151.4631181913724
[36m(TaskRunner pid=2914832)[0m Training Progress:  55%|█████▌    | 241/435 [1:29:32<1:16:25, 23.64s/it]
[36m(TaskRunner pid=2914832)[0m step:242 - global_seqlen/min:23963 - global_seqlen/max:25084 - global_seqlen/minmax_diff:1121 - global_seqlen/balanced_min:24717 - global_seqlen/balanced_max:24718 - global_seqlen/mean:24717.25 - actor/entropy:0.0834754928946495 - critic/vf_loss:0.07254426927829627 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.8211618736386299 - critic/grad_norm:27.088082313537598 - perf/mfu/critic:0.09658396584848676 - critic/lr:1e-05 - actor/pg_loss:-0.07543124922085553 - actor/pg_clipfrac:0.0037839719734620303 - actor/ppo_kl:0.0001104475477404776 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.8758912086486816 - perf/mfu/actor:0.07773598077499311 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.19977569580078 - actor/lr:1e-06 - training/global_step:242 - training/epoch:8 - critic/score/mean:0.69140625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.69140625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-2.928871545293532e-08 - critic/advantages/max:2.8018105030059814 - critic/advantages/min:-2.542126417160034 - critic/returns/mean:0.6154717206954956 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.7734375 - critic/values/max:1.15625 - critic/values/min:0.052490234375 - critic/vf_explained_var:0.43786871433258057 - response_length/mean:282.875 - response_length/max:512.0 - response_length/min:127.0 - response_length/clip_ratio:0.06640625 - prompt_length/mean:103.33203125 - prompt_length/max:201.0 - prompt_length/min:66.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.377922207117081e-06 - timing_s/generate_sequences:3.5675909519195557 - timing_s/reshard:0.9525341391563416 - timing_s/gen:5.074794281739742 - timing_s/reward:0.037300324998795986 - timing_s/old_log_prob:2.0770951989106834 - timing_s/values:1.3434828030876815 - timing_s/adv:0.036102325189858675 - timing_s/update_critic:5.509851451963186 - timing_s/update_actor:6.8421660251915455 - timing_s/step:20.929020835086703 - timing_s/stop_profile:2.137850970029831e-06 - timing_per_token_ms/values:0.01358851412563778 - timing_per_token_ms/adv:0.0003651531338423437 - timing_per_token_ms/update_actor:0.0692043615814011 - timing_per_token_ms/update_critic:0.055728807330540274 - timing_per_token_ms/gen:0.07007835674077195 - perf/total_num_tokens:98869 - perf/time_per_step:20.929020835086703 - perf/throughput:1181.003650135532
[36m(TaskRunner pid=2914832)[0m Training Progress:  56%|█████▌    | 242/435 [1:29:52<1:13:26, 22.83s/it]
[36m(TaskRunner pid=2914832)[0m step:243 - global_seqlen/min:23164 - global_seqlen/max:25754 - global_seqlen/minmax_diff:2590 - global_seqlen/balanced_min:24478 - global_seqlen/balanced_max:24479 - global_seqlen/mean:24478.5 - actor/entropy:0.07843813300132751 - critic/vf_loss:0.08207357977516949 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.576393386349082 - critic/grad_norm:18.167118668556213 - perf/mfu/critic:0.09911816971392999 - critic/lr:1e-05 - actor/pg_loss:0.052400874672457576 - actor/pg_clipfrac:0.004226182478305418 - actor/ppo_kl:0.00014811921846558107 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.844395339488983 - perf/mfu/actor:0.07317567585448427 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.60400390625 - actor/lr:1e-06 - training/global_step:243 - training/epoch:8 - critic/score/mean:0.72265625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.72265625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-7.040710792161065e-10 - critic/advantages/max:2.2439942359924316 - critic/advantages/min:-2.634533643722534 - critic/returns/mean:0.6745275259017944 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.59765625 - critic/values/max:0.98046875 - critic/values/min:-0.06298828125 - critic/vf_explained_var:0.34702688455581665 - response_length/mean:277.78125 - response_length/max:512.0 - response_length/min:137.0 - response_length/clip_ratio:0.0234375 - prompt_length/mean:104.6953125 - prompt_length/max:256.0 - prompt_length/min:65.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.89294359087944e-06 - timing_s/generate_sequences:3.471764326095581 - timing_s/reshard:0.584115207195282 - timing_s/gen:5.257119419053197 - timing_s/reward:0.03908839821815491 - timing_s/old_log_prob:2.1170263360254467 - timing_s/values:1.3525507519952953 - timing_s/adv:0.03314012382179499 - timing_s/update_critic:5.313394927885383 - timing_s/update_actor:7.194365791045129 - timing_s/step:21.313774581998587 - timing_s/stop_profile:6.726011633872986e-06 - timing_per_token_ms/values:0.013813660477513893 - timing_per_token_ms/adv:0.0003384615460689481 - timing_per_token_ms/update_actor:0.07347637509493156 - timing_per_token_ms/update_critic:0.05426593671880817 - timing_per_token_ms/gen:0.07392731773896384 - perf/total_num_tokens:97914 - perf/time_per_step:21.313774581998587 - perf/throughput:1148.4826352941873
[36m(TaskRunner pid=2914832)[0m Training Progress:  56%|█████▌    | 243/435 [1:30:14<1:11:36, 22.38s/it]
[36m(TaskRunner pid=2914832)[0m step:244 - global_seqlen/min:23165 - global_seqlen/max:25006 - global_seqlen/minmax_diff:1841 - global_seqlen/balanced_min:24102 - global_seqlen/balanced_max:24103 - global_seqlen/mean:24102.5 - actor/entropy:0.08566945791244507 - critic/vf_loss:0.0727021869388409 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.7357553895562887 - critic/grad_norm:16.197794437408447 - perf/mfu/critic:0.09861973494276506 - critic/lr:1e-05 - actor/pg_loss:0.08008412388153374 - actor/pg_clipfrac:0.00405983705422841 - actor/ppo_kl:0.00022381023518391885 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.9279510378837585 - perf/mfu/actor:0.07627420356515024 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.65474700927734 - actor/lr:1e-06 - training/global_step:244 - training/epoch:8 - critic/score/mean:0.73046875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.73046875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:1.794522752618377e-08 - critic/advantages/max:2.4752960205078125 - critic/advantages/min:-2.6452620029449463 - critic/returns/mean:0.6724194884300232 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.74609375 - critic/values/max:1.125 - critic/values/min:0.00445556640625 - critic/vf_explained_var:0.3559560775756836 - response_length/mean:273.19140625 - response_length/max:512.0 - response_length/min:133.0 - response_length/clip_ratio:0.0390625 - prompt_length/mean:103.41015625 - prompt_length/max:216.0 - prompt_length/min:65.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.431007593870163e-06 - timing_s/generate_sequences:3.573382616043091 - timing_s/reshard:0.58464515209198 - timing_s/gen:4.842939381953329 - timing_s/reward:0.033875200897455215 - timing_s/old_log_prob:2.0776086910627782 - timing_s/values:1.4346141871064901 - timing_s/adv:0.033277034759521484 - timing_s/update_critic:5.255772024858743 - timing_s/update_actor:6.793779254890978 - timing_s/step:20.47858511703089 - timing_s/stop_profile:1.7471611499786377e-06 - timing_per_token_ms/values:0.014880346303355359 - timing_per_token_ms/adv:0.0003451616508611294 - timing_per_token_ms/update_actor:0.07046757862141871 - timing_per_token_ms/update_critic:0.05451480162699661 - timing_per_token_ms/gen:0.06924717076730956 - perf/total_num_tokens:96410 - perf/time_per_step:20.47858511703089 - perf/throughput:1176.961194450651
[36m(TaskRunner pid=2914832)[0m Training Progress:  56%|█████▌    | 244/435 [1:30:34<1:09:26, 21.81s/it]
[36m(TaskRunner pid=2914832)[0m step:245 - global_seqlen/min:22769 - global_seqlen/max:25235 - global_seqlen/minmax_diff:2466 - global_seqlen/balanced_min:24262 - global_seqlen/balanced_max:24262 - global_seqlen/mean:24262.0 - actor/entropy:0.10261940211057663 - critic/vf_loss:0.05505229422124103 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.5756916273385286 - critic/grad_norm:26.57901358604431 - perf/mfu/critic:0.093200549267394 - critic/lr:1e-05 - actor/pg_loss:-0.04810289293527603 - actor/pg_clipfrac:0.004580733635521028 - actor/ppo_kl:0.00129846624986385 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.0519049167633057 - perf/mfu/actor:0.07392445299537338 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.32580184936523 - actor/lr:1e-06 - training/global_step:245 - training/epoch:8 - critic/score/mean:0.671875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.671875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-9.215580298871373e-09 - critic/advantages/max:2.740319013595581 - critic/advantages/min:-2.550355911254883 - critic/returns/mean:0.6121274828910828 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.68359375 - critic/values/max:1.109375 - critic/values/min:-0.01104736328125 - critic/vf_explained_var:0.38627171516418457 - response_length/mean:276.296875 - response_length/max:512.0 - response_length/min:101.0 - response_length/clip_ratio:0.01953125 - prompt_length/mean:102.796875 - prompt_length/max:180.0 - prompt_length/min:66.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.039852112531662e-06 - timing_s/generate_sequences:3.3500547409057617 - timing_s/reshard:0.8518650531768799 - timing_s/gen:4.926580901723355 - timing_s/reward:0.03570259781554341 - timing_s/old_log_prob:2.463527396786958 - timing_s/values:1.7527678408659995 - timing_s/adv:0.03492161026224494 - timing_s/update_critic:5.599068759940565 - timing_s/update_actor:7.056727095041424 - timing_s/step:21.877306344918907 - timing_s/stop_profile:1.695007085800171e-06 - timing_per_token_ms/values:0.018060834235285626 - timing_per_token_ms/adv:0.00035983853621141025 - timing_per_token_ms/update_actor:0.07271378178882021 - timing_per_token_ms/update_critic:0.057693808836251796 - timing_per_token_ms/gen:0.06965137281178753 - perf/total_num_tokens:97048 - perf/time_per_step:21.877306344918907 - perf/throughput:1109.0030745780066
[36m(TaskRunner pid=2914832)[0m Training Progress:  56%|█████▋    | 245/435 [1:30:56<1:09:08, 21.83s/it]
[36m(TaskRunner pid=2914832)[0m step:246 - global_seqlen/min:23563 - global_seqlen/max:25731 - global_seqlen/minmax_diff:2168 - global_seqlen/balanced_min:24511 - global_seqlen/balanced_max:24511 - global_seqlen/mean:24511.0 - actor/entropy:0.09465257078409195 - critic/vf_loss:0.07066786917857826 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.5998020246624947 - critic/grad_norm:17.478004574775696 - perf/mfu/critic:0.10242999289107126 - critic/lr:1e-05 - actor/pg_loss:0.03991267690435052 - actor/pg_clipfrac:0.004378251629532315 - actor/ppo_kl:-7.906334951712779e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.1423409581184387 - perf/mfu/actor:0.07769841080061204 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.61624908447266 - actor/lr:1e-06 - training/global_step:246 - training/epoch:8 - critic/score/mean:0.66015625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.66015625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:8.913501048368744e-09 - critic/advantages/max:2.7633824348449707 - critic/advantages/min:-2.734532594680786 - critic/returns/mean:0.6193879246711731 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.4453125 - critic/values/max:0.921875 - critic/values/min:-0.275390625 - critic/vf_explained_var:0.4030720591545105 - response_length/mean:278.2421875 - response_length/max:512.0 - response_length/min:120.0 - response_length/clip_ratio:0.03125 - prompt_length/mean:104.7421875 - prompt_length/max:193.0 - prompt_length/min:66.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.181668817996979e-06 - timing_s/generate_sequences:3.5445942878723145 - timing_s/reshard:0.9112355709075928 - timing_s/gen:4.939209774136543 - timing_s/reward:0.038604247849434614 - timing_s/old_log_prob:2.0811873502098024 - timing_s/values:1.3413075893186033 - timing_s/adv:0.0336503810249269 - timing_s/update_critic:5.149380382150412 - timing_s/update_actor:6.7859747358597815 - timing_s/step:20.37599530396983 - timing_s/stop_profile:1.7373822629451752e-06 - timing_per_token_ms/values:0.013680669794363788 - timing_per_token_ms/adv:0.00034321713745794644 - timing_per_token_ms/update_actor:0.0692135646838132 - timing_per_token_ms/update_critic:0.05252111686743107 - timing_per_token_ms/gen:0.0693417067827677 - perf/total_num_tokens:98044 - perf/time_per_step:20.37599530396983 - perf/throughput:1202.9351025235342
[36m(TaskRunner pid=2914832)[0m Training Progress:  57%|█████▋    | 246/435 [1:31:17<1:07:24, 21.40s/it]
[36m(TaskRunner pid=2914832)[0m step:247 - global_seqlen/min:24434 - global_seqlen/max:25917 - global_seqlen/minmax_diff:1483 - global_seqlen/balanced_min:24978 - global_seqlen/balanced_max:24979 - global_seqlen/mean:24978.25 - actor/entropy:0.07924004644155502 - critic/vf_loss:0.06496243231231347 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6548452954739332 - critic/grad_norm:11.656109273433685 - perf/mfu/critic:0.0971069823600703 - critic/lr:1e-05 - actor/pg_loss:-0.0776745785260573 - actor/pg_clipfrac:0.003495216995361261 - actor/ppo_kl:-9.922362187353428e-05 - actor/pg_clipfrac_lower:5.771006544819102e-05 - actor/grad_norm:3.1953631043434143 - perf/mfu/actor:0.075320281649473 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.64487838745117 - actor/lr:1e-06 - training/global_step:247 - training/epoch:8 - critic/score/mean:0.7109375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.7109375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-9.897738628694697e-09 - critic/advantages/max:2.858921527862549 - critic/advantages/min:-3.0925261974334717 - critic/returns/mean:0.644978404045105 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.68359375 - critic/values/max:1.2734375 - critic/values/min:-0.054443359375 - critic/vf_explained_var:0.36591434478759766 - response_length/mean:285.953125 - response_length/max:512.0 - response_length/min:113.0 - response_length/clip_ratio:0.05859375 - prompt_length/mean:104.33203125 - prompt_length/max:212.0 - prompt_length/min:67.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.54392284154892e-06 - timing_s/generate_sequences:3.5187315940856934 - timing_s/reshard:0.8860898017883301 - timing_s/gen:5.351835649926215 - timing_s/reward:0.03567654313519597 - timing_s/old_log_prob:2.1299676429480314 - timing_s/values:1.6318832719698548 - timing_s/adv:0.0334001868031919 - timing_s/update_critic:5.538541656918824 - timing_s/update_actor:7.139232616871595 - timing_s/step:21.867770976852626 - timing_s/stop_profile:4.077330231666565e-06 - timing_per_token_ms/values:0.016333042466644528 - timing_per_token_ms/adv:0.0003342927026832534 - timing_per_token_ms/update_actor:0.0714544915763874 - timing_per_token_ms/update_critic:0.05543364383932845 - timing_per_token_ms/gen:0.07310851387801508 - perf/total_num_tokens:99913 - perf/time_per_step:21.867770976852626 - perf/throughput:1142.2403328825724
[36m(TaskRunner pid=2914832)[0m Training Progress:  57%|█████▋    | 247/435 [1:31:38<1:07:30, 21.54s/it]
[36m(TaskRunner pid=2914832)[0m step:248 - global_seqlen/min:25339 - global_seqlen/max:27025 - global_seqlen/minmax_diff:1686 - global_seqlen/balanced_min:25863 - global_seqlen/balanced_max:25863 - global_seqlen/mean:25863.0 - actor/entropy:0.09155039489269257 - critic/vf_loss:0.06571143463952467 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.666185948997736 - critic/grad_norm:12.760044753551483 - perf/mfu/critic:0.10877026855914798 - critic/lr:1e-05 - actor/pg_loss:-0.09580727852880955 - actor/pg_clipfrac:0.003885429883666802 - actor/ppo_kl:0.0004768324943142943 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.1342244148254395 - perf/mfu/actor:0.08155252814959464 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.48580169677734 - actor/lr:1e-06 - training/global_step:248 - training/epoch:8 - critic/score/mean:0.6640625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.6640625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-9.968373904101213e-10 - critic/advantages/max:2.6963846683502197 - critic/advantages/min:-2.5375518798828125 - critic/returns/mean:0.5994825959205627 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.58203125 - critic/values/max:1.0546875 - critic/values/min:-0.234375 - critic/vf_explained_var:0.36760228872299194 - response_length/mean:298.96875 - response_length/max:512.0 - response_length/min:120.0 - response_length/clip_ratio:0.0703125 - prompt_length/mean:105.140625 - prompt_length/max:201.0 - prompt_length/min:63.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.688052624464035e-06 - timing_s/generate_sequences:3.544355869293213 - timing_s/reshard:0.9489863514900208 - timing_s/gen:4.9932979959994555 - timing_s/reward:0.0359269711188972 - timing_s/old_log_prob:2.0699907299131155 - timing_s/values:1.339591619092971 - timing_s/adv:0.0335635868832469 - timing_s/update_critic:5.125414821784943 - timing_s/update_actor:6.8316333764232695 - timing_s/step:20.436395823024213 - timing_s/stop_profile:1.7103739082813263e-06 - timing_per_token_ms/values:0.01294891949013041 - timing_per_token_ms/adv:0.00032443632683028744 - timing_per_token_ms/update_actor:0.0660367453159269 - timing_per_token_ms/update_critic:0.04954389303043869 - timing_per_token_ms/gen:0.06524116750286735 - perf/total_num_tokens:103452 - perf/time_per_step:20.436395823024213 - perf/throughput:1265.5362630460515
[36m(TaskRunner pid=2914832)[0m Training Progress:  57%|█████▋    | 248/435 [1:31:59<1:06:07, 21.21s/it]
[36m(TaskRunner pid=2914832)[0m step:249 - global_seqlen/min:23392 - global_seqlen/max:25632 - global_seqlen/minmax_diff:2240 - global_seqlen/balanced_min:24748 - global_seqlen/balanced_max:24749 - global_seqlen/mean:24748.25 - actor/entropy:0.08697239309549332 - critic/vf_loss:0.07221110223326832 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6810659896582365 - critic/grad_norm:24.308627009391785 - perf/mfu/critic:0.09860146278081595 - critic/lr:1e-05 - actor/pg_loss:0.04140201956033707 - actor/pg_clipfrac:0.004137552663451061 - actor/ppo_kl:0.0007064216370054055 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.0637452602386475 - perf/mfu/actor:0.07427956801553305 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.61933898925781 - actor/lr:1e-06 - training/global_step:249 - training/epoch:8 - critic/score/mean:0.67578125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.67578125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-2.6040666845084104e-10 - critic/advantages/max:2.676226854324341 - critic/advantages/min:-2.5229523181915283 - critic/returns/mean:0.6048604249954224 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.7734375 - critic/values/max:1.140625 - critic/values/min:-0.0751953125 - critic/vf_explained_var:0.44790536165237427 - response_length/mean:286.11328125 - response_length/max:512.0 - response_length/min:131.0 - response_length/clip_ratio:0.05078125 - prompt_length/mean:100.578125 - prompt_length/max:175.0 - prompt_length/min:69.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.878042429685593e-06 - timing_s/generate_sequences:3.5152688026428223 - timing_s/reshard:0.7804694771766663 - timing_s/gen:5.179456470068544 - timing_s/reward:0.03426388232037425 - timing_s/old_log_prob:2.1351337330415845 - timing_s/values:1.6185620869509876 - timing_s/adv:0.03347248397767544 - timing_s/update_critic:5.401987919118255 - timing_s/update_actor:7.167642695363611 - timing_s/step:21.577096813824028 - timing_s/stop_profile:1.816079020500183e-06 - timing_per_token_ms/values:0.016350268068964346 - timing_per_token_ms/adv:0.0003381298069325653 - timing_per_token_ms/update_actor:0.07240555085070269 - timing_per_token_ms/update_critic:0.0545693929784758 - timing_per_token_ms/gen:0.07071413024873431 - perf/total_num_tokens:98993 - perf/time_per_step:21.577096813824028 - perf/throughput:1146.9684829955565
[36m(TaskRunner pid=2914832)[0m Training Progress:  57%|█████▋    | 249/435 [1:32:20<1:06:07, 21.33s/it]
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 250}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and bakes muffins for her friends every day with four. She sells the remainder at the farmers' market daily for $2 per fresh duck egg. How much in dollars does she make every day at the farmers' market? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much Janet makes every day at the farmers' market, we need to follow these steps:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. Calculate the number of eggs laid by the ducks per day.
[36m(TaskRunner pid=2914832)[0m 2. Subtract the number of eggs eaten in the morning and the number of muffins baked.
[36m(TaskRunner pid=2914832)[0m 3. Determine the number of eggs sold at the farmers' market.
[36m(TaskRunner pid=2914832)[0m 4. Calculate the total revenue from selling the eggs.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Let's start with the first step:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. Janet's ducks lay 16 eggs per day.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 2. Janet eats 3 eggs for breakfast every morning. Therefore, the number of eggs eaten in the morning is:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    3 \text{ eggs}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m 3. Janet bakes 4 muffins every day. Therefore, the number of eggs baked is:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    4 \text{ eggs}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m 4. The total number of eggs laid per day is the sum of the eggs laid by the ducks and the eggs baked:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    16 \text{ eggs} + 3 \text{ eggs} + 4 \text{ eggs} = 23 \text{ eggs}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 5. Janet sells the remainder of the eggs at the farmers' market. The number of eggs sold is the total number of eggs laid minus the number of eggs eaten in the morning and the number of eggs baked:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    23 \text{ eggs} - 3 \text{ eggs} - 4 \text{ eggs} = 16 \text{ eggs}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m 6. Each egg is sold for $2. Therefore, the total revenue is:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    16 \text{ eggs} \times 2 \text{ dollars per egg} = 32 \text{ dollars}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Thus, the final answer is:
[36m(TaskRunner pid=2914832)[0m #### 32
[36m(TaskRunner pid=2914832)[0m [ground_truth] 18
[36m(TaskRunner pid=2914832)[0m [score] 0.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1312
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 250}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Tom's restaurant gets 6 reservations a night.  They normally order 2 meals that cost $5 each and a $5 bottle of wine.  How much do they make a week if they are open 2 days a week? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much Tom's restaurant makes a week, we need to follow these steps:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. Calculate the number of reservations per night and the revenue from reservations.
[36m(TaskRunner pid=2914832)[0m 2. Calculate the revenue from meals and the revenue from the bottle of wine.
[36m(TaskRunner pid=2914832)[0m 3. Add the revenues together to get the total revenue for the week.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m First, Tom's restaurant gets 6 reservations a night. Since they are open 2 days a week, the number of reservations per week is:
[36m(TaskRunner pid=2914832)[0m \[ 6 \text{ reservations/day} \times 2 \text{ days/week} = 12 \text{ reservations/week} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Next, the normal order amount is 2 meals that each cost $5 and a $5 bottle of wine. The total cost of the meals is:
[36m(TaskRunner pid=2914832)[0m \[ 2 \text{ meals} \times 5 \text{ dollars/meal} = 10 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m The total cost of the wine is:
[36m(TaskRunner pid=2914832)[0m \[ 1 \text{ bottle} \times 5 \text{ dollars/bottle} = 5 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m So, the total revenue from reservations is:
[36m(TaskRunner pid=2914832)[0m \[ 12 \text{ reservations/week} \times 10 \text{ dollars/reservation} = 120 \text{ dollars/week} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m The revenue from the meals is:
[36m(TaskRunner pid=2914832)[0m \[ 12 \text{ meals/week} \times 5 \text{ dollars/meal} = 60 \text{ dollars/week} \]
[36m(TaskRunner pid=2914832)[0m The revenue from the wine is:
[36m(TaskRunner pid=2914832)[0m \[ 1 \text{ bottle/week} \times 5 \text{ dollars/bottle} = 5 \text{ dollars/week} \]
[36m(TaskRunner pid=2914832)[0m So, the total revenue from meals and the wine is:
[36m(TaskRunner pid=2914832)[0m \[ 60 \text{ dollars/week} + 5 \text{ dollars/week} = 65 \text{ dollars/week} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Therefore, the total revenue for the week is:
[36m(TaskRunner pid=2914832)[0m \[ 120 \text{ dollars/week} + 65 \text{ dollars/week} = 185 \text{ dollars/week} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m The final answer is:
[36m(TaskRunner pid=2914832)[0m #### 185
[36m(TaskRunner pid=2914832)[0m [ground_truth] 180
[36m(TaskRunner pid=2914832)[0m [score] 0.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1319
[36m(TaskRunner pid=2914832)[0m step:250 - global_seqlen/min:24367 - global_seqlen/max:25539 - global_seqlen/minmax_diff:1172 - global_seqlen/balanced_min:25125 - global_seqlen/balanced_max:25126 - global_seqlen/mean:25125.5 - actor/entropy:0.09876661747694016 - critic/vf_loss:0.14389479241799563 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.4103574249893427 - critic/grad_norm:38.584062576293945 - perf/mfu/critic:0.09995926170079183 - critic/lr:1e-05 - actor/pg_loss:-0.25143191078677773 - actor/pg_clipfrac:0.004082030849531293 - actor/ppo_kl:0.00019980978652256454 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.095931112766266 - perf/mfu/actor:0.0792342847223782 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.483154296875 - actor/lr:1e-06 - val-core/openai/gsm8k/reward/mean@1:0.5413191811978771 - training/global_step:250 - training/epoch:8 - critic/score/mean:0.69140625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.69140625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-2.5882398446697152e-08 - critic/advantages/max:2.5413119792938232 - critic/advantages/min:-2.393432855606079 - critic/returns/mean:0.6273090839385986 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.359375 - critic/values/max:0.78125 - critic/values/min:-0.4453125 - critic/vf_explained_var:0.29057490825653076 - response_length/mean:288.22265625 - response_length/max:512.0 - response_length/min:145.0 - response_length/clip_ratio:0.046875 - prompt_length/mean:104.36328125 - prompt_length/max:196.0 - prompt_length/min:69.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:6.411224603652954e-06 - timing_s/generate_sequences:3.702151298522949 - timing_s/reshard:0.5831792950630188 - timing_s/gen:4.9391128863208 - timing_s/reward:0.035623262636363506 - timing_s/old_log_prob:2.075537113007158 - timing_s/values:1.4102357029914856 - timing_s/adv:0.034296208061277866 - timing_s/update_critic:5.410723556298763 - timing_s/update_actor:6.823803143110126 - timing_s/testing:14.177726348862052 - timing_s/step:34.91471161786467 - timing_s/stop_profile:2.4102628231048584e-06 - timing_per_token_ms/values:0.014031916807541 - timing_per_token_ms/adv:0.0003412490105796687 - timing_per_token_ms/update_actor:0.06789718754960226 - timing_per_token_ms/update_critic:0.053836973953739854 - timing_per_token_ms/gen:0.06693925440564884 - perf/total_num_tokens:100502 - perf/time_per_step:34.91471161786467 - perf/throughput:719.6250186739087
[36m(TaskRunner pid=2914832)[0m Training Progress:  57%|█████▋    | 250/435 [1:32:55<1:18:20, 25.41s/it]
[36m(TaskRunner pid=2914832)[0m step:251 - global_seqlen/min:24697 - global_seqlen/max:25107 - global_seqlen/minmax_diff:410 - global_seqlen/balanced_min:24861 - global_seqlen/balanced_max:24862 - global_seqlen/mean:24861.75 - actor/entropy:0.07049348205327988 - critic/vf_loss:0.08633191071567126 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.7449210248887539 - critic/grad_norm:17.35745072364807 - perf/mfu/critic:0.09754156748460288 - critic/lr:1e-05 - actor/pg_loss:-0.045551442075520754 - actor/pg_clipfrac:0.003968250020989217 - actor/ppo_kl:0.00038526875869138166 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.270880401134491 - perf/mfu/actor:0.07892400625728885 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.3677749633789 - actor/lr:1e-06 - training/global_step:251 - training/epoch:8 - critic/score/mean:0.7265625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.7265625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.8210188912348713e-08 - critic/advantages/max:2.974921941757202 - critic/advantages/min:-2.6093733310699463 - critic/returns/mean:0.6705909967422485 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.7265625 - critic/values/max:1.109375 - critic/values/min:-0.1240234375 - critic/vf_explained_var:0.31712454557418823 - response_length/mean:281.6953125 - response_length/max:512.0 - response_length/min:123.0 - response_length/clip_ratio:0.03515625 - prompt_length/mean:106.76953125 - prompt_length/max:238.0 - prompt_length/min:69.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.076864570379257e-06 - timing_s/generate_sequences:3.573767900466919 - timing_s/reshard:0.30110007524490356 - timing_s/gen:4.367377543821931 - timing_s/reward:0.035043120849877596 - timing_s/old_log_prob:2.0800258642993867 - timing_s/values:1.343742846045643 - timing_s/adv:0.033910972997546196 - timing_s/update_critic:5.487033013254404 - timing_s/update_actor:6.778919519856572 - timing_s/step:20.133446008898318 - timing_s/stop_profile:1.7061829566955566e-06 - timing_per_token_ms/values:0.013512150653570677 - timing_per_token_ms/adv:0.0003409954347295162 - timing_per_token_ms/update_actor:0.06816615403035357 - timing_per_token_ms/update_critic:0.055175450373107324 - timing_per_token_ms/gen:0.060562131400587 - perf/total_num_tokens:99447 - perf/time_per_step:20.133446008898318 - perf/throughput:1234.8482216612063
[36m(TaskRunner pid=2914832)[0m Training Progress:  58%|█████▊    | 251/435 [1:33:16<1:13:04, 23.83s/it]
[36m(TaskRunner pid=2914832)[0m step:252 - global_seqlen/min:23106 - global_seqlen/max:24927 - global_seqlen/minmax_diff:1821 - global_seqlen/balanced_min:24227 - global_seqlen/balanced_max:24227 - global_seqlen/mean:24227.0 - actor/entropy:0.06916055083274841 - critic/vf_loss:0.07042251992970705 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.619126707315445 - critic/grad_norm:9.541478991508484 - perf/mfu/critic:0.09891784090030001 - critic/lr:1e-05 - actor/pg_loss:-0.17549193155718967 - actor/pg_clipfrac:0.003589198306144681 - actor/ppo_kl:0.0001505826121501741 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.1561902165412903 - perf/mfu/actor:0.0767985831555787 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.26906967163086 - actor/lr:1e-06 - training/global_step:252 - training/epoch:8 - critic/score/mean:0.73828125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.73828125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.641482283432083e-09 - critic/advantages/max:2.710031747817993 - critic/advantages/min:-2.8259100914001465 - critic/returns/mean:0.6801354289054871 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.625 - critic/values/max:1.046875 - critic/values/min:-0.2255859375 - critic/vf_explained_var:0.3516928553581238 - response_length/mean:276.875 - response_length/max:512.0 - response_length/min:126.0 - response_length/clip_ratio:0.05078125 - prompt_length/mean:101.671875 - prompt_length/max:180.0 - prompt_length/min:66.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.067085683345795e-06 - timing_s/generate_sequences:3.596090316772461 - timing_s/reshard:0.8707531690597534 - timing_s/gen:5.048883228097111 - timing_s/reward:0.03532803291454911 - timing_s/old_log_prob:2.379790239036083 - timing_s/values:1.3443363141268492 - timing_s/adv:0.03439146000891924 - timing_s/update_critic:5.269609306938946 - timing_s/update_actor:6.7848347360268235 - timing_s/step:20.90378380799666 - timing_s/stop_profile:1.8868595361709595e-06 - timing_per_token_ms/values:0.013872294486800359 - timing_per_token_ms/adv:0.00035488772865933916 - timing_per_token_ms/update_actor:0.07001315408456292 - timing_per_token_ms/update_critic:0.05437744362631513 - timing_per_token_ms/gen:0.0712314225183001 - perf/total_num_tokens:96908 - perf/time_per_step:20.90378380799666 - perf/throughput:1158.9767777225125
[36m(TaskRunner pid=2914832)[0m Training Progress:  58%|█████▊    | 252/435 [1:33:36<1:10:01, 22.96s/it]
[36m(TaskRunner pid=2914832)[0m step:253 - global_seqlen/min:23225 - global_seqlen/max:26505 - global_seqlen/minmax_diff:3280 - global_seqlen/balanced_min:24838 - global_seqlen/balanced_max:24839 - global_seqlen/mean:24838.75 - actor/entropy:0.08002491295337677 - critic/vf_loss:0.0939661352604162 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.8760235793888569 - critic/grad_norm:32.787285804748535 - perf/mfu/critic:0.09844007909574021 - critic/lr:1e-05 - actor/pg_loss:-0.063316959887743 - actor/pg_clipfrac:0.003985700495832134 - actor/ppo_kl:0.0003455908963587717 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.2641425132751465 - perf/mfu/actor:0.07527696955740182 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.49189758300781 - actor/lr:1e-06 - training/global_step:253 - training/epoch:8 - critic/score/mean:0.7265625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.7265625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:4.085190496994073e-08 - critic/advantages/max:2.6151227951049805 - critic/advantages/min:-2.6307873725891113 - critic/returns/mean:0.6790437698364258 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.84765625 - critic/values/max:1.28125 - critic/values/min:0.0218505859375 - critic/vf_explained_var:0.3021582365036011 - response_length/mean:284.1484375 - response_length/max:512.0 - response_length/min:135.0 - response_length/clip_ratio:0.05078125 - prompt_length/mean:103.95703125 - prompt_length/max:186.0 - prompt_length/min:71.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.470814019441605e-06 - timing_s/generate_sequences:3.5327870845794678 - timing_s/reshard:0.5846527814865112 - timing_s/gen:5.000738749746233 - timing_s/reward:0.037242494989186525 - timing_s/old_log_prob:2.071312273852527 - timing_s/values:1.3454552171751857 - timing_s/adv:0.03492502914741635 - timing_s/update_critic:5.430535561405122 - timing_s/update_actor:7.099714607000351 - timing_s/step:21.02726571308449 - timing_s/stop_profile:1.9059516489505768e-06 - timing_per_token_ms/values:0.013541897410046657 - timing_per_token_ms/adv:0.0003515175798642882 - timing_per_token_ms/update_actor:0.07145805049570078 - timing_per_token_ms/update_critic:0.05465789906300762 - timing_per_token_ms/gen:0.06874623669607975 - perf/total_num_tokens:99355 - perf/time_per_step:21.02726571308449 - perf/throughput:1181.2639046332954
[36m(TaskRunner pid=2914832)[0m Training Progress:  58%|█████▊    | 253/435 [1:33:58<1:07:53, 22.38s/it]
[36m(TaskRunner pid=2914832)[0m step:254 - global_seqlen/min:24232 - global_seqlen/max:24589 - global_seqlen/minmax_diff:357 - global_seqlen/balanced_min:24412 - global_seqlen/balanced_max:24413 - global_seqlen/mean:24412.75 - actor/entropy:0.12327111512422562 - critic/vf_loss:0.1098905858816579 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.5011518793180585 - critic/grad_norm:38.281853914260864 - perf/mfu/critic:0.10187973718907625 - critic/lr:1e-05 - actor/pg_loss:-0.11181796155869961 - actor/pg_clipfrac:0.004750980559037998 - actor/ppo_kl:0.0006148515840322943 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.64436537027359 - perf/mfu/actor:0.07754704547649657 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.25041198730469 - actor/lr:1e-06 - training/global_step:254 - training/epoch:8 - critic/score/mean:0.74609375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.74609375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:9.934524314303417e-09 - critic/advantages/max:2.821275234222412 - critic/advantages/min:-2.7574665546417236 - critic/returns/mean:0.7035185694694519 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.70703125 - critic/values/max:1.15625 - critic/values/min:-0.07275390625 - critic/vf_explained_var:0.302823543548584 - response_length/mean:278.98828125 - response_length/max:512.0 - response_length/min:124.0 - response_length/clip_ratio:0.05859375 - prompt_length/mean:102.4609375 - prompt_length/max:178.0 - prompt_length/min:65.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.4510158002376556e-06 - timing_s/generate_sequences:3.5387957096099854 - timing_s/reshard:0.9193164706230164 - timing_s/gen:5.009493020828813 - timing_s/reward:0.035714230965822935 - timing_s/old_log_prob:2.071360549889505 - timing_s/values:1.346046969294548 - timing_s/adv:0.03439649101346731 - timing_s/update_critic:5.156466104090214 - timing_s/update_actor:6.770516742952168 - timing_s/step:20.4304466759786 - timing_s/stop_profile:1.945067197084427e-06 - timing_per_token_ms/values:0.013784262007501696 - timing_per_token_ms/adv:0.00035223900434677897 - timing_per_token_ms/update_actor:0.06933381883393071 - timing_per_token_ms/update_critic:0.05280505170546348 - timing_per_token_ms/gen:0.07014033716734312 - perf/total_num_tokens:97651 - perf/time_per_step:20.4304466759786 - perf/throughput:1194.9200322038798
[36m(TaskRunner pid=2914832)[0m Training Progress:  58%|█████▊    | 254/435 [1:34:18<1:05:45, 21.80s/it]
[36m(TaskRunner pid=2914832)[0m step:255 - global_seqlen/min:24208 - global_seqlen/max:26290 - global_seqlen/minmax_diff:2082 - global_seqlen/balanced_min:24893 - global_seqlen/balanced_max:24894 - global_seqlen/mean:24893.25 - actor/entropy:0.08779850602149963 - critic/vf_loss:0.07639285689219832 - critic/vf_clipfrac:0.021445766382385045 - critic/vpred_mean:0.6555643230676651 - critic/grad_norm:35.046042680740356 - perf/mfu/critic:0.10171190429793556 - critic/lr:1e-05 - actor/pg_loss:0.02925618179142475 - actor/pg_clipfrac:0.004345232940977439 - actor/ppo_kl:0.00028839029619120993 - actor/pg_clipfrac_lower:4.8449612222611904e-05 - actor/grad_norm:2.9019768834114075 - perf/mfu/actor:0.07461920223803363 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.66992568969727 - actor/lr:1e-06 - training/global_step:255 - training/epoch:8 - critic/score/mean:0.74609375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.74609375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-2.8741837354573363e-08 - critic/advantages/max:2.550429105758667 - critic/advantages/min:-2.8540520668029785 - critic/returns/mean:0.7025295495986938 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.423828125 - critic/values/max:0.87109375 - critic/values/min:-0.390625 - critic/vf_explained_var:0.3357459306716919 - response_length/mean:284.7578125 - response_length/max:512.0 - response_length/min:119.0 - response_length/clip_ratio:0.03125 - prompt_length/mean:104.19921875 - prompt_length/max:183.0 - prompt_length/min:64.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.312954843044281e-06 - timing_s/generate_sequences:3.5187482833862305 - timing_s/reshard:0.987608790397644 - timing_s/gen:5.372161403298378 - timing_s/reward:0.035382083151489496 - timing_s/old_log_prob:2.1107641672715545 - timing_s/values:1.6268418040126562 - timing_s/adv:0.034592869225889444 - timing_s/update_critic:5.269602911081165 - timing_s/update_actor:7.178029912058264 - timing_s/step:21.634414818137884 - timing_s/stop_profile:1.8570572137832642e-06 - timing_per_token_ms/values:0.016338182077597904 - timing_per_token_ms/adv:0.00034741214210568574 - timing_per_token_ms/update_actor:0.07208811537322632 - timing_per_token_ms/update_critic:0.05292200607675941 - timing_per_token_ms/gen:0.07369422210895193 - perf/total_num_tokens:99573 - perf/time_per_step:21.634414818137884 - perf/throughput:1150.6320004149115
[36m(TaskRunner pid=2914832)[0m Training Progress:  59%|█████▊    | 255/435 [1:34:40<1:05:15, 21.75s/it]
[36m(TaskRunner pid=2914832)[0m step:256 - global_seqlen/min:23272 - global_seqlen/max:24662 - global_seqlen/minmax_diff:1390 - global_seqlen/balanced_min:23876 - global_seqlen/balanced_max:23877 - global_seqlen/mean:23876.25 - actor/entropy:0.07338789105415344 - critic/vf_loss:0.14160218666074798 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.9846084341406822 - critic/grad_norm:60.49617385864258 - perf/mfu/critic:0.09314250336901397 - critic/lr:1e-05 - actor/pg_loss:-0.011509389500133693 - actor/pg_clipfrac:0.004371310962596908 - actor/ppo_kl:3.154298337904038e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.890133857727051 - perf/mfu/actor:0.07563301793144644 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.46904373168945 - actor/lr:1e-06 - training/global_step:256 - training/epoch:8 - critic/score/mean:0.69921875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.69921875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.7793100326457534e-08 - critic/advantages/max:2.653337001800537 - critic/advantages/min:-2.655435800552368 - critic/returns/mean:0.6362453699111938 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.99609375 - critic/values/max:1.4453125 - critic/values/min:0.248046875 - critic/vf_explained_var:0.36747121810913086 - response_length/mean:270.29296875 - response_length/max:512.0 - response_length/min:92.0 - response_length/clip_ratio:0.02734375 - prompt_length/mean:102.7734375 - prompt_length/max:191.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.7853758335113525e-06 - timing_s/generate_sequences:3.407176971435547 - timing_s/reshard:0.5864431262016296 - timing_s/gen:4.644584878813475 - timing_s/reward:0.034497966058552265 - timing_s/old_log_prob:2.0729474620893598 - timing_s/values:1.3400357468053699 - timing_s/adv:0.03642061119899154 - timing_s/update_critic:5.5115222739987075 - timing_s/update_actor:6.786307150032371 - timing_s/step:20.433639298193157 - timing_s/stop_profile:5.397014319896698e-06 - timing_per_token_ms/values:0.014031053314542378 - timing_per_token_ms/adv:0.0003813476906862629 - timing_per_token_ms/update_actor:0.07105708758737628 - timing_per_token_ms/update_critic:0.05770925369351037 - timing_per_token_ms/gen:0.06712312853260316 - perf/total_num_tokens:95505 - perf/time_per_step:20.433639298193157 - perf/throughput:1168.477609473671
[36m(TaskRunner pid=2914832)[0m Training Progress:  59%|█████▉    | 256/435 [1:35:00<1:03:43, 21.36s/it]
[36m(TaskRunner pid=2914832)[0m step:257 - global_seqlen/min:24129 - global_seqlen/max:25722 - global_seqlen/minmax_diff:1593 - global_seqlen/balanced_min:24761 - global_seqlen/balanced_max:24762 - global_seqlen/mean:24761.75 - actor/entropy:0.06891512125730515 - critic/vf_loss:0.08818120637442917 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.5632825251668692 - critic/grad_norm:29.531601428985596 - perf/mfu/critic:0.10360864414583935 - critic/lr:1e-05 - actor/pg_loss:0.06240923283621669 - actor/pg_clipfrac:0.003921621617337223 - actor/ppo_kl:-4.472115756470885e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.963522970676422 - perf/mfu/actor:0.07737589066468618 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.59173583984375 - actor/lr:1e-06 - training/global_step:257 - training/epoch:8 - critic/score/mean:0.75 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.75 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-6.0300675563951245e-09 - critic/advantages/max:2.450277090072632 - critic/advantages/min:-2.9668116569519043 - critic/returns/mean:0.6912529468536377 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.78125 - critic/values/max:1.2265625 - critic/values/min:0.07177734375 - critic/vf_explained_var:0.3854433298110962 - response_length/mean:282.328125 - response_length/max:512.0 - response_length/min:136.0 - response_length/clip_ratio:0.03515625 - prompt_length/mean:104.57421875 - prompt_length/max:183.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:6.936956197023392e-06 - timing_s/generate_sequences:3.530768394470215 - timing_s/reshard:0.8659716248512268 - timing_s/gen:4.857525670900941 - timing_s/reward:0.03480276791378856 - timing_s/old_log_prob:2.0699891126714647 - timing_s/values:1.344028577208519 - timing_s/adv:0.03457852313295007 - timing_s/update_critic:5.145374168641865 - timing_s/update_actor:6.88512038718909 - timing_s/step:20.379107515327632 - timing_s/stop_profile:2.4498440325260162e-06 - timing_per_token_ms/values:0.01356960409915009 - timing_per_token_ms/adv:0.00034911227127474903 - timing_per_token_ms/update_actor:0.06951366913878351 - timing_per_token_ms/update_critic:0.05194881388272098 - timing_per_token_ms/gen:0.06720800363745837 - perf/total_num_tokens:99047 - perf/time_per_step:20.379107515327632 - perf/throughput:1215.055663324612
[36m(TaskRunner pid=2914832)[0m Training Progress:  59%|█████▉    | 257/435 [1:35:20<1:02:30, 21.07s/it]
[36m(TaskRunner pid=2914832)[0m step:258 - global_seqlen/min:22545 - global_seqlen/max:24776 - global_seqlen/minmax_diff:2231 - global_seqlen/balanced_min:23834 - global_seqlen/balanced_max:23834 - global_seqlen/mean:23834.0 - actor/entropy:0.07521656155586243 - critic/vf_loss:0.0591029409551993 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6249917056411505 - critic/grad_norm:11.710400640964508 - perf/mfu/critic:0.09937733904961235 - critic/lr:1e-05 - actor/pg_loss:-0.014531407039612532 - actor/pg_clipfrac:0.003412799662328325 - actor/ppo_kl:-5.841747406520881e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.9528639912605286 - perf/mfu/actor:0.07419321165791624 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.78516006469727 - actor/lr:1e-06 - training/global_step:258 - training/epoch:8 - critic/score/mean:0.6796875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.6796875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-2.9667679868339292e-08 - critic/advantages/max:2.3606927394866943 - critic/advantages/min:-2.4913792610168457 - critic/returns/mean:0.6036458611488342 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.478515625 - critic/values/max:0.91796875 - critic/values/min:-0.1865234375 - critic/vf_explained_var:0.3329220414161682 - response_length/mean:272.35546875 - response_length/max:512.0 - response_length/min:122.0 - response_length/clip_ratio:0.046875 - prompt_length/mean:100.05078125 - prompt_length/max:173.0 - prompt_length/min:65.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.978850483894348e-06 - timing_s/generate_sequences:3.4743235111236572 - timing_s/reshard:0.6864941716194153 - timing_s/gen:5.099611822050065 - timing_s/reward:0.03283706400543451 - timing_s/old_log_prob:2.137976530008018 - timing_s/values:1.6196566438302398 - timing_s/adv:0.03359214961528778 - timing_s/update_critic:5.159055448137224 - timing_s/update_actor:6.907503878232092 - timing_s/step:20.997231277171522 - timing_s/stop_profile:2.292916178703308e-06 - timing_per_token_ms/values:0.016988930140033564 - timing_per_token_ms/adv:0.0003523553496610701 - timing_per_token_ms/update_actor:0.07245430769312843 - timing_per_token_ms/update_critic:0.054114452548221274 - timing_per_token_ms/gen:0.07314102695021822 - perf/total_num_tokens:95336 - perf/time_per_step:20.997231277171522 - perf/throughput:1135.1020372820608
[36m(TaskRunner pid=2914832)[0m Training Progress:  59%|█████▉    | 258/435 [1:35:41<1:02:06, 21.05s/it]
[36m(TaskRunner pid=2914832)[0m step:259 - global_seqlen/min:23419 - global_seqlen/max:25112 - global_seqlen/minmax_diff:1693 - global_seqlen/balanced_min:24288 - global_seqlen/balanced_max:24289 - global_seqlen/mean:24288.5 - actor/entropy:0.07998250424861908 - critic/vf_loss:0.0782286386238411 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.636626785621047 - critic/grad_norm:11.936884462833405 - perf/mfu/critic:0.09762765347840911 - critic/lr:1e-05 - actor/pg_loss:-0.1070137657225132 - actor/pg_clipfrac:0.004193728589598322 - actor/ppo_kl:0.00032145776640390977 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.559869349002838 - perf/mfu/actor:0.07504446650606418 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.9365005493164 - actor/lr:1e-06 - training/global_step:259 - training/epoch:8 - critic/score/mean:0.69140625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.69140625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:4.6916603935187595e-09 - critic/advantages/max:2.4910073280334473 - critic/advantages/min:-2.60835337638855 - critic/returns/mean:0.6103084683418274 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.74609375 - critic/values/max:1.1796875 - critic/values/min:-0.1318359375 - critic/vf_explained_var:0.4154713749885559 - response_length/mean:276.3203125 - response_length/max:512.0 - response_length/min:121.0 - response_length/clip_ratio:0.046875 - prompt_length/mean:103.1875 - prompt_length/max:180.0 - prompt_length/min:69.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.764871507883072e-06 - timing_s/generate_sequences:3.5735011100769043 - timing_s/reshard:0.5826552510261536 - timing_s/gen:4.759017196018249 - timing_s/reward:0.034281875006854534 - timing_s/old_log_prob:2.072946541942656 - timing_s/values:1.339643341023475 - timing_s/adv:0.034236126113682985 - timing_s/update_critic:5.354096964001656 - timing_s/update_actor:6.963881450239569 - timing_s/step:20.565025615040213 - timing_s/stop_profile:1.6158446669578552e-06 - timing_per_token_ms/values:0.013788864493726197 - timing_per_token_ms/adv:0.0003523902887547912 - timing_per_token_ms/update_actor:0.07167879294974544 - timing_per_token_ms/update_critic:0.05510938267082833 - timing_per_token_ms/gen:0.06727667160533587 - perf/total_num_tokens:97154 - perf/time_per_step:20.565025615040213 - perf/throughput:1181.0585824039347
[36m(TaskRunner pid=2914832)[0m Training Progress:  60%|█████▉    | 259/435 [1:36:02<1:01:19, 20.91s/it]
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 260}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and bakes muffins for her friends every day with four. She sells the remainder at the farmers' market daily for $2 per fresh duck egg. How much in dollars does she make every day at the farmers' market? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much Janet makes every day at the farmers' market, we need to follow the steps one by one.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. **Calculate the number of eggs laid by the ducks per day:**
[36m(TaskRunner pid=2914832)[0m    Janet's ducks lay 16 eggs per day.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 2. **Calculate the number of eggs eaten in a day:**
[36m(TaskRunner pid=2914832)[0m    Janet eats 3 eggs for breakfast every morning. Therefore, the number of eggs eaten in a day is:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    3 \text{ eggs/day}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 3. **Calculate the number of eggs baked per day:**
[36m(TaskRunner pid=2914832)[0m    Janet bakes 4 muffins every day. Therefore, the number of eggs baked in a day is:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    4 \text{ eggs/day}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 4. **Calculate the total number of eggs sold per day:**
[36m(TaskRunner pid=2914832)[0m    The remainder of the eggs after eating and baking are sold. The total number of eggs laid per day is 16, the number of eggs eaten is 3, and the number of eggs baked is 4. Therefore, the number of eggs sold per day is:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    16 - 3 - 4 = 7 \text{ eggs/day}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 5. **Calculate the amount of money earned per day:**
[36m(TaskRunner pid=2914832)[0m    Janet sells each egg for $2. Therefore, the total amount of money earned per day is:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    7 \text{ eggs/day} \times 2 \text{ dollars/egg} = 14 \text{ dollars/day}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Thus, the final answer is:
[36m(TaskRunner pid=2914832)[0m #### 14
[36m(TaskRunner pid=2914832)[0m [ground_truth] 18
[36m(TaskRunner pid=2914832)[0m [score] 0.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1312
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 260}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Tom's restaurant gets 6 reservations a night.  They normally order 2 meals that cost $5 each and a $5 bottle of wine.  How much do they make a week if they are open 2 days a week? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much Tom's restaurant makes a week, we need to follow these steps:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. Calculate the number of reservations per night and the revenue from reservations.
[36m(TaskRunner pid=2914832)[0m 2. Calculate the revenue from meals and the revenue from the bottle of wine.
[36m(TaskRunner pid=2914832)[0m 3. Add the revenues together to get the total revenue for the week.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m First, Tom's restaurant gets 6 reservations a night. They normally order 2 meals that cost $5 each and a $5 bottle of wine. Therefore, the revenue from the meals is:
[36m(TaskRunner pid=2914832)[0m \[ 2 \times 5 = 10 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m The revenue from the bottle of wine is:
[36m(TaskRunner pid=2914832)[0m \[ 5 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m The total revenue from reservations per night is:
[36m(TaskRunner pid=2914832)[0m \[ 10 + 5 = 15 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m Since the restaurant is open 2 days a week, the total revenue for the week is:
[36m(TaskRunner pid=2914832)[0m \[ 2 \times 15 = 30 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Thus, the final answer is:
[36m(TaskRunner pid=2914832)[0m #### 30
[36m(TaskRunner pid=2914832)[0m [ground_truth] 180
[36m(TaskRunner pid=2914832)[0m [score] 0.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1319
[36m(TaskRunner pid=2914832)[0m step:260 - global_seqlen/min:23694 - global_seqlen/max:26123 - global_seqlen/minmax_diff:2429 - global_seqlen/balanced_min:24822 - global_seqlen/balanced_max:24823 - global_seqlen/mean:24822.5 - actor/entropy:0.06658214330673218 - critic/vf_loss:0.10211565007921308 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6081556268036366 - critic/grad_norm:11.480525463819504 - perf/mfu/critic:0.10231577948362214 - critic/lr:1e-05 - actor/pg_loss:0.1229885253123939 - actor/pg_clipfrac:0.004282394875190221 - actor/ppo_kl:0.00027193766095479077 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.805532157421112 - perf/mfu/actor:0.07814209370175118 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.35868072509766 - actor/lr:1e-06 - val-core/openai/gsm8k/reward/mean@1:0.5284306292645944 - training/global_step:260 - training/epoch:8 - critic/score/mean:0.6484375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.6484375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.0671985073429369e-08 - critic/advantages/max:2.5651235580444336 - critic/advantages/min:-2.390801429748535 - critic/returns/mean:0.5834124088287354 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.54296875 - critic/values/max:1.015625 - critic/values/min:-0.2021484375 - critic/vf_explained_var:0.302523672580719 - response_length/mean:284.14453125 - response_length/max:512.0 - response_length/min:130.0 - response_length/clip_ratio:0.04296875 - prompt_length/mean:103.70703125 - prompt_length/max:206.0 - prompt_length/min:64.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.618203431367874e-06 - timing_s/generate_sequences:3.569985866546631 - timing_s/reshard:0.9549949169158936 - timing_s/gen:5.072440802119672 - timing_s/reward:0.03446413017809391 - timing_s/old_log_prob:2.07588958973065 - timing_s/values:1.3438725462183356 - timing_s/adv:0.03516190079972148 - timing_s/update_critic:5.222578461281955 - timing_s/update_actor:6.83641000604257 - timing_s/testing:13.620659586973488 - timing_s/step:34.248454418964684 - timing_s/stop_profile:2.030283212661743e-06 - timing_per_token_ms/values:0.013534822703377336 - timing_per_token_ms/adv:0.0003541333548164113 - timing_per_token_ms/update_actor:0.06885295604836912 - timing_per_token_ms/update_critic:0.05259923921121921 - timing_per_token_ms/gen:0.06973289894446973 - perf/total_num_tokens:99290 - perf/time_per_step:34.248454418964684 - perf/throughput:724.777232173573
[36m(TaskRunner pid=2914832)[0m Training Progress:  60%|█████▉    | 260/435 [1:36:36<1:12:40, 24.91s/it]
[36m(TaskRunner pid=2914832)[0m step:261 - global_seqlen/min:23433 - global_seqlen/max:26209 - global_seqlen/minmax_diff:2776 - global_seqlen/balanced_min:25035 - global_seqlen/balanced_max:25035 - global_seqlen/mean:25035.0 - actor/entropy:0.08047683537006378 - critic/vf_loss:0.09625758789479733 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.4978100322186947 - critic/grad_norm:37.64570331573486 - perf/mfu/critic:0.10533288976258708 - critic/lr:1e-05 - actor/pg_loss:0.14748882874846458 - actor/pg_clipfrac:0.005135977902682498 - actor/ppo_kl:0.000327439745888114 - actor/pg_clipfrac_lower:5.02008042531088e-05 - actor/grad_norm:2.827359914779663 - perf/mfu/actor:0.07726746087391079 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.21793365478516 - actor/lr:1e-06 - training/global_step:261 - training/epoch:8 - critic/score/mean:0.7109375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.7109375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.911672065091352e-08 - critic/advantages/max:2.899595260620117 - critic/advantages/min:-2.9447240829467773 - critic/returns/mean:0.638173520565033 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.4296875 - critic/values/max:0.96484375 - critic/values/min:-0.404296875 - critic/vf_explained_var:0.40945523977279663 - response_length/mean:286.0703125 - response_length/max:512.0 - response_length/min:104.0 - response_length/clip_ratio:0.046875 - prompt_length/mean:105.1015625 - prompt_length/max:186.0 - prompt_length/min:56.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.716923624277115e-06 - timing_s/generate_sequences:3.493593692779541 - timing_s/reshard:0.30270886421203613 - timing_s/gen:4.299856050405651 - timing_s/reward:0.035676753148436546 - timing_s/old_log_prob:2.073289749212563 - timing_s/values:1.3389156148768961 - timing_s/adv:0.03284767409786582 - timing_s/update_critic:5.119199038017541 - timing_s/update_actor:6.974515529349446 - timing_s/step:19.8831884348765 - timing_s/stop_profile:1.8510036170482635e-06 - timing_per_token_ms/values:0.013370437536218256 - timing_per_token_ms/adv:0.00032801751645562035 - timing_per_token_ms/update_actor:0.0696476485854748 - timing_per_token_ms/update_critic:0.05112042178966988 - timing_per_token_ms/gen:0.05871393137621393 - perf/total_num_tokens:100140 - perf/time_per_step:19.8831884348765 - perf/throughput:1259.1038948304117
[36m(TaskRunner pid=2914832)[0m Training Progress:  60%|██████    | 261/435 [1:36:56<1:07:53, 23.41s/it]
[36m(TaskRunner pid=2914832)[0m step:262 - global_seqlen/min:23390 - global_seqlen/max:25044 - global_seqlen/minmax_diff:1654 - global_seqlen/balanced_min:24160 - global_seqlen/balanced_max:24161 - global_seqlen/mean:24160.5 - actor/entropy:0.06493434309959412 - critic/vf_loss:0.07848818246566225 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.752131262794137 - critic/grad_norm:14.941940993070602 - perf/mfu/critic:0.10079077351815559 - critic/lr:1e-05 - actor/pg_loss:-0.059023426147177815 - actor/pg_clipfrac:0.004264748087734915 - actor/ppo_kl:-7.794098655722337e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.827259123325348 - perf/mfu/actor:0.07555668507940595 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:87.63512420654297 - actor/lr:1e-06 - training/global_step:262 - training/epoch:9 - critic/score/mean:0.68359375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.68359375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.3002554588581461e-08 - critic/advantages/max:2.943175792694092 - critic/advantages/min:-3.1151540279388428 - critic/returns/mean:0.6019505858421326 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.6171875 - critic/values/max:1.234375 - critic/values/min:-0.28515625 - critic/vf_explained_var:0.40014445781707764 - response_length/mean:274.7578125 - response_length/max:512.0 - response_length/min:127.0 - response_length/clip_ratio:0.04296875 - prompt_length/mean:102.75 - prompt_length/max:183.0 - prompt_length/min:65.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:1.0043848305940628e-05 - timing_s/generate_sequences:3.543302536010742 - timing_s/reshard:0.9408282041549683 - timing_s/gen:4.989174968097359 - timing_s/reward:0.034030199982225895 - timing_s/old_log_prob:2.088244732003659 - timing_s/values:1.353896982036531 - timing_s/adv:0.03844593605026603 - timing_s/update_critic:5.1569779817946255 - timing_s/update_actor:6.878070091828704 - timing_s/step:20.549199163913727 - timing_s/stop_profile:1.8291175365447998e-06 - timing_per_token_ms/values:0.014009405662512478 - timing_per_token_ms/adv:0.0003978180920331329 - timing_per_token_ms/update_actor:0.07117061000215956 - timing_per_token_ms/update_critic:0.053361664512268224 - timing_per_token_ms/gen:0.07093143063631834 - perf/total_num_tokens:96642 - perf/time_per_step:20.549199163913727 - perf/throughput:1175.739249363452
[36m(TaskRunner pid=2914832)[0m Training Progress:  60%|██████    | 262/435 [1:37:17<1:05:24, 22.68s/it]
[36m(TaskRunner pid=2914832)[0m step:263 - global_seqlen/min:22221 - global_seqlen/max:26377 - global_seqlen/minmax_diff:4156 - global_seqlen/balanced_min:24030 - global_seqlen/balanced_max:24030 - global_seqlen/mean:24030.0 - actor/entropy:0.05991775169968605 - critic/vf_loss:0.10720686917193234 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.43959243781864643 - critic/grad_norm:36.79104554653168 - perf/mfu/critic:0.0962326900798611 - critic/lr:1e-05 - actor/pg_loss:0.02011697308626026 - actor/pg_clipfrac:0.004640237173589412 - actor/ppo_kl:0.00045959308044984937 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.0006383061408997 - perf/mfu/actor:0.07191053747617211 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.08627319335938 - actor/lr:1e-06 - training/global_step:263 - training/epoch:9 - critic/score/mean:0.6953125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.6953125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:4.897563687933371e-09 - critic/advantages/max:2.7344653606414795 - critic/advantages/min:-2.948768138885498 - critic/returns/mean:0.6437644958496094 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.60546875 - critic/values/max:1.0625 - critic/values/min:-0.1416015625 - critic/vf_explained_var:0.42771095037460327 - response_length/mean:273.0703125 - response_length/max:512.0 - response_length/min:133.0 - response_length/clip_ratio:0.03515625 - prompt_length/mean:102.3984375 - prompt_length/max:194.0 - prompt_length/min:64.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:1.8088147044181824e-05 - timing_s/generate_sequences:3.5435638427734375 - timing_s/reshard:0.7794193029403687 - timing_s/gen:5.117043951060623 - timing_s/reward:0.03381020203232765 - timing_s/old_log_prob:2.090343068819493 - timing_s/values:1.7315458441153169 - timing_s/adv:0.03340379800647497 - timing_s/update_critic:5.372279033996165 - timing_s/update_actor:7.184484260156751 - timing_s/step:21.570276021026075 - timing_s/stop_profile:3.47895547747612e-06 - timing_per_token_ms/values:0.018014417853883864 - timing_per_token_ms/adv:0.00034752182695042626 - timing_per_token_ms/update_actor:0.07474494652680765 - timing_per_token_ms/update_critic:0.05589137571781278 - timing_per_token_ms/gen:0.07319892356965958 - perf/total_num_tokens:96120 - perf/time_per_step:21.570276021026075 - perf/throughput:1114.033032149253
[36m(TaskRunner pid=2914832)[0m Training Progress:  60%|██████    | 263/435 [1:37:39<1:04:04, 22.35s/it]
[36m(TaskRunner pid=2914832)[0m step:264 - global_seqlen/min:23592 - global_seqlen/max:24958 - global_seqlen/minmax_diff:1366 - global_seqlen/balanced_min:24437 - global_seqlen/balanced_max:24438 - global_seqlen/mean:24437.5 - actor/entropy:0.06414318084716797 - critic/vf_loss:0.06804890994681045 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6034579332917929 - critic/grad_norm:18.246484726667404 - perf/mfu/critic:0.09526012551444708 - critic/lr:1e-05 - actor/pg_loss:-0.08123314729891717 - actor/pg_clipfrac:0.004085200846020598 - actor/ppo_kl:0.00031519006779490155 - actor/pg_clipfrac_lower:3.762793494388461e-05 - actor/grad_norm:3.121778905391693 - perf/mfu/actor:0.07687035569077352 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.4908561706543 - actor/lr:1e-06 - training/global_step:264 - training/epoch:9 - critic/score/mean:0.68359375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.68359375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-7.204872787269778e-08 - critic/advantages/max:2.8162240982055664 - critic/advantages/min:-2.697993278503418 - critic/returns/mean:0.6112927794456482 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.3828125 - critic/values/max:0.81640625 - critic/values/min:-0.28515625 - critic/vf_explained_var:0.4322546720504761 - response_length/mean:279.4921875 - response_length/max:512.0 - response_length/min:104.0 - response_length/clip_ratio:0.05078125 - prompt_length/mean:102.34375 - prompt_length/max:196.0 - prompt_length/min:56.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.189088940620422e-06 - timing_s/generate_sequences:3.645759344100952 - timing_s/reshard:0.5841214060783386 - timing_s/gen:4.8792915982194245 - timing_s/reward:0.03404958872124553 - timing_s/old_log_prob:2.071880422066897 - timing_s/values:1.4156164666637778 - timing_s/adv:0.034749376121908426 - timing_s/update_critic:5.520733244717121 - timing_s/update_actor:6.837465189862996 - timing_s/step:20.800814480055124 - timing_s/stop_profile:4.951842129230499e-06 - timing_per_token_ms/values:0.014482009889143508 - timing_per_token_ms/adv:0.00035549233884305296 - timing_per_token_ms/update_actor:0.06994849299092579 - timing_per_token_ms/update_critic:0.056478089460021696 - timing_per_token_ms/gen:0.06819415231613452 - perf/total_num_tokens:97750 - perf/time_per_step:20.800814480055124 - perf/throughput:1174.8338039085882
[36m(TaskRunner pid=2914832)[0m Training Progress:  61%|██████    | 264/435 [1:38:00<1:02:23, 21.89s/it]
[36m(TaskRunner pid=2914832)[0m step:265 - global_seqlen/min:23248 - global_seqlen/max:24445 - global_seqlen/minmax_diff:1197 - global_seqlen/balanced_min:23723 - global_seqlen/balanced_max:23723 - global_seqlen/mean:23723.0 - actor/entropy:0.058588992804288864 - critic/vf_loss:0.09211083731497638 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.8809329196810722 - critic/grad_norm:25.70327377319336 - perf/mfu/critic:0.09475755683353318 - critic/lr:1e-05 - actor/pg_loss:0.08910832973197103 - actor/pg_clipfrac:0.003533805240294896 - actor/ppo_kl:0.00025088266056627617 - actor/pg_clipfrac_lower:6.823144212830812e-05 - actor/grad_norm:3.0385347604751587 - perf/mfu/actor:0.07121829512135701 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.22668075561523 - actor/lr:1e-06 - training/global_step:265 - training/epoch:9 - critic/score/mean:0.734375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.734375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.141312111485604e-08 - critic/advantages/max:2.5386757850646973 - critic/advantages/min:-2.7697651386260986 - critic/returns/mean:0.6675235629081726 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.859375 - critic/values/max:1.2265625 - critic/values/min:0.189453125 - critic/vf_explained_var:0.3973773717880249 - response_length/mean:268.95703125 - response_length/max:512.0 - response_length/min:134.0 - response_length/clip_ratio:0.03125 - prompt_length/mean:101.71484375 - prompt_length/max:177.0 - prompt_length/min:70.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.380250513553619e-06 - timing_s/generate_sequences:3.511122226715088 - timing_s/reshard:0.6846374273300171 - timing_s/gen:5.028941081371158 - timing_s/reward:0.033721582032740116 - timing_s/old_log_prob:2.087883561383933 - timing_s/values:1.7742048469372094 - timing_s/adv:0.033887476194649935 - timing_s/update_critic:5.382043652702123 - timing_s/update_actor:7.157467217184603 - timing_s/step:21.505204496905208 - timing_s/stop_profile:2.6137568056583405e-06 - timing_per_token_ms/values:0.018697096140214236 - timing_per_token_ms/adv:0.00035711626053460706 - timing_per_token_ms/update_actor:0.0754275093494141 - timing_per_token_ms/update_critic:0.05671757000276233 - timing_per_token_ms/gen:0.07303880849594292 - perf/total_num_tokens:94892 - perf/time_per_step:21.505204496905208 - perf/throughput:1103.1283149813319
[36m(TaskRunner pid=2914832)[0m Training Progress:  61%|██████    | 265/435 [1:38:21<1:01:42, 21.78s/it]
[36m(TaskRunner pid=2914832)[0m step:266 - global_seqlen/min:23528 - global_seqlen/max:25310 - global_seqlen/minmax_diff:1782 - global_seqlen/balanced_min:24146 - global_seqlen/balanced_max:24147 - global_seqlen/mean:24146.5 - actor/entropy:0.06456656008958817 - critic/vf_loss:0.07312807627022266 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.5764271095395088 - critic/grad_norm:24.573641538619995 - perf/mfu/critic:0.10091518142916965 - critic/lr:1e-05 - actor/pg_loss:0.21819077781401575 - actor/pg_clipfrac:0.0042755969043355435 - actor/ppo_kl:0.0007172522109613055 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.930972397327423 - perf/mfu/actor:0.07660318399400406 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.91129302978516 - actor/lr:1e-06 - training/global_step:266 - training/epoch:9 - critic/score/mean:0.734375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.734375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:5.055170948509158e-09 - critic/advantages/max:2.4214658737182617 - critic/advantages/min:-2.746678352355957 - critic/returns/mean:0.6772111058235168 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.578125 - critic/values/max:1.015625 - critic/values/min:-0.10693359375 - critic/vf_explained_var:0.3132769465446472 - response_length/mean:274.13671875 - response_length/max:512.0 - response_length/min:127.0 - response_length/clip_ratio:0.03125 - prompt_length/mean:103.15234375 - prompt_length/max:175.0 - prompt_length/min:69.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.828907549381256e-06 - timing_s/generate_sequences:3.6037521362304688 - timing_s/reshard:0.5838019847869873 - timing_s/gen:4.936708249151707 - timing_s/reward:0.03413214022293687 - timing_s/old_log_prob:2.081260641105473 - timing_s/values:1.4388561937958002 - timing_s/adv:0.03616892592981458 - timing_s/update_critic:5.149207727052271 - timing_s/update_actor:6.777938661631197 - timing_s/step:20.461650331970304 - timing_s/stop_profile:1.580454409122467e-06 - timing_per_token_ms/values:0.014897150661543082 - timing_per_token_ms/adv:0.00037447379464740826 - timing_per_token_ms/update_actor:0.07017516681124797 - timing_per_token_ms/update_critic:0.05331215421543776 - timing_per_token_ms/gen:0.0703445225658916 - perf/total_num_tokens:96586 - perf/time_per_step:20.461650331970304 - perf/throughput:1180.085653319581
[36m(TaskRunner pid=2914832)[0m Training Progress:  61%|██████    | 266/435 [1:38:42<1:00:14, 21.39s/it]
[36m(TaskRunner pid=2914832)[0m step:267 - global_seqlen/min:23569 - global_seqlen/max:24432 - global_seqlen/minmax_diff:863 - global_seqlen/balanced_min:23970 - global_seqlen/balanced_max:23971 - global_seqlen/mean:23970.5 - actor/entropy:0.06335734575986862 - critic/vf_loss:0.0663078001816757 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.7451747991144657 - critic/grad_norm:18.107666730880737 - perf/mfu/critic:0.09361642248086186 - critic/lr:1e-05 - actor/pg_loss:0.09117291201255284 - actor/pg_clipfrac:0.004198585957055911 - actor/ppo_kl:0.0003764705816138303 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.736409068107605 - perf/mfu/actor:0.07269927450711326 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.30158615112305 - actor/lr:1e-06 - training/global_step:267 - training/epoch:9 - critic/score/mean:0.6953125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.6953125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.3845653512589706e-08 - critic/advantages/max:2.8054919242858887 - critic/advantages/min:-2.890371084213257 - critic/returns/mean:0.6277689933776855 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.69140625 - critic/values/max:1.1015625 - critic/values/min:0.054443359375 - critic/vf_explained_var:0.4795900583267212 - response_length/mean:271.2109375 - response_length/max:512.0 - response_length/min:117.0 - response_length/clip_ratio:0.03125 - prompt_length/mean:103.328125 - prompt_length/max:217.0 - prompt_length/min:66.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.4798868000507355e-06 - timing_s/generate_sequences:3.4250776767730713 - timing_s/reshard:0.8934658765792847 - timing_s/gen:4.969985831063241 - timing_s/reward:0.03433635085821152 - timing_s/old_log_prob:2.4298565317876637 - timing_s/values:1.7368802851997316 - timing_s/adv:0.03361216699704528 - timing_s/update_critic:5.506243083160371 - timing_s/update_actor:7.087220279034227 - timing_s/step:21.806424817070365 - timing_s/stop_profile:1.6847625374794006e-06 - timing_per_token_ms/values:0.018114769041110236 - timing_per_token_ms/adv:0.0003505576333101654 - timing_per_token_ms/update_actor:0.07391606640489588 - timing_per_token_ms/update_critic:0.057427286489230206 - timing_per_token_ms/gen:0.07158268516582515 - perf/total_num_tokens:95882 - perf/time_per_step:21.806424817070365 - perf/throughput:1099.240256075153
[36m(TaskRunner pid=2914832)[0m Training Progress:  61%|██████▏   | 267/435 [1:39:03<1:00:14, 21.52s/it]
[36m(TaskRunner pid=2914832)[0m step:268 - global_seqlen/min:23675 - global_seqlen/max:24904 - global_seqlen/minmax_diff:1229 - global_seqlen/balanced_min:24031 - global_seqlen/balanced_max:24032 - global_seqlen/mean:24031.5 - actor/entropy:0.06605950742959976 - critic/vf_loss:0.09353536993148737 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.7090078443288803 - critic/grad_norm:14.15285575389862 - perf/mfu/critic:0.09326402321430576 - critic/lr:1e-05 - actor/pg_loss:-0.0005073194624856114 - actor/pg_clipfrac:0.004175992653472349 - actor/ppo_kl:0.0001790278846556248 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.008888900279999 - perf/mfu/actor:0.07623508780949802 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.19375228881836 - actor/lr:1e-06 - training/global_step:268 - training/epoch:9 - critic/score/mean:0.71875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.71875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.2277149075146099e-08 - critic/advantages/max:2.5698325634002686 - critic/advantages/min:-2.5659360885620117 - critic/returns/mean:0.6566776037216187 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.640625 - critic/values/max:1.078125 - critic/values/min:-0.11669921875 - critic/vf_explained_var:0.2521478533744812 - response_length/mean:274.91015625 - response_length/max:512.0 - response_length/min:125.0 - response_length/clip_ratio:0.03125 - prompt_length/mean:100.58203125 - prompt_length/max:167.0 - prompt_length/min:67.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.126690328121185e-06 - timing_s/generate_sequences:3.480994701385498 - timing_s/reshard:0.5825093388557434 - timing_s/gen:4.616288285236806 - timing_s/reward:0.03400530619546771 - timing_s/old_log_prob:2.076142025180161 - timing_s/values:1.3482588860206306 - timing_s/adv:0.03679836168885231 - timing_s/update_critic:5.542046569753438 - timing_s/update_actor:6.776858924888074 - timing_s/step:20.437157962936908 - timing_s/stop_profile:5.894806236028671e-06 - timing_per_token_ms/values:0.014025954330988813 - timing_per_token_ms/adv:0.00038281382444762407 - timing_per_token_ms/update_actor:0.07049974954630459 - timing_per_token_ms/update_critic:0.0576539809183097 - timing_per_token_ms/gen:0.06559370654101206 - perf/total_num_tokens:96126 - perf/time_per_step:20.437157962936908 - perf/throughput:1175.8728901338184
[36m(TaskRunner pid=2914832)[0m Training Progress:  62%|██████▏   | 268/435 [1:39:24<58:59, 21.20s/it]  
[36m(TaskRunner pid=2914832)[0m step:269 - global_seqlen/min:23137 - global_seqlen/max:25195 - global_seqlen/minmax_diff:2058 - global_seqlen/balanced_min:24265 - global_seqlen/balanced_max:24266 - global_seqlen/mean:24265.75 - actor/entropy:0.06090879440307617 - critic/vf_loss:0.06775455246679485 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.7134172786027193 - critic/grad_norm:12.016169548034668 - perf/mfu/critic:0.09774917467762279 - critic/lr:1e-05 - actor/pg_loss:0.014849656028673053 - actor/pg_clipfrac:0.004451011496712454 - actor/ppo_kl:0.0007104753458406776 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.6900013089179993 - perf/mfu/actor:0.07258210976632423 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.1622314453125 - actor/lr:1e-06 - training/global_step:269 - training/epoch:9 - critic/score/mean:0.734375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.734375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:1.0859575461097393e-09 - critic/advantages/max:2.5726163387298584 - critic/advantages/min:-2.68141770362854 - critic/returns/mean:0.672493040561676 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.69921875 - critic/values/max:1.1484375 - critic/values/min:0.000789642333984375 - critic/vf_explained_var:0.2829342484474182 - response_length/mean:274.43359375 - response_length/max:512.0 - response_length/min:125.0 - response_length/clip_ratio:0.01953125 - prompt_length/mean:104.71875 - prompt_length/max:201.0 - prompt_length/min:69.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.369089871644974e-06 - timing_s/generate_sequences:3.506650447845459 - timing_s/reshard:0.8631313443183899 - timing_s/gen:4.996307914610952 - timing_s/reward:0.033791794907301664 - timing_s/old_log_prob:2.4277002247981727 - timing_s/values:1.7519835247658193 - timing_s/adv:0.034648871049284935 - timing_s/update_critic:5.340160034131259 - timing_s/update_actor:7.188669926952571 - timing_s/step:21.78128136275336 - timing_s/stop_profile:2.6300549507141113e-06 - timing_per_token_ms/values:0.01804996265070953 - timing_per_token_ms/adv:0.0003569730077298758 - timing_per_token_ms/update_actor:0.07406189718999588 - timing_per_token_ms/update_critic:0.05501746323657067 - timing_per_token_ms/gen:0.07111675915751124 - perf/total_num_tokens:97063 - perf/time_per_step:21.78128136275336 - perf/throughput:1114.0643929927444
[36m(TaskRunner pid=2914832)[0m Training Progress:  62%|██████▏   | 269/435 [1:39:46<59:08, 21.38s/it]
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 270}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and bakes muffins for her friends every day with four. She sells the remainder at the farmers' market daily for $2 per fresh duck egg. How much in dollars does she make every day at the farmers' market? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much Janet makes every day at the farmers' market, we need to follow these steps:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. Calculate the number of eggs laid by the ducks in a day.
[36m(TaskRunner pid=2914832)[0m 2. Subtract the number of eggs eaten in a day.
[36m(TaskRunner pid=2914832)[0m 3. Subtract the number of eggs baked in a day.
[36m(TaskRunner pid=2914832)[0m 4. Subtract the number of eggs sold from the remaining eggs.
[36m(TaskRunner pid=2914832)[0m 5. Determine the revenue from selling the eggs.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Let's start with the first step:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. The ducks lay 16 eggs per day. Janet eats 3 eggs for breakfast and bakes 4 eggs for her friends. Therefore, the number of eggs laid by the ducks in a day is:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    16 - 3 - 4 = 19 \text{ eggs per day}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 2. Janet sells the remaining 19 eggs at the farmers' market. Each egg is sold for $2. Therefore, the total revenue is:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    19 \times 2 = 38 \text{ dollars per day}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Thus, the final answer is:
[36m(TaskRunner pid=2914832)[0m #### 38
[36m(TaskRunner pid=2914832)[0m [ground_truth] 18
[36m(TaskRunner pid=2914832)[0m [score] 0.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1312
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 270}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Tom's restaurant gets 6 reservations a night.  They normally order 2 meals that cost $5 each and a $5 bottle of wine.  How much do they make a week if they are open 2 days a week? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much Tom's restaurant makes a week, we need to follow these steps:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. Calculate the number of reservations per night and the revenue from reservations.
[36m(TaskRunner pid=2914832)[0m 2. Calculate the revenue from meals and the revenue from the bottle of wine.
[36m(TaskRunner pid=2914832)[0m 3. Add the revenues together to find the total revenue for the week.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m First, Tom's restaurant gets 6 reservations a night. They normally order 2 meals that cost $5 each and a $5 bottle of wine. The total revenue from the meals is:
[36m(TaskRunner pid=2914832)[0m \[ 2 \times 5 = 10 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m The total revenue from the wine is:
[36m(TaskRunner pid=2914832)[0m \[ 5 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m So, the total revenue from reservations per night is:
[36m(TaskRunner pid=2914832)[0m \[ 10 + 5 = 15 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m Since the restaurant is open 2 days a week, the total revenue for the week is:
[36m(TaskRunner pid=2914832)[0m \[ 2 \times 15 = 30 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Therefore, the final answer is:
[36m(TaskRunner pid=2914832)[0m #### 30
[36m(TaskRunner pid=2914832)[0m [ground_truth] 180
[36m(TaskRunner pid=2914832)[0m [score] 0.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1319
[36m(TaskRunner pid=2914832)[0m step:270 - global_seqlen/min:23724 - global_seqlen/max:25087 - global_seqlen/minmax_diff:1363 - global_seqlen/balanced_min:24531 - global_seqlen/balanced_max:24531 - global_seqlen/mean:24531.0 - actor/entropy:0.06006549671292305 - critic/vf_loss:0.08239617350045592 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.4958497527986765 - critic/grad_norm:18.697681665420532 - perf/mfu/critic:0.09570758945449788 - critic/lr:1e-05 - actor/pg_loss:0.050589470425620675 - actor/pg_clipfrac:0.004630810508388095 - actor/ppo_kl:0.0005899137122469256 - actor/pg_clipfrac_lower:0.00010511759319342673 - actor/grad_norm:3.0037843585014343 - perf/mfu/actor:0.0776743218711803 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.30777359008789 - actor/lr:1e-06 - val-core/openai/gsm8k/reward/mean@1:0.5420773313115997 - training/global_step:270 - training/epoch:9 - critic/score/mean:0.7109375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.7109375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.3414566346625634e-08 - critic/advantages/max:2.4316890239715576 - critic/advantages/min:-2.4314024448394775 - critic/returns/mean:0.6501069664955139 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.55859375 - critic/values/max:0.91796875 - critic/values/min:-0.1162109375 - critic/vf_explained_var:0.26481151580810547 - response_length/mean:279.37109375 - response_length/max:512.0 - response_length/min:118.0 - response_length/clip_ratio:0.03125 - prompt_length/mean:103.92578125 - prompt_length/max:180.0 - prompt_length/min:67.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.477108061313629e-06 - timing_s/generate_sequences:3.4931869506835938 - timing_s/reshard:0.5971113443374634 - timing_s/gen:4.648567283991724 - timing_s/reward:0.03376636002212763 - timing_s/old_log_prob:2.0730768628418446 - timing_s/values:1.348608209285885 - timing_s/adv:0.03532860614359379 - timing_s/update_critic:5.5173210999928415 - timing_s/update_actor:6.801686161197722 - timing_s/testing:14.12130586290732 - timing_s/step:34.58649934222922 - timing_s/stop_profile:1.979060471057892e-06 - timing_per_token_ms/values:0.01374391799443444 - timing_per_token_ms/adv:0.0003600404197096917 - timing_per_token_ms/update_actor:0.06931725328357713 - timing_per_token_ms/update_critic:0.05622804920297625 - timing_per_token_ms/gen:0.06499765494472412 - perf/total_num_tokens:98124 - perf/time_per_step:34.58649934222922 - perf/throughput:709.2651892077521
[36m(TaskRunner pid=2914832)[0m Training Progress:  62%|██████▏   | 270/435 [1:40:20<1:09:41, 25.35s/it]
[36m(TaskRunner pid=2914832)[0m step:271 - global_seqlen/min:25514 - global_seqlen/max:27065 - global_seqlen/minmax_diff:1551 - global_seqlen/balanced_min:26162 - global_seqlen/balanced_max:26163 - global_seqlen/mean:26162.75 - actor/entropy:0.08824510127305984 - critic/vf_loss:0.1001815628260374 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6548323556780815 - critic/grad_norm:16.48406159877777 - perf/mfu/critic:0.09834844432567641 - critic/lr:1e-05 - actor/pg_loss:-0.0004183286800980568 - actor/pg_clipfrac:0.004372695198981091 - actor/ppo_kl:-0.00012810537145924172 - actor/pg_clipfrac_lower:4.720543802250177e-05 - actor/grad_norm:3.609134614467621 - perf/mfu/actor:0.0829804746412026 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.21955871582031 - actor/lr:1e-06 - training/global_step:271 - training/epoch:9 - critic/score/mean:0.64453125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.64453125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:5.159844107538447e-09 - critic/advantages/max:2.4696226119995117 - critic/advantages/min:-2.2231504917144775 - critic/returns/mean:0.577183187007904 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.671875 - critic/values/max:1.0546875 - critic/values/min:-0.005096435546875 - critic/vf_explained_var:0.3263218402862549 - response_length/mean:303.23046875 - response_length/max:512.0 - response_length/min:114.0 - response_length/clip_ratio:0.0703125 - prompt_length/mean:105.5625 - prompt_length/max:199.0 - prompt_length/min:69.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:1.654215157032013e-05 - timing_s/generate_sequences:3.5944056510925293 - timing_s/reshard:0.30169767141342163 - timing_s/gen:4.44746274035424 - timing_s/reward:0.03615325503051281 - timing_s/old_log_prob:2.081486964132637 - timing_s/values:1.3435942796058953 - timing_s/adv:0.034795104060322046 - timing_s/update_critic:5.734125807415694 - timing_s/update_actor:6.794889236334711 - timing_s/step:20.48073699278757 - timing_s/stop_profile:1.7499551177024841e-06 - timing_per_token_ms/values:0.012838809754382617 - timing_per_token_ms/adv:0.0003324870671118484 - timing_per_token_ms/update_actor:0.06492904259237572 - timing_per_token_ms/update_critic:0.05479284294861678 - timing_per_token_ms/gen:0.05729272985371379 - perf/total_num_tokens:104651 - perf/time_per_step:20.48073699278757 - perf/throughput:1277.4320577044366
[36m(TaskRunner pid=2914832)[0m Training Progress:  62%|██████▏   | 271/435 [1:40:41<1:05:17, 23.89s/it]
[36m(TaskRunner pid=2914832)[0m step:272 - global_seqlen/min:23739 - global_seqlen/max:25502 - global_seqlen/minmax_diff:1763 - global_seqlen/balanced_min:24489 - global_seqlen/balanced_max:24490 - global_seqlen/mean:24489.75 - actor/entropy:0.06390143930912018 - critic/vf_loss:0.07543907035142183 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.5083558317273855 - critic/grad_norm:16.836164712905884 - perf/mfu/critic:0.09715703890356618 - critic/lr:1e-05 - actor/pg_loss:0.30054870595631655 - actor/pg_clipfrac:0.004659387341234833 - actor/ppo_kl:-0.0002652828061400214 - actor/pg_clipfrac_lower:5.615453846985474e-05 - actor/grad_norm:3.0885316133499146 - perf/mfu/actor:0.07322924382902102 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.33242416381836 - actor/lr:1e-06 - training/global_step:272 - training/epoch:9 - critic/score/mean:0.66015625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.66015625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:1.4780657586754842e-08 - critic/advantages/max:2.441800117492676 - critic/advantages/min:-2.2250843048095703 - critic/returns/mean:0.6038282513618469 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.53515625 - critic/values/max:0.875 - critic/values/min:-0.138671875 - critic/vf_explained_var:0.3162832260131836 - response_length/mean:277.74609375 - response_length/max:512.0 - response_length/min:98.0 - response_length/clip_ratio:0.02734375 - prompt_length/mean:104.90625 - prompt_length/max:180.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.269888788461685e-06 - timing_s/generate_sequences:3.534355640411377 - timing_s/reshard:0.8746525645256042 - timing_s/gen:5.435714388731867 - timing_s/reward:0.03521680412814021 - timing_s/old_log_prob:2.122730248142034 - timing_s/values:1.6215682770125568 - timing_s/adv:0.033897764049470425 - timing_s/update_critic:5.422045167069882 - timing_s/update_actor:7.191615116782486 - timing_s/step:21.870125740766525 - timing_s/stop_profile:1.976732164621353e-06 - timing_per_token_ms/values:0.01655354053239168 - timing_per_token_ms/adv:0.0003460403234972838 - timing_per_token_ms/update_actor:0.07341454196942074 - timing_per_token_ms/update_critic:0.055350148195366246 - timing_per_token_ms/gen:0.07644845349326845 - perf/total_num_tokens:97959 - perf/time_per_step:21.870125740766525 - perf/throughput:1119.7809418329234
[36m(TaskRunner pid=2914832)[0m Training Progress:  63%|██████▎   | 272/435 [1:41:03<1:03:15, 23.29s/it]
[36m(TaskRunner pid=2914832)[0m step:273 - global_seqlen/min:23405 - global_seqlen/max:26222 - global_seqlen/minmax_diff:2817 - global_seqlen/balanced_min:25178 - global_seqlen/balanced_max:25179 - global_seqlen/mean:25178.5 - actor/entropy:0.08383256942033768 - critic/vf_loss:0.06994874126394279 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6322306618094444 - critic/grad_norm:11.520979702472687 - perf/mfu/critic:0.10519433114090632 - critic/lr:1e-05 - actor/pg_loss:-0.1391363013535738 - actor/pg_clipfrac:0.0037679845554521307 - actor/ppo_kl:0.00027956298799836077 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.874208152294159 - perf/mfu/actor:0.07868415194460698 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.50802993774414 - actor/lr:1e-06 - training/global_step:273 - training/epoch:9 - critic/score/mean:0.6796875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.6796875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:6.496664983757228e-09 - critic/advantages/max:2.673703908920288 - critic/advantages/min:-2.351775646209717 - critic/returns/mean:0.5876392126083374 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.62109375 - critic/values/max:1.0078125 - critic/values/min:-0.058837890625 - critic/vf_explained_var:0.363941490650177 - response_length/mean:288.71484375 - response_length/max:512.0 - response_length/min:126.0 - response_length/clip_ratio:0.0703125 - prompt_length/mean:104.69921875 - prompt_length/max:215.0 - prompt_length/min:62.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.805158823728561e-06 - timing_s/generate_sequences:3.531367778778076 - timing_s/reshard:0.9519869685173035 - timing_s/gen:5.011142595671117 - timing_s/reward:0.039765387773513794 - timing_s/old_log_prob:2.0849685380235314 - timing_s/values:1.3482958562672138 - timing_s/adv:0.03605378931388259 - timing_s/update_critic:5.157140892930329 - timing_s/update_actor:6.891774352174252 - timing_s/step:20.575910167302936 - timing_s/stop_profile:2.202112227678299e-06 - timing_per_token_ms/values:0.013387372721441049 - timing_per_token_ms/adv:0.00035798190235600405 - timing_per_token_ms/update_actor:0.06842915932416796 - timing_per_token_ms/update_critic:0.051205799520725306 - timing_per_token_ms/gen:0.06779968605040004 - perf/total_num_tokens:100714 - perf/time_per_step:20.575910167302936 - perf/throughput:1223.68827406775
[36m(TaskRunner pid=2914832)[0m Training Progress:  63%|██████▎   | 273/435 [1:41:23<1:00:41, 22.48s/it]
[36m(TaskRunner pid=2914832)[0m step:274 - global_seqlen/min:23755 - global_seqlen/max:25661 - global_seqlen/minmax_diff:1906 - global_seqlen/balanced_min:24446 - global_seqlen/balanced_max:24446 - global_seqlen/mean:24446.0 - actor/entropy:0.06433212012052536 - critic/vf_loss:0.09039985697017983 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.5832840278744698 - critic/grad_norm:8.8258535861969 - perf/mfu/critic:0.09548400387749899 - critic/lr:1e-05 - actor/pg_loss:0.08143114030826837 - actor/pg_clipfrac:0.003777274218009552 - actor/ppo_kl:6.479682178905932e-05 - actor/pg_clipfrac_lower:6.786102312617004e-05 - actor/grad_norm:3.2775506377220154 - perf/mfu/actor:0.07346532441617094 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.21165466308594 - actor/lr:1e-06 - training/global_step:274 - training/epoch:9 - critic/score/mean:0.69140625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.69140625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:1.3957965450117626e-08 - critic/advantages/max:2.261491537094116 - critic/advantages/min:-2.645892381668091 - critic/returns/mean:0.6262021660804749 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.578125 - critic/values/max:1.015625 - critic/values/min:-0.11181640625 - critic/vf_explained_var:0.349783718585968 - response_length/mean:279.4375 - response_length/max:512.0 - response_length/min:136.0 - response_length/clip_ratio:0.04296875 - prompt_length/mean:102.53125 - prompt_length/max:216.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.40375879406929e-06 - timing_s/generate_sequences:3.4859437942504883 - timing_s/reshard:0.7765325307846069 - timing_s/gen:5.206356431823224 - timing_s/reward:0.034465136006474495 - timing_s/old_log_prob:2.1282132752239704 - timing_s/values:1.6142278257757425 - timing_s/adv:0.034056538715958595 - timing_s/update_critic:5.508834335021675 - timing_s/update_actor:7.1562790726311505 - timing_s/step:21.68941290024668 - timing_s/stop_profile:2.4419277906417847e-06 - timing_per_token_ms/values:0.01650809770285264 - timing_per_token_ms/adv:0.0003482833461093696 - timing_per_token_ms/update_actor:0.07318456058896293 - timing_per_token_ms/update_critic:0.05633676608669797 - timing_per_token_ms/gen:0.07277952963295717 - perf/total_num_tokens:97784 - perf/time_per_step:21.68941290024668 - perf/throughput:1127.093670650807
[36m(TaskRunner pid=2914832)[0m Training Progress:  63%|██████▎   | 274/435 [1:41:45<59:41, 22.25s/it]  
[36m(TaskRunner pid=2914832)[0m step:275 - global_seqlen/min:24031 - global_seqlen/max:24991 - global_seqlen/minmax_diff:960 - global_seqlen/balanced_min:24435 - global_seqlen/balanced_max:24436 - global_seqlen/mean:24435.25 - actor/entropy:0.05480851233005524 - critic/vf_loss:0.07117914722766727 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.627925731241703 - critic/grad_norm:13.061446189880371 - perf/mfu/critic:0.10213057516132329 - critic/lr:1e-05 - actor/pg_loss:0.042211367457639426 - actor/pg_clipfrac:0.00432534419815056 - actor/ppo_kl:-2.4841689082677476e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.735832691192627 - perf/mfu/actor:0.0770759602846062 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.60240173339844 - actor/lr:1e-06 - training/global_step:275 - training/epoch:9 - critic/score/mean:0.7109375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.7109375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:1.1159904111934793e-09 - critic/advantages/max:2.609086036682129 - critic/advantages/min:-2.8347256183624268 - critic/returns/mean:0.645908534526825 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.703125 - critic/values/max:1.125 - critic/values/min:-0.0166015625 - critic/vf_explained_var:0.44282907247543335 - response_length/mean:277.0625 - response_length/max:512.0 - response_length/min:124.0 - response_length/clip_ratio:0.03125 - prompt_length/mean:104.73828125 - prompt_length/max:188.0 - prompt_length/min:65.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.4705735743045807e-06 - timing_s/generate_sequences:3.5632479190826416 - timing_s/reshard:0.8852643966674805 - timing_s/gen:4.984154810197651 - timing_s/reward:0.03393520973622799 - timing_s/old_log_prob:2.0788742122240365 - timing_s/values:1.348389112856239 - timing_s/adv:0.0391195067204535 - timing_s/update_critic:5.151620340067893 - timing_s/update_actor:6.8243084801360965 - timing_s/step:20.46775569813326 - timing_s/stop_profile:1.1526048183441162e-05 - timing_per_token_ms/values:0.013795532200982587 - timing_per_token_ms/adv:0.0004002364076534259 - timing_per_token_ms/update_actor:0.06982032596490824 - timing_per_token_ms/update_critic:0.05270685116857709 - timing_per_token_ms/gen:0.0702706238748823 - perf/total_num_tokens:97741 - perf/time_per_step:20.46775569813326 - perf/throughput:1193.841198829073
[36m(TaskRunner pid=2914832)[0m Training Progress:  63%|██████▎   | 275/435 [1:42:05<57:54, 21.72s/it]
[36m(TaskRunner pid=2914832)[0m step:276 - global_seqlen/min:23329 - global_seqlen/max:25660 - global_seqlen/minmax_diff:2331 - global_seqlen/balanced_min:24452 - global_seqlen/balanced_max:24453 - global_seqlen/mean:24452.75 - actor/entropy:0.05630086362361908 - critic/vf_loss:0.0733509276760742 - critic/vf_clipfrac:0.0005260942853055894 - critic/vpred_mean:0.6842178013175726 - critic/grad_norm:22.03942108154297 - perf/mfu/critic:0.09538891925208892 - critic/lr:1e-05 - actor/pg_loss:-0.10314507456496358 - actor/pg_clipfrac:0.004197050933726132 - actor/ppo_kl:0.0004631054584933736 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.9084211587905884 - perf/mfu/actor:0.073646090015278 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:87.7503776550293 - actor/lr:1e-06 - training/global_step:276 - training/epoch:9 - critic/score/mean:0.65625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.65625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-7.846235661190804e-09 - critic/advantages/max:2.5100886821746826 - critic/advantages/min:-2.4490158557891846 - critic/returns/mean:0.5917641520500183 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.53515625 - critic/values/max:0.9609375 - critic/values/min:-0.294921875 - critic/vf_explained_var:0.36211544275283813 - response_length/mean:276.80078125 - response_length/max:512.0 - response_length/min:118.0 - response_length/clip_ratio:0.046875 - prompt_length/mean:105.2734375 - prompt_length/max:201.0 - prompt_length/min:65.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.190951585769653e-06 - timing_s/generate_sequences:3.568665027618408 - timing_s/reshard:0.7778331637382507 - timing_s/gen:5.217078759800643 - timing_s/reward:0.03512744000181556 - timing_s/old_log_prob:2.1337996828369796 - timing_s/values:1.6187027399428189 - timing_s/adv:0.034408681094646454 - timing_s/update_critic:5.515174457803369 - timing_s/update_actor:7.139722589869052 - timing_s/step:21.701147630810738 - timing_s/stop_profile:1.7872080206871033e-06 - timing_per_token_ms/values:0.016549291387909528 - timing_per_token_ms/adv:0.00035178743796348525 - timing_per_token_ms/update_actor:0.07299508838340321 - timing_per_token_ms/update_critic:0.05638603488159173 - timing_per_token_ms/gen:0.07362411989388581 - perf/total_num_tokens:97811 - perf/time_per_step:21.701147630810738 - perf/throughput:1126.795246776839
[36m(TaskRunner pid=2914832)[0m Training Progress:  63%|██████▎   | 276/435 [1:42:27<57:32, 21.71s/it]
[36m(TaskRunner pid=2914832)[0m step:277 - global_seqlen/min:24087 - global_seqlen/max:24908 - global_seqlen/minmax_diff:821 - global_seqlen/balanced_min:24668 - global_seqlen/balanced_max:24669 - global_seqlen/mean:24668.5 - actor/entropy:0.05526120588183403 - critic/vf_loss:0.10648519240203314 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6906936625018716 - critic/grad_norm:17.72017925977707 - perf/mfu/critic:0.10134251302677712 - critic/lr:1e-05 - actor/pg_loss:-0.05079380422830582 - actor/pg_clipfrac:0.003760532825253904 - actor/ppo_kl:-1.2115538993384689e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.781781315803528 - perf/mfu/actor:0.07819375437897878 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.00341033935547 - actor/lr:1e-06 - training/global_step:277 - training/epoch:9 - critic/score/mean:0.671875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.671875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:3.9970814214029815e-08 - critic/advantages/max:2.935183525085449 - critic/advantages/min:-2.361088991165161 - critic/returns/mean:0.6079726219177246 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.83203125 - critic/values/max:1.234375 - critic/values/min:-0.09423828125 - critic/vf_explained_var:0.3152696490287781 - response_length/mean:282.1171875 - response_length/max:512.0 - response_length/min:128.0 - response_length/clip_ratio:0.0390625 - prompt_length/mean:103.328125 - prompt_length/max:161.0 - prompt_length/min:70.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.275701940059662e-06 - timing_s/generate_sequences:3.600867509841919 - timing_s/reshard:0.8993116617202759 - timing_s/gen:5.269667302258313 - timing_s/reward:0.034196259919553995 - timing_s/old_log_prob:2.4225432528182864 - timing_s/values:1.3424444580450654 - timing_s/adv:0.0334279821254313 - timing_s/update_critic:5.23789062583819 - timing_s/update_actor:6.786093301605433 - timing_s/step:21.13280751137063 - timing_s/stop_profile:2.4260953068733215e-06 - timing_per_token_ms/values:0.013604844822800995 - timing_per_token_ms/adv:0.0003387719371408 - timing_per_token_ms/update_actor:0.06877286115496922 - timing_per_token_ms/update_critic:0.053082783973875496 - timing_per_token_ms/gen:0.07296484869234185 - perf/total_num_tokens:98674 - perf/time_per_step:21.13280751137063 - perf/throughput:1167.3082237997469
[36m(TaskRunner pid=2914832)[0m Training Progress:  64%|██████▎   | 277/435 [1:42:48<56:43, 21.54s/it]
[36m(TaskRunner pid=2914832)[0m step:278 - global_seqlen/min:24006 - global_seqlen/max:25529 - global_seqlen/minmax_diff:1523 - global_seqlen/balanced_min:24646 - global_seqlen/balanced_max:24646 - global_seqlen/mean:24646.0 - actor/entropy:0.0626007467508316 - critic/vf_loss:0.07889151645940728 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.4623689213767648 - critic/grad_norm:36.182318449020386 - perf/mfu/critic:0.10051691274282692 - critic/lr:1e-05 - actor/pg_loss:0.11976565414806828 - actor/pg_clipfrac:0.003756448859348893 - actor/ppo_kl:0.0005296033450576942 - actor/pg_clipfrac_lower:6.537656736327335e-05 - actor/grad_norm:2.78143972158432 - perf/mfu/actor:0.0737793709974954 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.25634002685547 - actor/lr:1e-06 - training/global_step:278 - training/epoch:9 - critic/score/mean:0.7421875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.7421875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-7.693035541933568e-08 - critic/advantages/max:2.77130389213562 - critic/advantages/min:-2.9427413940429688 - critic/returns/mean:0.6665880084037781 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.3984375 - critic/values/max:0.83203125 - critic/values/min:-0.53125 - critic/vf_explained_var:0.39816707372665405 - response_length/mean:281.44140625 - response_length/max:512.0 - response_length/min:119.0 - response_length/clip_ratio:0.046875 - prompt_length/mean:103.65234375 - prompt_length/max:199.0 - prompt_length/min:65.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.820059984922409e-06 - timing_s/generate_sequences:3.685115337371826 - timing_s/reshard:0.5871171355247498 - timing_s/gen:5.053358745761216 - timing_s/reward:0.034518643748015165 - timing_s/old_log_prob:2.078747372608632 - timing_s/values:1.3459228719584644 - timing_s/adv:0.03508278587833047 - timing_s/update_critic:5.2778783878311515 - timing_s/update_actor:7.185305059887469 - timing_s/step:21.01994327129796 - timing_s/stop_profile:2.2049061954021454e-06 - timing_per_token_ms/values:0.01365254881074479 - timing_per_token_ms/adv:0.0003558669345769138 - timing_per_token_ms/update_actor:0.07288510366679653 - timing_per_token_ms/update_critic:0.05353686589944769 - timing_per_token_ms/gen:0.07013780546241052 - perf/total_num_tokens:98584 - perf/time_per_step:21.01994327129796 - perf/throughput:1172.5055430407988
[36m(TaskRunner pid=2914832)[0m Training Progress:  64%|██████▍   | 278/435 [1:43:09<55:58, 21.39s/it]
[36m(TaskRunner pid=2914832)[0m step:279 - global_seqlen/min:23420 - global_seqlen/max:26246 - global_seqlen/minmax_diff:2826 - global_seqlen/balanced_min:24686 - global_seqlen/balanced_max:24686 - global_seqlen/mean:24686.0 - actor/entropy:0.06068771705031395 - critic/vf_loss:0.07786187654710375 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.8139577899128199 - critic/grad_norm:28.280673265457153 - perf/mfu/critic:0.09859984570294344 - critic/lr:1e-05 - actor/pg_loss:-0.003210260532796383 - actor/pg_clipfrac:0.0033030360245902557 - actor/ppo_kl:0.00018703870318859117 - actor/pg_clipfrac_lower:5.10204081365373e-05 - actor/grad_norm:3.0524704456329346 - perf/mfu/actor:0.07701453769933388 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.03407287597656 - actor/lr:1e-06 - training/global_step:279 - training/epoch:9 - critic/score/mean:0.6875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.6875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-5.950711923219387e-09 - critic/advantages/max:2.990647792816162 - critic/advantages/min:-2.780506134033203 - critic/returns/mean:0.6177098751068115 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.73828125 - critic/values/max:1.1875 - critic/values/min:-0.18359375 - critic/vf_explained_var:0.4468088150024414 - response_length/mean:281.7109375 - response_length/max:512.0 - response_length/min:109.0 - response_length/clip_ratio:0.02734375 - prompt_length/mean:104.0078125 - prompt_length/max:190.0 - prompt_length/min:66.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.971865564584732e-06 - timing_s/generate_sequences:3.5369410514831543 - timing_s/reshard:0.8926888704299927 - timing_s/gen:5.057675701100379 - timing_s/reward:0.03436185326427221 - timing_s/old_log_prob:2.0722691020928323 - timing_s/values:1.3428139248862863 - timing_s/adv:0.03427045186981559 - timing_s/update_critic:5.388240994885564 - timing_s/update_actor:6.894886810798198 - timing_s/step:20.830782196950167 - timing_s/stop_profile:1.946929842233658e-06 - timing_per_token_ms/values:0.013598941959878942 - timing_per_token_ms/adv:0.00034706363799132697 - timing_per_token_ms/update_actor:0.06982588117554685 - timing_per_token_ms/update_critic:0.05456778128175448 - timing_per_token_ms/gen:0.0701305596536285 - perf/total_num_tokens:98744 - perf/time_per_step:20.830782196950167 - perf/throughput:1185.073117591056
[36m(TaskRunner pid=2914832)[0m Training Progress:  64%|██████▍   | 279/435 [1:43:30<55:11, 21.23s/it]
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 280}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and bakes muffins for her friends every day with four. She sells the remainder at the farmers' market daily for $2 per fresh duck egg. How much in dollars does she make every day at the farmers' market? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much Janet makes every day at the farmers' market, we need to follow these steps:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. Calculate the number of eggs laid by the ducks in a day.
[36m(TaskRunner pid=2914832)[0m 2. Subtract the number of eggs eaten in a day.
[36m(TaskRunner pid=2914832)[0m 3. Subtract the number of eggs baked in a day.
[36m(TaskRunner pid=2914832)[0m 4. Subtract the number of eggs sold from the remaining eggs.
[36m(TaskRunner pid=2914832)[0m 5. Determine the number of ducks and the price per duck.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Let's start with the first step:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. The ducks lay 16 eggs per day. Janet eats 3 eggs for breakfast every morning and bakes 4 eggs for her friends every day. Therefore, the number of eggs laid by the ducks in a day is:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    16 - 3 - 4 = 19 \text{ eggs per day}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 2. Janet sells the remainder of the eggs at the farmers' market. The number of eggs sold is:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    19 - 16 = 3 \text{ eggs per day}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 3. Each egg is sold for $2. Therefore, the total revenue from selling the eggs is:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    3 \times 2 = 6 \text{ dollars per day}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Thus, the final answer is:
[36m(TaskRunner pid=2914832)[0m #### 6
[36m(TaskRunner pid=2914832)[0m [ground_truth] 18
[36m(TaskRunner pid=2914832)[0m [score] 0.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1312
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 280}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Tom's restaurant gets 6 reservations a night.  They normally order 2 meals that cost $5 each and a $5 bottle of wine.  How much do they make a week if they are open 2 days a week? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much Tom's restaurant makes a week, we need to follow these steps:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. Calculate the number of reservations per night and the revenue from reservations.
[36m(TaskRunner pid=2914832)[0m 2. Calculate the revenue from meals and the revenue from the bottle of wine.
[36m(TaskRunner pid=2914832)[0m 3. Add the revenues together to find the total revenue for the week.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m First, Tom's restaurant gets 6 reservations a night. They normally order 2 meals that cost $5 each and a $5 bottle of wine. Therefore, the revenue from the meals is:
[36m(TaskRunner pid=2914832)[0m \[ 2 \times 5 = 10 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m The revenue from the wine is:
[36m(TaskRunner pid=2914832)[0m \[ 5 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m So, the total revenue from reservations per night is:
[36m(TaskRunner pid=2914832)[0m \[ 10 + 5 = 15 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m Since the restaurant is open 2 days a week, the total revenue for the week is:
[36m(TaskRunner pid=2914832)[0m \[ 2 \times 15 = 30 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Therefore, the final answer is:
[36m(TaskRunner pid=2914832)[0m #### 30
[36m(TaskRunner pid=2914832)[0m [ground_truth] 180
[36m(TaskRunner pid=2914832)[0m [score] 0.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1319
[36m(TaskRunner pid=2914832)[0m step:280 - global_seqlen/min:24384 - global_seqlen/max:25340 - global_seqlen/minmax_diff:956 - global_seqlen/balanced_min:24779 - global_seqlen/balanced_max:24780 - global_seqlen/mean:24779.25 - actor/entropy:0.06494199484586716 - critic/vf_loss:0.08521046454552561 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.4855341138318181 - critic/grad_norm:28.77786087989807 - perf/mfu/critic:0.09754839140677046 - critic/lr:1e-05 - actor/pg_loss:-0.11523254963685758 - actor/pg_clipfrac:0.00280764362832997 - actor/ppo_kl:4.936748155159876e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.4632391333580017 - perf/mfu/actor:0.07501814074762184 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.48519515991211 - actor/lr:1e-06 - val-core/openai/gsm8k/reward/mean@1:0.5511751326762699 - training/global_step:280 - training/epoch:9 - critic/score/mean:0.671875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.671875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:1.0300665209683757e-08 - critic/advantages/max:2.8304481506347656 - critic/advantages/min:-2.6312716007232666 - critic/returns/mean:0.6106896996498108 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.63671875 - critic/values/max:1.125 - critic/values/min:-0.2333984375 - critic/vf_explained_var:0.3388078808784485 - response_length/mean:280.64453125 - response_length/max:512.0 - response_length/min:125.0 - response_length/clip_ratio:0.03125 - prompt_length/mean:106.53125 - prompt_length/max:256.0 - prompt_length/min:65.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.3353065848350525e-06 - timing_s/generate_sequences:3.531799554824829 - timing_s/reshard:0.5847245454788208 - timing_s/gen:5.014518710784614 - timing_s/reward:0.034382123965770006 - timing_s/old_log_prob:2.1381898317486048 - timing_s/values:1.6325032021850348 - timing_s/adv:0.03432507207617164 - timing_s/update_critic:5.468017283827066 - timing_s/update_actor:7.106877262704074 - timing_s/testing:13.719641664996743 - timing_s/step:35.15543753514066 - timing_s/stop_profile:2.8158538043498993e-06 - timing_per_token_ms/values:0.016470466238738407 - timing_per_token_ms/adv:0.0003463086259286665 - timing_per_token_ms/update_actor:0.07170190040764021 - timing_per_token_ms/update_critic:0.055167300098137216 - timing_per_token_ms/gen:0.06979634923494486 - perf/total_num_tokens:99117 - perf/time_per_step:35.15543753514066 - perf/throughput:704.8482891225906
[36m(TaskRunner pid=2914832)[0m Training Progress:  64%|██████▍   | 280/435 [1:44:05<1:05:38, 25.41s/it]
[36m(TaskRunner pid=2914832)[0m step:281 - global_seqlen/min:23895 - global_seqlen/max:25392 - global_seqlen/minmax_diff:1497 - global_seqlen/balanced_min:24364 - global_seqlen/balanced_max:24364 - global_seqlen/mean:24364.0 - actor/entropy:0.052831072360277176 - critic/vf_loss:0.08788475417532027 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6422473788261414 - critic/grad_norm:29.607744693756104 - perf/mfu/critic:0.09588088486471497 - critic/lr:1e-05 - actor/pg_loss:-0.023108232766389847 - actor/pg_clipfrac:0.003996177023509517 - actor/ppo_kl:0.0001474170458095614 - actor/pg_clipfrac_lower:6.25000029685907e-05 - actor/grad_norm:2.7113246619701385 - perf/mfu/actor:0.07375687928402633 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.0882797241211 - actor/lr:1e-06 - training/global_step:281 - training/epoch:9 - critic/score/mean:0.71484375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.71484375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:3.11796704011158e-08 - critic/advantages/max:2.425285577774048 - critic/advantages/min:-2.6756253242492676 - critic/returns/mean:0.6527606248855591 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.458984375 - critic/values/max:0.89453125 - critic/values/min:-0.318359375 - critic/vf_explained_var:0.3118314743041992 - response_length/mean:277.90625 - response_length/max:512.0 - response_length/min:136.0 - response_length/clip_ratio:0.0390625 - prompt_length/mean:102.78125 - prompt_length/max:232.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.4319389164447784e-06 - timing_s/generate_sequences:3.6000277996063232 - timing_s/reshard:0.30188843607902527 - timing_s/gen:4.793858807068318 - timing_s/reward:0.033437464851886034 - timing_s/old_log_prob:2.1210089651867747 - timing_s/values:1.336720002349466 - timing_s/adv:0.03362093633040786 - timing_s/update_critic:5.465971278958023 - timing_s/update_actor:7.102481751702726 - timing_s/step:20.895734349731356 - timing_s/stop_profile:2.7818605303764343e-06 - timing_per_token_ms/values:0.013716138589204011 - timing_per_token_ms/adv:0.00034498580210975065 - timing_per_token_ms/update_actor:0.0728788556035824 - timing_per_token_ms/update_critic:0.056086554742222364 - timing_per_token_ms/gen:0.06738247507967388 - perf/total_num_tokens:97456 - perf/time_per_step:20.895734349731356 - perf/throughput:1165.9796010142727
[36m(TaskRunner pid=2914832)[0m Training Progress:  65%|██████▍   | 281/435 [1:44:26<1:01:45, 24.06s/it]
[36m(TaskRunner pid=2914832)[0m step:282 - global_seqlen/min:24345 - global_seqlen/max:24736 - global_seqlen/minmax_diff:391 - global_seqlen/balanced_min:24491 - global_seqlen/balanced_max:24492 - global_seqlen/mean:24491.25 - actor/entropy:0.06527725607156754 - critic/vf_loss:0.06149850954534486 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6948893461376429 - critic/grad_norm:22.453767776489258 - perf/mfu/critic:0.10332593056056961 - critic/lr:1e-05 - actor/pg_loss:-0.03153869458765257 - actor/pg_clipfrac:0.004032672775792889 - actor/ppo_kl:0.0004480140163991564 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.8647421002388 - perf/mfu/actor:0.07653588914182266 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:86.38597869873047 - actor/lr:1e-06 - training/global_step:282 - training/epoch:9 - critic/score/mean:0.6953125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.6953125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-3.6857073837381904e-08 - critic/advantages/max:2.619006633758545 - critic/advantages/min:-2.7587499618530273 - critic/returns/mean:0.6311785578727722 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.828125 - critic/values/max:1.2578125 - critic/values/min:0.0859375 - critic/vf_explained_var:0.43681013584136963 - response_length/mean:278.8125 - response_length/max:512.0 - response_length/min:125.0 - response_length/clip_ratio:0.046875 - prompt_length/mean:103.86328125 - prompt_length/max:189.0 - prompt_length/min:69.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.556030035018921e-06 - timing_s/generate_sequences:3.584832191467285 - timing_s/reshard:0.9654648303985596 - timing_s/gen:5.117610819172114 - timing_s/reward:0.036298633087426424 - timing_s/old_log_prob:2.069391882047057 - timing_s/values:1.3389296876266599 - timing_s/adv:0.03316505393013358 - timing_s/update_critic:5.099849652964622 - timing_s/update_actor:6.883821306750178 - timing_s/step:20.58708601212129 - timing_s/stop_profile:7.81891867518425e-06 - timing_per_token_ms/values:0.013667429057588526 - timing_per_token_ms/adv:0.0003385398247346867 - timing_per_token_ms/update_actor:0.0702681703337945 - timing_per_token_ms/update_critic:0.052057874271062336 - timing_per_token_ms/gen:0.07169932216952637 - perf/total_num_tokens:97965 - perf/time_per_step:20.58708601212129 - perf/throughput:1189.6414084819976
[36m(TaskRunner pid=2914832)[0m Training Progress:  65%|██████▍   | 282/435 [1:44:47<58:42, 23.02s/it]  
[36m(TaskRunner pid=2914832)[0m step:283 - global_seqlen/min:23334 - global_seqlen/max:24963 - global_seqlen/minmax_diff:1629 - global_seqlen/balanced_min:24143 - global_seqlen/balanced_max:24144 - global_seqlen/mean:24143.5 - actor/entropy:0.05226992443203926 - critic/vf_loss:0.1061418839963153 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.4951543342322111 - critic/grad_norm:35.10991382598877 - perf/mfu/critic:0.0943674718316511 - critic/lr:1e-05 - actor/pg_loss:-0.024911590851843357 - actor/pg_clipfrac:0.0028303746876190417 - actor/ppo_kl:0.000283388934803952 - actor/pg_clipfrac_lower:5.521201455849223e-05 - actor/grad_norm:2.7052289843559265 - perf/mfu/actor:0.07341460528623907 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.06277465820312 - actor/lr:1e-06 - training/global_step:283 - training/epoch:9 - critic/score/mean:0.7265625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.7265625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.050398523716467e-07 - critic/advantages/max:2.3754546642303467 - critic/advantages/min:-2.717296600341797 - critic/returns/mean:0.6727283000946045 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.419921875 - critic/values/max:0.859375 - critic/values/min:-0.27734375 - critic/vf_explained_var:0.2864869236946106 - response_length/mean:272.375 - response_length/max:512.0 - response_length/min:104.0 - response_length/clip_ratio:0.01953125 - prompt_length/mean:104.8671875 - prompt_length/max:190.0 - prompt_length/min:64.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:2.432800829410553e-05 - timing_s/generate_sequences:3.600144147872925 - timing_s/reshard:0.7758805155754089 - timing_s/gen:5.21073412289843 - timing_s/reward:0.03328798292204738 - timing_s/old_log_prob:2.1284770439378917 - timing_s/values:1.6274284939281642 - timing_s/adv:0.03404809534549713 - timing_s/update_critic:5.501423262991011 - timing_s/update_actor:7.067035038024187 - timing_s/step:21.610447575803846 - timing_s/stop_profile:1.8370337784290314e-06 - timing_per_token_ms/values:0.016851621491583285 - timing_per_token_ms/adv:0.00035255964695981456 - timing_per_token_ms/update_actor:0.07317740839174298 - timing_per_token_ms/update_critic:0.056965883809213774 - timing_per_token_ms/gen:0.07472943613610644 - perf/total_num_tokens:96574 - perf/time_per_step:21.610447575803846 - perf/throughput:1117.2142508992868
[36m(TaskRunner pid=2914832)[0m Training Progress:  65%|██████▌   | 283/435 [1:45:08<57:15, 22.60s/it]
[36m(TaskRunner pid=2914832)[0m step:284 - global_seqlen/min:22348 - global_seqlen/max:25519 - global_seqlen/minmax_diff:3171 - global_seqlen/balanced_min:23943 - global_seqlen/balanced_max:23943 - global_seqlen/mean:23943.0 - actor/entropy:0.05949079990386963 - critic/vf_loss:0.09393906989134848 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.8812833577394485 - critic/grad_norm:34.60377776622772 - perf/mfu/critic:0.09725653817608648 - critic/lr:1e-05 - actor/pg_loss:-0.1187506914138794 - actor/pg_clipfrac:0.004247677541570738 - actor/ppo_kl:-0.00033537503077241126 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.9194315671920776 - perf/mfu/actor:0.07588070629792631 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.12491989135742 - actor/lr:1e-06 - training/global_step:284 - training/epoch:9 - critic/score/mean:0.734375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.734375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:1.032123986277611e-08 - critic/advantages/max:2.4256296157836914 - critic/advantages/min:-2.586296796798706 - critic/returns/mean:0.6606268286705017 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.7109375 - critic/values/max:1.1171875 - critic/values/min:0.05712890625 - critic/vf_explained_var:0.3165743947029114 - response_length/mean:270.33984375 - response_length/max:512.0 - response_length/min:119.0 - response_length/clip_ratio:0.04296875 - prompt_length/mean:103.76953125 - prompt_length/max:206.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.020294338464737e-06 - timing_s/generate_sequences:3.7112948894500732 - timing_s/reshard:0.5850880742073059 - timing_s/gen:4.8574297884479165 - timing_s/reward:0.03417721902951598 - timing_s/old_log_prob:2.081778885796666 - timing_s/values:1.416150838136673 - timing_s/adv:0.03719849279150367 - timing_s/update_critic:5.295578414108604 - timing_s/update_actor:6.7842361982911825 - timing_s/step:20.51542908139527 - timing_s/stop_profile:3.753090277314186e-05 - timing_per_token_ms/values:0.014786689618434124 - timing_per_token_ms/adv:0.0003884067659807007 - timing_per_token_ms/update_actor:0.07083736580933031 - timing_per_token_ms/update_critic:0.05529359744088673 - timing_per_token_ms/gen:0.07018697224916434 - perf/total_num_tokens:95772 - perf/time_per_step:20.51542908139527 - perf/throughput:1167.072836010682
[36m(TaskRunner pid=2914832)[0m Training Progress:  65%|██████▌   | 284/435 [1:45:29<55:18, 21.98s/it]
[36m(TaskRunner pid=2914832)[0m step:285 - global_seqlen/min:22721 - global_seqlen/max:26270 - global_seqlen/minmax_diff:3549 - global_seqlen/balanced_min:24720 - global_seqlen/balanced_max:24721 - global_seqlen/mean:24720.5 - actor/entropy:0.059050459414720535 - critic/vf_loss:0.09775197511771694 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.73032571002841 - critic/grad_norm:25.258134126663208 - perf/mfu/critic:0.09751684860828244 - critic/lr:1e-05 - actor/pg_loss:-0.07380463066510856 - actor/pg_clipfrac:0.004238153371261433 - actor/ppo_kl:0.00046060768691802423 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.2158931493759155 - perf/mfu/actor:0.07499574116665356 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.3145751953125 - actor/lr:1e-06 - training/global_step:285 - training/epoch:9 - critic/score/mean:0.6796875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.6796875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-2.9693399739016968e-08 - critic/advantages/max:2.0252811908721924 - critic/advantages/min:-2.216878890991211 - critic/returns/mean:0.6053622961044312 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.90234375 - critic/values/max:1.2265625 - critic/values/min:0.373046875 - critic/vf_explained_var:0.3345988392829895 - response_length/mean:280.0234375 - response_length/max:512.0 - response_length/min:128.0 - response_length/clip_ratio:0.03125 - prompt_length/mean:106.234375 - prompt_length/max:222.0 - prompt_length/min:69.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.600042641162872e-06 - timing_s/generate_sequences:3.5928027629852295 - timing_s/reshard:0.8796950578689575 - timing_s/gen:5.327416822314262 - timing_s/reward:0.03371924813836813 - timing_s/old_log_prob:2.1194562427699566 - timing_s/values:1.6193997268565 - timing_s/adv:0.03379968600347638 - timing_s/update_critic:5.455480094067752 - timing_s/update_actor:7.089802346657962 - timing_s/step:21.68897821661085 - timing_s/stop_profile:1.6861595213413239e-06 - timing_per_token_ms/values:0.016377093170207923 - timing_per_token_ms/adv:0.0003418183896308366 - timing_per_token_ms/update_actor:0.07169962527717848 - timing_per_token_ms/update_critic:0.055171619648346035 - timing_per_token_ms/gen:0.07431600064607123 - perf/total_num_tokens:98882 - perf/time_per_step:21.68897821661085 - perf/throughput:1139.7724573796386
[36m(TaskRunner pid=2914832)[0m Training Progress:  66%|██████▌   | 285/435 [1:45:51<54:44, 21.90s/it]
[36m(TaskRunner pid=2914832)[0m step:286 - global_seqlen/min:23376 - global_seqlen/max:25134 - global_seqlen/minmax_diff:1758 - global_seqlen/balanced_min:24370 - global_seqlen/balanced_max:24370 - global_seqlen/mean:24370.0 - actor/entropy:0.056260060518980026 - critic/vf_loss:0.08973717305343598 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6059825476258993 - critic/grad_norm:2.798436939716339 - perf/mfu/critic:0.09928522218748288 - critic/lr:1e-05 - actor/pg_loss:-0.10969431232661009 - actor/pg_clipfrac:0.0034897500881925225 - actor/ppo_kl:0.00046192185254767537 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.3094186186790466 - perf/mfu/actor:0.07708882615069024 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.22936630249023 - actor/lr:1e-06 - training/global_step:286 - training/epoch:9 - critic/score/mean:0.66796875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.66796875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-6.535670338259081e-10 - critic/advantages/max:1.8454523086547852 - critic/advantages/min:-2.0231688022613525 - critic/returns/mean:0.6122097969055176 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.578125 - critic/values/max:0.84375 - critic/values/min:0.138671875 - critic/vf_explained_var:0.2613157033920288 - response_length/mean:279.296875 - response_length/max:512.0 - response_length/min:116.0 - response_length/clip_ratio:0.02734375 - prompt_length/mean:101.484375 - prompt_length/max:191.0 - prompt_length/min:66.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.573725163936615e-06 - timing_s/generate_sequences:3.614537239074707 - timing_s/reshard:0.5817338228225708 - timing_s/gen:4.817584363743663 - timing_s/reward:0.03338503884151578 - timing_s/old_log_prob:2.079290662892163 - timing_s/values:1.3946621380746365 - timing_s/adv:0.034920784179121256 - timing_s/update_critic:5.279313600156456 - timing_s/update_actor:6.797480879351497 - timing_s/step:20.443683861754835 - timing_s/stop_profile:2.7581118047237396e-06 - timing_per_token_ms/values:0.0143071618596085 - timing_per_token_ms/adv:0.00035823537319574535 - timing_per_token_ms/update_actor:0.06973205662034773 - timing_per_token_ms/update_critic:0.054157915471444974 - timing_per_token_ms/gen:0.06737880229012116 - perf/total_num_tokens:97480 - perf/time_per_step:20.443683861754835 - perf/throughput:1192.0552168971049
[36m(TaskRunner pid=2914832)[0m Training Progress:  66%|██████▌   | 286/435 [1:46:11<53:18, 21.47s/it]
[36m(TaskRunner pid=2914832)[0m step:287 - global_seqlen/min:23689 - global_seqlen/max:24624 - global_seqlen/minmax_diff:935 - global_seqlen/balanced_min:24072 - global_seqlen/balanced_max:24073 - global_seqlen/mean:24072.25 - actor/entropy:0.054999567568302155 - critic/vf_loss:0.08302495710086077 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.7222933676093817 - critic/grad_norm:13.164179801940918 - perf/mfu/critic:0.09355909552514957 - critic/lr:1e-05 - actor/pg_loss:-0.03452969714999199 - actor/pg_clipfrac:0.0035357175656827167 - actor/ppo_kl:0.00020146638780715875 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.189980983734131 - perf/mfu/actor:0.07242266820404089 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.28704452514648 - actor/lr:1e-06 - training/global_step:287 - training/epoch:9 - critic/score/mean:0.75 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.75 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:1.0153702767468076e-08 - critic/advantages/max:2.2133560180664062 - critic/advantages/min:-2.8103184700012207 - critic/returns/mean:0.7049462795257568 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.6484375 - critic/values/max:1.0703125 - critic/values/min:-0.0576171875 - critic/vf_explained_var:0.32191014289855957 - response_length/mean:274.43359375 - response_length/max:512.0 - response_length/min:150.0 - response_length/clip_ratio:0.015625 - prompt_length/mean:101.6953125 - prompt_length/max:185.0 - prompt_length/min:63.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.1406601667404175e-06 - timing_s/generate_sequences:3.5420689582824707 - timing_s/reshard:0.8558451533317566 - timing_s/gen:5.000788661185652 - timing_s/reward:0.03673635609447956 - timing_s/old_log_prob:2.4616783731617033 - timing_s/values:1.7328864862211049 - timing_s/adv:0.03438522294163704 - timing_s/update_critic:5.532103268895298 - timing_s/update_actor:7.144131266046315 - timing_s/step:21.94958307268098 - timing_s/stop_profile:7.002148777246475e-06 - timing_per_token_ms/values:0.017996723262481747 - timing_per_token_ms/adv:0.0003571043726867767 - timing_per_token_ms/update_actor:0.07419467712870957 - timing_per_token_ms/update_critic:0.057453117893999296 - timing_per_token_ms/gen:0.07118053748751907 - perf/total_num_tokens:96289 - perf/time_per_step:21.94958307268098 - perf/throughput:1096.706480496249
[36m(TaskRunner pid=2914832)[0m Training Progress:  66%|██████▌   | 287/435 [1:46:33<53:18, 21.61s/it]
[36m(TaskRunner pid=2914832)[0m step:288 - global_seqlen/min:24046 - global_seqlen/max:25819 - global_seqlen/minmax_diff:1773 - global_seqlen/balanced_min:24820 - global_seqlen/balanced_max:24821 - global_seqlen/mean:24820.75 - actor/entropy:0.059941209852695465 - critic/vf_loss:0.07847001636400819 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6520594991743565 - critic/grad_norm:14.532854080200195 - perf/mfu/critic:0.10254732725512036 - critic/lr:1e-05 - actor/pg_loss:0.11795223061926663 - actor/pg_clipfrac:0.0038588647803408094 - actor/ppo_kl:-0.00019840799723169766 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.8659804463386536 - perf/mfu/actor:0.07803040761052343 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.21312713623047 - actor/lr:1e-06 - training/global_step:288 - training/epoch:9 - critic/score/mean:0.68359375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.68359375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:2.6380886808397008e-08 - critic/advantages/max:3.015284538269043 - critic/advantages/min:-2.950122117996216 - critic/returns/mean:0.6198633313179016 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.69921875 - critic/values/max:1.359375 - critic/values/min:-0.1533203125 - critic/vf_explained_var:0.3582441210746765 - response_length/mean:282.98828125 - response_length/max:512.0 - response_length/min:125.0 - response_length/clip_ratio:0.0390625 - prompt_length/mean:104.8359375 - prompt_length/max:212.0 - prompt_length/min:66.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:6.7157670855522156e-06 - timing_s/generate_sequences:3.554011583328247 - timing_s/reshard:0.8766322731971741 - timing_s/gen:5.122727972920984 - timing_s/reward:0.03527010278776288 - timing_s/old_log_prob:2.076219658832997 - timing_s/values:1.3426253949292004 - timing_s/adv:0.034488760866224766 - timing_s/update_critic:5.209800967015326 - timing_s/update_actor:6.8443397134542465 - timing_s/step:20.672557172831148 - timing_s/stop_profile:2.052169293165207e-06 - timing_per_token_ms/values:0.013523215403736797 - timing_per_token_ms/adv:0.0003473783111532162 - timing_per_token_ms/update_actor:0.06893768030231003 - timing_per_token_ms/update_critic:0.052474250042961294 - timing_per_token_ms/gen:0.07071196042405942 - perf/total_num_tokens:99283 - perf/time_per_step:20.672557172831148 - perf/throughput:1200.6618142346028
[36m(TaskRunner pid=2914832)[0m Training Progress:  66%|██████▌   | 288/435 [1:46:54<52:16, 21.33s/it]
[36m(TaskRunner pid=2914832)[0m step:289 - global_seqlen/min:22237 - global_seqlen/max:25259 - global_seqlen/minmax_diff:3022 - global_seqlen/balanced_min:23912 - global_seqlen/balanced_max:23913 - global_seqlen/mean:23912.25 - actor/entropy:0.051820456981658936 - critic/vf_loss:0.06755597377195954 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6622903570532799 - critic/grad_norm:6.295813024044037 - perf/mfu/critic:0.09328515794898178 - critic/lr:1e-05 - actor/pg_loss:0.10452107340097427 - actor/pg_clipfrac:0.003880526521243155 - actor/ppo_kl:0.00048169137409104223 - actor/pg_clipfrac_lower:5.781683648820035e-05 - actor/grad_norm:3.156034767627716 - perf/mfu/actor:0.0718304338077618 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.34707641601562 - actor/lr:1e-06 - training/global_step:289 - training/epoch:9 - critic/score/mean:0.69140625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.69140625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-7.168315274697079e-09 - critic/advantages/max:2.600564479827881 - critic/advantages/min:-3.0281386375427246 - critic/returns/mean:0.6204299926757812 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.60546875 - critic/values/max:1.2890625 - critic/values/min:-0.28515625 - critic/vf_explained_var:0.35840070247650146 - response_length/mean:271.27734375 - response_length/max:512.0 - response_length/min:119.0 - response_length/clip_ratio:0.01953125 - prompt_length/mean:102.3515625 - prompt_length/max:182.0 - prompt_length/min:66.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.979316145181656e-06 - timing_s/generate_sequences:3.4835147857666016 - timing_s/reshard:0.5880296230316162 - timing_s/gen:5.015738440211862 - timing_s/reward:0.03899775771424174 - timing_s/old_log_prob:2.127196211833507 - timing_s/values:1.626264892052859 - timing_s/adv:0.03938230033963919 - timing_s/update_critic:5.511970715131611 - timing_s/update_actor:7.154403793159872 - timing_s/step:21.521051560994238 - timing_s/stop_profile:2.169981598854065e-06 - timing_per_token_ms/values:0.017002424406453377 - timing_per_token_ms/adv:0.00041173771121119076 - timing_per_token_ms/update_actor:0.07479852160670653 - timing_per_token_ms/update_critic:0.057627060556112567 - timing_per_token_ms/gen:0.07222397569674517 - perf/total_num_tokens:95649 - perf/time_per_step:21.521051560994238 - perf/throughput:1111.1097397926262
[36m(TaskRunner pid=2914832)[0m Training Progress:  66%|██████▋   | 289/435 [1:47:15<52:03, 21.39s/it]
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 290}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and bakes muffins for her friends every day with four. She sells the remainder at the farmers' market daily for $2 per fresh duck egg. How much in dollars does she make every day at the farmers' market? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much Janet makes every day at the farmers' market, we need to follow these steps:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. Calculate the number of eggs laid by the ducks in a day.
[36m(TaskRunner pid=2914832)[0m 2. Subtract the number of eggs eaten in a day.
[36m(TaskRunner pid=2914832)[0m 3. Subtract the number of eggs baked in a day.
[36m(TaskRunner pid=2914832)[0m 4. Subtract the number of eggs sold from the remaining eggs.
[36m(TaskRunner pid=2914832)[0m 5. Determine the amount earned from selling the eggs.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Let's start with the first step:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. Janet's ducks lay 16 eggs per day.
[36m(TaskRunner pid=2914832)[0m 2. Janet eats 3 eggs for breakfast every morning. Therefore, the number of eggs eaten in a day is:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    3 \text{ eggs/day}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m 3. Janet bakes 4 muffins for her friends every day. Therefore, the number of eggs baked in a day is:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    4 \text{ eggs/day}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m 4. The number of eggs sold at the farmers' market is the remainder after subtracting the eggs eaten and the eggs baked from the total eggs laid. Therefore, the number of eggs sold is:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    16 \text{ eggs} - 3 \text{ eggs (eaten)} - 4 \text{ eggs (baked)} = 16 - 3 - 4 = 13 \text{ eggs/day}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m 5. Janet sells each egg for $2. Therefore, the total amount earned per day is:
[36m(TaskRunner pid=2914832)[0m    \[
[36m(TaskRunner pid=2914832)[0m    13 \text{ eggs/day} \times 2 \text{ dollars/egg} = 26 \text{ dollars/day}
[36m(TaskRunner pid=2914832)[0m    \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Thus, the final answer is:
[36m(TaskRunner pid=2914832)[0m #### 26
[36m(TaskRunner pid=2914832)[0m [ground_truth] 18
[36m(TaskRunner pid=2914832)[0m [score] 0.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1312
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 290}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Tom's restaurant gets 6 reservations a night.  They normally order 2 meals that cost $5 each and a $5 bottle of wine.  How much do they make a week if they are open 2 days a week? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much Tom's restaurant makes a week, we need to follow these steps:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. Calculate the number of reservations per night and the revenue from reservations.
[36m(TaskRunner pid=2914832)[0m 2. Calculate the revenue from meals and the revenue from the bottle of wine.
[36m(TaskRunner pid=2914832)[0m 3. Add the revenues together to find the total revenue for the week.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m First, Tom's restaurant gets 6 reservations a night. They normally order 2 meals that cost $5 each and a $5 bottle of wine. Therefore, the revenue from the meals per night is:
[36m(TaskRunner pid=2914832)[0m \[ 2 \times 5 = 10 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m The revenue from the wine per night is:
[36m(TaskRunner pid=2914832)[0m \[ 5 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m So, the total revenue from reservations per night is:
[36m(TaskRunner pid=2914832)[0m \[ 10 + 5 = 15 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m Since the restaurant is open 2 days a week, the total revenue for the week is:
[36m(TaskRunner pid=2914832)[0m \[ 2 \times 15 = 30 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Therefore, the final answer is:
[36m(TaskRunner pid=2914832)[0m #### 30
[36m(TaskRunner pid=2914832)[0m [ground_truth] 180
[36m(TaskRunner pid=2914832)[0m [score] 0.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1319
[36m(TaskRunner pid=2914832)[0m step:290 - global_seqlen/min:23605 - global_seqlen/max:24705 - global_seqlen/minmax_diff:1100 - global_seqlen/balanced_min:24139 - global_seqlen/balanced_max:24140 - global_seqlen/mean:24139.5 - actor/entropy:0.06001124531030655 - critic/vf_loss:0.06773331551812589 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.5881005823612213 - critic/grad_norm:12.318331211805344 - perf/mfu/critic:0.10061966899769073 - critic/lr:1e-05 - actor/pg_loss:-0.09567291778512299 - actor/pg_clipfrac:0.004266845891834237 - actor/ppo_kl:0.00037731538532170816 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.380288243293762 - perf/mfu/actor:0.07549273302906888 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.4128646850586 - actor/lr:1e-06 - val-core/openai/gsm8k/reward/mean@1:0.5481425322213799 - training/global_step:290 - training/epoch:9 - critic/score/mean:0.703125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.703125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-2.1052652954267614e-08 - critic/advantages/max:2.723527193069458 - critic/advantages/min:-3.0041518211364746 - critic/returns/mean:0.6166664361953735 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.53125 - critic/values/max:1.203125 - critic/values/min:-0.2421875 - critic/vf_explained_var:0.431581974029541 - response_length/mean:273.56640625 - response_length/max:512.0 - response_length/min:124.0 - response_length/clip_ratio:0.04296875 - prompt_length/mean:103.61328125 - prompt_length/max:183.0 - prompt_length/min:63.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.3441541492938995e-06 - timing_s/generate_sequences:3.553920030593872 - timing_s/reshard:0.8650784492492676 - timing_s/gen:4.962773059960455 - timing_s/reward:0.03562743589282036 - timing_s/old_log_prob:2.073637750931084 - timing_s/values:1.347736215684563 - timing_s/adv:0.03452382702380419 - timing_s/update_critic:5.162657746579498 - timing_s/update_actor:6.8765615238808095 - timing_s/testing:13.249141680076718 - timing_s/step:33.75041150301695 - timing_s/stop_profile:2.289190888404846e-06 - timing_per_token_ms/values:0.013957789263288002 - timing_per_token_ms/adv:0.0003575449680379066 - timing_per_token_ms/update_actor:0.07121690097020246 - timing_per_token_ms/update_critic:0.053466908454809524 - timing_per_token_ms/gen:0.07086335099111069 - perf/total_num_tokens:96558 - perf/time_per_step:33.75041150301695 - perf/throughput:715.2357238027207
[36m(TaskRunner pid=2914832)[0m Training Progress:  67%|██████▋   | 290/435 [1:47:49<1:00:40, 25.11s/it]
[36m(TaskRunner pid=2914832)[0m step:291 - global_seqlen/min:24070 - global_seqlen/max:24826 - global_seqlen/minmax_diff:756 - global_seqlen/balanced_min:24438 - global_seqlen/balanced_max:24439 - global_seqlen/mean:24438.75 - actor/entropy:0.07304786890745163 - critic/vf_loss:0.06815470790024847 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.5880761593580246 - critic/grad_norm:15.776063323020935 - perf/mfu/critic:0.0946795111378912 - critic/lr:1e-05 - actor/pg_loss:-0.08575246401596814 - actor/pg_clipfrac:0.004691481226473115 - actor/ppo_kl:-0.00012558745561364049 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.062962591648102 - perf/mfu/actor:0.07545967465790498 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.28274154663086 - actor/lr:1e-06 - training/global_step:291 - training/epoch:10 - critic/score/mean:0.65234375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.65234375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-3.534960413276167e-08 - critic/advantages/max:2.4621384143829346 - critic/advantages/min:-2.6002118587493896 - critic/returns/mean:0.579797625541687 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.68359375 - critic/values/max:1.2109375 - critic/values/min:-0.040771484375 - critic/vf_explained_var:0.36687082052230835 - response_length/mean:277.58203125 - response_length/max:512.0 - response_length/min:117.0 - response_length/clip_ratio:0.03515625 - prompt_length/mean:104.2734375 - prompt_length/max:196.0 - prompt_length/min:65.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:1.1374708265066147e-05 - timing_s/generate_sequences:3.53926420211792 - timing_s/reshard:0.3028694987297058 - timing_s/gen:4.3787216120399535 - timing_s/reward:0.03435445902869105 - timing_s/old_log_prob:2.092103488277644 - timing_s/values:1.3403743840754032 - timing_s/adv:0.036181359086185694 - timing_s/update_critic:5.553558497224003 - timing_s/update_actor:6.967734143137932 - timing_s/step:20.41374143306166 - timing_s/stop_profile:2.1401792764663696e-06 - timing_per_token_ms/values:0.013711568554809506 - timing_per_token_ms/adv:0.00037012284881781694 - timing_per_token_ms/update_actor:0.07127752179569262 - timing_per_token_ms/update_critic:0.05681099173672961 - timing_per_token_ms/gen:0.06161919494575018 - perf/total_num_tokens:97755 - perf/time_per_step:20.41374143306166 - perf/throughput:1197.1715268431647
[36m(TaskRunner pid=2914832)[0m Training Progress:  67%|██████▋   | 291/435 [1:48:10<57:12, 23.84s/it]  
[36m(TaskRunner pid=2914832)[0m step:292 - global_seqlen/min:23437 - global_seqlen/max:25820 - global_seqlen/minmax_diff:2383 - global_seqlen/balanced_min:24211 - global_seqlen/balanced_max:24212 - global_seqlen/mean:24211.25 - actor/entropy:0.06106497719883919 - critic/vf_loss:0.08716958059812896 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.46895763417705894 - critic/grad_norm:38.84031391143799 - perf/mfu/critic:0.10089117175780399 - critic/lr:1e-05 - actor/pg_loss:-0.06202476378530264 - actor/pg_clipfrac:0.0033454638978582807 - actor/ppo_kl:0.0005176538511477702 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.206791937351227 - perf/mfu/actor:0.07648023801655703 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.54565048217773 - actor/lr:1e-06 - training/global_step:292 - training/epoch:10 - critic/score/mean:0.734375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.734375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-4.416277477048425e-08 - critic/advantages/max:2.5461113452911377 - critic/advantages/min:-2.9782192707061768 - critic/returns/mean:0.6767406463623047 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.365234375 - critic/values/max:0.88671875 - critic/values/min:-0.31640625 - critic/vf_explained_var:0.38381052017211914 - response_length/mean:274.40234375 - response_length/max:512.0 - response_length/min:116.0 - response_length/clip_ratio:0.03125 - prompt_length/mean:103.8984375 - prompt_length/max:184.0 - prompt_length/min:65.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.993045538663864e-06 - timing_s/generate_sequences:3.507963180541992 - timing_s/reshard:0.8607718348503113 - timing_s/gen:5.1350856511853635 - timing_s/reward:0.03524250024929643 - timing_s/old_log_prob:2.080078763887286 - timing_s/values:1.3472546259872615 - timing_s/adv:0.03415304096415639 - timing_s/update_critic:5.162567782681435 - timing_s/update_actor:6.807464416138828 - timing_s/step:20.60936383716762 - timing_s/stop_profile:1.969747245311737e-06 - timing_per_token_ms/values:0.013911452589057375 - timing_per_token_ms/adv:0.00035265672945589745 - timing_per_token_ms/update_actor:0.07029236838390034 - timing_per_token_ms/update_critic:0.05330753041129057 - timing_per_token_ms/gen:0.07310042636960103 - perf/total_num_tokens:96845 - perf/time_per_step:20.60936383716762 - perf/throughput:1174.7694005157314
[36m(TaskRunner pid=2914832)[0m Training Progress:  67%|██████▋   | 292/435 [1:48:31<54:30, 22.87s/it]
[36m(TaskRunner pid=2914832)[0m step:293 - global_seqlen/min:23393 - global_seqlen/max:24425 - global_seqlen/minmax_diff:1032 - global_seqlen/balanced_min:23974 - global_seqlen/balanced_max:23975 - global_seqlen/mean:23974.25 - actor/entropy:0.055280834436416626 - critic/vf_loss:0.06978149135829881 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.8456756547093391 - critic/grad_norm:27.468615531921387 - perf/mfu/critic:0.09994483174561115 - critic/lr:1e-05 - actor/pg_loss:0.0016326486365869641 - actor/pg_clipfrac:0.004458253748452989 - actor/ppo_kl:0.0004344063618191285 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.8584299087524414 - perf/mfu/actor:0.07582127476891323 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.02215957641602 - actor/lr:1e-06 - training/global_step:293 - training/epoch:10 - critic/score/mean:0.71875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.71875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:1.7827494147582e-08 - critic/advantages/max:2.7431559562683105 - critic/advantages/min:-2.988436698913574 - critic/returns/mean:0.6660348773002625 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.7578125 - critic/values/max:1.2265625 - critic/values/min:0.03076171875 - critic/vf_explained_var:0.4632630944252014 - response_length/mean:269.98046875 - response_length/max:512.0 - response_length/min:133.0 - response_length/clip_ratio:0.01953125 - prompt_length/mean:104.6171875 - prompt_length/max:222.0 - prompt_length/min:71.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.534369170665741e-06 - timing_s/generate_sequences:3.59073805809021 - timing_s/reshard:0.6982012391090393 - timing_s/gen:5.213031406980008 - timing_s/reward:0.039147650357335806 - timing_s/old_log_prob:2.138271937146783 - timing_s/values:1.5091012818738818 - timing_s/adv:0.035270067397505045 - timing_s/update_critic:5.158464609179646 - timing_s/update_actor:6.796819339971989 - timing_s/step:20.902347422670573 - timing_s/stop_profile:2.323184162378311e-06 - timing_per_token_ms/values:0.01573668917561427 - timing_per_token_ms/adv:0.0003677911446396138 - timing_per_token_ms/update_actor:0.07087624576339187 - timing_per_token_ms/update_critic:0.05379172037894455 - timing_per_token_ms/gen:0.07542547069348199 - perf/total_num_tokens:95897 - perf/time_per_step:20.902347422670573 - perf/throughput:1146.964477970434
[36m(TaskRunner pid=2914832)[0m Training Progress:  67%|██████▋   | 293/435 [1:48:51<52:44, 22.29s/it]
[36m(TaskRunner pid=2914832)[0m step:294 - global_seqlen/min:22617 - global_seqlen/max:24825 - global_seqlen/minmax_diff:2208 - global_seqlen/balanced_min:23524 - global_seqlen/balanced_max:23525 - global_seqlen/mean:23524.75 - actor/entropy:0.0547582283616066 - critic/vf_loss:0.08533944992814213 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6133035449311137 - critic/grad_norm:17.102105617523193 - perf/mfu/critic:0.09455936340019583 - critic/lr:1e-05 - actor/pg_loss:0.023875572718679905 - actor/pg_clipfrac:0.0036719369018101133 - actor/ppo_kl:2.110645618813578e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.938638746738434 - perf/mfu/actor:0.07269605382655789 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.09607315063477 - actor/lr:1e-06 - training/global_step:294 - training/epoch:10 - critic/score/mean:0.69921875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.69921875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-5.9941465124779825e-09 - critic/advantages/max:2.639726400375366 - critic/advantages/min:-2.779585838317871 - critic/returns/mean:0.6379302740097046 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.75390625 - critic/values/max:1.234375 - critic/values/min:0.078125 - critic/vf_explained_var:0.3589082360267639 - response_length/mean:264.75390625 - response_length/max:512.0 - response_length/min:124.0 - response_length/clip_ratio:0.015625 - prompt_length/mean:102.8203125 - prompt_length/max:189.0 - prompt_length/min:70.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.070150554180145e-06 - timing_s/generate_sequences:3.5716824531555176 - timing_s/reshard:0.5829039216041565 - timing_s/gen:4.875276857987046 - timing_s/reward:0.033516026102006435 - timing_s/old_log_prob:2.0787174277938902 - timing_s/values:1.3445043610408902 - timing_s/adv:0.03438327740877867 - timing_s/update_critic:5.34928719419986 - timing_s/update_actor:6.952693668194115 - timing_s/step:20.676236688625067 - timing_s/stop_profile:2.325046807527542e-06 - timing_per_token_ms/values:0.01428818968364053 - timing_per_token_ms/adv:0.0003653947162964396 - timing_per_token_ms/update_actor:0.07388700908823809 - timing_per_token_ms/update_critic:0.056847439337292215 - timing_per_token_ms/gen:0.071931139737478 - perf/total_num_tokens:94099 - perf/time_per_step:20.676236688625067 - perf/throughput:1137.7674938758091
[36m(TaskRunner pid=2914832)[0m Training Progress:  68%|██████▊   | 294/435 [1:49:12<51:14, 21.81s/it]
[36m(TaskRunner pid=2914832)[0m step:295 - global_seqlen/min:22273 - global_seqlen/max:23914 - global_seqlen/minmax_diff:1641 - global_seqlen/balanced_min:23231 - global_seqlen/balanced_max:23232 - global_seqlen/mean:23231.5 - actor/entropy:0.05367407947778702 - critic/vf_loss:0.05642996326787397 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6382761187851429 - critic/grad_norm:11.80120250582695 - perf/mfu/critic:0.09622723044493903 - critic/lr:1e-05 - actor/pg_loss:-0.05348295718431473 - actor/pg_clipfrac:0.003058430454984773 - actor/ppo_kl:-2.6617203729983885e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.017169773578644 - perf/mfu/actor:0.0735206962313003 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.30615997314453 - actor/lr:1e-06 - training/global_step:295 - training/epoch:10 - critic/score/mean:0.6875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.6875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.717790532040908e-08 - critic/advantages/max:2.8355329036712646 - critic/advantages/min:-2.7767810821533203 - critic/returns/mean:0.6275649070739746 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.57421875 - critic/values/max:1.046875 - critic/values/min:-0.08056640625 - critic/vf_explained_var:0.4403947591781616 - response_length/mean:260.23828125 - response_length/max:512.0 - response_length/min:128.0 - response_length/clip_ratio:0.00390625 - prompt_length/mean:102.75390625 - prompt_length/max:212.0 - prompt_length/min:66.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.3120235204696655e-06 - timing_s/generate_sequences:3.292639970779419 - timing_s/reshard:0.9537470936775208 - timing_s/gen:4.841818217653781 - timing_s/reward:0.034157510846853256 - timing_s/old_log_prob:2.070527760311961 - timing_s/values:1.3407606510445476 - timing_s/adv:0.03428609995171428 - timing_s/update_critic:5.186611191835254 - timing_s/update_actor:6.785044373944402 - timing_s/step:20.299755121115595 - timing_s/stop_profile:2.278946340084076e-06 - timing_per_token_ms/values:0.014428261746384731 - timing_per_token_ms/adv:0.00036896132354469446 - timing_per_token_ms/update_actor:0.07301556479289328 - timing_per_token_ms/update_critic:0.05581442429282714 - timing_per_token_ms/gen:0.0726770570488852 - perf/total_num_tokens:92926 - perf/time_per_step:20.299755121115595 - perf/throughput:1144.422672164889
[36m(TaskRunner pid=2914832)[0m Training Progress:  68%|██████▊   | 295/435 [1:49:32<49:50, 21.36s/it]
[36m(TaskRunner pid=2914832)[0m step:296 - global_seqlen/min:23032 - global_seqlen/max:24044 - global_seqlen/minmax_diff:1012 - global_seqlen/balanced_min:23441 - global_seqlen/balanced_max:23441 - global_seqlen/mean:23441.0 - actor/entropy:0.05233702063560486 - critic/vf_loss:0.06253899709554389 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6122274352237582 - critic/grad_norm:10.635339558124542 - perf/mfu/critic:0.09188019683950825 - critic/lr:1e-05 - actor/pg_loss:0.006169224623590708 - actor/pg_clipfrac:0.0034318979451199993 - actor/ppo_kl:0.00018595285473566037 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.874805986881256 - perf/mfu/actor:0.07079113152611652 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.59687423706055 - actor/lr:1e-06 - training/global_step:296 - training/epoch:10 - critic/score/mean:0.69921875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.69921875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-5.351084908511439e-09 - critic/advantages/max:2.9782330989837646 - critic/advantages/min:-3.1883320808410645 - critic/returns/mean:0.6354031562805176 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.71484375 - critic/values/max:1.328125 - critic/values/min:-0.2392578125 - critic/vf_explained_var:0.4196159243583679 - response_length/mean:261.76171875 - response_length/max:512.0 - response_length/min:118.0 - response_length/clip_ratio:0.015625 - prompt_length/mean:104.50390625 - prompt_length/max:202.0 - prompt_length/min:69.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.8140063881874084e-06 - timing_s/generate_sequences:3.472872018814087 - timing_s/reshard:0.8815934062004089 - timing_s/gen:5.311457756906748 - timing_s/reward:0.03371742181479931 - timing_s/old_log_prob:2.126479763071984 - timing_s/values:1.6342427786439657 - timing_s/adv:0.03479639068245888 - timing_s/update_critic:5.482311058789492 - timing_s/update_actor:7.114882863592356 - timing_s/step:21.744872679002583 - timing_s/stop_profile:2.221670001745224e-06 - timing_per_token_ms/values:0.017429320193720038 - timing_per_token_ms/adv:0.00037110608210463375 - timing_per_token_ms/update_actor:0.0758807523526338 - timing_per_token_ms/update_critic:0.05846925321860726 - timing_per_token_ms/gen:0.07926247566678228 - perf/total_num_tokens:93764 - perf/time_per_step:21.744872679002583 - perf/throughput:1078.001253262579
[36m(TaskRunner pid=2914832)[0m Training Progress:  68%|██████▊   | 296/435 [1:49:54<49:45, 21.48s/it]
[36m(TaskRunner pid=2914832)[0m step:297 - global_seqlen/min:24173 - global_seqlen/max:24659 - global_seqlen/minmax_diff:486 - global_seqlen/balanced_min:24484 - global_seqlen/balanced_max:24484 - global_seqlen/mean:24484.0 - actor/entropy:0.05859164521098137 - critic/vf_loss:0.07259151362814009 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6331996954977512 - critic/grad_norm:15.963173508644104 - perf/mfu/critic:0.09768056343111996 - critic/lr:1e-05 - actor/pg_loss:0.13261876243632287 - actor/pg_clipfrac:0.0036674424045486376 - actor/ppo_kl:0.00021150353859411553 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.7390090227127075 - perf/mfu/actor:0.07707141478023613 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.41358184814453 - actor/lr:1e-06 - training/global_step:297 - training/epoch:10 - critic/score/mean:0.70703125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.70703125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:4.878231596450178e-09 - critic/advantages/max:2.9712073802948 - critic/advantages/min:-3.2180697917938232 - critic/returns/mean:0.6335178017616272 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.50390625 - critic/values/max:1.125 - critic/values/min:-0.353515625 - critic/vf_explained_var:0.3997761607170105 - response_length/mean:280.26171875 - response_length/max:512.0 - response_length/min:134.0 - response_length/clip_ratio:0.046875 - prompt_length/mean:102.30078125 - prompt_length/max:256.0 - prompt_length/min:70.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.78584149479866e-06 - timing_s/generate_sequences:3.5556299686431885 - timing_s/reshard:0.9577776193618774 - timing_s/gen:5.105434212833643 - timing_s/reward:0.035364650189876556 - timing_s/old_log_prob:2.074648927897215 - timing_s/values:1.3441721093840897 - timing_s/adv:0.03657921031117439 - timing_s/update_critic:5.394798436202109 - timing_s/update_actor:6.835528876166791 - timing_s/step:20.835789334960282 - timing_s/stop_profile:1.778826117515564e-06 - timing_per_token_ms/values:0.01372500520119353 - timing_per_token_ms/adv:0.0003735011672028099 - timing_per_token_ms/update_actor:0.06979587563476955 - timing_per_token_ms/update_critic:0.055084937471431436 - timing_per_token_ms/gen:0.07115885281382696 - perf/total_num_tokens:97936 - perf/time_per_step:20.835789334960282 - perf/throughput:1175.0934704891838
[36m(TaskRunner pid=2914832)[0m Training Progress:  68%|██████▊   | 297/435 [1:50:15<48:57, 21.29s/it]
[36m(TaskRunner pid=2914832)[0m step:298 - global_seqlen/min:23465 - global_seqlen/max:23818 - global_seqlen/minmax_diff:353 - global_seqlen/balanced_min:23624 - global_seqlen/balanced_max:23625 - global_seqlen/mean:23624.75 - actor/entropy:0.0529252253472805 - critic/vf_loss:0.06753889692481607 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.675685590133071 - critic/grad_norm:16.611308872699738 - perf/mfu/critic:0.0983168198946711 - critic/lr:1e-05 - actor/pg_loss:-0.06808558758348227 - actor/pg_clipfrac:0.0033803775877458975 - actor/ppo_kl:0.0005613695011561504 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.934880256652832 - perf/mfu/actor:0.07350852333912211 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.56900024414062 - actor/lr:1e-06 - training/global_step:298 - training/epoch:10 - critic/score/mean:0.64453125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.64453125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.3339573889936673e-08 - critic/advantages/max:2.5544443130493164 - critic/advantages/min:-2.569284677505493 - critic/returns/mean:0.5880215764045715 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.7890625 - critic/values/max:1.21875 - critic/values/min:0.09716796875 - critic/vf_explained_var:0.39299577474594116 - response_length/mean:265.58203125 - response_length/max:512.0 - response_length/min:115.0 - response_length/clip_ratio:0.03515625 - prompt_length/mean:103.5546875 - prompt_length/max:191.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.7937425076961517e-06 - timing_s/generate_sequences:3.560235023498535 - timing_s/reshard:0.5867704153060913 - timing_s/gen:5.001479143742472 - timing_s/reward:0.034737114794552326 - timing_s/old_log_prob:2.1340179559774697 - timing_s/values:1.6178539032116532 - timing_s/adv:0.033945959992706776 - timing_s/update_critic:5.166850212030113 - timing_s/update_actor:6.906776794232428 - timing_s/step:20.90284533519298 - timing_s/stop_profile:8.555129170417786e-06 - timing_per_token_ms/values:0.017120328291427987 - timing_per_token_ms/adv:0.0003592203091324435 - timing_per_token_ms/update_actor:0.07308835854593623 - timing_per_token_ms/update_critic:0.05467624220393986 - timing_per_token_ms/gen:0.0735630637859429 - perf/total_num_tokens:94499 - perf/time_per_step:20.90284533519298 - perf/throughput:1130.2169451650823
[36m(TaskRunner pid=2914832)[0m Training Progress:  69%|██████▊   | 298/435 [1:50:36<48:21, 21.18s/it]
[36m(TaskRunner pid=2914832)[0m step:299 - global_seqlen/min:22945 - global_seqlen/max:23907 - global_seqlen/minmax_diff:962 - global_seqlen/balanced_min:23535 - global_seqlen/balanced_max:23536 - global_seqlen/mean:23535.25 - actor/entropy:0.05508725717663765 - critic/vf_loss:0.07429590111132711 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.45047247782349586 - critic/grad_norm:32.65098428726196 - perf/mfu/critic:0.09544991324167004 - critic/lr:1e-05 - actor/pg_loss:0.11340472800657153 - actor/pg_clipfrac:0.003354479602421634 - actor/ppo_kl:0.0005445029952397817 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.2682201862335205 - perf/mfu/actor:0.07075824806299709 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.18845748901367 - actor/lr:1e-06 - training/global_step:299 - training/epoch:10 - critic/score/mean:0.71484375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.71484375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-7.796529644110706e-09 - critic/advantages/max:2.2433440685272217 - critic/advantages/min:-2.644291400909424 - critic/returns/mean:0.6572312116622925 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.45703125 - critic/values/max:0.8125 - critic/values/min:-0.162109375 - critic/vf_explained_var:0.44501519203186035 - response_length/mean:263.9921875 - response_length/max:512.0 - response_length/min:117.0 - response_length/clip_ratio:0.01171875 - prompt_length/mean:103.74609375 - prompt_length/max:165.0 - prompt_length/min:70.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.627050995826721e-06 - timing_s/generate_sequences:3.4195094108581543 - timing_s/reshard:0.5805990695953369 - timing_s/gen:4.612665351945907 - timing_s/reward:0.03321316000074148 - timing_s/old_log_prob:2.075244944076985 - timing_s/values:1.3415981163270772 - timing_s/adv:0.03400059184059501 - timing_s/update_critic:5.299158038105816 - timing_s/update_actor:7.143861003220081 - timing_s/step:20.54656131612137 - timing_s/stop_profile:4.305969923734665e-06 - timing_per_token_ms/values:0.014250943970502514 - timing_per_token_ms/adv:0.000361166673825379 - timing_per_token_ms/update_actor:0.07588469426944776 - timing_per_token_ms/update_critic:0.05628958730102523 - timing_per_token_ms/gen:0.06825286839611001 - perf/total_num_tokens:94141 - perf/time_per_step:20.54656131612137 - perf/throughput:1145.4593125290326
[36m(TaskRunner pid=2914832)[0m Training Progress:  69%|██████▊   | 299/435 [1:50:57<47:35, 21.00s/it]
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 300}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and bakes muffins for her friends every day with four. She sells the remainder at the farmers' market daily for $2 per fresh duck egg. How much in dollars does she make every day at the farmers' market? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much Janet makes every day at the farmers' market, we need to follow these steps:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. Calculate the number of eggs Janet lays in a day.
[36m(TaskRunner pid=2914832)[0m 2. Subtract the number of eggs she eats in a day.
[36m(TaskRunner pid=2914832)[0m 3. Subtract the number of muffins she bakes in a day.
[36m(TaskRunner pid=2914832)[0m 4. Subtract the number of eggs sold from the remainder.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Let's start with the number of eggs Janet lays in a day. She lays 16 eggs per day.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Next, Janet eats 3 eggs for breakfast every morning. So, the number of eggs she eats in a day is:
[36m(TaskRunner pid=2914832)[0m \[ 3 \text{ eggs} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Then, Janet bakes 4 muffins every day. So, the number of eggs she bakes in a day is:
[36m(TaskRunner pid=2914832)[0m \[ 4 \text{ eggs} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m The number of eggs she sells at the farmers' market is the remainder after subtracting the eggs she eats and the eggs she bakes. Therefore, the number of eggs sold is:
[36m(TaskRunner pid=2914832)[0m \[ 16 \text{ eggs} - 3 \text{ eggs} - 4 \text{ eggs} = 7 \text{ eggs} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Since she sells each egg for $2, the total amount of money she makes every day is:
[36m(TaskRunner pid=2914832)[0m \[ 7 \text{ eggs} \times 2 \text{ dollars per egg} = 14 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Thus, the final answer is:
[36m(TaskRunner pid=2914832)[0m #### 14
[36m(TaskRunner pid=2914832)[0m [ground_truth] 18
[36m(TaskRunner pid=2914832)[0m [score] 0.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1312
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 300}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Tom's restaurant gets 6 reservations a night.  They normally order 2 meals that cost $5 each and a $5 bottle of wine.  How much do they make a week if they are open 2 days a week? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much Tom's restaurant makes a week, we need to follow these steps:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. Calculate the number of reservations per night and the revenue from reservations.
[36m(TaskRunner pid=2914832)[0m 2. Calculate the revenue from meals and the revenue from the bottle of wine.
[36m(TaskRunner pid=2914832)[0m 3. Add the revenues together to find the total revenue for the week.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m First, Tom's restaurant gets 6 reservations a night. They normally order 2 meals that cost $5 each and a $5 bottle of wine. Therefore, the revenue from the meals per night is:
[36m(TaskRunner pid=2914832)[0m \[ 2 \times 5 = 10 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m The revenue from the bottle of wine per night is:
[36m(TaskRunner pid=2914832)[0m \[ 5 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m So, the total revenue from reservations per night is:
[36m(TaskRunner pid=2914832)[0m \[ 10 + 5 = 15 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m Since the restaurant is open 2 days a week, the total revenue for the week is:
[36m(TaskRunner pid=2914832)[0m \[ 2 \times 15 = 30 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Therefore, the final answer is:
[36m(TaskRunner pid=2914832)[0m #### 30
[36m(TaskRunner pid=2914832)[0m [ground_truth] 180
[36m(TaskRunner pid=2914832)[0m [score] 0.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1319
[36m(TaskRunner pid=2914832)[0m step:300 - global_seqlen/min:22858 - global_seqlen/max:23700 - global_seqlen/minmax_diff:842 - global_seqlen/balanced_min:23282 - global_seqlen/balanced_max:23283 - global_seqlen/mean:23282.75 - actor/entropy:0.053108781576156616 - critic/vf_loss:0.12768057372886688 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.8403058759868145 - critic/grad_norm:33.57046377658844 - perf/mfu/critic:0.09604602598172993 - critic/lr:1e-05 - actor/pg_loss:0.10386269985247054 - actor/pg_clipfrac:0.004164858866715804 - actor/ppo_kl:0.0003353797333147668 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.1929964423179626 - perf/mfu/actor:0.07273619016547556 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.15547180175781 - actor/lr:1e-06 - val-core/openai/gsm8k/reward/mean@1:0.5458680818802123 - training/global_step:300 - training/epoch:10 - critic/score/mean:0.71484375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.71484375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-5.962510041257474e-09 - critic/advantages/max:2.1091017723083496 - critic/advantages/min:-2.422231674194336 - critic/returns/mean:0.6589521765708923 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.6640625 - critic/values/max:1.0078125 - critic/values/min:0.05078125 - critic/vf_explained_var:0.3274475932121277 - response_length/mean:261.78515625 - response_length/max:512.0 - response_length/min:132.0 - response_length/clip_ratio:0.02734375 - prompt_length/mean:102.0078125 - prompt_length/max:193.0 - prompt_length/min:70.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:6.0158781707286835e-06 - timing_s/generate_sequences:3.505258083343506 - timing_s/reshard:0.8739291429519653 - timing_s/gen:4.898359851911664 - timing_s/reward:0.03325325716286898 - timing_s/old_log_prob:2.0718792700208724 - timing_s/values:1.3538563521578908 - timing_s/adv:0.033807871863245964 - timing_s/update_critic:5.208627026062459 - timing_s/update_actor:6.874063184019178 - timing_s/testing:13.76139557082206 - timing_s/step:34.2418368733488 - timing_s/stop_profile:2.469867467880249e-06 - timing_per_token_ms/values:0.01453711816857857 - timing_per_token_ms/adv:0.00036301416137747865 - timing_per_token_ms/update_actor:0.07381068799883152 - timing_per_token_ms/update_critic:0.05592796196822174 - timing_per_token_ms/gen:0.07309130298150714 - perf/total_num_tokens:93131 - perf/time_per_step:34.2418368733488 - perf/throughput:679.9503801772238
[36m(TaskRunner pid=2914832)[0m Training Progress:  69%|██████▉   | 300/435 [1:51:31<56:11, 24.97s/it]
[36m(TaskRunner pid=2914832)[0m step:301 - global_seqlen/min:22390 - global_seqlen/max:24665 - global_seqlen/minmax_diff:2275 - global_seqlen/balanced_min:23222 - global_seqlen/balanced_max:23223 - global_seqlen/mean:23222.5 - actor/entropy:0.05847930163145065 - critic/vf_loss:0.09551172732608393 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.7629726398736238 - critic/grad_norm:24.48671245574951 - perf/mfu/critic:0.08735196987402276 - critic/lr:1e-05 - actor/pg_loss:0.056874859146773815 - actor/pg_clipfrac:0.0038684095634380355 - actor/ppo_kl:0.0002569984328602004 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.050636053085327 - perf/mfu/actor:0.07276381547298136 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.60892868041992 - actor/lr:1e-06 - training/global_step:301 - training/epoch:10 - critic/score/mean:0.6875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.6875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:1.636079716149652e-08 - critic/advantages/max:2.341526508331299 - critic/advantages/min:-2.4323365688323975 - critic/returns/mean:0.620883584022522 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.9453125 - critic/values/max:1.296875 - critic/values/min:0.298828125 - critic/vf_explained_var:0.37303459644317627 - response_length/mean:260.484375 - response_length/max:512.0 - response_length/min:125.0 - response_length/clip_ratio:0.03125 - prompt_length/mean:102.3671875 - prompt_length/max:173.0 - prompt_length/min:66.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:6.919726729393005e-06 - timing_s/generate_sequences:3.480424642562866 - timing_s/reshard:0.3025667369365692 - timing_s/gen:4.307559530250728 - timing_s/reward:0.03387934993952513 - timing_s/old_log_prob:2.0738363810814917 - timing_s/values:1.3444334510713816 - timing_s/adv:0.03432358894497156 - timing_s/update_critic:5.712222810834646 - timing_s/update_actor:6.856550759170204 - timing_s/step:20.37122118473053 - timing_s/stop_profile:1.8379651010036469e-06 - timing_per_token_ms/values:0.014473392734108963 - timing_per_token_ms/adv:0.0003695079012269519 - timing_per_token_ms/update_actor:0.07381365872720642 - timing_per_token_ms/update_critic:0.06149448606776452 - timing_per_token_ms/gen:0.06459659783832296 - perf/total_num_tokens:92890 - perf/time_per_step:20.37122118473053 - perf/throughput:1139.9660231172925
[36m(TaskRunner pid=2914832)[0m Training Progress:  69%|██████▉   | 301/435 [1:51:51<52:41, 23.60s/it]
[36m(TaskRunner pid=2914832)[0m step:302 - global_seqlen/min:22778 - global_seqlen/max:26174 - global_seqlen/minmax_diff:3396 - global_seqlen/balanced_min:24153 - global_seqlen/balanced_max:24154 - global_seqlen/mean:24153.75 - actor/entropy:0.055055249482393265 - critic/vf_loss:0.09160893864464015 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.41239172453060746 - critic/grad_norm:22.891483068466187 - perf/mfu/critic:0.10099727312167155 - critic/lr:1e-05 - actor/pg_loss:-0.050627360586076975 - actor/pg_clipfrac:0.0034720348339760676 - actor/ppo_kl:0.0004028071380162146 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.1577207446098328 - perf/mfu/actor:0.07620666240025525 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.61105346679688 - actor/lr:1e-06 - training/global_step:302 - training/epoch:10 - critic/score/mean:0.62890625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.62890625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:3.398378822794257e-08 - critic/advantages/max:2.443120002746582 - critic/advantages/min:-2.51053524017334 - critic/returns/mean:0.551556408405304 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.408203125 - critic/values/max:0.83203125 - critic/values/min:-0.2109375 - critic/vf_explained_var:0.42921483516693115 - response_length/mean:273.0625 - response_length/max:512.0 - response_length/min:132.0 - response_length/clip_ratio:0.0390625 - prompt_length/mean:104.33984375 - prompt_length/max:211.0 - prompt_length/min:65.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.325768142938614e-06 - timing_s/generate_sequences:3.49761700630188 - timing_s/reshard:0.8895246386528015 - timing_s/gen:4.883259409107268 - timing_s/reward:0.03924900386482477 - timing_s/old_log_prob:2.0733825536444783 - timing_s/values:1.3449119087308645 - timing_s/adv:0.03526500891894102 - timing_s/update_critic:5.145873030181974 - timing_s/update_actor:6.815572293009609 - timing_s/step:20.344669649843127 - timing_s/stop_profile:2.013053745031357e-06 - timing_per_token_ms/values:0.01392032198655348 - timing_per_token_ms/adv:0.0003650055262530769 - timing_per_token_ms/update_actor:0.07054362462360513 - timing_per_token_ms/update_critic:0.0532616367042589 - timing_per_token_ms/gen:0.0698566521101406 - perf/total_num_tokens:96615 - perf/time_per_step:20.344669649843127 - perf/throughput:1187.227436754484
[36m(TaskRunner pid=2914832)[0m Training Progress:  69%|██████▉   | 302/435 [1:52:12<50:08, 22.62s/it]
[36m(TaskRunner pid=2914832)[0m step:303 - global_seqlen/min:22600 - global_seqlen/max:25698 - global_seqlen/minmax_diff:3098 - global_seqlen/balanced_min:23707 - global_seqlen/balanced_max:23708 - global_seqlen/mean:23707.75 - actor/entropy:0.05289742350578308 - critic/vf_loss:0.10023941192775965 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.8735160455107689 - critic/grad_norm:33.33318603038788 - perf/mfu/critic:0.09438617650695554 - critic/lr:1e-05 - actor/pg_loss:0.1515590058406815 - actor/pg_clipfrac:0.0040688728768145666 - actor/ppo_kl:-0.00016228132608375745 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.918618679046631 - perf/mfu/actor:0.07099493388046353 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.45648574829102 - actor/lr:1e-06 - training/global_step:303 - training/epoch:10 - critic/score/mean:0.71875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.71875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.651203263008938e-08 - critic/advantages/max:2.2025434970855713 - critic/advantages/min:-2.5855610370635986 - critic/returns/mean:0.6452211141586304 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.6484375 - critic/values/max:1.0703125 - critic/values/min:-0.087890625 - critic/vf_explained_var:0.32174134254455566 - response_length/mean:267.57421875 - response_length/max:512.0 - response_length/min:128.0 - response_length/clip_ratio:0.0390625 - prompt_length/mean:102.859375 - prompt_length/max:215.0 - prompt_length/min:66.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.093403160572052e-06 - timing_s/generate_sequences:3.4968948364257812 - timing_s/reshard:0.7841958999633789 - timing_s/gen:5.1911036293022335 - timing_s/reward:0.03421439463272691 - timing_s/old_log_prob:2.138373511377722 - timing_s/values:1.6095177959650755 - timing_s/adv:0.03582643764093518 - timing_s/update_critic:5.402081617154181 - timing_s/update_actor:7.179434741847217 - timing_s/step:21.59873978001997 - timing_s/stop_profile:3.6428682506084442e-06 - timing_per_token_ms/values:0.01697248574796296 - timing_per_token_ms/adv:0.0003777924691391547 - timing_per_token_ms/update_actor:0.0757076772558258 - timing_per_token_ms/update_critic:0.0569653553917409 - timing_per_token_ms/gen:0.07578364106486567 - perf/total_num_tokens:94831 - perf/time_per_step:21.59873978001997 - perf/throughput:1097.64505899233
[36m(TaskRunner pid=2914832)[0m Training Progress:  70%|██████▉   | 303/435 [1:52:33<49:06, 22.32s/it]
[36m(TaskRunner pid=2914832)[0m step:304 - global_seqlen/min:22529 - global_seqlen/max:23908 - global_seqlen/minmax_diff:1379 - global_seqlen/balanced_min:23157 - global_seqlen/balanced_max:23158 - global_seqlen/mean:23157.25 - actor/entropy:0.05192435532808304 - critic/vf_loss:0.0922975861467421 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.8100937772542238 - critic/grad_norm:28.558218955993652 - perf/mfu/critic:0.09009532839489835 - critic/lr:1e-05 - actor/pg_loss:-0.04823350056540221 - actor/pg_clipfrac:0.0036327163034002297 - actor/ppo_kl:-0.00011064350519518484 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.033904194831848 - perf/mfu/actor:0.07327425676816919 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.53173446655273 - actor/lr:1e-06 - training/global_step:304 - training/epoch:10 - critic/score/mean:0.72265625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.72265625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:7.001415269769495e-08 - critic/advantages/max:2.473507881164551 - critic/advantages/min:-2.636103630065918 - critic/returns/mean:0.6804165840148926 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.94921875 - critic/values/max:1.3828125 - critic/values/min:0.228515625 - critic/vf_explained_var:0.2899567484855652 - response_length/mean:258.4296875 - response_length/max:512.0 - response_length/min:128.0 - response_length/clip_ratio:0.0078125 - prompt_length/mean:103.40234375 - prompt_length/max:180.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.6819990277290344e-06 - timing_s/generate_sequences:3.2786457538604736 - timing_s/reshard:0.5819746255874634 - timing_s/gen:4.438993257004768 - timing_s/reward:0.03411319013684988 - timing_s/old_log_prob:2.0811138818971813 - timing_s/values:1.3407619367353618 - timing_s/adv:0.034665876999497414 - timing_s/update_critic:5.521008781157434 - timing_s/update_actor:6.7860221969895065 - timing_s/step:20.244064854923636 - timing_s/stop_profile:1.0028015822172165e-05 - timing_per_token_ms/values:0.014474537528585667 - timing_per_token_ms/adv:0.000374244318728448 - timing_per_token_ms/update_actor:0.0732602338035551 - timing_per_token_ms/update_critic:0.05960345875651722 - timing_per_token_ms/gen:0.06709684780381463 - perf/total_num_tokens:92629 - perf/time_per_step:20.244064854923636 - perf/throughput:1143.9031719149941
[36m(TaskRunner pid=2914832)[0m Training Progress:  70%|██████▉   | 304/435 [1:52:53<47:22, 21.70s/it]
[36m(TaskRunner pid=2914832)[0m step:305 - global_seqlen/min:23216 - global_seqlen/max:24604 - global_seqlen/minmax_diff:1388 - global_seqlen/balanced_min:24010 - global_seqlen/balanced_max:24011 - global_seqlen/mean:24010.75 - actor/entropy:0.05406411364674568 - critic/vf_loss:0.10414357529953122 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.38570808758959174 - critic/grad_norm:35.13223361968994 - perf/mfu/critic:0.09867581629370818 - critic/lr:1e-05 - actor/pg_loss:0.0018886053003370762 - actor/pg_clipfrac:0.0033915934909600765 - actor/ppo_kl:0.00029293204363511904 - actor/pg_clipfrac_lower:5.600358417723328e-05 - actor/grad_norm:3.2449639439582825 - perf/mfu/actor:0.07567091482357378 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.59992599487305 - actor/lr:1e-06 - training/global_step:305 - training/epoch:10 - critic/score/mean:0.65625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.65625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:4.913476914225612e-08 - critic/advantages/max:2.5208120346069336 - critic/advantages/min:-2.6207330226898193 - critic/returns/mean:0.5870192646980286 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.376953125 - critic/values/max:0.875 - critic/values/min:-0.27734375 - critic/vf_explained_var:0.3722202777862549 - response_length/mean:270.59375 - response_length/max:512.0 - response_length/min:123.0 - response_length/clip_ratio:0.03515625 - prompt_length/mean:104.57421875 - prompt_length/max:171.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.783978849649429e-06 - timing_s/generate_sequences:3.4989497661590576 - timing_s/reshard:0.8857035636901855 - timing_s/gen:4.912365538999438 - timing_s/reward:0.03449831996113062 - timing_s/old_log_prob:2.077408504206687 - timing_s/values:1.3536731232888997 - timing_s/adv:0.034970255102962255 - timing_s/update_critic:5.233304537367076 - timing_s/update_actor:6.820451348088682 - timing_s/step:20.474094869103283 - timing_s/stop_profile:2.0400620996952057e-06 - timing_per_token_ms/values:0.014094448562507415 - timing_per_token_ms/adv:0.0003641103995393965 - timing_per_token_ms/update_actor:0.07101455960443429 - timing_per_token_ms/update_critic:0.05448918231799377 - timing_per_token_ms/gen:0.0709141577982365 - perf/total_num_tokens:96043 - perf/time_per_step:20.474094869103283 - perf/throughput:1172.738045491513
[36m(TaskRunner pid=2914832)[0m Training Progress:  70%|███████   | 305/435 [1:53:14<46:13, 21.34s/it]
[36m(TaskRunner pid=2914832)[0m step:306 - global_seqlen/min:22663 - global_seqlen/max:23772 - global_seqlen/minmax_diff:1109 - global_seqlen/balanced_min:23339 - global_seqlen/balanced_max:23340 - global_seqlen/mean:23339.75 - actor/entropy:0.05207245051860809 - critic/vf_loss:0.10878779424820095 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.8563241958618164 - critic/grad_norm:28.2420814037323 - perf/mfu/critic:0.09297949830359835 - critic/lr:1e-05 - actor/pg_loss:0.022427590563893318 - actor/pg_clipfrac:0.004268159682396799 - actor/ppo_kl:0.00040749490153757506 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.041931629180908 - perf/mfu/actor:0.0695392576390195 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.55217361450195 - actor/lr:1e-06 - training/global_step:306 - training/epoch:10 - critic/score/mean:0.72265625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.72265625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:7.597291684646734e-09 - critic/advantages/max:2.3607749938964844 - critic/advantages/min:-2.7398996353149414 - critic/returns/mean:0.6704301834106445 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.61328125 - critic/values/max:1.078125 - critic/values/min:-0.08837890625 - critic/vf_explained_var:0.2873566746711731 - response_length/mean:260.86328125 - response_length/max:512.0 - response_length/min:112.0 - response_length/clip_ratio:0.0078125 - prompt_length/mean:103.8203125 - prompt_length/max:199.0 - prompt_length/min:70.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.2710453271865845e-06 - timing_s/generate_sequences:3.4454500675201416 - timing_s/reshard:0.6879342198371887 - timing_s/gen:5.1098532830365 - timing_s/reward:0.0342830503359437 - timing_s/old_log_prob:2.1253002462908626 - timing_s/values:1.6135432426817715 - timing_s/adv:0.03324591601267457 - timing_s/update_critic:5.393335564993322 - timing_s/update_actor:7.209563848562539 - timing_s/step:21.527792086824775 - timing_s/stop_profile:2.2440217435359955e-06 - timing_per_token_ms/values:0.017283210431578867 - timing_per_token_ms/adv:0.00035610831320680993 - timing_per_token_ms/update_actor:0.07722409032404523 - timing_per_token_ms/update_critic:0.05776985148719804 - timing_per_token_ms/gen:0.07651657332229976 - perf/total_num_tokens:93359 - perf/time_per_step:21.527792086824775 - perf/throughput:1084.168311634901
[36m(TaskRunner pid=2914832)[0m Training Progress:  70%|███████   | 306/435 [1:53:35<46:00, 21.40s/it]
[36m(TaskRunner pid=2914832)[0m step:307 - global_seqlen/min:22416 - global_seqlen/max:24292 - global_seqlen/minmax_diff:1876 - global_seqlen/balanced_min:23554 - global_seqlen/balanced_max:23554 - global_seqlen/mean:23554.0 - actor/entropy:0.05361608415842056 - critic/vf_loss:0.09042442252393812 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.7656209096312523 - critic/grad_norm:25.36715304851532 - perf/mfu/critic:0.09844980690025387 - critic/lr:1e-05 - actor/pg_loss:0.08605605131015182 - actor/pg_clipfrac:0.003571723253116943 - actor/ppo_kl:0.0003580185257305857 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.046990990638733 - perf/mfu/actor:0.0746472497735744 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.3592414855957 - actor/lr:1e-06 - training/global_step:307 - training/epoch:10 - critic/score/mean:0.69921875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.69921875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:5.460401553136762e-08 - critic/advantages/max:2.5981593132019043 - critic/advantages/min:-2.8827197551727295 - critic/returns/mean:0.6344010233879089 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.8984375 - critic/values/max:1.3671875 - critic/values/min:0.15625 - critic/vf_explained_var:0.45361781120300293 - response_length/mean:265.25390625 - response_length/max:512.0 - response_length/min:125.0 - response_length/clip_ratio:0.01171875 - prompt_length/mean:102.77734375 - prompt_length/max:201.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.479661583900452e-06 - timing_s/generate_sequences:3.3901212215423584 - timing_s/reshard:0.9442373514175415 - timing_s/gen:5.026287157088518 - timing_s/reward:0.03537902608513832 - timing_s/old_log_prob:2.0704383198171854 - timing_s/values:1.346034447196871 - timing_s/adv:0.034397940151393414 - timing_s/update_critic:5.143099939916283 - timing_s/update_actor:6.779564349912107 - timing_s/step:20.44196191104129 - timing_s/stop_profile:1.982320100069046e-06 - timing_per_token_ms/values:0.014286686414163953 - timing_per_token_ms/adv:0.0003650965881739133 - timing_per_token_ms/update_actor:0.07195767544697405 - timing_per_token_ms/update_critic:0.05458839199197889 - timing_per_token_ms/gen:0.07401939705601235 - perf/total_num_tokens:94216 - perf/time_per_step:20.44196191104129 - perf/throughput:1152.2377403158064
[36m(TaskRunner pid=2914832)[0m Training Progress:  71%|███████   | 307/435 [1:53:56<45:03, 21.12s/it]
[36m(TaskRunner pid=2914832)[0m step:308 - global_seqlen/min:22943 - global_seqlen/max:24330 - global_seqlen/minmax_diff:1387 - global_seqlen/balanced_min:23463 - global_seqlen/balanced_max:23464 - global_seqlen/mean:23463.5 - actor/entropy:0.05429644137620926 - critic/vf_loss:0.09749848174396902 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.4002721857978031 - critic/grad_norm:36.518330574035645 - perf/mfu/critic:0.09479487290956719 - critic/lr:1e-05 - actor/pg_loss:-0.052559835370630026 - actor/pg_clipfrac:0.0034588900016387925 - actor/ppo_kl:0.00016722824329917785 - actor/pg_clipfrac_lower:5.225752465776168e-05 - actor/grad_norm:2.9599332213401794 - perf/mfu/actor:0.07013790257926894 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.18477249145508 - actor/lr:1e-06 - training/global_step:308 - training/epoch:10 - critic/score/mean:0.69140625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.69140625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:3.1863538474397046e-09 - critic/advantages/max:2.564948320388794 - critic/advantages/min:-2.745154857635498 - critic/returns/mean:0.6295020580291748 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.400390625 - critic/values/max:0.890625 - critic/values/min:-0.294921875 - critic/vf_explained_var:0.44123804569244385 - response_length/mean:265.39453125 - response_length/max:512.0 - response_length/min:127.0 - response_length/clip_ratio:0.02734375 - prompt_length/mean:101.22265625 - prompt_length/max:216.0 - prompt_length/min:67.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.715045750141144e-06 - timing_s/generate_sequences:3.4844014644622803 - timing_s/reshard:0.9922086596488953 - timing_s/gen:5.365297147072852 - timing_s/reward:0.03775952197611332 - timing_s/old_log_prob:2.112735207658261 - timing_s/values:1.6251124790869653 - timing_s/adv:0.036775471176952124 - timing_s/update_critic:5.3218066450208426 - timing_s/update_actor:7.185113331768662 - timing_s/step:21.692837181966752 - timing_s/stop_profile:3.139954060316086e-06 - timing_per_token_ms/values:0.01731532464345649 - timing_per_token_ms/adv:0.00039183701469252375 - timing_per_token_ms/update_actor:0.07655628243621648 - timing_per_token_ms/update_critic:0.056703034980084416 - timing_per_token_ms/gen:0.07896994667539264 - perf/total_num_tokens:93854 - perf/time_per_step:21.692837181966752 - perf/throughput:1081.6243077463928
[36m(TaskRunner pid=2914832)[0m Training Progress:  71%|███████   | 308/435 [1:54:18<45:04, 21.29s/it]
[36m(TaskRunner pid=2914832)[0m step:309 - global_seqlen/min:23704 - global_seqlen/max:25045 - global_seqlen/minmax_diff:1341 - global_seqlen/balanced_min:24198 - global_seqlen/balanced_max:24199 - global_seqlen/mean:24198.5 - actor/entropy:0.05676235258579254 - critic/vf_loss:0.0783578691771254 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.8006689697504044 - critic/grad_norm:28.621898412704468 - perf/mfu/critic:0.09693377713277081 - critic/lr:1e-05 - actor/pg_loss:0.059768566861748695 - actor/pg_clipfrac:0.0044285167241469026 - actor/ppo_kl:0.0003041091304112342 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.2282679677009583 - perf/mfu/actor:0.07665289145083629 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.47503280639648 - actor/lr:1e-06 - training/global_step:309 - training/epoch:10 - critic/score/mean:0.69140625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.69140625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.3273577792460856e-08 - critic/advantages/max:2.687074661254883 - critic/advantages/min:-2.750379800796509 - critic/returns/mean:0.6310603618621826 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.5859375 - critic/values/max:1.09375 - critic/values/min:-0.1142578125 - critic/vf_explained_var:0.3788384795188904 - response_length/mean:274.33984375 - response_length/max:512.0 - response_length/min:124.0 - response_length/clip_ratio:0.02734375 - prompt_length/mean:103.76171875 - prompt_length/max:189.0 - prompt_length/min:66.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.223082214593887e-06 - timing_s/generate_sequences:3.583667278289795 - timing_s/reshard:0.5814628601074219 - timing_s/gen:4.781829111743718 - timing_s/reward:0.03621973702684045 - timing_s/old_log_prob:2.0800568577833474 - timing_s/values:1.362376883160323 - timing_s/adv:0.034374929033219814 - timing_s/update_critic:5.37152353907004 - timing_s/update_actor:6.787921084091067 - timing_s/step:20.46404179930687 - timing_s/stop_profile:2.4330802261829376e-06 - timing_per_token_ms/values:0.014075013773171094 - timing_per_token_ms/adv:0.00035513491573051855 - timing_per_token_ms/update_actor:0.07012749844092679 - timing_per_token_ms/update_critic:0.05549438538618137 - timing_per_token_ms/gen:0.06808715683592315 - perf/total_num_tokens:96794 - perf/time_per_step:20.46404179930687 - perf/throughput:1182.4887887406298
[36m(TaskRunner pid=2914832)[0m Training Progress:  71%|███████   | 309/435 [1:54:38<44:12, 21.05s/it]
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 310}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and bakes muffins for her friends every day with four. She sells the remainder at the farmers' market daily for $2 per fresh duck egg. How much in dollars does she make every day at the farmers' market? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much Janet makes every day at the farmers' market, we need to follow these steps:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. Calculate the number of eggs laid by the ducks in a day.
[36m(TaskRunner pid=2914832)[0m 2. Subtract the number of eggs eaten in the morning and the number of eggs baked.
[36m(TaskRunner pid=2914832)[0m 3. Determine the number of ducks laid in a day.
[36m(TaskRunner pid=2914832)[0m 4. Calculate the total revenue from selling the eggs.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Let's start with the number of eggs laid by the ducks in a day. Janet's ducks lay 16 eggs per day.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Next, Janet eats 3 eggs for breakfast every morning. So, the number of eggs eaten in a day is:
[36m(TaskRunner pid=2914832)[0m \[ 3 \text{ eggs} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Then, Janet bakes 4 muffins every day. So, the number of eggs baked in a day is:
[36m(TaskRunner pid=2914832)[0m \[ 4 \text{ eggs} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m The number of eggs sold each day is the remainder after subtracting the eggs eaten in the morning and the eggs baked. Therefore, the number of eggs sold each day is:
[36m(TaskRunner pid=2914832)[0m \[ 16 \text{ eggs} - 3 \text{ eggs} - 4 \text{ eggs} = 7 \text{ eggs} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Since the eggs are sold for $2 per egg, the total revenue per day is:
[36m(TaskRunner pid=2914832)[0m \[ 7 \text{ eggs} \times 2 \text{ dollars per egg} = 14 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Thus, the final answer is:
[36m(TaskRunner pid=2914832)[0m #### 14
[36m(TaskRunner pid=2914832)[0m [ground_truth] 18
[36m(TaskRunner pid=2914832)[0m [score] 0.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1312
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 310}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Tom's restaurant gets 6 reservations a night.  They normally order 2 meals that cost $5 each and a $5 bottle of wine.  How much do they make a week if they are open 2 days a week? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much Tom's restaurant makes in a week, we need to follow these steps:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. Calculate the number of reservations per night and the revenue from reservations.
[36m(TaskRunner pid=2914832)[0m 2. Calculate the revenue from meals and the revenue from the bottle of wine.
[36m(TaskRunner pid=2914832)[0m 3. Add the two amounts together to get the total revenue for the week.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m First, Tom's restaurant gets 6 reservations a night. They normally order 2 meals that cost $5 each and a $5 bottle of wine. Therefore, the revenue from the meals per night is:
[36m(TaskRunner pid=2914832)[0m \[ 2 \times 5 = 10 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m The revenue from the wine per night is:
[36m(TaskRunner pid=2914832)[0m \[ 5 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m So, the total revenue from reservations per night is:
[36m(TaskRunner pid=2914832)[0m \[ 10 + 5 = 15 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m Since they are open 2 days a week, the total revenue for the week is:
[36m(TaskRunner pid=2914832)[0m \[ 2 \times 15 = 30 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Therefore, the final answer is:
[36m(TaskRunner pid=2914832)[0m #### 30
[36m(TaskRunner pid=2914832)[0m [ground_truth] 180
[36m(TaskRunner pid=2914832)[0m [score] 0.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1319
[36m(TaskRunner pid=2914832)[0m step:310 - global_seqlen/min:23056 - global_seqlen/max:24546 - global_seqlen/minmax_diff:1490 - global_seqlen/balanced_min:23555 - global_seqlen/balanced_max:23556 - global_seqlen/mean:23555.75 - actor/entropy:0.05158123001456261 - critic/vf_loss:0.07971568018547259 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.7749975211918354 - critic/grad_norm:19.952038288116455 - perf/mfu/critic:0.09933681122425617 - critic/lr:1e-05 - actor/pg_loss:0.08161821006797254 - actor/pg_clipfrac:0.0035184844600735232 - actor/ppo_kl:0.00022667742302928673 - actor/pg_clipfrac_lower:0.0001536749732622411 - actor/grad_norm:2.979002892971039 - perf/mfu/actor:0.07453705810913028 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.3751449584961 - actor/lr:1e-06 - val-core/openai/gsm8k/reward/mean@1:0.533737680060652 - training/global_step:310 - training/epoch:10 - critic/score/mean:0.74609375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.74609375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:1.3949800425905323e-08 - critic/advantages/max:2.39611554145813 - critic/advantages/min:-2.8702402114868164 - critic/returns/mean:0.6935715675354004 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.8984375 - critic/values/max:1.328125 - critic/values/min:0.201171875 - critic/vf_explained_var:0.3014078736305237 - response_length/mean:266.515625 - response_length/max:512.0 - response_length/min:124.0 - response_length/clip_ratio:0.015625 - prompt_length/mean:101.54296875 - prompt_length/max:180.0 - prompt_length/min:64.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.7960708141326904e-06 - timing_s/generate_sequences:3.5041327476501465 - timing_s/reshard:0.8731842637062073 - timing_s/gen:4.9009149288758636 - timing_s/reward:0.034627933986485004 - timing_s/old_log_prob:2.449581799097359 - timing_s/values:1.3409153139218688 - timing_s/adv:0.03524594800546765 - timing_s/update_critic:5.0980222267098725 - timing_s/update_actor:6.789186153095216 - timing_s/testing:13.658750341739506 - timing_s/step:34.315807898994535 - timing_s/stop_profile:2.551823854446411e-06 - timing_per_token_ms/values:0.014231295054518204 - timing_per_token_ms/adv:0.0003740694735411487 - timing_per_token_ms/update_actor:0.07205444693010428 - timing_per_token_ms/update_critic:0.054105921343088975 - timing_per_token_ms/gen:0.07183143180037321 - perf/total_num_tokens:94223 - perf/time_per_step:34.315807898994535 - perf/throughput:686.4401989116565
[36m(TaskRunner pid=2914832)[0m Training Progress:  71%|███████▏  | 310/435 [1:55:12<52:08, 25.03s/it]
[36m(TaskRunner pid=2914832)[0m step:311 - global_seqlen/min:22851 - global_seqlen/max:25667 - global_seqlen/minmax_diff:2816 - global_seqlen/balanced_min:23808 - global_seqlen/balanced_max:23809 - global_seqlen/mean:23808.75 - actor/entropy:0.06147998571395874 - critic/vf_loss:0.09806601097807288 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.404208863619715 - critic/grad_norm:39.834598898887634 - perf/mfu/critic:0.09267081214969143 - critic/lr:1e-05 - actor/pg_loss:0.0950437820283696 - actor/pg_clipfrac:0.0044217736285645515 - actor/ppo_kl:0.0007853004050275558 - actor/pg_clipfrac_lower:6.944444612599909e-05 - actor/grad_norm:3.126650035381317 - perf/mfu/actor:0.07530375540526148 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.13043212890625 - actor/lr:1e-06 - training/global_step:311 - training/epoch:10 - critic/score/mean:0.703125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.703125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:3.1739762818006056e-08 - critic/advantages/max:2.430830955505371 - critic/advantages/min:-2.8176848888397217 - critic/returns/mean:0.6564414501190186 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.390625 - critic/values/max:0.8359375 - critic/values/min:-0.2412109375 - critic/vf_explained_var:0.3643273115158081 - response_length/mean:269.0703125 - response_length/max:512.0 - response_length/min:122.0 - response_length/clip_ratio:0.0078125 - prompt_length/mean:102.94140625 - prompt_length/max:184.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.010981112718582e-06 - timing_s/generate_sequences:3.4781625270843506 - timing_s/reshard:0.2989753782749176 - timing_s/gen:4.285095538012683 - timing_s/reward:0.03780879685655236 - timing_s/old_log_prob:2.077605997212231 - timing_s/values:1.3372575351968408 - timing_s/adv:0.03539766184985638 - timing_s/update_critic:5.523810639046133 - timing_s/update_actor:6.795405999291688 - timing_s/step:20.09998409403488 - timing_s/stop_profile:2.196989953517914e-06 - timing_per_token_ms/values:0.014041660473532218 - timing_per_token_ms/adv:0.0003716875292681932 - timing_per_token_ms/update_actor:0.07135408200022773 - timing_per_token_ms/update_critic:0.05800189677162947 - timing_per_token_ms/gen:0.06220922066741214 - perf/total_num_tokens:95235 - perf/time_per_step:20.09998409403488 - perf/throughput:1184.515862729751
[36m(TaskRunner pid=2914832)[0m Training Progress:  71%|███████▏  | 311/435 [1:55:33<48:40, 23.56s/it]
[36m(TaskRunner pid=2914832)[0m step:312 - global_seqlen/min:22582 - global_seqlen/max:25433 - global_seqlen/minmax_diff:2851 - global_seqlen/balanced_min:23959 - global_seqlen/balanced_max:23960 - global_seqlen/mean:23959.25 - actor/entropy:0.052749741822481155 - critic/vf_loss:0.04588501955731772 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.7659974452108145 - critic/grad_norm:16.308226764202118 - perf/mfu/critic:0.10084141740901395 - critic/lr:1e-05 - actor/pg_loss:-0.1591390147805214 - actor/pg_clipfrac:0.004398756049340591 - actor/ppo_kl:1.1126213848910993e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.9227697253227234 - perf/mfu/actor:0.07527258428346816 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.27160263061523 - actor/lr:1e-06 - training/global_step:312 - training/epoch:10 - critic/score/mean:0.6875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.6875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.9579902144073458e-08 - critic/advantages/max:2.525646924972534 - critic/advantages/min:-2.9038076400756836 - critic/returns/mean:0.6443713903427124 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.60546875 - critic/values/max:1.015625 - critic/values/min:-0.06298828125 - critic/vf_explained_var:0.4482495188713074 - response_length/mean:268.6484375 - response_length/max:512.0 - response_length/min:127.0 - response_length/clip_ratio:0.015625 - prompt_length/mean:105.71484375 - prompt_length/max:238.0 - prompt_length/min:64.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.264991730451584e-06 - timing_s/generate_sequences:3.3880228996276855 - timing_s/reshard:0.87123703956604 - timing_s/gen:4.932274396065623 - timing_s/reward:0.03483670298010111 - timing_s/old_log_prob:2.0891655539162457 - timing_s/values:1.3462990927509964 - timing_s/adv:0.034705682657659054 - timing_s/update_critic:5.108109112363309 - timing_s/update_actor:6.83969217306003 - timing_s/step:20.392616793047637 - timing_s/stop_profile:3.822147846221924e-06 - timing_per_token_ms/values:0.014047800878063758 - timing_per_token_ms/adv:0.0003621323983185936 - timing_per_token_ms/update_actor:0.07136797033567442 - timing_per_token_ms/update_critic:0.05329996882585336 - timing_per_token_ms/gen:0.0717171372330477 - perf/total_num_tokens:95837 - perf/time_per_step:20.392616793047637 - perf/throughput:1174.8982606375616
[36m(TaskRunner pid=2914832)[0m Training Progress:  72%|███████▏  | 312/435 [1:55:53<46:20, 22.61s/it]
[36m(TaskRunner pid=2914832)[0m step:313 - global_seqlen/min:22645 - global_seqlen/max:24999 - global_seqlen/minmax_diff:2354 - global_seqlen/balanced_min:23599 - global_seqlen/balanced_max:23599 - global_seqlen/mean:23599.0 - actor/entropy:0.0507989376783371 - critic/vf_loss:0.04688650305615738 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6958456225693226 - critic/grad_norm:20.531415462493896 - perf/mfu/critic:0.10006424080940708 - critic/lr:1e-05 - actor/pg_loss:-0.06592484656721354 - actor/pg_clipfrac:0.0027242006290180143 - actor/ppo_kl:-1.451870321034221e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.268347680568695 - perf/mfu/actor:0.07378448690534394 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.51109313964844 - actor/lr:1e-06 - training/global_step:313 - training/epoch:10 - critic/score/mean:0.69140625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.69140625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:2.8100900079097713e-11 - critic/advantages/max:2.695810556411743 - critic/advantages/min:-2.903463363647461 - critic/returns/mean:0.6274327635765076 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.84375 - critic/values/max:1.265625 - critic/values/min:0.07177734375 - critic/vf_explained_var:0.4909125566482544 - response_length/mean:265.13671875 - response_length/max:512.0 - response_length/min:109.0 - response_length/clip_ratio:0.01953125 - prompt_length/mean:103.59765625 - prompt_length/max:185.0 - prompt_length/min:63.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.373956471681595e-06 - timing_s/generate_sequences:3.51104474067688 - timing_s/reshard:0.6819909811019897 - timing_s/gen:5.111813362687826 - timing_s/reward:0.03333199908956885 - timing_s/old_log_prob:2.1377337710000575 - timing_s/values:1.6195959192700684 - timing_s/adv:0.0363478260114789 - timing_s/update_critic:5.069758556783199 - timing_s/update_actor:6.870952354744077 - timing_s/step:20.887263861019164 - timing_s/stop_profile:6.26780092716217e-06 - timing_per_token_ms/values:0.017157463444108526 - timing_per_token_ms/adv:0.00038505684575065576 - timing_per_token_ms/update_actor:0.07278859649502178 - timing_per_token_ms/update_critic:0.05370734519241493 - timing_per_token_ms/gen:0.07531216740608215 - perf/total_num_tokens:94396 - perf/time_per_step:20.887263861019164 - perf/throughput:1129.8272553563902
[36m(TaskRunner pid=2914832)[0m Training Progress:  72%|███████▏  | 313/435 [1:56:14<44:55, 22.10s/it]
[36m(TaskRunner pid=2914832)[0m step:314 - global_seqlen/min:23275 - global_seqlen/max:25019 - global_seqlen/minmax_diff:1744 - global_seqlen/balanced_min:24042 - global_seqlen/balanced_max:24043 - global_seqlen/mean:24042.25 - actor/entropy:0.055834151804447174 - critic/vf_loss:0.0880003571510315 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.4419153053313494 - critic/grad_norm:32.45944786071777 - perf/mfu/critic:0.09677339496525851 - critic/lr:1e-05 - actor/pg_loss:0.02457255870103836 - actor/pg_clipfrac:0.0036776726628886536 - actor/ppo_kl:0.0007915204078017268 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.8388252556324005 - perf/mfu/actor:0.07246384305403815 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.06610870361328 - actor/lr:1e-06 - training/global_step:314 - training/epoch:10 - critic/score/mean:0.67578125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.67578125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:4.1181703380743784e-08 - critic/advantages/max:2.6586272716522217 - critic/advantages/min:-2.884688377380371 - critic/returns/mean:0.605289101600647 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.388671875 - critic/values/max:0.84375 - critic/values/min:-0.408203125 - critic/vf_explained_var:0.48663389682769775 - response_length/mean:269.5703125 - response_length/max:512.0 - response_length/min:110.0 - response_length/clip_ratio:0.02734375 - prompt_length/mean:106.08984375 - prompt_length/max:194.0 - prompt_length/min:67.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.92902472615242e-06 - timing_s/generate_sequences:3.59663724899292 - timing_s/reshard:0.5803974270820618 - timing_s/gen:4.727673116605729 - timing_s/reward:0.034223646856844425 - timing_s/old_log_prob:2.0708486628718674 - timing_s/values:1.3431144678033888 - timing_s/adv:0.03405948495492339 - timing_s/update_critic:5.34258520277217 - timing_s/update_actor:7.131441903766245 - timing_s/step:20.691517360974103 - timing_s/stop_profile:1.9529834389686584e-06 - timing_per_token_ms/values:0.013966189393706795 - timing_per_token_ms/adv:0.0003541628274695941 - timing_per_token_ms/update_actor:0.07415530892248276 - timing_per_token_ms/update_critic:0.05555413077781999 - timing_per_token_ms/gen:0.0685070731286151 - perf/total_num_tokens:96169 - perf/time_per_step:20.691517360974103 - perf/throughput:1161.9375022416507
[36m(TaskRunner pid=2914832)[0m Training Progress:  72%|███████▏  | 314/435 [1:56:35<43:42, 21.68s/it]
[36m(TaskRunner pid=2914832)[0m step:315 - global_seqlen/min:23708 - global_seqlen/max:25564 - global_seqlen/minmax_diff:1856 - global_seqlen/balanced_min:24545 - global_seqlen/balanced_max:24546 - global_seqlen/mean:24545.5 - actor/entropy:0.05462372303009033 - critic/vf_loss:0.10337761745904572 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.7865459993481636 - critic/grad_norm:31.949437618255615 - perf/mfu/critic:0.09939256024110488 - critic/lr:1e-05 - actor/pg_loss:-0.0493108278606087 - actor/pg_clipfrac:0.003969326877268031 - actor/ppo_kl:0.000691611765887501 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.8149430751800537 - perf/mfu/actor:0.07758845775233622 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.3499870300293 - actor/lr:1e-06 - training/global_step:315 - training/epoch:10 - critic/score/mean:0.6796875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.6796875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:9.913176057807505e-09 - critic/advantages/max:2.75598406791687 - critic/advantages/min:-2.620431900024414 - critic/returns/mean:0.6141873598098755 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.59765625 - critic/values/max:1.09375 - critic/values/min:-0.2177734375 - critic/vf_explained_var:0.32370567321777344 - response_length/mean:278.0859375 - response_length/max:512.0 - response_length/min:89.0 - response_length/clip_ratio:0.046875 - prompt_length/mean:105.4375 - prompt_length/max:201.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.82611358165741e-06 - timing_s/generate_sequences:3.6156532764434814 - timing_s/reshard:0.8625123500823975 - timing_s/gen:5.062316674273461 - timing_s/reward:0.03403607988730073 - timing_s/old_log_prob:2.0742606231942773 - timing_s/values:1.3461400750093162 - timing_s/adv:0.033596517983824015 - timing_s/update_critic:5.314817984122783 - timing_s/update_actor:6.804910357110202 - timing_s/step:20.676879351958632 - timing_s/stop_profile:2.151820808649063e-06 - timing_per_token_ms/values:0.013710660559056814 - timing_per_token_ms/adv:0.0003421861235646454 - timing_per_token_ms/update_actor:0.06930914380548575 - timing_per_token_ms/update_critic:0.054132305148833625 - timing_per_token_ms/gen:0.0711099406415713 - perf/total_num_tokens:98182 - perf/time_per_step:20.676879351958632 - perf/throughput:1187.0988644945064
[36m(TaskRunner pid=2914832)[0m Training Progress:  72%|███████▏  | 315/435 [1:56:55<42:45, 21.38s/it]
[36m(TaskRunner pid=2914832)[0m step:316 - global_seqlen/min:23301 - global_seqlen/max:24153 - global_seqlen/minmax_diff:852 - global_seqlen/balanced_min:23683 - global_seqlen/balanced_max:23684 - global_seqlen/mean:23683.5 - actor/entropy:0.05158529058098793 - critic/vf_loss:0.08796645517577417 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.7764182584360242 - critic/grad_norm:27.0827956199646 - perf/mfu/critic:0.09412975469539445 - critic/lr:1e-05 - actor/pg_loss:-0.23204215709120035 - actor/pg_clipfrac:0.003769701565033756 - actor/ppo_kl:-0.0007037808081804542 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.9378849267959595 - perf/mfu/actor:0.0711465411597772 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.42312240600586 - actor/lr:1e-06 - training/global_step:316 - training/epoch:10 - critic/score/mean:0.70703125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.70703125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-3.1838840897080445e-08 - critic/advantages/max:2.5751707553863525 - critic/advantages/min:-2.5972344875335693 - critic/returns/mean:0.6512718796730042 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.9453125 - critic/values/max:1.3671875 - critic/values/min:0.111328125 - critic/vf_explained_var:0.3352920413017273 - response_length/mean:267.35546875 - response_length/max:512.0 - response_length/min:99.0 - response_length/clip_ratio:0.03125 - prompt_length/mean:102.69921875 - prompt_length/max:177.0 - prompt_length/min:64.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:2.976972609758377e-06 - timing_s/generate_sequences:3.4984290599823 - timing_s/reshard:0.583807110786438 - timing_s/gen:5.0012097069993615 - timing_s/reward:0.0334319700486958 - timing_s/old_log_prob:2.138165726326406 - timing_s/values:1.6053980649448931 - timing_s/adv:0.03369827289134264 - timing_s/update_critic:5.407187803182751 - timing_s/update_actor:7.151200560387224 - timing_s/step:21.377685720101 - timing_s/stop_profile:2.1010637283325195e-06 - timing_per_token_ms/values:0.016946376854612845 - timing_per_token_ms/adv:0.0003557146630707311 - timing_per_token_ms/update_actor:0.07548715941886994 - timing_per_token_ms/update_critic:0.057077583583325424 - timing_per_token_ms/gen:0.07307116442878543 - perf/total_num_tokens:94734 - perf/time_per_step:21.377685720101 - perf/throughput:1107.860799811969
[36m(TaskRunner pid=2914832)[0m Training Progress:  73%|███████▎  | 316/435 [1:57:17<42:24, 21.38s/it]
[36m(TaskRunner pid=2914832)[0m step:317 - global_seqlen/min:23172 - global_seqlen/max:25051 - global_seqlen/minmax_diff:1879 - global_seqlen/balanced_min:23859 - global_seqlen/balanced_max:23859 - global_seqlen/mean:23859.0 - actor/entropy:0.04969631880521774 - critic/vf_loss:0.10747106233611703 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.4388852156698704 - critic/grad_norm:37.59489727020264 - perf/mfu/critic:0.09285018012642296 - critic/lr:1e-05 - actor/pg_loss:-0.07681540702469647 - actor/pg_clipfrac:0.003150774988171179 - actor/ppo_kl:8.905285540095065e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.387425124645233 - perf/mfu/actor:0.07463934408134915 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.38995742797852 - actor/lr:1e-06 - training/global_step:317 - training/epoch:10 - critic/score/mean:0.7265625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.7265625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:3.8656086331911865e-08 - critic/advantages/max:2.452596426010132 - critic/advantages/min:-2.788647413253784 - critic/returns/mean:0.6777253150939941 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.443359375 - critic/values/max:0.8671875 - critic/values/min:-0.330078125 - critic/vf_explained_var:0.3359711170196533 - response_length/mean:268.1015625 - response_length/max:512.0 - response_length/min:137.0 - response_length/clip_ratio:0.015625 - prompt_length/mean:104.6953125 - prompt_length/max:232.0 - prompt_length/min:62.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.579072654247284e-06 - timing_s/generate_sequences:3.51686954498291 - timing_s/reshard:0.580150306224823 - timing_s/gen:4.701819506008178 - timing_s/reward:0.03350987611338496 - timing_s/old_log_prob:2.0693732467480004 - timing_s/values:1.4114238596521318 - timing_s/adv:0.03502918221056461 - timing_s/update_critic:5.524544089566916 - timing_s/update_actor:6.87035761307925 - timing_s/step:20.65259232511744 - timing_s/stop_profile:2.2333115339279175e-06 - timing_per_token_ms/values:0.014789218530241541 - timing_per_token_ms/adv:0.0003670436964097889 - timing_per_token_ms/update_actor:0.07198916145981862 - timing_per_token_ms/update_critic:0.05788742287571688 - timing_per_token_ms/gen:0.06850568968744614 - perf/total_num_tokens:95436 - perf/time_per_step:20.65259232511744 - perf/throughput:1155.2544893351217
[36m(TaskRunner pid=2914832)[0m Training Progress:  73%|███████▎  | 317/435 [1:57:37<41:37, 21.17s/it]
[36m(TaskRunner pid=2914832)[0m step:318 - global_seqlen/min:22595 - global_seqlen/max:24414 - global_seqlen/minmax_diff:1819 - global_seqlen/balanced_min:23664 - global_seqlen/balanced_max:23665 - global_seqlen/mean:23664.5 - actor/entropy:0.052282776683568954 - critic/vf_loss:0.07733411181834526 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6153212767094374 - critic/grad_norm:7.468989968299866 - perf/mfu/critic:0.08889808668062399 - critic/lr:1e-05 - actor/pg_loss:-0.0029231830849312246 - actor/pg_clipfrac:0.004500066934269853 - actor/ppo_kl:0.0002996260536747286 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.1702420711517334 - perf/mfu/actor:0.07329905542597541 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.70231246948242 - actor/lr:1e-06 - training/global_step:318 - training/epoch:10 - critic/score/mean:0.66015625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.66015625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.1869483174109519e-08 - critic/advantages/max:2.9761674404144287 - critic/advantages/min:-2.504434585571289 - critic/returns/mean:0.5914011597633362 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.59765625 - critic/values/max:1.03125 - critic/values/min:-0.138671875 - critic/vf_explained_var:0.41562318801879883 - response_length/mean:265.20703125 - response_length/max:512.0 - response_length/min:115.0 - response_length/clip_ratio:0.03125 - prompt_length/mean:104.55078125 - prompt_length/max:182.0 - prompt_length/min:63.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.5532360672950745e-06 - timing_s/generate_sequences:3.5706286430358887 - timing_s/reshard:0.7747054100036621 - timing_s/gen:5.216220403090119 - timing_s/reward:0.03475612075999379 - timing_s/old_log_prob:2.1185354492627084 - timing_s/values:1.6131038218736649 - timing_s/adv:0.03554004989564419 - timing_s/update_critic:5.722199841402471 - timing_s/update_actor:6.937537620775402 - timing_s/step:21.688097827136517 - timing_s/stop_profile:3.843102604150772e-06 - timing_per_token_ms/values:0.01704138923148244 - timing_per_token_ms/adv:0.00037545743514171215 - timing_per_token_ms/update_actor:0.07329055780573646 - timing_per_token_ms/update_critic:0.06045130724716845 - timing_per_token_ms/gen:0.07683001786767589 - perf/total_num_tokens:94658 - perf/time_per_step:21.688097827136517 - perf/throughput:1091.1284239224785
[36m(TaskRunner pid=2914832)[0m Training Progress:  73%|███████▎  | 318/435 [1:57:59<41:35, 21.33s/it]
[36m(TaskRunner pid=2914832)[0m step:319 - global_seqlen/min:22342 - global_seqlen/max:24893 - global_seqlen/minmax_diff:2551 - global_seqlen/balanced_min:23762 - global_seqlen/balanced_max:23763 - global_seqlen/mean:23762.75 - actor/entropy:0.05136853829026222 - critic/vf_loss:0.08060060237767175 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.521225274540484 - critic/grad_norm:17.03288322687149 - perf/mfu/critic:0.09612746722063964 - critic/lr:1e-05 - actor/pg_loss:-0.11512789442713256 - actor/pg_clipfrac:0.0033263811201322824 - actor/ppo_kl:0.00040832509330357425 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.2814361453056335 - perf/mfu/actor:0.07476670314598227 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.43276596069336 - actor/lr:1e-06 - training/global_step:319 - training/epoch:10 - critic/score/mean:0.68359375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.68359375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-5.014780146694875e-09 - critic/advantages/max:2.619213581085205 - critic/advantages/min:-2.8706843852996826 - critic/returns/mean:0.627167820930481 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.53125 - critic/values/max:0.94140625 - critic/values/min:-0.2333984375 - critic/vf_explained_var:0.47628355026245117 - response_length/mean:266.6875 - response_length/max:512.0 - response_length/min:127.0 - response_length/clip_ratio:0.02734375 - prompt_length/mean:104.60546875 - prompt_length/max:180.0 - prompt_length/min:56.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.6368146538734436e-06 - timing_s/generate_sequences:3.510457992553711 - timing_s/reshard:0.8844269514083862 - timing_s/gen:4.958358199335635 - timing_s/reward:0.03363835532218218 - timing_s/old_log_prob:2.0905665061436594 - timing_s/values:1.3474475829862058 - timing_s/adv:0.03371567325666547 - timing_s/update_critic:5.314997781068087 - timing_s/update_actor:6.829801703803241 - timing_s/step:20.616175409872085 - timing_s/stop_profile:1.776963472366333e-06 - timing_per_token_ms/values:0.01417604846857167 - timing_per_token_ms/adv:0.00035471139973977623 - timing_per_token_ms/update_actor:0.07185407522070511 - timing_per_token_ms/update_critic:0.05591732628870908 - timing_per_token_ms/gen:0.07262652623821822 - perf/total_num_tokens:95051 - perf/time_per_step:20.616175409872085 - perf/throughput:1152.6264948551598
[36m(TaskRunner pid=2914832)[0m Training Progress:  73%|███████▎  | 319/435 [1:58:20<40:49, 21.12s/it]
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 320}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and bakes muffins for her friends every day with four. She sells the remainder at the farmers' market daily for $2 per fresh duck egg. How much in dollars does she make every day at the farmers' market? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much Janet makes every day at the farmers' market, we need to follow these steps:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. Calculate the number of eggs Janet lays in a day.
[36m(TaskRunner pid=2914832)[0m 2. Subtract the number of eggs she eats in a day.
[36m(TaskRunner pid=2914832)[0m 3. Subtract the number of eggs baked.
[36m(TaskRunner pid=2914832)[0m 4. Sell the remaining eggs at the farmers' market.
[36m(TaskRunner pid=2914832)[0m 5. Determine the total revenue from selling the eggs.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Let's start by calculating the number of eggs Janet lays in a day. She lays 16 eggs per day. She eats 3 eggs for breakfast every morning, so the number of eggs she eats in a day is:
[36m(TaskRunner pid=2914832)[0m \[ 3 \text{ eggs} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m She bakes 4 eggs for her friends every day. So, the number of eggs she bakes in a day is:
[36m(TaskRunner pid=2914832)[0m \[ 4 \text{ eggs} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Therefore, the number of eggs she sells in a day is the remainder after subtracting the eggs she eats and the eggs she bakes:
[36m(TaskRunner pid=2914832)[0m \[ \text{Eggs sold} = 16 - 3 - 4 = 7 \text{ eggs} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Next, Janet sells each egg for $2. Therefore, the total revenue from selling the eggs is:
[36m(TaskRunner pid=2914832)[0m \[ \text{Revenue} = 7 \text{ eggs} \times 2 \text{ dollars per egg} = 14 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Thus, the final answer is:
[36m(TaskRunner pid=2914832)[0m \[ \boxed{14} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m #### 14
[36m(TaskRunner pid=2914832)[0m [ground_truth] 18
[36m(TaskRunner pid=2914832)[0m [score] 0.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1312
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 320}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Tom's restaurant gets 6 reservations a night.  They normally order 2 meals that cost $5 each and a $5 bottle of wine.  How much do they make a week if they are open 2 days a week? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much Tom's restaurant makes a week, we need to follow these steps:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. Calculate the number of reservations per night and the revenue from reservations.
[36m(TaskRunner pid=2914832)[0m 2. Calculate the revenue from meals and the revenue from the bottle of wine.
[36m(TaskRunner pid=2914832)[0m 3. Add the two amounts together to find the total revenue for the week.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m First, Tom's restaurant gets 6 reservations a night. They normally order 2 meals that cost $5 each and a $5 bottle of wine. Therefore, the revenue from the meals is:
[36m(TaskRunner pid=2914832)[0m \[ 2 \times 5 = 10 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m The revenue from the bottle of wine is:
[36m(TaskRunner pid=2914832)[0m \[ 5 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m So, the total revenue from reservations per night is:
[36m(TaskRunner pid=2914832)[0m \[ 10 + 5 = 15 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m Since they are open 2 days a week, the total revenue for the week is:
[36m(TaskRunner pid=2914832)[0m \[ 2 \times 15 = 30 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Therefore, the final answer is:
[36m(TaskRunner pid=2914832)[0m \[ \boxed{30} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m #### 30
[36m(TaskRunner pid=2914832)[0m [ground_truth] 180
[36m(TaskRunner pid=2914832)[0m [score] 0.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1319
[36m(TaskRunner pid=2914832)[0m step:320 - global_seqlen/min:22807 - global_seqlen/max:24742 - global_seqlen/minmax_diff:1935 - global_seqlen/balanced_min:23725 - global_seqlen/balanced_max:23726 - global_seqlen/mean:23725.25 - actor/entropy:0.05074849724769592 - critic/vf_loss:0.03964526881463826 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.7987278327345848 - critic/grad_norm:10.902840614318848 - perf/mfu/critic:0.09275514880253011 - critic/lr:1e-05 - actor/pg_loss:-0.09096048772335052 - actor/pg_clipfrac:0.003219969425117597 - actor/ppo_kl:-4.924690188090608e-06 - actor/pg_clipfrac_lower:7.046222890494391e-05 - actor/grad_norm:2.876495599746704 - perf/mfu/actor:0.07103408310832166 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.80085372924805 - actor/lr:1e-06 - val-core/openai/gsm8k/reward/mean@1:0.5435936315390447 - training/global_step:320 - training/epoch:11 - critic/score/mean:0.70703125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.70703125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:1.3780694807508098e-08 - critic/advantages/max:2.404233932495117 - critic/advantages/min:-2.6633336544036865 - critic/returns/mean:0.6512942314147949 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.703125 - critic/values/max:1.1484375 - critic/values/min:-0.1376953125 - critic/vf_explained_var:0.31620538234710693 - response_length/mean:266.8125 - response_length/max:512.0 - response_length/min:129.0 - response_length/clip_ratio:0.02734375 - prompt_length/mean:103.89453125 - prompt_length/max:222.0 - prompt_length/min:65.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:1.1486001312732697e-05 - timing_s/generate_sequences:3.4678525924682617 - timing_s/reshard:0.5826022624969482 - timing_s/gen:4.986266694962978 - timing_s/reward:0.03360096178948879 - timing_s/old_log_prob:2.0934396008960903 - timing_s/values:1.3972390023991466 - timing_s/adv:0.03660936187952757 - timing_s/update_critic:5.499468777794391 - timing_s/update_actor:7.177825673948973 - timing_s/testing:14.067622618749738 - timing_s/step:35.3034285469912 - timing_s/stop_profile:2.086162567138672e-06 - timing_per_token_ms/values:0.014723122015565132 - timing_per_token_ms/adv:0.0003857637103879577 - timing_per_token_ms/update_actor:0.07563487923150412 - timing_per_token_ms/update_critic:0.05794953454436087 - timing_per_token_ms/gen:0.0730010935664526 - perf/total_num_tokens:94901 - perf/time_per_step:35.3034285469912 - perf/throughput:672.0381270736955
[36m(TaskRunner pid=2914832)[0m Training Progress:  74%|███████▎  | 320/435 [1:58:55<48:55, 25.52s/it]
[36m(TaskRunner pid=2914832)[0m step:321 - global_seqlen/min:22659 - global_seqlen/max:24245 - global_seqlen/minmax_diff:1586 - global_seqlen/balanced_min:23440 - global_seqlen/balanced_max:23441 - global_seqlen/mean:23440.75 - actor/entropy:0.05175073817372322 - critic/vf_loss:0.05954644310986623 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6225983835756779 - critic/grad_norm:15.87197208404541 - perf/mfu/critic:0.09158001180835555 - critic/lr:1e-05 - actor/pg_loss:-0.024544130646972917 - actor/pg_clipfrac:0.003700886940350756 - actor/ppo_kl:-0.00033977168504861766 - actor/pg_clipfrac_lower:4.8790006985655054e-05 - actor/grad_norm:3.1819509863853455 - perf/mfu/actor:0.07249478406194827 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.95244979858398 - actor/lr:1e-06 - training/global_step:321 - training/epoch:11 - critic/score/mean:0.72265625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.72265625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:2.5718456697632064e-08 - critic/advantages/max:3.0327208042144775 - critic/advantages/min:-3.013590097427368 - critic/returns/mean:0.6704599261283875 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.58203125 - critic/values/max:1.0390625 - critic/values/min:-0.208984375 - critic/vf_explained_var:0.46887922286987305 - response_length/mean:263.625 - response_length/max:512.0 - response_length/min:130.0 - response_length/clip_ratio:0.01171875 - prompt_length/mean:102.63671875 - prompt_length/max:172.0 - prompt_length/min:67.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.395632565021515e-06 - timing_s/generate_sequences:3.3492136001586914 - timing_s/reshard:0.3020230531692505 - timing_s/gen:4.543639209121466 - timing_s/reward:0.03393705282360315 - timing_s/old_log_prob:2.07921058870852 - timing_s/values:1.350383928976953 - timing_s/adv:0.03445811802521348 - timing_s/update_critic:5.499330983031541 - timing_s/update_actor:6.947336278855801 - timing_s/step:20.49715531198308 - timing_s/stop_profile:2.09687277674675e-06 - timing_per_token_ms/values:0.014402098151477161 - timing_per_token_ms/adv:0.00036750229861686894 - timing_per_token_ms/update_actor:0.07409464585023731 - timing_per_token_ms/update_critic:0.05865139749188423 - timing_per_token_ms/gen:0.06732514238266753 - perf/total_num_tokens:93763 - perf/time_per_step:20.49715531198308 - perf/throughput:1143.6099128495177
[36m(TaskRunner pid=2914832)[0m Training Progress:  74%|███████▍  | 321/435 [1:59:16<45:38, 24.02s/it]
[36m(TaskRunner pid=2914832)[0m step:322 - global_seqlen/min:22724 - global_seqlen/max:24059 - global_seqlen/minmax_diff:1335 - global_seqlen/balanced_min:23345 - global_seqlen/balanced_max:23346 - global_seqlen/mean:23345.25 - actor/entropy:0.047845419496297836 - critic/vf_loss:0.09937737055224716 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.8047456666827202 - critic/grad_norm:13.102200388908386 - perf/mfu/critic:0.0963420187079904 - critic/lr:1e-05 - actor/pg_loss:0.3448564049322158 - actor/pg_clipfrac:0.0042735132374218665 - actor/ppo_kl:0.0009136362641584128 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.9541256427764893 - perf/mfu/actor:0.0733796520964109 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.8601188659668 - actor/lr:1e-06 - training/global_step:322 - training/epoch:11 - critic/score/mean:0.71484375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.71484375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.2328330356581318e-08 - critic/advantages/max:2.4521090984344482 - critic/advantages/min:-2.6548473834991455 - critic/returns/mean:0.6653343439102173 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.73046875 - critic/values/max:1.1796875 - critic/values/min:-0.056396484375 - critic/vf_explained_var:0.348405659198761 - response_length/mean:262.890625 - response_length/max:512.0 - response_length/min:111.0 - response_length/clip_ratio:0.01171875 - prompt_length/mean:101.87890625 - prompt_length/max:173.0 - prompt_length/min:64.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.553010851144791e-06 - timing_s/generate_sequences:3.4061288833618164 - timing_s/reshard:0.8607673048973083 - timing_s/gen:4.881004228722304 - timing_s/reward:0.03340642899274826 - timing_s/old_log_prob:2.0754612060263753 - timing_s/values:1.3436795962043107 - timing_s/adv:0.0345968552865088 - timing_s/update_critic:5.206403728108853 - timing_s/update_actor:6.833632680121809 - timing_s/step:20.4148906650953 - timing_s/stop_profile:1.9832514226436615e-06 - timing_per_token_ms/values:0.01438921832283131 - timing_per_token_ms/adv:0.0003704913771164241 - timing_per_token_ms/update_actor:0.07318011886916835 - timing_per_token_ms/update_critic:0.05575442250681459 - timing_per_token_ms/gen:0.07252606580568059 - perf/total_num_tokens:93381 - perf/time_per_step:20.4148906650953 - perf/throughput:1143.5402904172752
[36m(TaskRunner pid=2914832)[0m Training Progress:  74%|███████▍  | 322/435 [1:59:36<43:12, 22.94s/it]
[36m(TaskRunner pid=2914832)[0m step:323 - global_seqlen/min:22858 - global_seqlen/max:25111 - global_seqlen/minmax_diff:2253 - global_seqlen/balanced_min:23994 - global_seqlen/balanced_max:23995 - global_seqlen/mean:23994.25 - actor/entropy:0.049919240176677704 - critic/vf_loss:0.0863201649626717 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.5965553596615791 - critic/grad_norm:12.391218423843384 - perf/mfu/critic:0.09600782626765669 - critic/lr:1e-05 - actor/pg_loss:0.1931499633938074 - actor/pg_clipfrac:0.00298380087770056 - actor/ppo_kl:0.00023006358333077515 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.9990152716636658 - perf/mfu/actor:0.07147608724577156 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.21004867553711 - actor/lr:1e-06 - training/global_step:323 - training/epoch:11 - critic/score/mean:0.69921875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.69921875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.0373542025376992e-08 - critic/advantages/max:2.6611170768737793 - critic/advantages/min:-2.9059066772460938 - critic/returns/mean:0.6362146735191345 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.57421875 - critic/values/max:1.015625 - critic/values/min:-0.173828125 - critic/vf_explained_var:0.4766519069671631 - response_length/mean:269.3359375 - response_length/max:512.0 - response_length/min:126.0 - response_length/clip_ratio:0.02734375 - prompt_length/mean:105.57421875 - prompt_length/max:165.0 - prompt_length/min:65.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.984904080629349e-06 - timing_s/generate_sequences:3.49676775932312 - timing_s/reshard:0.7755743265151978 - timing_s/gen:5.214712047949433 - timing_s/reward:0.03454347513616085 - timing_s/old_log_prob:2.1222230438143015 - timing_s/values:1.6127949156798422 - timing_s/adv:0.03364540031179786 - timing_s/update_critic:5.37371410895139 - timing_s/update_actor:7.214604259934276 - timing_s/step:21.613791127689183 - timing_s/stop_profile:1.9739381968975067e-06 - timing_per_token_ms/values:0.016803972990193924 - timing_per_token_ms/adv:0.00035055690750698457 - timing_per_token_ms/update_actor:0.07517013721969093 - timing_per_token_ms/update_critic:0.055989602810583676 - timing_per_token_ms/gen:0.07563034152210926 - perf/total_num_tokens:95977 - perf/time_per_step:21.613791127689183 - perf/throughput:1110.13610977582
[36m(TaskRunner pid=2914832)[0m Training Progress:  74%|███████▍  | 323/435 [1:59:58<42:05, 22.55s/it]
[36m(TaskRunner pid=2914832)[0m step:324 - global_seqlen/min:22791 - global_seqlen/max:24383 - global_seqlen/minmax_diff:1592 - global_seqlen/balanced_min:23315 - global_seqlen/balanced_max:23316 - global_seqlen/mean:23315.5 - actor/entropy:0.04994697868824005 - critic/vf_loss:0.05396648582245689 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.7562291547656059 - critic/grad_norm:14.75141304731369 - perf/mfu/critic:0.0973706613777062 - critic/lr:1e-05 - actor/pg_loss:0.02639817469753325 - actor/pg_clipfrac:0.003615658191847615 - actor/ppo_kl:3.470531282800948e-05 - actor/pg_clipfrac_lower:5.444250928121619e-05 - actor/grad_norm:2.7307387590408325 - perf/mfu/actor:0.0736442647110152 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.24446868896484 - actor/lr:1e-06 - training/global_step:324 - training/epoch:11 - critic/score/mean:0.69140625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.69140625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.4784763635589115e-08 - critic/advantages/max:2.8785650730133057 - critic/advantages/min:-3.056910276412964 - critic/returns/mean:0.6344835758209229 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.7109375 - critic/values/max:1.15625 - critic/values/min:0.00101470947265625 - critic/vf_explained_var:0.55298912525177 - response_length/mean:261.0390625 - response_length/max:512.0 - response_length/min:130.0 - response_length/clip_ratio:0.015625 - prompt_length/mean:103.265625 - prompt_length/max:199.0 - prompt_length/min:66.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.142297595739365e-06 - timing_s/generate_sequences:3.43847393989563 - timing_s/reshard:0.9586519598960876 - timing_s/gen:4.980081948917359 - timing_s/reward:0.033560268115252256 - timing_s/old_log_prob:2.0734253129921854 - timing_s/values:1.3540286109782755 - timing_s/adv:0.04305757721886039 - timing_s/update_critic:5.144883099012077 - timing_s/update_actor:6.799423771910369 - timing_s/step:20.43568278104067 - timing_s/stop_profile:1.844950020313263e-06 - timing_per_token_ms/values:0.014518545720424991 - timing_per_token_ms/adv:0.00046168404300637333 - timing_per_token_ms/update_actor:0.07290669052679943 - timing_per_token_ms/update_critic:0.05516591000634853 - timing_per_token_ms/gen:0.07452311897939962 - perf/total_num_tokens:93262 - perf/time_per_step:20.43568278104067 - perf/throughput:1140.921017898707
[36m(TaskRunner pid=2914832)[0m Training Progress:  74%|███████▍  | 324/435 [2:00:18<40:32, 21.92s/it]
[36m(TaskRunner pid=2914832)[0m step:325 - global_seqlen/min:22753 - global_seqlen/max:23420 - global_seqlen/minmax_diff:667 - global_seqlen/balanced_min:22964 - global_seqlen/balanced_max:22964 - global_seqlen/mean:22964.0 - actor/entropy:0.05088316649198532 - critic/vf_loss:0.08451985660940409 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6645450424402952 - critic/grad_norm:8.33184951543808 - perf/mfu/critic:0.09374394841128945 - critic/lr:1e-05 - actor/pg_loss:-0.024140188470482826 - actor/pg_clipfrac:0.0032748708181316033 - actor/ppo_kl:0.00018673403928914922 - actor/pg_clipfrac_lower:5.765682726632804e-05 - actor/grad_norm:3.439734160900116 - perf/mfu/actor:0.06866250759210976 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.6609001159668 - actor/lr:1e-06 - training/global_step:325 - training/epoch:11 - critic/score/mean:0.72265625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.72265625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-9.917566323736082e-09 - critic/advantages/max:3.0002191066741943 - critic/advantages/min:-3.0426368713378906 - critic/returns/mean:0.6682207584381104 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.62109375 - critic/values/max:1.0234375 - critic/values/min:-0.1064453125 - critic/vf_explained_var:0.4994044899940491 - response_length/mean:258.0546875 - response_length/max:512.0 - response_length/min:127.0 - response_length/clip_ratio:0.0234375 - prompt_length/mean:100.7578125 - prompt_length/max:176.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:6.518792361021042e-06 - timing_s/generate_sequences:3.372586965560913 - timing_s/reshard:0.96698397397995 - timing_s/gen:4.949072064831853 - timing_s/reward:0.03378310101106763 - timing_s/old_log_prob:2.394317532889545 - timing_s/values:1.757762267254293 - timing_s/adv:0.03511637030169368 - timing_s/update_critic:5.264916819985956 - timing_s/update_actor:7.181671662256122 - timing_s/step:21.62455207016319 - timing_s/stop_profile:3.9836857467889786e-05 - timing_per_token_ms/values:0.01913606370029495 - timing_per_token_ms/adv:0.0003822980567594243 - timing_per_token_ms/update_actor:0.07818402349608215 - timing_per_token_ms/update_critic:0.05731707041440903 - timing_per_token_ms/gen:0.07491556514837354 - perf/total_num_tokens:91856 - perf/time_per_step:21.62455207016319 - perf/throughput:1061.941071680506
[36m(TaskRunner pid=2914832)[0m Training Progress:  75%|███████▍  | 325/435 [2:00:40<40:01, 21.83s/it]
[36m(TaskRunner pid=2914832)[0m step:326 - global_seqlen/min:22826 - global_seqlen/max:23503 - global_seqlen/minmax_diff:677 - global_seqlen/balanced_min:23072 - global_seqlen/balanced_max:23072 - global_seqlen/mean:23072.0 - actor/entropy:0.05036797747015953 - critic/vf_loss:0.05773203032731544 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.8491951748728752 - critic/grad_norm:23.457520484924316 - perf/mfu/critic:0.08914724976856248 - critic/lr:1e-05 - actor/pg_loss:0.10149306018138304 - actor/pg_clipfrac:0.004063502623466775 - actor/ppo_kl:0.000475511554213881 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.970035493373871 - perf/mfu/actor:0.07306585680840622 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.42203903198242 - actor/lr:1e-06 - training/global_step:326 - training/epoch:11 - critic/score/mean:0.7421875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.7421875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:1.2806727234249138e-08 - critic/advantages/max:2.836528778076172 - critic/advantages/min:-2.880514144897461 - critic/returns/mean:0.6839597821235657 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.80078125 - critic/values/max:1.203125 - critic/values/min:0.01336669921875 - critic/vf_explained_var:0.43303871154785156 - response_length/mean:257.43359375 - response_length/max:512.0 - response_length/min:135.0 - response_length/clip_ratio:0.0234375 - prompt_length/mean:103.06640625 - prompt_length/max:190.0 - prompt_length/min:64.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:6.870366632938385e-06 - timing_s/generate_sequences:3.3706345558166504 - timing_s/reshard:0.5844947099685669 - timing_s/gen:4.61774246301502 - timing_s/reward:0.033353971783071756 - timing_s/old_log_prob:2.076173743698746 - timing_s/values:1.3419635808095336 - timing_s/adv:0.035259065218269825 - timing_s/update_critic:5.5585702527314425 - timing_s/update_actor:6.780195421073586 - timing_s/step:20.452669803984463 - timing_s/stop_profile:1.8356367945671082e-06 - timing_per_token_ms/values:0.014541040880824523 - timing_per_token_ms/adv:0.00038205471153638417 - timing_per_token_ms/update_actor:0.07346779019020443 - timing_per_token_ms/update_critic:0.0602306936192294 - timing_per_token_ms/gen:0.07006877476010227 - perf/total_num_tokens:92288 - perf/time_per_step:20.452669803984463 - perf/throughput:1128.0678865458071
[36m(TaskRunner pid=2914832)[0m Training Progress:  75%|███████▍  | 326/435 [2:01:01<38:55, 21.42s/it]
[36m(TaskRunner pid=2914832)[0m step:327 - global_seqlen/min:21818 - global_seqlen/max:23944 - global_seqlen/minmax_diff:2126 - global_seqlen/balanced_min:22650 - global_seqlen/balanced_max:22651 - global_seqlen/mean:22650.5 - actor/entropy:0.05254563316702843 - critic/vf_loss:0.06580717489123344 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.5820862613618374 - critic/grad_norm:20.032129287719727 - perf/mfu/critic:0.09463911435380586 - critic/lr:1e-05 - actor/pg_loss:0.007042016368359327 - actor/pg_clipfrac:0.004625574525562115 - actor/ppo_kl:6.874228529341053e-05 - actor/pg_clipfrac_lower:7.88146280683577e-05 - actor/grad_norm:3.380284368991852 - perf/mfu/actor:0.0714805030186801 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.6912956237793 - actor/lr:1e-06 - training/global_step:327 - training/epoch:11 - critic/score/mean:0.6953125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.6953125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.6172521100088488e-08 - critic/advantages/max:2.8627688884735107 - critic/advantages/min:-2.5840866565704346 - critic/returns/mean:0.657025933265686 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.703125 - critic/values/max:1.1015625 - critic/values/min:-0.1298828125 - critic/vf_explained_var:0.3115084767341614 - response_length/mean:251.078125 - response_length/max:512.0 - response_length/min:111.0 - response_length/clip_ratio:0.00390625 - prompt_length/mean:102.8359375 - prompt_length/max:186.0 - prompt_length/min:62.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.536006599664688e-06 - timing_s/generate_sequences:3.301978588104248 - timing_s/reshard:0.8685120940208435 - timing_s/gen:4.872388582676649 - timing_s/reward:0.03350073518231511 - timing_s/old_log_prob:2.0715677361004055 - timing_s/values:1.3480148022063076 - timing_s/adv:0.036376592703163624 - timing_s/update_critic:5.13918544864282 - timing_s/update_actor:6.799690320156515 - timing_s/step:20.307397358119488 - timing_s/stop_profile:1.6582198441028595e-06 - timing_per_token_ms/values:0.014878422134238843 - timing_per_token_ms/adv:0.0004014987826224987 - timing_per_token_ms/update_actor:0.07505011280276942 - timing_per_token_ms/update_critic:0.0567226490435401 - timing_per_token_ms/gen:0.07580416613785315 - perf/total_num_tokens:90602 - perf/time_per_step:20.307397358119488 - perf/throughput:1115.3817301429654
[36m(TaskRunner pid=2914832)[0m Training Progress:  75%|███████▌  | 327/435 [2:01:21<37:57, 21.09s/it]
[36m(TaskRunner pid=2914832)[0m step:328 - global_seqlen/min:21732 - global_seqlen/max:25307 - global_seqlen/minmax_diff:3575 - global_seqlen/balanced_min:23157 - global_seqlen/balanced_max:23158 - global_seqlen/mean:23157.25 - actor/entropy:0.0518462248146534 - critic/vf_loss:0.07431979064131156 - critic/vf_clipfrac:4.856254963669926e-05 - critic/vpred_mean:0.699094551615417 - critic/grad_norm:22.017186641693115 - perf/mfu/critic:0.09691640852168616 - critic/lr:1e-05 - actor/pg_loss:0.04440560401417315 - actor/pg_clipfrac:0.003061879389861133 - actor/ppo_kl:-0.00020540601089180655 - actor/pg_clipfrac_lower:7.086167897796258e-05 - actor/grad_norm:3.0340235829353333 - perf/mfu/actor:0.07171968574190055 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.54086685180664 - actor/lr:1e-06 - training/global_step:328 - training/epoch:11 - critic/score/mean:0.703125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.703125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:2.072795624030732e-08 - critic/advantages/max:2.970853805541992 - critic/advantages/min:-2.807201385498047 - critic/returns/mean:0.6644238233566284 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.44921875 - critic/values/max:0.87890625 - critic/values/min:-0.388671875 - critic/vf_explained_var:0.3433603048324585 - response_length/mean:257.18359375 - response_length/max:512.0 - response_length/min:117.0 - response_length/clip_ratio:0.00390625 - prompt_length/mean:104.6484375 - prompt_length/max:196.0 - prompt_length/min:67.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:6.259884685277939e-06 - timing_s/generate_sequences:3.2504897117614746 - timing_s/reshard:0.7841188311576843 - timing_s/gen:4.8126875390298665 - timing_s/reward:0.03447798592969775 - timing_s/old_log_prob:2.3913682377897203 - timing_s/values:1.7388177230022848 - timing_s/adv:0.03377795312553644 - timing_s/update_critic:5.134019900113344 - timing_s/update_actor:6.934231599792838 - timing_s/step:21.091553947888315 - timing_s/stop_profile:2.1401792764663696e-06 - timing_per_token_ms/values:0.018771850316880077 - timing_per_token_ms/adv:0.00036465851002964993 - timing_per_token_ms/update_actor:0.07486026622108452 - timing_per_token_ms/update_critic:0.05542562156682404 - timing_per_token_ms/gen:0.07309782255243649 - perf/total_num_tokens:92629 - perf/time_per_step:21.091553947888315 - perf/throughput:1097.939490718203
[36m(TaskRunner pid=2914832)[0m Training Progress:  75%|███████▌  | 328/435 [2:01:42<37:37, 21.09s/it]
[36m(TaskRunner pid=2914832)[0m step:329 - global_seqlen/min:22540 - global_seqlen/max:23713 - global_seqlen/minmax_diff:1173 - global_seqlen/balanced_min:22997 - global_seqlen/balanced_max:22998 - global_seqlen/mean:22997.5 - actor/entropy:0.051744263619184494 - critic/vf_loss:0.11631233664229512 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.9954413399100304 - critic/grad_norm:53.230780601501465 - perf/mfu/critic:0.08703835632625524 - critic/lr:1e-05 - actor/pg_loss:-0.02098559821024537 - actor/pg_clipfrac:0.004248351790010929 - actor/ppo_kl:0.00025431313315493753 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.318713426589966 - perf/mfu/actor:0.07197703632858578 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.51679229736328 - actor/lr:1e-06 - training/global_step:329 - training/epoch:11 - critic/score/mean:0.73046875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.73046875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:7.421908776450437e-08 - critic/advantages/max:3.0948312282562256 - critic/advantages/min:-2.822813034057617 - critic/returns/mean:0.6744828820228577 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:1.0078125 - critic/values/max:1.390625 - critic/values/min:0.1552734375 - critic/vf_explained_var:0.41271501779556274 - response_length/mean:254.37890625 - response_length/max:512.0 - response_length/min:123.0 - response_length/clip_ratio:0.01171875 - prompt_length/mean:104.95703125 - prompt_length/max:183.0 - prompt_length/min:66.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.499219357967377e-06 - timing_s/generate_sequences:3.185389995574951 - timing_s/reshard:0.5812192559242249 - timing_s/gen:4.5210642027668655 - timing_s/reward:0.03310821810737252 - timing_s/old_log_prob:2.080474062357098 - timing_s/values:1.3436332899145782 - timing_s/adv:0.03380331723019481 - timing_s/update_critic:5.673596571199596 - timing_s/update_actor:6.860045857261866 - timing_s/step:20.552368202246726 - timing_s/stop_profile:5.5409036576747894e-06 - timing_per_token_ms/values:0.014606297313996937 - timing_per_token_ms/adv:0.000367467303295954 - timing_per_token_ms/update_actor:0.0745738216899866 - timing_per_token_ms/update_critic:0.06167623188607018 - timing_per_token_ms/gen:0.06942559547253367 - perf/total_num_tokens:91990 - perf/time_per_step:20.552368202246726 - perf/throughput:1118.9708053929269
[36m(TaskRunner pid=2914832)[0m Training Progress:  76%|███████▌  | 329/435 [2:02:03<36:59, 20.94s/it]
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 330}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and bakes muffins for her friends every day with four. She sells the remainder at the farmers' market daily for $2 per fresh duck egg. How much in dollars does she make every day at the farmers' market? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much Janet makes every day from selling the eggs, we will follow these steps:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. Calculate the number of eggs laid by the ducks in a day.
[36m(TaskRunner pid=2914832)[0m 2. Subtract the number of eggs eaten in the morning and the number of eggs baked.
[36m(TaskRunner pid=2914832)[0m 3. Determine the number of ducks laid in a day.
[36m(TaskRunner pid=2914832)[0m 4. Calculate the total revenue from selling the eggs.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Let's start by calculating the number of eggs laid by the ducks in a day. Janet's ducks lay 16 eggs per day.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Next, Janet eats 3 eggs for breakfast every morning. Therefore, the number of eggs eaten in a day is:
[36m(TaskRunner pid=2914832)[0m \[ 3 \text{ eggs} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Janet bakes 4 eggs for her friends every day. Therefore, the number of eggs baked in a day is:
[36m(TaskRunner pid=2914832)[0m \[ 4 \text{ eggs} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m The number of eggs sold each day is the remainder after subtracting the eggs eaten and the eggs baked. Therefore, the number of eggs sold in a day is:
[36m(TaskRunner pid=2914832)[0m \[ 16 \text{ eggs} - 3 \text{ eggs} - 4 \text{ eggs} = 17 \text{ eggs} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Since Janet sells each egg for $2, the total revenue per day is:
[36m(TaskRunner pid=2914832)[0m \[ 17 \text{ eggs} \times 2 \text{ dollars per egg} = 34 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Therefore, the final answer is:
[36m(TaskRunner pid=2914832)[0m #### 34
[36m(TaskRunner pid=2914832)[0m [ground_truth] 18
[36m(TaskRunner pid=2914832)[0m [score] 0.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1312
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 330}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Tom's restaurant gets 6 reservations a night.  They normally order 2 meals that cost $5 each and a $5 bottle of wine.  How much do they make a week if they are open 2 days a week? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much Tom's restaurant makes a week, we need to follow these steps:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. Calculate the number of reservations per night and the revenue from reservations.
[36m(TaskRunner pid=2914832)[0m 2. Calculate the revenue from meals and the revenue from the wine.
[36m(TaskRunner pid=2914832)[0m 3. Add the two revenues together to get the total revenue for the week.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m First, Tom's restaurant gets 6 reservations a night. They normally order 2 meals that cost $5 each and a $5 bottle of wine. Therefore, the revenue from the meals is:
[36m(TaskRunner pid=2914832)[0m \[ 2 \times 5 = 10 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m The revenue from the wine is:
[36m(TaskRunner pid=2914832)[0m \[ 5 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m So, the total revenue from reservations per night is:
[36m(TaskRunner pid=2914832)[0m \[ 10 + 5 = 15 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m Since they are open 2 days a week, the total revenue for the week is:
[36m(TaskRunner pid=2914832)[0m \[ 15 \times 2 = 30 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Therefore, the final answer is:
[36m(TaskRunner pid=2914832)[0m #### 30
[36m(TaskRunner pid=2914832)[0m [ground_truth] 180
[36m(TaskRunner pid=2914832)[0m [score] 0.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1319
[36m(TaskRunner pid=2914832)[0m step:330 - global_seqlen/min:21356 - global_seqlen/max:24124 - global_seqlen/minmax_diff:2768 - global_seqlen/balanced_min:22683 - global_seqlen/balanced_max:22684 - global_seqlen/mean:22683.5 - actor/entropy:0.05210762470960617 - critic/vf_loss:0.0746052100439556 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6922353748232126 - critic/grad_norm:15.01846969127655 - perf/mfu/critic:0.09531534321681553 - critic/lr:1e-05 - actor/pg_loss:-0.15953097061719745 - actor/pg_clipfrac:0.00484507302462589 - actor/ppo_kl:-2.0376536667754408e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.405741810798645 - perf/mfu/actor:0.07183707200466675 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.92612075805664 - actor/lr:1e-06 - val-core/openai/gsm8k/reward/mean@1:0.5481425322213799 - training/global_step:330 - training/epoch:11 - critic/score/mean:0.734375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.734375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-3.499966183539982e-08 - critic/advantages/max:2.759223222732544 - critic/advantages/min:-2.5873632431030273 - critic/returns/mean:0.6846758723258972 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.84375 - critic/values/max:1.1875 - critic/values/min:-0.0361328125 - critic/vf_explained_var:0.343652606010437 - response_length/mean:252.2578125 - response_length/max:512.0 - response_length/min:118.0 - response_length/clip_ratio:0.015625 - prompt_length/mean:102.171875 - prompt_length/max:211.0 - prompt_length/min:63.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.595851689577103e-06 - timing_s/generate_sequences:3.2445068359375 - timing_s/reshard:0.9272568821907043 - timing_s/gen:4.878462317865342 - timing_s/reward:0.034456608816981316 - timing_s/old_log_prob:2.0700872726738453 - timing_s/values:1.3505431138910353 - timing_s/adv:0.03637373307719827 - timing_s/update_critic:5.112827324774116 - timing_s/update_actor:6.777995690703392 - timing_s/testing:13.452225900720805 - timing_s/step:33.72336488496512 - timing_s/stop_profile:2.2281892597675323e-06 - timing_per_token_ms/values:0.014884642073434824 - timing_per_token_ms/adv:0.0004008831648246332 - timing_per_token_ms/update_actor:0.07470182831907986 - timing_per_token_ms/update_critic:0.05634962995981789 - timing_per_token_ms/gen:0.07554371949991238 - perf/total_num_tokens:90734 - perf/time_per_step:33.72336488496512 - perf/throughput:672.6345392097269
[36m(TaskRunner pid=2914832)[0m Training Progress:  76%|███████▌  | 330/435 [2:02:36<43:21, 24.78s/it]
[36m(TaskRunner pid=2914832)[0m step:331 - global_seqlen/min:22085 - global_seqlen/max:23108 - global_seqlen/minmax_diff:1023 - global_seqlen/balanced_min:22422 - global_seqlen/balanced_max:22423 - global_seqlen/mean:22422.25 - actor/entropy:0.051771461963653564 - critic/vf_loss:0.0690813778055599 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6881006490439177 - critic/grad_norm:18.101027250289917 - perf/mfu/critic:0.08746384016885439 - critic/lr:1e-05 - actor/pg_loss:-0.06520211149472743 - actor/pg_clipfrac:0.0035241280929767527 - actor/ppo_kl:0.0007208313754745177 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.3793084025382996 - perf/mfu/actor:0.0673449307503615 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.60968780517578 - actor/lr:1e-06 - training/global_step:331 - training/epoch:11 - critic/score/mean:0.73046875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.73046875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.7832455512234446e-08 - critic/advantages/max:2.7471864223480225 - critic/advantages/min:-2.8884012699127197 - critic/returns/mean:0.6952050924301147 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.5703125 - critic/values/max:0.89453125 - critic/values/min:-0.2265625 - critic/vf_explained_var:0.4817056655883789 - response_length/mean:246.92578125 - response_length/max:512.0 - response_length/min:128.0 - response_length/clip_ratio:0.00390625 - prompt_length/mean:103.421875 - prompt_length/max:171.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.3800100684165955e-06 - timing_s/generate_sequences:3.2318947315216064 - timing_s/reshard:0.3008701801300049 - timing_s/gen:4.540152901317924 - timing_s/reward:0.032394027803093195 - timing_s/old_log_prob:2.1111464640125632 - timing_s/values:1.3430796582251787 - timing_s/adv:0.034422522876411676 - timing_s/update_critic:5.501333239022642 - timing_s/update_actor:7.141916161868721 - timing_s/step:20.7128663090989 - timing_s/stop_profile:1.9762665033340454e-06 - timing_per_token_ms/values:0.014974853752691843 - timing_per_token_ms/adv:0.0003837987141835864 - timing_per_token_ms/update_actor:0.07962978918115624 - timing_per_token_ms/update_critic:0.061337881334641284 - timing_per_token_ms/gen:0.0718230886260409 - perf/total_num_tokens:89689 - perf/time_per_step:20.7128663090989 - perf/throughput:1082.5276263261637
[36m(TaskRunner pid=2914832)[0m Training Progress:  76%|███████▌  | 331/435 [2:02:57<40:50, 23.56s/it]
[36m(TaskRunner pid=2914832)[0m step:332 - global_seqlen/min:22006 - global_seqlen/max:23610 - global_seqlen/minmax_diff:1604 - global_seqlen/balanced_min:23094 - global_seqlen/balanced_max:23095 - global_seqlen/mean:23094.5 - actor/entropy:0.049044594168663025 - critic/vf_loss:0.09136987221427262 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6619316320866346 - critic/grad_norm:18.257468700408936 - perf/mfu/critic:0.09694413901545065 - critic/lr:1e-05 - actor/pg_loss:-0.1291730687371455 - actor/pg_clipfrac:0.004169465217273682 - actor/ppo_kl:0.0008246836141552194 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.2862106561660767 - perf/mfu/actor:0.07301644931395553 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.7204818725586 - actor/lr:1e-06 - training/global_step:332 - training/epoch:11 - critic/score/mean:0.74609375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.74609375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:3.7915928174925284e-08 - critic/advantages/max:2.5272862911224365 - critic/advantages/min:-2.8471858501434326 - critic/returns/mean:0.702686607837677 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.80078125 - critic/values/max:1.1328125 - critic/values/min:-0.02001953125 - critic/vf_explained_var:0.4168509244918823 - response_length/mean:256.04296875 - response_length/max:512.0 - response_length/min:114.0 - response_length/clip_ratio:0.00390625 - prompt_length/mean:104.80859375 - prompt_length/max:188.0 - prompt_length/min:70.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.33996319770813e-06 - timing_s/generate_sequences:3.2595694065093994 - timing_s/reshard:0.8881381750106812 - timing_s/gen:4.828483285848051 - timing_s/reward:0.0377489197999239 - timing_s/old_log_prob:2.08091063471511 - timing_s/values:1.3524683662690222 - timing_s/adv:0.034953147172927856 - timing_s/update_critic:5.117036013863981 - timing_s/update_actor:6.789975834079087 - timing_s/step:20.24840900208801 - timing_s/stop_profile:1.7248094081878662e-06 - timing_per_token_ms/values:0.014640589385665658 - timing_per_token_ms/adv:0.0003783709018697943 - timing_per_token_ms/update_actor:0.0735020874459188 - timing_per_token_ms/update_critic:0.05539236629786292 - timing_per_token_ms/gen:0.07366444361828994 - perf/total_num_tokens:92378 - perf/time_per_step:20.24840900208801 - perf/throughput:1140.55874699185
[36m(TaskRunner pid=2914832)[0m Training Progress:  76%|███████▋  | 332/435 [2:03:17<38:44, 22.57s/it]
[36m(TaskRunner pid=2914832)[0m step:333 - global_seqlen/min:22397 - global_seqlen/max:23210 - global_seqlen/minmax_diff:813 - global_seqlen/balanced_min:22789 - global_seqlen/balanced_max:22790 - global_seqlen/mean:22789.25 - actor/entropy:0.05361677333712578 - critic/vf_loss:0.059637871192535385 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6646039839833975 - critic/grad_norm:12.177945733070374 - perf/mfu/critic:0.09466631489233793 - critic/lr:1e-05 - actor/pg_loss:0.05544443475082517 - actor/pg_clipfrac:0.004337255108112004 - actor/ppo_kl:0.00014741496852366254 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.920215368270874 - perf/mfu/actor:0.07156757784245661 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.31251907348633 - actor/lr:1e-06 - training/global_step:333 - training/epoch:11 - critic/score/mean:0.6640625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.6640625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.1831086110802858e-09 - critic/advantages/max:2.3233642578125 - critic/advantages/min:-2.622704029083252 - critic/returns/mean:0.6220420002937317 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.5625 - critic/values/max:0.95703125 - critic/values/min:-0.1669921875 - critic/vf_explained_var:0.4108660817146301 - response_length/mean:251.8984375 - response_length/max:507.0 - response_length/min:124.0 - response_length/clip_ratio:0.0 - prompt_length/mean:104.18359375 - prompt_length/max:184.0 - prompt_length/min:73.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.5353157222270966e-06 - timing_s/generate_sequences:3.208022117614746 - timing_s/reshard:0.8505412340164185 - timing_s/gen:4.7086369739845395 - timing_s/reward:0.03325934195891023 - timing_s/old_log_prob:2.083734075073153 - timing_s/values:1.3561757020652294 - timing_s/adv:0.03458271920681 - timing_s/update_critic:5.170782056171447 - timing_s/update_actor:6.835213028360158 - timing_s/step:20.230357540771365 - timing_s/stop_profile:1.0453164577484131e-05 - timing_per_token_ms/values:0.01487736215611779 - timing_per_token_ms/adv:0.0003793753546826903 - timing_per_token_ms/update_actor:0.07498286503900038 - timing_per_token_ms/update_critic:0.05672391649759697 - timing_per_token_ms/gen:0.07301797248991315 - perf/total_num_tokens:91157 - perf/time_per_step:20.230357540771365 - perf/throughput:1126.4877525803267
[36m(TaskRunner pid=2914832)[0m Training Progress:  77%|███████▋  | 333/435 [2:03:37<37:10, 21.87s/it]
[36m(TaskRunner pid=2914832)[0m step:334 - global_seqlen/min:21792 - global_seqlen/max:23595 - global_seqlen/minmax_diff:1803 - global_seqlen/balanced_min:22959 - global_seqlen/balanced_max:22960 - global_seqlen/mean:22959.5 - actor/entropy:0.05201707407832146 - critic/vf_loss:0.05954271036898717 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6862901411950588 - critic/grad_norm:10.846446752548218 - perf/mfu/critic:0.09316553714641852 - critic/lr:1e-05 - actor/pg_loss:0.024992240127176046 - actor/pg_clipfrac:0.003468622307991609 - actor/ppo_kl:0.00014853365064482205 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.7352438271045685 - perf/mfu/actor:0.0688274732440625 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.3734130859375 - actor/lr:1e-06 - training/global_step:334 - training/epoch:11 - critic/score/mean:0.703125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.703125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:9.3934460210221e-09 - critic/advantages/max:2.6228079795837402 - critic/advantages/min:-2.836535692214966 - critic/returns/mean:0.6444349884986877 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.71484375 - critic/values/max:1.171875 - critic/values/min:-0.072265625 - critic/vf_explained_var:0.41375476121902466 - response_length/mean:256.58984375 - response_length/max:512.0 - response_length/min:115.0 - response_length/clip_ratio:0.02734375 - prompt_length/mean:102.15234375 - prompt_length/max:195.0 - prompt_length/min:71.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.563270628452301e-06 - timing_s/generate_sequences:3.4926304817199707 - timing_s/reshard:0.6842267513275146 - timing_s/gen:5.11286153877154 - timing_s/reward:0.036941248923540115 - timing_s/old_log_prob:2.1180916419252753 - timing_s/values:1.6313263173215091 - timing_s/adv:0.03514109831303358 - timing_s/update_critic:5.295911672990769 - timing_s/update_actor:7.164679724723101 - timing_s/step:21.405558549333364 - timing_s/stop_profile:1.996755599975586e-06 - timing_per_token_ms/values:0.017763086274978867 - timing_per_token_ms/adv:0.00038264224300435095 - timing_per_token_ms/update_actor:0.07801432658292973 - timing_per_token_ms/update_critic:0.05766579926599849 - timing_per_token_ms/gen:0.07783673388602828 - perf/total_num_tokens:91838 - perf/time_per_step:21.405558549333364 - perf/throughput:1072.5952302101937
[36m(TaskRunner pid=2914832)[0m Training Progress:  77%|███████▋  | 334/435 [2:03:59<36:35, 21.74s/it]
[36m(TaskRunner pid=2914832)[0m step:335 - global_seqlen/min:22741 - global_seqlen/max:23574 - global_seqlen/minmax_diff:833 - global_seqlen/balanced_min:22983 - global_seqlen/balanced_max:22983 - global_seqlen/mean:22983.0 - actor/entropy:0.05587832257151604 - critic/vf_loss:0.07338695274665952 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6075842306017876 - critic/grad_norm:15.0754114985466 - perf/mfu/critic:0.09233288652872641 - critic/lr:1e-05 - actor/pg_loss:0.04283844435121864 - actor/pg_clipfrac:0.004223970579914749 - actor/ppo_kl:0.0004202633525665078 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.017868757247925 - perf/mfu/actor:0.07268073968010379 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.5134048461914 - actor/lr:1e-06 - training/global_step:335 - training/epoch:11 - critic/score/mean:0.69921875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.69921875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-6.9975643057773596e-09 - critic/advantages/max:2.820619821548462 - critic/advantages/min:-2.6924870014190674 - critic/returns/mean:0.6385447978973389 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.71484375 - critic/values/max:1.171875 - critic/values/min:-0.1865234375 - critic/vf_explained_var:0.37336796522140503 - response_length/mean:254.47265625 - response_length/max:512.0 - response_length/min:103.0 - response_length/clip_ratio:0.0234375 - prompt_length/mean:104.63671875 - prompt_length/max:202.0 - prompt_length/min:65.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.7050416469573975e-06 - timing_s/generate_sequences:3.459437370300293 - timing_s/reshard:0.5827270150184631 - timing_s/gen:4.750643863808364 - timing_s/reward:0.03884673770517111 - timing_s/old_log_prob:2.0783434184268117 - timing_s/values:1.3867825157940388 - timing_s/adv:0.03868563612923026 - timing_s/update_critic:5.347132840193808 - timing_s/update_actor:6.789774842560291 - timing_s/step:20.4400047743693 - timing_s/stop_profile:1.8533319234848022e-06 - timing_per_token_ms/values:0.015084872686268532 - timing_per_token_ms/adv:0.00042080707620012904 - timing_per_token_ms/update_actor:0.07385649004220828 - timing_per_token_ms/update_critic:0.058163999915087326 - timing_per_token_ms/gen:0.0729241517201376 - perf/total_num_tokens:91932 - perf/time_per_step:20.4400047743693 - perf/throughput:1124.4126532112891
[36m(TaskRunner pid=2914832)[0m Training Progress:  77%|███████▋  | 335/435 [2:04:19<35:34, 21.35s/it]
[36m(TaskRunner pid=2914832)[0m step:336 - global_seqlen/min:22183 - global_seqlen/max:24403 - global_seqlen/minmax_diff:2220 - global_seqlen/balanced_min:23283 - global_seqlen/balanced_max:23284 - global_seqlen/mean:23283.75 - actor/entropy:0.049899570643901825 - critic/vf_loss:0.06503353200969286 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6365476679056883 - critic/grad_norm:11.110498428344727 - perf/mfu/critic:0.09759957061582239 - critic/lr:1e-05 - actor/pg_loss:-0.18678608862683177 - actor/pg_clipfrac:0.00444761011749506 - actor/ppo_kl:0.00028521444801299367 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.7926231026649475 - perf/mfu/actor:0.0731328884259861 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.67258834838867 - actor/lr:1e-06 - training/global_step:336 - training/epoch:11 - critic/score/mean:0.69921875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.69921875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:6.442002487005993e-09 - critic/advantages/max:3.1205968856811523 - critic/advantages/min:-3.0492172241210938 - critic/returns/mean:0.646594762802124 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.5 - critic/values/max:0.97265625 - critic/values/min:-0.435546875 - critic/vf_explained_var:0.4587307572364807 - response_length/mean:259.9375 - response_length/max:512.0 - response_length/min:132.0 - response_length/clip_ratio:0.01171875 - prompt_length/mean:103.87109375 - prompt_length/max:184.0 - prompt_length/min:69.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.02287831902504e-06 - timing_s/generate_sequences:3.2934813499450684 - timing_s/reshard:0.8526409864425659 - timing_s/gen:4.770022027660161 - timing_s/reward:0.033584549091756344 - timing_s/old_log_prob:2.0774074671790004 - timing_s/values:1.3411653311923146 - timing_s/adv:0.03336753835901618 - timing_s/update_critic:5.1295011499896646 - timing_s/update_actor:6.8404149119742215 - timing_s/step:20.232097326777875 - timing_s/stop_profile:1.461198553442955e-05 - timing_per_token_ms/values:0.014400229035188861 - timing_per_token_ms/adv:0.0003582706647234249 - timing_per_token_ms/update_actor:0.07344623301631203 - timing_per_token_ms/update_critic:0.05507597734460369 - timing_per_token_ms/gen:0.0716822257102092 - perf/total_num_tokens:93135 - perf/time_per_step:20.232097326777875 - perf/throughput:1150.8322456111932
[36m(TaskRunner pid=2914832)[0m Training Progress:  77%|███████▋  | 336/435 [2:04:40<34:40, 21.02s/it]
[36m(TaskRunner pid=2914832)[0m step:337 - global_seqlen/min:22419 - global_seqlen/max:24609 - global_seqlen/minmax_diff:2190 - global_seqlen/balanced_min:23491 - global_seqlen/balanced_max:23492 - global_seqlen/mean:23491.75 - actor/entropy:0.05016696825623512 - critic/vf_loss:0.053316730860387906 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.685859676450491 - critic/grad_norm:11.303584635257721 - perf/mfu/critic:0.09369891847556555 - critic/lr:1e-05 - actor/pg_loss:-0.03681806044187397 - actor/pg_clipfrac:0.0043350573869247455 - actor/ppo_kl:-0.0001523508899481385 - actor/pg_clipfrac_lower:0.00012886598415207118 - actor/grad_norm:3.306338667869568 - perf/mfu/actor:0.07013582281225272 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.42923355102539 - actor/lr:1e-06 - training/global_step:337 - training/epoch:11 - critic/score/mean:0.6875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.6875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-3.2747551337308778e-09 - critic/advantages/max:2.7136268615722656 - critic/advantages/min:-2.6995513439178467 - critic/returns/mean:0.6263335347175598 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.734375 - critic/values/max:1.1484375 - critic/values/min:-0.11083984375 - critic/vf_explained_var:0.4398874044418335 - response_length/mean:261.07421875 - response_length/max:512.0 - response_length/min:114.0 - response_length/clip_ratio:0.015625 - prompt_length/mean:105.984375 - prompt_length/max:256.0 - prompt_length/min:70.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:6.027054041624069e-06 - timing_s/generate_sequences:3.4693093299865723 - timing_s/reshard:0.7770401835441589 - timing_s/gen:5.206542278174311 - timing_s/reward:0.03372581675648689 - timing_s/old_log_prob:2.1343455729074776 - timing_s/values:1.6136178271844983 - timing_s/adv:0.03353492263704538 - timing_s/update_critic:5.388041940983385 - timing_s/update_actor:7.194524409249425 - timing_s/step:21.61221050983295 - timing_s/stop_profile:2.9671937227249146e-06 - timing_per_token_ms/values:0.01717217562744898 - timing_per_token_ms/adv:0.00035687978372242793 - timing_per_token_ms/update_actor:0.07656437269732379 - timing_per_token_ms/update_critic:0.057339725020309096 - timing_per_token_ms/gen:0.07790143305415292 - perf/total_num_tokens:93967 - perf/time_per_step:21.61221050983295 - perf/throughput:1086.9665548238072
[36m(TaskRunner pid=2914832)[0m Training Progress:  77%|███████▋  | 337/435 [2:05:01<34:38, 21.20s/it]
[36m(TaskRunner pid=2914832)[0m step:338 - global_seqlen/min:22219 - global_seqlen/max:23169 - global_seqlen/minmax_diff:950 - global_seqlen/balanced_min:22842 - global_seqlen/balanced_max:22843 - global_seqlen/mean:22842.5 - actor/entropy:0.051981426775455475 - critic/vf_loss:0.08944369410164654 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.5048303976655006 - critic/grad_norm:23.110835790634155 - perf/mfu/critic:0.09224773262293734 - critic/lr:1e-05 - actor/pg_loss:-0.029940373729914427 - actor/pg_clipfrac:0.003164585374179296 - actor/ppo_kl:0.0005758315037382999 - actor/pg_clipfrac_lower:6.313131598290056e-05 - actor/grad_norm:3.090411603450775 - perf/mfu/actor:0.07206742226612106 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.16954040527344 - actor/lr:1e-06 - training/global_step:338 - training/epoch:11 - critic/score/mean:0.6953125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.6953125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-3.1554538537648114e-08 - critic/advantages/max:2.684861421585083 - critic/advantages/min:-2.514601707458496 - critic/returns/mean:0.6448646783828735 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.51171875 - critic/values/max:0.9140625 - critic/values/min:-0.232421875 - critic/vf_explained_var:0.36026012897491455 - response_length/mean:254.0625 - response_length/max:512.0 - response_length/min:124.0 - response_length/clip_ratio:0.0078125 - prompt_length/mean:102.8515625 - prompt_length/max:177.0 - prompt_length/min:65.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.3229741752147675e-06 - timing_s/generate_sequences:3.441765785217285 - timing_s/reshard:0.9638060331344604 - timing_s/gen:5.168893238063902 - timing_s/reward:0.03301134193316102 - timing_s/old_log_prob:2.0839530657976866 - timing_s/values:1.3436769992113113 - timing_s/adv:0.033099635038524866 - timing_s/update_critic:5.31739515485242 - timing_s/update_actor:6.8030905071645975 - timing_s/step:20.790606600698084 - timing_s/stop_profile:2.5010667741298676e-06 - timing_per_token_ms/values:0.01470588813846242 - timing_per_token_ms/adv:0.0003622593306175426 - timing_per_token_ms/update_actor:0.07445650111814159 - timing_per_token_ms/update_critic:0.05819629150544402 - timing_per_token_ms/gen:0.0794725282605151 - perf/total_num_tokens:91370 - perf/time_per_step:20.790606600698084 - perf/throughput:1098.6932915768325
[36m(TaskRunner pid=2914832)[0m Training Progress:  78%|███████▊  | 338/435 [2:05:22<34:05, 21.08s/it]
[36m(TaskRunner pid=2914832)[0m step:339 - global_seqlen/min:22395 - global_seqlen/max:24151 - global_seqlen/minmax_diff:1756 - global_seqlen/balanced_min:22924 - global_seqlen/balanced_max:22925 - global_seqlen/mean:22924.75 - actor/entropy:0.05042553320527077 - critic/vf_loss:0.11215140779677313 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.8603401593863964 - critic/grad_norm:34.839434027671814 - perf/mfu/critic:0.0897515059459572 - critic/lr:1e-05 - actor/pg_loss:0.1228060902794823 - actor/pg_clipfrac:0.0038981347752269357 - actor/ppo_kl:0.0008343419542597985 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.237885534763336 - perf/mfu/actor:0.06911649563420409 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.66011047363281 - actor/lr:1e-06 - training/global_step:339 - training/epoch:11 - critic/score/mean:0.71484375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.71484375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-6.504011551555777e-09 - critic/advantages/max:2.5936357975006104 - critic/advantages/min:-2.652977466583252 - critic/returns/mean:0.6553407907485962 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.68359375 - critic/values/max:1.109375 - critic/values/min:-0.12158203125 - critic/vf_explained_var:0.37571048736572266 - response_length/mean:256.02734375 - response_length/max:512.0 - response_length/min:114.0 - response_length/clip_ratio:0.01171875 - prompt_length/mean:102.171875 - prompt_length/max:232.0 - prompt_length/min:67.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.120171070098877e-06 - timing_s/generate_sequences:3.3936994075775146 - timing_s/reshard:0.5826598405838013 - timing_s/gen:5.018629767931998 - timing_s/reward:0.03618579311296344 - timing_s/old_log_prob:2.12468837806955 - timing_s/values:1.6172288460657 - timing_s/adv:0.03513059811666608 - timing_s/update_critic:5.4859168459661305 - timing_s/update_actor:7.11941982107237 - timing_s/step:21.44363479875028 - timing_s/stop_profile:7.690396159887314e-06 - timing_per_token_ms/values:0.017636275707103678 - timing_per_token_ms/adv:0.00038310775599151656 - timing_per_token_ms/update_actor:0.07763901265087264 - timing_per_token_ms/update_critic:0.059825263590291396 - timing_per_token_ms/gen:0.07657003444962845 - perf/total_num_tokens:91699 - perf/time_per_step:21.44363479875028 - perf/throughput:1069.070156022991
[36m(TaskRunner pid=2914832)[0m Training Progress:  78%|███████▊  | 339/435 [2:05:43<33:54, 21.20s/it]
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 340}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and bakes muffins for her friends every day with four. She sells the remainder at the farmers' market daily for $2 per fresh duck egg. How much in dollars does she make every day at the farmers' market? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much Janet makes every day from selling the eggs, we will follow these steps:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. Calculate the number of eggs laid by the ducks in a day.
[36m(TaskRunner pid=2914832)[0m 2. Subtract the number of eggs eaten in the morning and the number of eggs baked.
[36m(TaskRunner pid=2914832)[0m 3. Sell the remaining eggs at the farmers' market.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m First, Janet's ducks lay 16 eggs per day. Janet eats 3 eggs for breakfast and bakes 4 eggs for her friends. Therefore, the number of eggs laid minus the eggs eaten and the eggs baked is:
[36m(TaskRunner pid=2914832)[0m \[ 16 - 3 - 4 = 10 \text{ eggs per day} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Since Janet sells each egg for $2, the total revenue from selling the eggs is:
[36m(TaskRunner pid=2914832)[0m \[ 10 \times 2 = 20 \text{ dollars per day} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Therefore, the final answer is:
[36m(TaskRunner pid=2914832)[0m #### 20
[36m(TaskRunner pid=2914832)[0m [ground_truth] 18
[36m(TaskRunner pid=2914832)[0m [score] 0.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1312
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 340}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Tom's restaurant gets 6 reservations a night.  They normally order 2 meals that cost $5 each and a $5 bottle of wine.  How much do they make a week if they are open 2 days a week? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much Tom's restaurant makes a week, we need to follow these steps:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. Calculate the number of reservations per night and the revenue from reservations.
[36m(TaskRunner pid=2914832)[0m 2. Calculate the revenue from meals and the revenue from the bottle of wine.
[36m(TaskRunner pid=2914832)[0m 3. Add the two revenues together to get the total revenue for the week.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m First, Tom's restaurant gets 6 reservations a night. They normally order 2 meals that cost $5 each and a $5 bottle of wine. Therefore, the revenue from the meals per night is:
[36m(TaskRunner pid=2914832)[0m \[ 2 \times 5 = 10 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m The revenue from the wine per night is:
[36m(TaskRunner pid=2914832)[0m \[ 5 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m So, the total revenue from reservations per night is:
[36m(TaskRunner pid=2914832)[0m \[ 10 + 5 = 15 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m Since they are open 2 days a week, the total revenue for the week is:
[36m(TaskRunner pid=2914832)[0m \[ 2 \times 15 = 30 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Therefore, the final answer is:
[36m(TaskRunner pid=2914832)[0m #### 30
[36m(TaskRunner pid=2914832)[0m [ground_truth] 180
[36m(TaskRunner pid=2914832)[0m [score] 0.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1319
[36m(TaskRunner pid=2914832)[0m step:340 - global_seqlen/min:22683 - global_seqlen/max:23644 - global_seqlen/minmax_diff:961 - global_seqlen/balanced_min:23019 - global_seqlen/balanced_max:23020 - global_seqlen/mean:23019.25 - actor/entropy:0.05237627774477005 - critic/vf_loss:0.08955084951594472 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.7044359557330608 - critic/grad_norm:19.138829946517944 - perf/mfu/critic:0.09623069556159658 - critic/lr:1e-05 - actor/pg_loss:-0.0650006226496771 - actor/pg_clipfrac:0.004140880988416029 - actor/ppo_kl:0.00029397781827356084 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.7435452342033386 - perf/mfu/actor:0.07276791860782232 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.29584121704102 - actor/lr:1e-06 - val-core/openai/gsm8k/reward/mean@1:0.5420773313115997 - training/global_step:340 - training/epoch:11 - critic/score/mean:0.70703125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.70703125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:1.0015652307515666e-08 - critic/advantages/max:2.6636390686035156 - critic/advantages/min:-2.7824952602386475 - critic/returns/mean:0.6505311727523804 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.90234375 - critic/values/max:1.3203125 - critic/values/min:0.11962890625 - critic/vf_explained_var:0.4252192974090576 - response_length/mean:258.875 - response_length/max:512.0 - response_length/min:38.0 - response_length/clip_ratio:0.01171875 - prompt_length/mean:100.80078125 - prompt_length/max:170.0 - prompt_length/min:70.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.007721483707428e-06 - timing_s/generate_sequences:3.466341257095337 - timing_s/reshard:0.9623572826385498 - timing_s/gen:4.904077468905598 - timing_s/reward:0.03324464522302151 - timing_s/old_log_prob:2.0785610456950963 - timing_s/values:1.4082694882526994 - timing_s/adv:0.03386107133701444 - timing_s/update_critic:5.139008051715791 - timing_s/update_actor:6.792208286002278 - timing_s/testing:13.583936362992972 - timing_s/step:33.98008894873783 - timing_s/stop_profile:2.273824065923691e-06 - timing_per_token_ms/values:0.015294476234593866 - timing_per_token_ms/adv:0.0003677473346982899 - timing_per_token_ms/update_actor:0.0737666114882357 - timing_per_token_ms/update_critic:0.05581207089409724 - timing_per_token_ms/gen:0.0739992375197006 - perf/total_num_tokens:92077 - perf/time_per_step:33.98008894873783 - perf/throughput:677.433482729451
[36m(TaskRunner pid=2914832)[0m Training Progress:  78%|███████▊  | 340/435 [2:06:17<39:38, 25.03s/it]
[36m(TaskRunner pid=2914832)[0m step:341 - global_seqlen/min:22097 - global_seqlen/max:23500 - global_seqlen/minmax_diff:1403 - global_seqlen/balanced_min:22744 - global_seqlen/balanced_max:22745 - global_seqlen/mean:22744.75 - actor/entropy:0.053141217678785324 - critic/vf_loss:0.08472068380797282 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.4067766056396067 - critic/grad_norm:28.83433222770691 - perf/mfu/critic:0.08783207923240954 - critic/lr:1e-05 - actor/pg_loss:-0.034609028487466276 - actor/pg_clipfrac:0.0047965822741389275 - actor/ppo_kl:0.0010384502108991 - actor/pg_clipfrac_lower:5.8085501223104075e-05 - actor/grad_norm:3.010247230529785 - perf/mfu/actor:0.06895056409364551 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:87.91586685180664 - actor/lr:1e-06 - training/global_step:341 - training/epoch:11 - critic/score/mean:0.6328125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.6328125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-4.024485278364409e-08 - critic/advantages/max:2.552766799926758 - critic/advantages/min:-2.714486837387085 - critic/returns/mean:0.5684176087379456 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.38671875 - critic/values/max:0.8359375 - critic/values/min:-0.326171875 - critic/vf_explained_var:0.46940696239471436 - response_length/mean:251.87109375 - response_length/max:512.0 - response_length/min:117.0 - response_length/clip_ratio:0.01953125 - prompt_length/mean:103.515625 - prompt_length/max:182.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.69014048576355e-06 - timing_s/generate_sequences:3.216156005859375 - timing_s/reshard:0.30079224705696106 - timing_s/gen:4.514290469698608 - timing_s/reward:0.03360893903300166 - timing_s/old_log_prob:2.103924449067563 - timing_s/values:1.346075126901269 - timing_s/adv:0.044255138374865055 - timing_s/update_critic:5.566357391886413 - timing_s/update_actor:7.078347069211304 - timing_s/step:20.695622148923576 - timing_s/stop_profile:1.8239952623844147e-06 - timing_per_token_ms/values:0.014795448695866837 - timing_per_token_ms/adv:0.00048643245556518597 - timing_per_token_ms/update_actor:0.07780198803252733 - timing_per_token_ms/update_critic:0.061182881674742666 - timing_per_token_ms/gen:0.07001179406781445 - perf/total_num_tokens:90979 - perf/time_per_step:20.695622148923576 - perf/throughput:1099.0126238453288
[36m(TaskRunner pid=2914832)[0m Training Progress:  78%|███████▊  | 341/435 [2:06:38<37:11, 23.74s/it]
[36m(TaskRunner pid=2914832)[0m step:342 - global_seqlen/min:21416 - global_seqlen/max:23737 - global_seqlen/minmax_diff:2321 - global_seqlen/balanced_min:22590 - global_seqlen/balanced_max:22591 - global_seqlen/mean:22590.5 - actor/entropy:0.05019337683916092 - critic/vf_loss:0.05562679254217073 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.7890216503292322 - critic/grad_norm:25.01476812362671 - perf/mfu/critic:0.09289406651624955 - critic/lr:1e-05 - actor/pg_loss:-0.061684051226620795 - actor/pg_clipfrac:0.004480307761696167 - actor/ppo_kl:0.0006401556865966995 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.112139582633972 - perf/mfu/actor:0.07125779720576023 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.34651184082031 - actor/lr:1e-06 - training/global_step:342 - training/epoch:11 - critic/score/mean:0.70703125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.70703125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:4.334546055417832e-09 - critic/advantages/max:2.725505828857422 - critic/advantages/min:-2.9461092948913574 - critic/returns/mean:0.6720211505889893 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.62890625 - critic/values/max:1.03125 - critic/values/min:-0.1494140625 - critic/vf_explained_var:0.4326821565628052 - response_length/mean:250.95703125 - response_length/max:472.0 - response_length/min:100.0 - response_length/clip_ratio:0.0 - prompt_length/mean:102.01953125 - prompt_length/max:180.0 - prompt_length/min:67.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.115048795938492e-06 - timing_s/generate_sequences:3.201565742492676 - timing_s/reshard:0.8610771894454956 - timing_s/gen:4.623114043381065 - timing_s/reward:0.03553877491503954 - timing_s/old_log_prob:2.0855706818401814 - timing_s/values:1.422743794042617 - timing_s/adv:0.03587533067911863 - timing_s/update_critic:5.221648142207414 - timing_s/update_actor:6.802842635195702 - timing_s/step:20.234396046958864 - timing_s/stop_profile:2.1010637283325195e-06 - timing_per_token_ms/values:0.01574493475180515 - timing_per_token_ms/adv:0.00039701789113918057 - timing_per_token_ms/update_actor:0.07528433008560792 - timing_per_token_ms/update_critic:0.057785885020333924 - timing_per_token_ms/gen:0.07196068244036213 - perf/total_num_tokens:90362 - perf/time_per_step:20.234396046958864 - perf/throughput:1116.4405375664894
[36m(TaskRunner pid=2914832)[0m Training Progress:  79%|███████▊  | 342/435 [2:06:58<35:09, 22.69s/it]
[36m(TaskRunner pid=2914832)[0m step:343 - global_seqlen/min:21985 - global_seqlen/max:24013 - global_seqlen/minmax_diff:2028 - global_seqlen/balanced_min:22978 - global_seqlen/balanced_max:22979 - global_seqlen/mean:22978.75 - actor/entropy:0.05319977551698685 - critic/vf_loss:0.09112765362442588 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.7102243397384882 - critic/grad_norm:21.05038595199585 - perf/mfu/critic:0.09565743964254161 - critic/lr:1e-05 - actor/pg_loss:0.23992345808073878 - actor/pg_clipfrac:0.004364803768112324 - actor/ppo_kl:0.0005893729994568275 - actor/pg_clipfrac_lower:4.340277882874943e-05 - actor/grad_norm:3.0909119248390198 - perf/mfu/actor:0.07263138492386212 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.43883514404297 - actor/lr:1e-06 - training/global_step:343 - training/epoch:11 - critic/score/mean:0.6484375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.6484375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-3.673618564903336e-08 - critic/advantages/max:2.8202755451202393 - critic/advantages/min:-2.463677406311035 - critic/returns/mean:0.5928835868835449 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.8671875 - critic/values/max:1.28125 - critic/values/min:0.058837890625 - critic/vf_explained_var:0.3694116473197937 - response_length/mean:256.55859375 - response_length/max:512.0 - response_length/min:133.0 - response_length/clip_ratio:0.015625 - prompt_length/mean:102.484375 - prompt_length/max:216.0 - prompt_length/min:67.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.036817699670792e-06 - timing_s/generate_sequences:3.473252534866333 - timing_s/reshard:0.8916818499565125 - timing_s/gen:4.889430663082749 - timing_s/reward:0.03363052383065224 - timing_s/old_log_prob:2.406843756791204 - timing_s/values:1.34417434502393 - timing_s/adv:0.03963606106117368 - timing_s/update_critic:5.163518264889717 - timing_s/update_actor:6.794985088054091 - timing_s/step:20.678977463860065 - timing_s/stop_profile:3.4347176551818848e-06 - timing_per_token_ms/values:0.014624102105466247 - timing_per_token_ms/adv:0.00043122516521975387 - timing_per_token_ms/update_actor:0.07392683553341774 - timing_per_token_ms/update_critic:0.056177101288034784 - timing_per_token_ms/gen:0.07444435303647663 - perf/total_num_tokens:91915 - perf/time_per_step:20.678977463860065 - perf/throughput:1111.213068448823
[36m(TaskRunner pid=2914832)[0m Training Progress:  79%|███████▉  | 343/435 [2:07:19<33:52, 22.09s/it]
[36m(TaskRunner pid=2914832)[0m step:344 - global_seqlen/min:23445 - global_seqlen/max:25101 - global_seqlen/minmax_diff:1656 - global_seqlen/balanced_min:24222 - global_seqlen/balanced_max:24223 - global_seqlen/mean:24222.25 - actor/entropy:0.05772468075156212 - critic/vf_loss:0.06860750494524837 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.477329621091485 - critic/grad_norm:15.81101679801941 - perf/mfu/critic:0.10106921164319142 - critic/lr:1e-05 - actor/pg_loss:0.02317943563684821 - actor/pg_clipfrac:0.0038733138972020242 - actor/ppo_kl:0.00010088808448927011 - actor/pg_clipfrac_lower:6.510417006211355e-05 - actor/grad_norm:3.0739800930023193 - perf/mfu/actor:0.07592707671696083 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.24691390991211 - actor/lr:1e-06 - training/global_step:344 - training/epoch:11 - critic/score/mean:0.63671875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.63671875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:1.0850908616077959e-08 - critic/advantages/max:2.7855679988861084 - critic/advantages/min:-2.7674314975738525 - critic/returns/mean:0.5798471570014954 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.4453125 - critic/values/max:0.84375 - critic/values/min:-0.27734375 - critic/vf_explained_var:0.5229856967926025 - response_length/mean:271.90625 - response_length/max:512.0 - response_length/min:142.0 - response_length/clip_ratio:0.015625 - prompt_length/mean:106.56640625 - prompt_length/max:199.0 - prompt_length/min:64.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.273614078760147e-06 - timing_s/generate_sequences:3.536789894104004 - timing_s/reshard:0.583867073059082 - timing_s/gen:5.045718573965132 - timing_s/reward:0.03377368859946728 - timing_s/old_log_prob:2.0780848530121148 - timing_s/values:1.345005493145436 - timing_s/adv:0.03431660495698452 - timing_s/update_critic:5.155976966954768 - timing_s/update_actor:6.85887517593801 - timing_s/step:20.559191817883402 - timing_s/stop_profile:2.596992999315262e-06 - timing_per_token_ms/values:0.013881921509618596 - timing_per_token_ms/adv:0.00035418473672949995 - timing_per_token_ms/update_actor:0.07079106168850964 - timing_per_token_ms/update_critic:0.05321529757717355 - timing_per_token_ms/gen:0.07248762461161264 - perf/total_num_tokens:96889 - perf/time_per_step:20.559191817883402 - perf/throughput:1178.1713121101525
[36m(TaskRunner pid=2914832)[0m Training Progress:  79%|███████▉  | 344/435 [2:07:40<32:48, 21.63s/it]
[36m(TaskRunner pid=2914832)[0m step:345 - global_seqlen/min:22295 - global_seqlen/max:24392 - global_seqlen/minmax_diff:2097 - global_seqlen/balanced_min:23232 - global_seqlen/balanced_max:23233 - global_seqlen/mean:23232.25 - actor/entropy:0.05069485306739807 - critic/vf_loss:0.11604200903093442 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.7950753457844257 - critic/grad_norm:22.337650775909424 - perf/mfu/critic:0.09322434342820733 - critic/lr:1e-05 - actor/pg_loss:0.221789964241907 - actor/pg_clipfrac:0.0043599189521046355 - actor/ppo_kl:0.0014796193483164188 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.256675064563751 - perf/mfu/actor:0.06992631267907506 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.39097595214844 - actor/lr:1e-06 - training/global_step:345 - training/epoch:11 - critic/score/mean:0.69921875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.69921875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.607145527771081e-08 - critic/advantages/max:2.2775795459747314 - critic/advantages/min:-2.5182933807373047 - critic/returns/mean:0.6480938792228699 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.75 - critic/values/max:1.0703125 - critic/values/min:0.022705078125 - critic/vf_explained_var:0.3811759352684021 - response_length/mean:257.29296875 - response_length/max:512.0 - response_length/min:125.0 - response_length/clip_ratio:0.01171875 - prompt_length/mean:105.7109375 - prompt_length/max:194.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.694797098636627e-06 - timing_s/generate_sequences:3.3508591651916504 - timing_s/reshard:0.5804405212402344 - timing_s/gen:4.535922916140407 - timing_s/reward:0.03316504508256912 - timing_s/old_log_prob:2.071431902702898 - timing_s/values:1.3479173630475998 - timing_s/adv:0.03367306897416711 - timing_s/update_critic:5.35346190398559 - timing_s/update_actor:7.133029151707888 - timing_s/step:20.5152360717766 - timing_s/stop_profile:9.233132004737854e-06 - timing_per_token_ms/values:0.014504808650126438 - timing_per_token_ms/adv:0.0003623526452901366 - timing_per_token_ms/update_actor:0.07675783826047722 - timing_per_token_ms/update_critic:0.057608086861857866 - timing_per_token_ms/gen:0.0688648779531542 - perf/total_num_tokens:92929 - perf/time_per_step:20.5152360717766 - perf/throughput:1132.438833202669
[36m(TaskRunner pid=2914832)[0m Training Progress:  79%|███████▉  | 345/435 [2:08:00<31:57, 21.30s/it]
[36m(TaskRunner pid=2914832)[0m step:346 - global_seqlen/min:23741 - global_seqlen/max:24018 - global_seqlen/minmax_diff:277 - global_seqlen/balanced_min:23862 - global_seqlen/balanced_max:23862 - global_seqlen/mean:23862.0 - actor/entropy:0.05017826706171036 - critic/vf_loss:0.07516066869720817 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.4911334179341793 - critic/grad_norm:24.277291774749756 - perf/mfu/critic:0.09677779371113837 - critic/lr:1e-05 - actor/pg_loss:0.16917570075020194 - actor/pg_clipfrac:0.0033584002885618247 - actor/ppo_kl:0.00046304447641887236 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.973945438861847 - perf/mfu/actor:0.07430088991645532 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.77013397216797 - actor/lr:1e-06 - training/global_step:346 - training/epoch:11 - critic/score/mean:0.6796875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.6796875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-5.519528833985987e-09 - critic/advantages/max:2.47491192817688 - critic/advantages/min:-2.411501407623291 - critic/returns/mean:0.6173731684684753 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.65234375 - critic/values/max:1.015625 - critic/values/min:-0.064453125 - critic/vf_explained_var:0.4122447967529297 - response_length/mean:267.609375 - response_length/max:512.0 - response_length/min:125.0 - response_length/clip_ratio:0.0078125 - prompt_length/mean:105.234375 - prompt_length/max:238.0 - prompt_length/min:56.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.844980478286743e-06 - timing_s/generate_sequences:3.341132640838623 - timing_s/reshard:0.9017246961593628 - timing_s/gen:4.899391705170274 - timing_s/reward:0.03351004468277097 - timing_s/old_log_prob:2.075405803974718 - timing_s/values:1.3424232578836381 - timing_s/adv:0.03285200381651521 - timing_s/update_critic:5.30282581364736 - timing_s/update_actor:6.901543837971985 - timing_s/step:20.59547448111698 - timing_s/stop_profile:2.8409995138645172e-06 - timing_per_token_ms/values:0.014064446168422996 - timing_per_token_ms/adv:0.0003441874509315565 - timing_per_token_ms/update_actor:0.07230684601009958 - timing_per_token_ms/update_critic:0.05555722292397284 - timing_per_token_ms/gen:0.07151561431030352 - perf/total_num_tokens:95448 - perf/time_per_step:20.59547448111698 - perf/throughput:1158.604042935643
[36m(TaskRunner pid=2914832)[0m Training Progress:  80%|███████▉  | 346/435 [2:08:21<31:17, 21.09s/it]
[36m(TaskRunner pid=2914832)[0m step:347 - global_seqlen/min:23277 - global_seqlen/max:23869 - global_seqlen/minmax_diff:592 - global_seqlen/balanced_min:23619 - global_seqlen/balanced_max:23620 - global_seqlen/mean:23619.5 - actor/entropy:0.04742015153169632 - critic/vf_loss:0.07079465023707598 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6343014147132635 - critic/grad_norm:18.802918195724487 - perf/mfu/critic:0.09764571897981829 - critic/lr:1e-05 - actor/pg_loss:-0.02175010257633403 - actor/pg_clipfrac:0.0031293776992242783 - actor/ppo_kl:0.0005860975643372512 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.1498636603355408 - perf/mfu/actor:0.07368641969307056 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.3675422668457 - actor/lr:1e-06 - training/global_step:347 - training/epoch:11 - critic/score/mean:0.64453125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.64453125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:1.3132749110411623e-08 - critic/advantages/max:2.581637382507324 - critic/advantages/min:-2.4991872310638428 - critic/returns/mean:0.6142730712890625 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.47265625 - critic/values/max:0.84375 - critic/values/min:-0.216796875 - critic/vf_explained_var:0.37012040615081787 - response_length/mean:264.375 - response_length/max:512.0 - response_length/min:115.0 - response_length/clip_ratio:0.01953125 - prompt_length/mean:104.6796875 - prompt_length/max:217.0 - prompt_length/min:66.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.050096660852432e-06 - timing_s/generate_sequences:3.454261302947998 - timing_s/reshard:0.6789205074310303 - timing_s/gen:5.109026220161468 - timing_s/reward:0.03308230917900801 - timing_s/old_log_prob:2.133556514978409 - timing_s/values:1.6287607639096677 - timing_s/adv:0.03297215607017279 - timing_s/update_critic:5.198181925341487 - timing_s/update_actor:6.885779746808112 - timing_s/step:21.02801871392876 - timing_s/stop_profile:2.0149163901805878e-06 - timing_per_token_ms/values:0.017239577085773065 - timing_per_token_ms/adv:0.0003489929514825969 - timing_per_token_ms/update_actor:0.07288236146836419 - timing_per_token_ms/update_critic:0.055020025035897105 - timing_per_token_ms/gen:0.07548797606621555 - perf/total_num_tokens:94478 - perf/time_per_step:21.02801871392876 - perf/throughput:1123.2394416861855
[36m(TaskRunner pid=2914832)[0m Training Progress:  80%|███████▉  | 347/435 [2:08:42<30:54, 21.08s/it]
[36m(TaskRunner pid=2914832)[0m step:348 - global_seqlen/min:23357 - global_seqlen/max:24687 - global_seqlen/minmax_diff:1330 - global_seqlen/balanced_min:23854 - global_seqlen/balanced_max:23855 - global_seqlen/mean:23854.75 - actor/entropy:0.04815296828746796 - critic/vf_loss:0.07802056403306779 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.677770372480154 - critic/grad_norm:16.705844342708588 - perf/mfu/critic:0.0885669671921657 - critic/lr:1e-05 - actor/pg_loss:0.06712933978997171 - actor/pg_clipfrac:0.0032643851554894354 - actor/ppo_kl:-7.780095484122285e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.1761032938957214 - perf/mfu/actor:0.0754758731461615 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.59093856811523 - actor/lr:1e-06 - training/global_step:348 - training/epoch:11 - critic/score/mean:0.6796875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.6796875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:5.007269621160049e-08 - critic/advantages/max:3.030337333679199 - critic/advantages/min:-2.6893222332000732 - critic/returns/mean:0.6332371830940247 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.78125 - critic/values/max:1.1796875 - critic/values/min:-0.00113677978515625 - critic/vf_explained_var:0.42386454343795776 - response_length/mean:268.0546875 - response_length/max:512.0 - response_length/min:132.0 - response_length/clip_ratio:0.0234375 - prompt_length/mean:104.67578125 - prompt_length/max:169.0 - prompt_length/min:70.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.422144800424576e-06 - timing_s/generate_sequences:3.575246572494507 - timing_s/reshard:0.5819400548934937 - timing_s/gen:4.843640795908868 - timing_s/reward:0.03400252293795347 - timing_s/old_log_prob:2.080484770704061 - timing_s/values:1.3492647330276668 - timing_s/adv:0.03336978983134031 - timing_s/update_critic:5.789018536917865 - timing_s/update_actor:6.791908625047654 - timing_s/step:20.92836185824126 - timing_s/stop_profile:1.9031576812267303e-06 - timing_per_token_ms/values:0.014140419969059273 - timing_per_token_ms/adv:0.0003497185029327525 - timing_per_token_ms/update_actor:0.07117983446742948 - timing_per_token_ms/update_critic:0.06066945301164197 - timing_per_token_ms/gen:0.0705843722991004 - perf/total_num_tokens:95419 - perf/time_per_step:20.92836185824126 - perf/throughput:1139.828819932525
[36m(TaskRunner pid=2914832)[0m Training Progress:  80%|████████  | 348/435 [2:09:03<30:30, 21.04s/it]
[36m(TaskRunner pid=2914832)[0m step:349 - global_seqlen/min:22806 - global_seqlen/max:23960 - global_seqlen/minmax_diff:1154 - global_seqlen/balanced_min:23324 - global_seqlen/balanced_max:23325 - global_seqlen/mean:23324.5 - actor/entropy:0.048536933958530426 - critic/vf_loss:0.07478455966338515 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.44133035046979785 - critic/grad_norm:32.62604475021362 - perf/mfu/critic:0.09588966485807274 - critic/lr:1e-05 - actor/pg_loss:0.14541429257951677 - actor/pg_clipfrac:0.004676966302213259 - actor/ppo_kl:0.0006291801273619058 - actor/pg_clipfrac_lower:5.287647945806384e-05 - actor/grad_norm:2.9106706976890564 - perf/mfu/actor:0.0731497682312494 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.56841659545898 - actor/lr:1e-06 - training/global_step:349 - training/epoch:12 - critic/score/mean:0.71484375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.71484375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:3.574174911591399e-08 - critic/advantages/max:2.5979998111724854 - critic/advantages/min:-2.982478380203247 - critic/returns/mean:0.6666317582130432 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.423828125 - critic/values/max:0.88671875 - critic/values/min:-0.376953125 - critic/vf_explained_var:0.45707207918167114 - response_length/mean:261.1953125 - response_length/max:512.0 - response_length/min:136.0 - response_length/clip_ratio:0.01953125 - prompt_length/mean:103.25 - prompt_length/max:186.0 - prompt_length/min:66.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:1.8625054508447647e-05 - timing_s/generate_sequences:3.3164312839508057 - timing_s/reshard:0.5897493362426758 - timing_s/gen:4.986325493082404 - timing_s/reward:0.03687908034771681 - timing_s/old_log_prob:2.1000631507486105 - timing_s/values:1.6332341618835926 - timing_s/adv:0.03644205117598176 - timing_s/update_critic:5.226599578280002 - timing_s/update_actor:6.848368952050805 - timing_s/step:20.87983084982261 - timing_s/stop_profile:2.5602057576179504e-06 - timing_per_token_ms/values:0.01750556455533444 - timing_per_token_ms/adv:0.00039059841771508244 - timing_per_token_ms/update_actor:0.07340316997203375 - timing_per_token_ms/update_critic:0.05602048895238914 - timing_per_token_ms/gen:0.07457191237822516 - perf/total_num_tokens:93298 - perf/time_per_step:20.87983084982261 - perf/throughput:1117.0828043464805
[36m(TaskRunner pid=2914832)[0m Training Progress:  80%|████████  | 349/435 [2:09:24<30:17, 21.13s/it]
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 350}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and bakes muffins for her friends every day with four. She sells the remainder at the farmers' market daily for $2 per fresh duck egg. How much in dollars does she make every day at the farmers' market? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much Janet makes every day from selling the eggs, we will follow these steps:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. Calculate the number of eggs Janet lays in a day.
[36m(TaskRunner pid=2914832)[0m 2. Subtract the number of eggs she eats in a day.
[36m(TaskRunner pid=2914832)[0m 3. Subtract the number of muffins she bakes in a day.
[36m(TaskRunner pid=2914832)[0m 4. Determine the number of ducks she has and calculate the revenue from selling the eggs.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Let's start with the number of eggs Janet lays in a day:
[36m(TaskRunner pid=2914832)[0m \[ \text{Number of eggs per day} = 16 \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Next, we subtract the number of eggs she eats in a day:
[36m(TaskRunner pid=2914832)[0m \[ \text{Eggs eaten in a day} = 3 \]
[36m(TaskRunner pid=2914832)[0m \[ \text{Number of eggs remaining} = 16 - 3 = 13 \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Then, we subtract the number of muffins she bakes in a day:
[36m(TaskRunner pid=2914832)[0m \[ \text{Muffins baked in a day} = 4 \]
[36m(TaskRunner pid=2914832)[0m \[ \text{Number of eggs remaining for sale} = 13 - 4 = 9 \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Since she sells each egg for $2, the total revenue from selling the eggs is:
[36m(TaskRunner pid=2914832)[0m \[ \text{Revenue} = 9 \times 2 = 18 \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Therefore, the final answer is:
[36m(TaskRunner pid=2914832)[0m \[ \boxed{18} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m #### 18
[36m(TaskRunner pid=2914832)[0m [ground_truth] 18
[36m(TaskRunner pid=2914832)[0m [score] 1.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1312
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 350}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Tom's restaurant gets 6 reservations a night.  They normally order 2 meals that cost $5 each and a $5 bottle of wine.  How much do they make a week if they are open 2 days a week? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much Tom's restaurant makes in a week, we will follow these steps:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. Calculate the number of reservations per night and the revenue from reservations.
[36m(TaskRunner pid=2914832)[0m 2. Calculate the revenue from meals and the revenue from the wine.
[36m(TaskRunner pid=2914832)[0m 3. Add the two amounts together to find the total revenue for the week.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m First, Tom's restaurant gets 6 reservations a night. They normally order 2 meals that cost $5 each and a $5 bottle of wine. Therefore, the revenue from the meals per night is:
[36m(TaskRunner pid=2914832)[0m \[ 2 \times 5 = 10 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m The revenue from the wine per night is:
[36m(TaskRunner pid=2914832)[0m \[ 5 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m So, the revenue from reservations per night is:
[36m(TaskRunner pid=2914832)[0m \[ 10 + 5 = 15 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m Since they are open 2 days a week, the total revenue for the week is:
[36m(TaskRunner pid=2914832)[0m \[ 2 \times 15 = 30 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Therefore, the final answer is:
[36m(TaskRunner pid=2914832)[0m \[
[36m(TaskRunner pid=2914832)[0m \boxed{30}
[36m(TaskRunner pid=2914832)[0m \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m #### 30
[36m(TaskRunner pid=2914832)[0m [ground_truth] 180
[36m(TaskRunner pid=2914832)[0m [score] 0.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1319
[36m(TaskRunner pid=2914832)[0m step:350 - global_seqlen/min:22666 - global_seqlen/max:23055 - global_seqlen/minmax_diff:389 - global_seqlen/balanced_min:22854 - global_seqlen/balanced_max:22855 - global_seqlen/mean:22854.75 - actor/entropy:0.04486566036939621 - critic/vf_loss:0.06533950450830162 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.856973011046648 - critic/grad_norm:35.63384926319122 - perf/mfu/critic:0.09317077556121697 - critic/lr:1e-05 - actor/pg_loss:0.051265460439026356 - actor/pg_clipfrac:0.0043238686776021495 - actor/ppo_kl:0.0005207959159179154 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.353191316127777 - perf/mfu/actor:0.06898476861284347 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.34120559692383 - actor/lr:1e-06 - val-core/openai/gsm8k/reward/mean@1:0.5428354814253222 - training/global_step:350 - training/epoch:12 - critic/score/mean:0.72265625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.72265625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-4.1883252421826e-10 - critic/advantages/max:3.0343456268310547 - critic/advantages/min:-3.313870668411255 - critic/returns/mean:0.6792307496070862 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.6796875 - critic/values/max:1.203125 - critic/values/min:-0.1435546875 - critic/vf_explained_var:0.45614516735076904 - response_length/mean:253.4921875 - response_length/max:512.0 - response_length/min:128.0 - response_length/clip_ratio:0.0078125 - prompt_length/mean:103.61328125 - prompt_length/max:189.0 - prompt_length/min:66.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.343928933143616e-06 - timing_s/generate_sequences:3.307251453399658 - timing_s/reshard:0.5793624520301819 - timing_s/gen:4.58916412293911 - timing_s/reward:0.035175974015146494 - timing_s/old_log_prob:2.0776967788115144 - timing_s/values:1.3392697046510875 - timing_s/adv:0.03430254990234971 - timing_s/update_critic:5.266600077971816 - timing_s/update_actor:7.109691306017339 - timing_s/testing:13.818911329843104 - timing_s/step:34.27778566675261 - timing_s/stop_profile:2.530869096517563e-06 - timing_per_token_ms/values:0.014649796045144745 - timing_per_token_ms/adv:0.00037522342075881066 - timing_per_token_ms/update_actor:0.07777039024729367 - timing_per_token_ms/update_critic:0.0576094693441387 - timing_per_token_ms/gen:0.0707178494612616 - perf/total_num_tokens:91419 - perf/time_per_step:34.27778566675261 - perf/throughput:666.7510621074842
[36m(TaskRunner pid=2914832)[0m Training Progress:  80%|████████  | 350/435 [2:09:58<35:32, 25.09s/it]
[36m(TaskRunner pid=2914832)[0m step:351 - global_seqlen/min:22925 - global_seqlen/max:24087 - global_seqlen/minmax_diff:1162 - global_seqlen/balanced_min:23332 - global_seqlen/balanced_max:23333 - global_seqlen/mean:23332.25 - actor/entropy:0.045872852206230164 - critic/vf_loss:0.10195410303276731 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.9770969823002815 - critic/grad_norm:31.921664714813232 - perf/mfu/critic:0.09103687527124756 - critic/lr:1e-05 - actor/pg_loss:0.013447740813717246 - actor/pg_clipfrac:0.004242828174028546 - actor/ppo_kl:0.0002237153214537102 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.1941041350364685 - perf/mfu/actor:0.06998633300258172 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.33771514892578 - actor/lr:1e-06 - training/global_step:351 - training/epoch:12 - critic/score/mean:0.73046875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.73046875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:6.935658092288577e-08 - critic/advantages/max:2.7983317375183105 - critic/advantages/min:-2.9933736324310303 - critic/returns/mean:0.6780359745025635 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:1.03125 - critic/values/max:1.5234375 - critic/values/min:0.12451171875 - critic/vf_explained_var:0.42569923400878906 - response_length/mean:261.578125 - response_length/max:512.0 - response_length/min:101.0 - response_length/clip_ratio:0.015625 - prompt_length/mean:102.98828125 - prompt_length/max:222.0 - prompt_length/min:70.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.492940545082092e-06 - timing_s/generate_sequences:3.436755895614624 - timing_s/reshard:0.30108270049095154 - timing_s/gen:4.344102603849024 - timing_s/reward:0.03313026903197169 - timing_s/old_log_prob:2.1306914538145065 - timing_s/values:1.6315290690399706 - timing_s/adv:0.036505046766251326 - timing_s/update_critic:5.506435493007302 - timing_s/update_actor:7.158686467912048 - timing_s/step:20.849041626788676 - timing_s/stop_profile:2.9122456908226013e-06 - timing_per_token_ms/values:0.01748148023701069 - timing_per_token_ms/adv:0.0003911436613083964 - timing_per_token_ms/update_actor:0.07670377340282279 - timing_per_token_ms/update_critic:0.05900026243726283 - timing_per_token_ms/gen:0.0648722090055705 - perf/total_num_tokens:93329 - perf/time_per_step:20.849041626788676 - perf/throughput:1119.104197577153
[36m(TaskRunner pid=2914832)[0m Training Progress:  81%|████████  | 351/435 [2:10:19<33:20, 23.82s/it]
[36m(TaskRunner pid=2914832)[0m step:352 - global_seqlen/min:22809 - global_seqlen/max:24748 - global_seqlen/minmax_diff:1939 - global_seqlen/balanced_min:23660 - global_seqlen/balanced_max:23661 - global_seqlen/mean:23660.5 - actor/entropy:0.04856584221124649 - critic/vf_loss:0.09553441603202373 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.3485125992447138 - critic/grad_norm:39.0530059337616 - perf/mfu/critic:0.09893311919678154 - critic/lr:1e-05 - actor/pg_loss:0.03296299371868372 - actor/pg_clipfrac:0.003506403576466255 - actor/ppo_kl:-6.748200894435286e-05 - actor/pg_clipfrac_lower:0.0001115477025450673 - actor/grad_norm:3.3596686124801636 - perf/mfu/actor:0.0749146565874936 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.24748229980469 - actor/lr:1e-06 - training/global_step:352 - training/epoch:12 - critic/score/mean:0.68359375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.68359375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:1.6001342473259683e-08 - critic/advantages/max:2.937312364578247 - critic/advantages/min:-2.996168375015259 - critic/returns/mean:0.6383126974105835 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.498046875 - critic/values/max:0.97265625 - critic/values/min:-0.359375 - critic/vf_explained_var:0.45968329906463623 - response_length/mean:264.0078125 - response_length/max:512.0 - response_length/min:131.0 - response_length/clip_ratio:0.03125 - prompt_length/mean:105.6875 - prompt_length/max:256.0 - prompt_length/min:67.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.623085260391235e-06 - timing_s/generate_sequences:3.588932752609253 - timing_s/reshard:0.8712441921234131 - timing_s/gen:5.060105666983873 - timing_s/reward:0.03361180704087019 - timing_s/old_log_prob:2.0832221331074834 - timing_s/values:1.349506855942309 - timing_s/adv:0.03457489097490907 - timing_s/update_critic:5.141615883912891 - timing_s/update_actor:6.786927773151547 - timing_s/step:20.497801376972347 - timing_s/stop_profile:1.993030309677124e-06 - timing_per_token_ms/values:0.014259069503416126 - timing_per_token_ms/adv:0.0003653229113386136 - timing_per_token_ms/update_actor:0.07171158442500736 - timing_per_token_ms/update_critic:0.05432699947077292 - timing_per_token_ms/gen:0.07486913957008659 - perf/total_num_tokens:94642 - perf/time_per_step:20.497801376972347 - perf/throughput:1154.2945296845687
[36m(TaskRunner pid=2914832)[0m Training Progress:  81%|████████  | 352/435 [2:10:40<31:34, 22.83s/it]
[36m(TaskRunner pid=2914832)[0m step:353 - global_seqlen/min:22887 - global_seqlen/max:23967 - global_seqlen/minmax_diff:1080 - global_seqlen/balanced_min:23432 - global_seqlen/balanced_max:23433 - global_seqlen/mean:23432.75 - actor/entropy:0.05061839520931244 - critic/vf_loss:0.07394494503751048 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6159109529107809 - critic/grad_norm:22.658590078353882 - perf/mfu/critic:0.09180427931574534 - critic/lr:1e-05 - actor/pg_loss:-0.1317703048698604 - actor/pg_clipfrac:0.0034435749039403163 - actor/ppo_kl:0.0009265218232030747 - actor/pg_clipfrac_lower:5.879586024093442e-05 - actor/grad_norm:3.410657227039337 - perf/mfu/actor:0.07059888468109134 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.50518035888672 - actor/lr:1e-06 - training/global_step:353 - training/epoch:12 - critic/score/mean:0.69140625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.69140625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-2.224658501859267e-08 - critic/advantages/max:2.9821414947509766 - critic/advantages/min:-2.7035930156707764 - critic/returns/mean:0.6216927766799927 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.412109375 - critic/values/max:0.8359375 - critic/values/min:-0.443359375 - critic/vf_explained_var:0.4552755355834961 - response_length/mean:262.65234375 - response_length/max:512.0 - response_length/min:112.0 - response_length/clip_ratio:0.01953125 - prompt_length/mean:103.484375 - prompt_length/max:182.0 - prompt_length/min:56.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.7439167499542236e-06 - timing_s/generate_sequences:3.4721896648406982 - timing_s/reshard:0.7770823836326599 - timing_s/gen:5.2167283510789275 - timing_s/reward:0.034017276018857956 - timing_s/old_log_prob:2.137343612033874 - timing_s/values:1.6158082731999457 - timing_s/adv:0.03351514786481857 - timing_s/update_critic:5.484666709788144 - timing_s/update_actor:7.127962498925626 - timing_s/step:21.65795869100839 - timing_s/stop_profile:3.875000402331352e-05 - timing_per_token_ms/values:0.01723878197394614 - timing_per_token_ms/adv:0.0003575673775465809 - timing_per_token_ms/update_actor:0.0760470121830091 - timing_per_token_ms/update_critic:0.05851497060511617 - timing_per_token_ms/gen:0.07758485924952672 - perf/total_num_tokens:93731 - perf/time_per_step:21.65795869100839 - perf/throughput:1081.9463798187242
[36m(TaskRunner pid=2914832)[0m Training Progress:  81%|████████  | 353/435 [2:11:02<30:43, 22.48s/it]
[36m(TaskRunner pid=2914832)[0m step:354 - global_seqlen/min:23391 - global_seqlen/max:24425 - global_seqlen/minmax_diff:1034 - global_seqlen/balanced_min:23761 - global_seqlen/balanced_max:23762 - global_seqlen/mean:23761.75 - actor/entropy:0.048863112926483154 - critic/vf_loss:0.0553182419098448 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.7196259181946516 - critic/grad_norm:13.719934940338135 - perf/mfu/critic:0.09760255627888123 - critic/lr:1e-05 - actor/pg_loss:-0.0582065237686038 - actor/pg_clipfrac:0.0027068644340033643 - actor/ppo_kl:0.00010098797793034464 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.6563271284103394 - perf/mfu/actor:0.07449613987264837 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.5990219116211 - actor/lr:1e-06 - training/global_step:354 - training/epoch:12 - critic/score/mean:0.75 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.75 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:1.5197581859638376e-08 - critic/advantages/max:2.600630283355713 - critic/advantages/min:-2.9664101600646973 - critic/returns/mean:0.7081857919692993 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.77734375 - critic/values/max:1.1484375 - critic/values/min:-0.0166015625 - critic/vf_explained_var:0.39486628770828247 - response_length/mean:268.04296875 - response_length/max:512.0 - response_length/min:144.0 - response_length/clip_ratio:0.0234375 - prompt_length/mean:103.234375 - prompt_length/max:199.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:6.401911377906799e-06 - timing_s/generate_sequences:3.4966373443603516 - timing_s/reshard:0.9618614315986633 - timing_s/gen:4.971540921833366 - timing_s/reward:0.03348533436655998 - timing_s/old_log_prob:2.0761513030156493 - timing_s/values:1.3572611100971699 - timing_s/adv:0.0350266108289361 - timing_s/update_critic:5.233295807149261 - timing_s/update_actor:6.852999872062355 - timing_s/step:20.567264626268297 - timing_s/stop_profile:2.244953066110611e-06 - timing_per_token_ms/values:0.014279894263860721 - timing_per_token_ms/adv:0.0003685188467698728 - timing_per_token_ms/update_actor:0.07210116965356461 - timing_per_token_ms/update_critic:0.055060084033680824 - timing_per_token_ms/gen:0.07245137530178763 - perf/total_num_tokens:95047 - perf/time_per_step:20.567264626268297 - perf/throughput:1155.3189221697346
[36m(TaskRunner pid=2914832)[0m Training Progress:  81%|████████▏ | 354/435 [2:11:22<29:34, 21.91s/it]
[36m(TaskRunner pid=2914832)[0m step:355 - global_seqlen/min:23139 - global_seqlen/max:23520 - global_seqlen/minmax_diff:381 - global_seqlen/balanced_min:23380 - global_seqlen/balanced_max:23381 - global_seqlen/mean:23380.25 - actor/entropy:0.046943455934524536 - critic/vf_loss:0.07178368922905065 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.8043240383267403 - critic/grad_norm:15.293185710906982 - perf/mfu/critic:0.09312212728966333 - critic/lr:1e-05 - actor/pg_loss:-0.04561133426614106 - actor/pg_clipfrac:0.003943491079553496 - actor/ppo_kl:0.00033964560861932114 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.1080405712127686 - perf/mfu/actor:0.06987078415738057 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.40661239624023 - actor/lr:1e-06 - training/global_step:355 - training/epoch:12 - critic/score/mean:0.703125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.703125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.4146306348550297e-08 - critic/advantages/max:2.800788164138794 - critic/advantages/min:-2.5644731521606445 - critic/returns/mean:0.647678792476654 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.66015625 - critic/values/max:1.015625 - critic/values/min:-0.11767578125 - critic/vf_explained_var:0.38423097133636475 - response_length/mean:262.0234375 - response_length/max:512.0 - response_length/min:130.0 - response_length/clip_ratio:0.00390625 - prompt_length/mean:103.29296875 - prompt_length/max:189.0 - prompt_length/min:72.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.0102750062942505e-06 - timing_s/generate_sequences:3.322341203689575 - timing_s/reshard:0.7772381901741028 - timing_s/gen:5.198341593146324 - timing_s/reward:0.03383478196337819 - timing_s/old_log_prob:2.143023299984634 - timing_s/values:1.6239944091066718 - timing_s/adv:0.033819427248090506 - timing_s/update_critic:5.393974627833813 - timing_s/update_actor:7.184780217707157 - timing_s/step:21.618772816844285 - timing_s/stop_profile:1.5129335224628448e-06 - timing_per_token_ms/values:0.017365023995751454 - timing_per_token_ms/adv:0.0003616238839200875 - timing_per_token_ms/update_actor:0.07682531428991518 - timing_per_token_ms/update_critic:0.057676614106284295 - timing_per_token_ms/gen:0.0774969676070593 - perf/total_num_tokens:93521 - perf/time_per_step:21.618772816844285 - perf/throughput:1081.4790551748274
[36m(TaskRunner pid=2914832)[0m Training Progress:  82%|████████▏ | 355/435 [2:11:44<29:05, 21.82s/it]
[36m(TaskRunner pid=2914832)[0m step:356 - global_seqlen/min:22623 - global_seqlen/max:24692 - global_seqlen/minmax_diff:2069 - global_seqlen/balanced_min:23893 - global_seqlen/balanced_max:23894 - global_seqlen/mean:23893.75 - actor/entropy:0.05194238945841789 - critic/vf_loss:0.0402698012185283 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6525403819978237 - critic/grad_norm:9.446457386016846 - perf/mfu/critic:0.10010959632369888 - critic/lr:1e-05 - actor/pg_loss:-0.052666280418634415 - actor/pg_clipfrac:0.003493436859571375 - actor/ppo_kl:1.9592675016610883e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.907332122325897 - perf/mfu/actor:0.07532331548214824 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.45210266113281 - actor/lr:1e-06 - training/global_step:356 - training/epoch:12 - critic/score/mean:0.67578125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.67578125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:1.0538834693818444e-08 - critic/advantages/max:2.74103045463562 - critic/advantages/min:-2.7685484886169434 - critic/returns/mean:0.6187993884086609 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.59765625 - critic/values/max:1.0 - critic/values/min:-0.2109375 - critic/vf_explained_var:0.47986167669296265 - response_length/mean:268.29296875 - response_length/max:512.0 - response_length/min:125.0 - response_length/clip_ratio:0.0078125 - prompt_length/mean:105.046875 - prompt_length/max:215.0 - prompt_length/min:70.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.5637058317661285e-06 - timing_s/generate_sequences:3.4300310611724854 - timing_s/reshard:0.960491418838501 - timing_s/gen:5.11777571728453 - timing_s/reward:0.043894761241972446 - timing_s/old_log_prob:2.088156322017312 - timing_s/values:1.3513650670647621 - timing_s/adv:0.04043156187981367 - timing_s/update_critic:5.132138836197555 - timing_s/update_actor:6.817621627822518 - timing_s/step:20.598818212747574 - timing_s/stop_profile:2.0940788090229034e-06 - timing_per_token_ms/values:0.01413931537603727 - timing_per_token_ms/adv:0.0004230349137307211 - timing_per_token_ms/update_actor:0.07133268770936456 - timing_per_token_ms/update_critic:0.05369750286369401 - timing_per_token_ms/gen:0.07451299036565862 - perf/total_num_tokens:95575 - perf/time_per_step:20.598818212747574 - perf/throughput:1159.9573214939758
[36m(TaskRunner pid=2914832)[0m Training Progress:  82%|████████▏ | 356/435 [2:12:04<28:15, 21.46s/it]
[36m(TaskRunner pid=2914832)[0m step:357 - global_seqlen/min:22689 - global_seqlen/max:24523 - global_seqlen/minmax_diff:1834 - global_seqlen/balanced_min:23855 - global_seqlen/balanced_max:23855 - global_seqlen/mean:23855.0 - actor/entropy:0.04628828540444374 - critic/vf_loss:0.04455504092038609 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6196639500558376 - critic/grad_norm:13.003091126680374 - perf/mfu/critic:0.09353489598232269 - critic/lr:1e-05 - actor/pg_loss:-0.053202036302536726 - actor/pg_clipfrac:0.0038628342881565914 - actor/ppo_kl:-0.00034967670808327966 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.171702802181244 - perf/mfu/actor:0.07191603548554813 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.56997299194336 - actor/lr:1e-06 - training/global_step:357 - training/epoch:12 - critic/score/mean:0.64453125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.64453125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-4.531101183147257e-08 - critic/advantages/max:2.9310379028320312 - critic/advantages/min:-2.6539809703826904 - critic/returns/mean:0.5853348970413208 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.7109375 - critic/values/max:1.1171875 - critic/values/min:-0.12060546875 - critic/vf_explained_var:0.46962952613830566 - response_length/mean:267.6953125 - response_length/max:512.0 - response_length/min:139.0 - response_length/clip_ratio:0.015625 - prompt_length/mean:105.0390625 - prompt_length/max:173.0 - prompt_length/min:70.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.071742296218872e-06 - timing_s/generate_sequences:3.399514675140381 - timing_s/reshard:0.7828942537307739 - timing_s/gen:5.222783864941448 - timing_s/reward:0.03488309495151043 - timing_s/old_log_prob:2.1371554541401565 - timing_s/values:1.6022447058930993 - timing_s/adv:0.04175177216529846 - timing_s/update_critic:5.4920967551879585 - timing_s/update_actor:7.1294588111341 - timing_s/step:21.668046158272773 - timing_s/stop_profile:3.097113221883774e-06 - timing_per_token_ms/values:0.016791497651363438 - timing_per_token_ms/adv:0.00043755787219973234 - timing_per_token_ms/update_actor:0.0747166087941113 - timing_per_token_ms/update_critic:0.05755708190303876 - timing_per_token_ms/gen:0.07621164256444547 - perf/total_num_tokens:95420 - perf/time_per_step:21.668046158272773 - perf/throughput:1100.9299050663253
[36m(TaskRunner pid=2914832)[0m Training Progress:  82%|████████▏ | 357/435 [2:12:26<27:58, 21.53s/it]
[36m(TaskRunner pid=2914832)[0m step:358 - global_seqlen/min:22852 - global_seqlen/max:25132 - global_seqlen/minmax_diff:2280 - global_seqlen/balanced_min:23711 - global_seqlen/balanced_max:23712 - global_seqlen/mean:23711.75 - actor/entropy:0.051204897463321686 - critic/vf_loss:0.1071047582081519 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.43905536690726876 - critic/grad_norm:34.8631796836853 - perf/mfu/critic:0.09743372178693187 - critic/lr:1e-05 - actor/pg_loss:0.052323318901471794 - actor/pg_clipfrac:0.003774249882553704 - actor/ppo_kl:0.00044629944773078023 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.272523283958435 - perf/mfu/actor:0.07390548780467064 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.5207633972168 - actor/lr:1e-06 - training/global_step:358 - training/epoch:12 - critic/score/mean:0.69921875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.69921875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:1.7695972687192807e-08 - critic/advantages/max:2.6896417140960693 - critic/advantages/min:-2.793834686279297 - critic/returns/mean:0.6486636400222778 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.3828125 - critic/values/max:0.86328125 - critic/values/min:-0.44140625 - critic/vf_explained_var:0.350726842880249 - response_length/mean:267.4609375 - response_length/max:512.0 - response_length/min:123.0 - response_length/clip_ratio:0.015625 - prompt_length/mean:103.03515625 - prompt_length/max:190.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.544628947973251e-06 - timing_s/generate_sequences:3.3970775604248047 - timing_s/reshard:0.9590566158294678 - timing_s/gen:4.941389003768563 - timing_s/reward:0.033904883079230785 - timing_s/old_log_prob:2.0882185832597315 - timing_s/values:1.3509670007042587 - timing_s/adv:0.035428537987172604 - timing_s/update_critic:5.231423532124609 - timing_s/update_actor:6.895762635860592 - timing_s/step:20.58451034501195 - timing_s/stop_profile:4.555098712444305e-06 - timing_per_token_ms/values:0.014243645035733958 - timing_per_token_ms/adv:0.00037353356444771687 - timing_per_token_ms/update_actor:0.07270406692737348 - timing_per_token_ms/update_critic:0.055156447037066104 - timing_per_token_ms/gen:0.07216867246631464 - perf/total_num_tokens:94847 - perf/time_per_step:20.58451034501195 - perf/throughput:1151.9219841800048
[36m(TaskRunner pid=2914832)[0m Training Progress:  82%|████████▏ | 358/435 [2:12:47<27:16, 21.25s/it]
[36m(TaskRunner pid=2914832)[0m step:359 - global_seqlen/min:22834 - global_seqlen/max:24350 - global_seqlen/minmax_diff:1516 - global_seqlen/balanced_min:23545 - global_seqlen/balanced_max:23546 - global_seqlen/mean:23545.25 - actor/entropy:0.04626428335905075 - critic/vf_loss:0.08209679694846272 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.8703324403613806 - critic/grad_norm:34.897804975509644 - perf/mfu/critic:0.09709178273989143 - critic/lr:1e-05 - actor/pg_loss:-0.11555261086323299 - actor/pg_clipfrac:0.003664383228169754 - actor/ppo_kl:0.00020050970260854228 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.897944986820221 - perf/mfu/actor:0.07380390593599712 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.35255432128906 - actor/lr:1e-06 - training/global_step:359 - training/epoch:12 - critic/score/mean:0.71875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.71875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.1088423512717327e-08 - critic/advantages/max:2.7743544578552246 - critic/advantages/min:-2.7500290870666504 - critic/returns/mean:0.6696186661720276 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.6796875 - critic/values/max:1.2265625 - critic/values/min:-0.12060546875 - critic/vf_explained_var:0.3290703296661377 - response_length/mean:266.41796875 - response_length/max:512.0 - response_length/min:124.0 - response_length/clip_ratio:0.01171875 - prompt_length/mean:101.4765625 - prompt_length/max:180.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:2.0131003111600876e-05 - timing_s/generate_sequences:3.476348638534546 - timing_s/reshard:0.7833265662193298 - timing_s/gen:5.1954769268631935 - timing_s/reward:0.034036535769701004 - timing_s/old_log_prob:2.1378191239200532 - timing_s/values:1.5999014410190284 - timing_s/adv:0.03430518973618746 - timing_s/update_critic:5.210437010042369 - timing_s/update_actor:6.850260519888252 - timing_s/step:21.06937949312851 - timing_s/stop_profile:2.4177134037017822e-06 - timing_per_token_ms/values:0.016987518087714384 - timing_per_token_ms/adv:0.000364247456877581 - timing_per_token_ms/update_actor:0.0727350582377364 - timing_per_token_ms/update_critic:0.05532365349743971 - timing_per_token_ms/gen:0.07617666271077803 - perf/total_num_tokens:94181 - perf/time_per_step:21.06937949312851 - perf/throughput:1117.5103665335262
[36m(TaskRunner pid=2914832)[0m Training Progress:  83%|████████▎ | 359/435 [2:13:08<26:51, 21.20s/it]
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 360}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and bakes muffins for her friends every day with four. She sells the remainder at the farmers' market daily for $2 per fresh duck egg. How much in dollars does she make every day at the farmers' market? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much Janet makes every day from selling the eggs, we will follow these steps:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. Calculate the number of eggs Janet lays in a day.
[36m(TaskRunner pid=2914832)[0m 2. Subtract the number of eggs she eats in a day.
[36m(TaskRunner pid=2914832)[0m 3. Subtract the number of muffins she bakes in a day.
[36m(TaskRunner pid=2914832)[0m 4. Determine the remainder of the eggs that are sold.
[36m(TaskRunner pid=2914832)[0m 5. Calculate the amount of money she makes from selling the remainder.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Let's start with the number of eggs Janet lays in a day. She lays 16 eggs per day.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Next, Janet eats 3 eggs for breakfast every morning. Therefore, the number of eggs she eats in a day is:
[36m(TaskRunner pid=2914832)[0m \[ 3 \text{ eggs} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Then, Janet bakes 4 muffins for her friends every day. Therefore, the number of eggs she bakes in a day is:
[36m(TaskRunner pid=2914832)[0m \[ 4 \text{ eggs} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m The total number of eggs Janet lays and eats in a day is:
[36m(TaskRunner pid=2914832)[0m \[ 16 + 3 + 4 = 23 \text{ eggs} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Subtract the number of eggs she eats from the number of eggs she lays to find the remainder:
[36m(TaskRunner pid=2914832)[0m \[ 23 - 23 = 0 \text{ eggs} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Since the remainder of the eggs that are sold is 0, the amount of money Janet makes every day from selling the eggs is:
[36m(TaskRunner pid=2914832)[0m \[ 0 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Therefore, the final answer is:
[36m(TaskRunner pid=2914832)[0m \[ \boxed{0} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m #### 0
[36m(TaskRunner pid=2914832)[0m [ground_truth] 18
[36m(TaskRunner pid=2914832)[0m [score] 0.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1312
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 360}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Tom's restaurant gets 6 reservations a night.  They normally order 2 meals that cost $5 each and a $5 bottle of wine.  How much do they make a week if they are open 2 days a week? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much Tom's restaurant makes in a week, we will follow these steps:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. Calculate the number of reservations per day and the amount spent on reservations per day.
[36m(TaskRunner pid=2914832)[0m 2. Multiply the daily amount by the number of days the restaurant is open in a week.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m First, Tom gets 6 reservations a night. Since the restaurant is open 2 days a week, the number of reservations per week is:
[36m(TaskRunner pid=2914832)[0m \[ 6 \times 2 = 12 \text{ reservations per week} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Next, the amount spent on reservations per week is the number of reservations multiplied by the price of each reservation. The price of each reservation is $5, so the amount spent on reservations per week is:
[36m(TaskRunner pid=2914832)[0m \[ 12 \times 5 = 60 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Adding the amount spent on the wine, the total amount made per week is:
[36m(TaskRunner pid=2914832)[0m \[ 60 + 5 = 65 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Therefore, the final answer is:
[36m(TaskRunner pid=2914832)[0m \[ \boxed{65} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m #### 65
[36m(TaskRunner pid=2914832)[0m [ground_truth] 180
[36m(TaskRunner pid=2914832)[0m [score] 0.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1319
[36m(TaskRunner pid=2914832)[0m step:360 - global_seqlen/min:23946 - global_seqlen/max:24404 - global_seqlen/minmax_diff:458 - global_seqlen/balanced_min:24224 - global_seqlen/balanced_max:24225 - global_seqlen/mean:24224.25 - actor/entropy:0.05062812194228172 - critic/vf_loss:0.07228113431483507 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.8285441361367702 - critic/grad_norm:29.858193784952164 - perf/mfu/critic:0.0941783351021275 - critic/lr:1e-05 - actor/pg_loss:0.010866852651815861 - actor/pg_clipfrac:0.0032469189245603047 - actor/ppo_kl:0.00022648215917797643 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.1960145235061646 - perf/mfu/actor:0.07592505632536478 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.37393569946289 - actor/lr:1e-06 - val-core/openai/gsm8k/reward/mean@1:0.535253980288097 - training/global_step:360 - training/epoch:12 - critic/score/mean:0.703125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.703125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:8.039368282197756e-08 - critic/advantages/max:2.5802319049835205 - critic/advantages/min:-2.9005696773529053 - critic/returns/mean:0.6476833820343018 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.984375 - critic/values/max:1.4921875 - critic/values/min:0.236328125 - critic/vf_explained_var:0.4107745289802551 - response_length/mean:274.08984375 - response_length/max:512.0 - response_length/min:138.0 - response_length/clip_ratio:0.01953125 - prompt_length/mean:104.4140625 - prompt_length/max:238.0 - prompt_length/min:66.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.754176527261734e-06 - timing_s/generate_sequences:3.5457699298858643 - timing_s/reshard:0.583667516708374 - timing_s/gen:4.711850948166102 - timing_s/reward:0.03390891803428531 - timing_s/old_log_prob:2.0802588337101042 - timing_s/values:1.3552027991972864 - timing_s/adv:0.033651068806648254 - timing_s/update_critic:5.531773084774613 - timing_s/update_actor:6.859687933232635 - timing_s/testing:13.544529820792377 - timing_s/step:34.15895870188251 - timing_s/stop_profile:2.1550804376602173e-06 - timing_per_token_ms/values:0.013986014006597587 - timing_per_token_ms/adv:0.0003472870037942171 - timing_per_token_ms/update_actor:0.07079360489212912 - timing_per_token_ms/update_critic:0.05708920900311272 - timing_per_token_ms/gen:0.06715195103347874 - perf/total_num_tokens:96897 - perf/time_per_step:34.15895870188251 - perf/throughput:709.162425336607
[36m(TaskRunner pid=2914832)[0m Training Progress:  83%|████████▎ | 360/435 [2:13:42<31:21, 25.09s/it]
[36m(TaskRunner pid=2914832)[0m step:361 - global_seqlen/min:23039 - global_seqlen/max:24184 - global_seqlen/minmax_diff:1145 - global_seqlen/balanced_min:23631 - global_seqlen/balanced_max:23631 - global_seqlen/mean:23631.0 - actor/entropy:0.04785354435443878 - critic/vf_loss:0.07229542336426675 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.4973833756521344 - critic/grad_norm:23.308332443237305 - perf/mfu/critic:0.09876297711788817 - critic/lr:1e-05 - actor/pg_loss:-0.06074224645271897 - actor/pg_clipfrac:0.002815543623000849 - actor/ppo_kl:0.000350513742887415 - actor/pg_clipfrac_lower:5.18242122780066e-05 - actor/grad_norm:2.899646580219269 - perf/mfu/actor:0.07365652977087675 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.52654647827148 - actor/lr:1e-06 - training/global_step:361 - training/epoch:12 - critic/score/mean:0.6953125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.6953125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-4.578883938677336e-09 - critic/advantages/max:2.395555257797241 - critic/advantages/min:-2.6449666023254395 - critic/returns/mean:0.6417553424835205 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.53515625 - critic/values/max:1.0078125 - critic/values/min:-0.10498046875 - critic/vf_explained_var:0.35283195972442627 - response_length/mean:267.66796875 - response_length/max:512.0 - response_length/min:132.0 - response_length/clip_ratio:0.015625 - prompt_length/mean:101.56640625 - prompt_length/max:183.0 - prompt_length/min:66.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.209112375974655e-06 - timing_s/generate_sequences:3.413078784942627 - timing_s/reshard:0.3021441698074341 - timing_s/gen:4.804634463042021 - timing_s/reward:0.0342574049718678 - timing_s/old_log_prob:2.107080318965018 - timing_s/values:1.3413081890903413 - timing_s/adv:0.034225327894091606 - timing_s/update_critic:5.143498549703509 - timing_s/update_actor:6.892781119327992 - timing_s/step:20.36643858999014 - timing_s/stop_profile:1.58604234457016e-06 - timing_per_token_ms/values:0.014190133607235637 - timing_per_token_ms/adv:0.00036208082491316076 - timing_per_token_ms/update_actor:0.0729209631345266 - timing_per_token_ms/update_critic:0.05441473646590822 - timing_per_token_ms/gen:0.07011710612556399 - perf/total_num_tokens:94524 - perf/time_per_step:20.36643858999014 - perf/throughput:1160.2912259590812
[36m(TaskRunner pid=2914832)[0m Training Progress:  83%|████████▎ | 361/435 [2:14:02<29:12, 23.68s/it]
[36m(TaskRunner pid=2914832)[0m step:362 - global_seqlen/min:22799 - global_seqlen/max:23760 - global_seqlen/minmax_diff:961 - global_seqlen/balanced_min:23326 - global_seqlen/balanced_max:23327 - global_seqlen/mean:23326.25 - actor/entropy:0.04719528183341026 - critic/vf_loss:0.062089042679872364 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6616635173559189 - critic/grad_norm:3.5481683015823364 - perf/mfu/critic:0.09252032816967432 - critic/lr:1e-05 - actor/pg_loss:0.005818752804771066 - actor/pg_clipfrac:0.003430937202210771 - actor/ppo_kl:-7.179309079674567e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.4794246554374695 - perf/mfu/actor:0.07100411026851979 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.62092208862305 - actor/lr:1e-06 - training/global_step:362 - training/epoch:12 - critic/score/mean:0.703125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.703125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.9967996145453526e-09 - critic/advantages/max:2.4298501014709473 - critic/advantages/min:-2.5108299255371094 - critic/returns/mean:0.6490320563316345 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.6484375 - critic/values/max:1.0 - critic/values/min:0.019775390625 - critic/vf_explained_var:0.39320069551467896 - response_length/mean:262.12109375 - response_length/max:512.0 - response_length/min:129.0 - response_length/clip_ratio:0.01171875 - prompt_length/mean:102.3515625 - prompt_length/max:179.0 - prompt_length/min:64.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.914814442396164e-06 - timing_s/generate_sequences:3.324862480163574 - timing_s/reshard:0.5823798775672913 - timing_s/gen:4.615861605852842 - timing_s/reward:0.03467391198500991 - timing_s/old_log_prob:2.0806307648308575 - timing_s/values:1.3448007181286812 - timing_s/adv:0.03398122591897845 - timing_s/update_critic:5.419342612847686 - timing_s/update_actor:7.054330567829311 - timing_s/step:20.59066247800365 - timing_s/stop_profile:1.6330741345882416e-06 - timing_per_token_ms/values:0.014412954483989939 - timing_per_token_ms/adv:0.00036419512265128826 - timing_per_token_ms/update_actor:0.07560506476426034 - timing_per_token_ms/update_critic:0.05808201717858299 - timing_per_token_ms/gen:0.06878770853542826 - perf/total_num_tokens:93305 - perf/time_per_step:20.59066247800365 - perf/throughput:1132.8557313257254
[36m(TaskRunner pid=2914832)[0m Training Progress:  83%|████████▎ | 362/435 [2:14:23<27:41, 22.75s/it]
[36m(TaskRunner pid=2914832)[0m step:363 - global_seqlen/min:22979 - global_seqlen/max:23753 - global_seqlen/minmax_diff:774 - global_seqlen/balanced_min:23375 - global_seqlen/balanced_max:23375 - global_seqlen/mean:23375.0 - actor/entropy:0.04727249965071678 - critic/vf_loss:0.06622803129721433 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6017114650458097 - critic/grad_norm:8.112413048744202 - perf/mfu/critic:0.09462533898720894 - critic/lr:1e-05 - actor/pg_loss:-0.1820966781815514 - actor/pg_clipfrac:0.0031470588728552684 - actor/ppo_kl:6.196221329446416e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.057822287082672 - perf/mfu/actor:0.07315210023933716 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.66293334960938 - actor/lr:1e-06 - training/global_step:363 - training/epoch:12 - critic/score/mean:0.66796875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.66796875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.0231129721205434e-08 - critic/advantages/max:2.370656728744507 - critic/advantages/min:-2.5766637325286865 - critic/returns/mean:0.6085795164108276 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.5546875 - critic/values/max:0.93359375 - critic/values/min:-0.07568359375 - critic/vf_explained_var:0.4182213544845581 - response_length/mean:263.25390625 - response_length/max:512.0 - response_length/min:134.0 - response_length/clip_ratio:0.0078125 - prompt_length/mean:101.98046875 - prompt_length/max:201.0 - prompt_length/min:67.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:6.310176104307175e-06 - timing_s/generate_sequences:3.4467058181762695 - timing_s/reshard:0.8741976022720337 - timing_s/gen:4.885135243181139 - timing_s/reward:0.034232680685818195 - timing_s/old_log_prob:2.0729165519587696 - timing_s/values:1.346546411048621 - timing_s/adv:0.0349087156355381 - timing_s/update_critic:5.309180223848671 - timing_s/update_actor:6.865037373267114 - timing_s/step:20.555191620253026 - timing_s/stop_profile:1.8761493265628815e-06 - timing_per_token_ms/values:0.014401565893568138 - timing_per_token_ms/adv:0.00037335524743891015 - timing_per_token_ms/update_actor:0.0734228596071349 - timing_per_token_ms/update_critic:0.056782676190894874 - timing_per_token_ms/gen:0.07248727973500421 - perf/total_num_tokens:93500 - perf/time_per_step:20.555191620253026 - perf/throughput:1137.1822959299789
[36m(TaskRunner pid=2914832)[0m Training Progress:  83%|████████▎ | 363/435 [2:14:43<26:31, 22.10s/it]
[36m(TaskRunner pid=2914832)[0m step:364 - global_seqlen/min:23375 - global_seqlen/max:24584 - global_seqlen/minmax_diff:1209 - global_seqlen/balanced_min:23981 - global_seqlen/balanced_max:23982 - global_seqlen/mean:23981.25 - actor/entropy:0.04588770866394043 - critic/vf_loss:0.05039332052547252 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.7297490099444985 - critic/grad_norm:10.126034587621689 - perf/mfu/critic:0.09558974717320572 - critic/lr:1e-05 - actor/pg_loss:-0.013653394940774888 - actor/pg_clipfrac:0.00350470492412569 - actor/ppo_kl:-2.306682654307224e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.0250754356384277 - perf/mfu/actor:0.07171395170889366 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.57768249511719 - actor/lr:1e-06 - training/global_step:364 - training/epoch:12 - critic/score/mean:0.75390625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.75390625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.5427044530724743e-08 - critic/advantages/max:3.011990785598755 - critic/advantages/min:-3.2405447959899902 - critic/returns/mean:0.7081616520881653 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.67578125 - critic/values/max:1.078125 - critic/values/min:-0.189453125 - critic/vf_explained_var:0.4794957637786865 - response_length/mean:271.1796875 - response_length/max:512.0 - response_length/min:141.0 - response_length/clip_ratio:0.0234375 - prompt_length/mean:103.52734375 - prompt_length/max:211.0 - prompt_length/min:64.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.182104021310806e-06 - timing_s/generate_sequences:3.497642993927002 - timing_s/reshard:0.6832247376441956 - timing_s/gen:5.131735838018358 - timing_s/reward:0.0389050911180675 - timing_s/old_log_prob:2.1159637342207134 - timing_s/values:1.6251895832829177 - timing_s/adv:0.039511107839643955 - timing_s/update_critic:5.3948001228272915 - timing_s/update_actor:7.186213884036988 - timing_s/step:21.54088219208643 - timing_s/stop_profile:1.7159618437290192e-06 - timing_per_token_ms/values:0.016942294326639747 - timing_per_token_ms/adv:0.00041189583361630393 - timing_per_token_ms/update_actor:0.07491492190812601 - timing_per_token_ms/update_critic:0.0562397719346082 - timing_per_token_ms/gen:0.07392088729823915 - perf/total_num_tokens:95925 - perf/time_per_step:21.54088219208643 - perf/throughput:1113.2900586963935
[36m(TaskRunner pid=2914832)[0m Training Progress:  84%|████████▎ | 364/435 [2:15:05<25:57, 21.94s/it]
[36m(TaskRunner pid=2914832)[0m step:365 - global_seqlen/min:22845 - global_seqlen/max:24268 - global_seqlen/minmax_diff:1423 - global_seqlen/balanced_min:23439 - global_seqlen/balanced_max:23440 - global_seqlen/mean:23439.5 - actor/entropy:0.04708414897322655 - critic/vf_loss:0.07380385108990595 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.5903047062456608 - critic/grad_norm:14.287054061889648 - perf/mfu/critic:0.09168652811289507 - critic/lr:1e-05 - actor/pg_loss:-0.03870733234180079 - actor/pg_clipfrac:0.003942692375858314 - actor/ppo_kl:-0.0002382915913585748 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.990568518638611 - perf/mfu/actor:0.07422179830571306 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.73310852050781 - actor/lr:1e-06 - training/global_step:365 - training/epoch:12 - critic/score/mean:0.671875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.671875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.326346321661731e-08 - critic/advantages/max:3.0943448543548584 - critic/advantages/min:-2.7738122940063477 - critic/returns/mean:0.6198946237564087 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.671875 - critic/values/max:1.1015625 - critic/values/min:-0.1962890625 - critic/vf_explained_var:0.4725190997123718 - response_length/mean:261.76953125 - response_length/max:512.0 - response_length/min:138.0 - response_length/clip_ratio:0.0078125 - prompt_length/mean:104.47265625 - prompt_length/max:189.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:6.455928087234497e-06 - timing_s/generate_sequences:3.2260799407958984 - timing_s/reshard:0.5845807790756226 - timing_s/gen:4.636635250877589 - timing_s/reward:0.03374303039163351 - timing_s/old_log_prob:2.075847634114325 - timing_s/values:1.3403796176426113 - timing_s/adv:0.033416369929909706 - timing_s/update_critic:5.492429203353822 - timing_s/update_actor:6.7820285758934915 - timing_s/step:20.40118166198954 - timing_s/stop_profile:1.7029233276844025e-06 - timing_per_token_ms/values:0.01429616264897514 - timing_per_token_ms/adv:0.0003564108655251787 - timing_per_token_ms/update_actor:0.07233546551647317 - timing_per_token_ms/update_critic:0.05858091259789908 - timing_per_token_ms/gen:0.06919008626501708 - perf/total_num_tokens:93758 - perf/time_per_step:20.40118166198954 - perf/throughput:1148.9285468042913
[36m(TaskRunner pid=2914832)[0m Training Progress:  84%|████████▍ | 365/435 [2:15:25<25:03, 21.48s/it]
[36m(TaskRunner pid=2914832)[0m step:366 - global_seqlen/min:23502 - global_seqlen/max:24716 - global_seqlen/minmax_diff:1214 - global_seqlen/balanced_min:24273 - global_seqlen/balanced_max:24274 - global_seqlen/mean:24273.75 - actor/entropy:0.049835022538900375 - critic/vf_loss:0.07251792043098249 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.5791222415864468 - critic/grad_norm:13.557298064231873 - perf/mfu/critic:0.09713399985567651 - critic/lr:1e-05 - actor/pg_loss:-0.10631538880988955 - actor/pg_clipfrac:0.003118275388260372 - actor/ppo_kl:8.29461200737569e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.9824023842811584 - perf/mfu/actor:0.07530475471709837 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.63840866088867 - actor/lr:1e-06 - training/global_step:366 - training/epoch:12 - critic/score/mean:0.66015625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.66015625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:1.695541307356052e-08 - critic/advantages/max:3.244473457336426 - critic/advantages/min:-2.7755069732666016 - critic/returns/mean:0.5929991602897644 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.5078125 - critic/values/max:0.98828125 - critic/values/min:-0.431640625 - critic/vf_explained_var:0.429246723651886 - response_length/mean:275.078125 - response_length/max:512.0 - response_length/min:130.0 - response_length/clip_ratio:0.015625 - prompt_length/mean:104.19921875 - prompt_length/max:181.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.8568472266197205e-06 - timing_s/generate_sequences:3.4609808921813965 - timing_s/reshard:0.8924961686134338 - timing_s/gen:4.911462453193963 - timing_s/reward:0.03353084670379758 - timing_s/old_log_prob:2.4332140698097646 - timing_s/values:1.3472937941551208 - timing_s/adv:0.034053171053528786 - timing_s/update_critic:5.3760974779725075 - timing_s/update_actor:6.932870056014508 - timing_s/step:21.075735431164503 - timing_s/stop_profile:6.466638296842575e-06 - timing_per_token_ms/values:0.013876036810908089 - timing_per_token_ms/adv:0.00035072013032111626 - timing_per_token_ms/update_actor:0.0714029564448685 - timing_per_token_ms/update_critic:0.05536945752070145 - timing_per_token_ms/gen:0.06974527766535023 - perf/total_num_tokens:97095 - perf/time_per_step:21.075735431164503 - perf/throughput:1151.7391684518216
[36m(TaskRunner pid=2914832)[0m Training Progress:  84%|████████▍ | 366/435 [2:15:46<24:34, 21.37s/it]
[36m(TaskRunner pid=2914832)[0m step:367 - global_seqlen/min:23769 - global_seqlen/max:24886 - global_seqlen/minmax_diff:1117 - global_seqlen/balanced_min:24175 - global_seqlen/balanced_max:24176 - global_seqlen/mean:24175.75 - actor/entropy:0.05737036466598511 - critic/vf_loss:0.06659220241999719 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.7499624826014042 - critic/grad_norm:9.153849452733994 - perf/mfu/critic:0.09604245351442087 - critic/lr:1e-05 - actor/pg_loss:-0.07181505870539695 - actor/pg_clipfrac:0.004602668384904973 - actor/ppo_kl:-8.14871018519625e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.096211314201355 - perf/mfu/actor:0.07308800563533832 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.58975219726562 - actor/lr:1e-06 - training/global_step:367 - training/epoch:12 - critic/score/mean:0.734375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.734375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:1.1340710592833148e-08 - critic/advantages/max:3.070730447769165 - critic/advantages/min:-2.883223056793213 - critic/returns/mean:0.692599356174469 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.71484375 - critic/values/max:1.171875 - critic/values/min:-0.16015625 - critic/vf_explained_var:0.34404540061950684 - response_length/mean:271.98828125 - response_length/max:512.0 - response_length/min:140.0 - response_length/clip_ratio:0.01953125 - prompt_length/mean:105.7578125 - prompt_length/max:191.0 - prompt_length/min:65.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.905035555362701e-06 - timing_s/generate_sequences:3.249580144882202 - timing_s/reshard:0.5846172571182251 - timing_s/gen:4.617341515142471 - timing_s/reward:0.03439174126833677 - timing_s/old_log_prob:2.0830181487835944 - timing_s/values:1.34448126796633 - timing_s/adv:0.03389720385894179 - timing_s/update_critic:5.4120571771636605 - timing_s/update_actor:7.10792532004416 - timing_s/step:20.644733209628612 - timing_s/stop_profile:1.4579854905605316e-06 - timing_per_token_ms/values:0.013903201224019213 - timing_per_token_ms/adv:0.0003505289790279701 - timing_per_token_ms/update_actor:0.0735026350789961 - timing_per_token_ms/update_critic:0.055965762976987896 - timing_per_token_ms/gen:0.06631348310535079 - perf/total_num_tokens:96703 - perf/time_per_step:20.644733209628612 - perf/throughput:1171.03717226651
[36m(TaskRunner pid=2914832)[0m Training Progress:  84%|████████▍ | 367/435 [2:16:07<23:58, 21.15s/it]
[36m(TaskRunner pid=2914832)[0m step:368 - global_seqlen/min:23271 - global_seqlen/max:24510 - global_seqlen/minmax_diff:1239 - global_seqlen/balanced_min:23709 - global_seqlen/balanced_max:23709 - global_seqlen/mean:23709.0 - actor/entropy:0.04634101316332817 - critic/vf_loss:0.09314979403279722 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.5103477574884892 - critic/grad_norm:27.307093620300293 - perf/mfu/critic:0.08962908822911779 - critic/lr:1e-05 - actor/pg_loss:-0.1520519028417766 - actor/pg_clipfrac:0.0037679208508052398 - actor/ppo_kl:-0.0002478502369740454 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.9540263414382935 - perf/mfu/actor:0.07510399964975453 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.50564956665039 - actor/lr:1e-06 - training/global_step:368 - training/epoch:12 - critic/score/mean:0.67578125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.67578125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:2.0639885356388277e-09 - critic/advantages/max:2.2977852821350098 - critic/advantages/min:-2.2419724464416504 - critic/returns/mean:0.6338617205619812 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.640625 - critic/values/max:0.93359375 - critic/values/min:0.002655029296875 - critic/vf_explained_var:0.3479108214378357 - response_length/mean:267.125 - response_length/max:512.0 - response_length/min:125.0 - response_length/clip_ratio:0.00390625 - prompt_length/mean:103.328125 - prompt_length/max:183.0 - prompt_length/min:69.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.578847438097e-06 - timing_s/generate_sequences:3.391815185546875 - timing_s/reshard:0.5804218649864197 - timing_s/gen:4.506432908121496 - timing_s/reward:0.03389547625556588 - timing_s/old_log_prob:2.0738648041151464 - timing_s/values:1.348878471646458 - timing_s/adv:0.03376280516386032 - timing_s/update_critic:5.684113734867424 - timing_s/update_actor:6.782386634033173 - timing_s/step:20.469974166713655 - timing_s/stop_profile:1.708976924419403e-06 - timing_per_token_ms/values:0.014223274617723838 - timing_per_token_ms/adv:0.0003560125391608706 - timing_per_token_ms/update_actor:0.0715170044501368 - timing_per_token_ms/update_critic:0.05993624504267814 - timing_per_token_ms/gen:0.06589893700458435 - perf/total_num_tokens:94836 - perf/time_per_step:20.469974166713655 - perf/throughput:1158.2330200764661
[36m(TaskRunner pid=2914832)[0m Training Progress:  85%|████████▍ | 368/435 [2:16:28<23:23, 20.95s/it]
[36m(TaskRunner pid=2914832)[0m step:369 - global_seqlen/min:22303 - global_seqlen/max:24065 - global_seqlen/minmax_diff:1762 - global_seqlen/balanced_min:23006 - global_seqlen/balanced_max:23006 - global_seqlen/mean:23006.0 - actor/entropy:0.04606243968009949 - critic/vf_loss:0.12110287882387638 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6278849709779024 - critic/grad_norm:23.95674979686737 - perf/mfu/critic:0.09273055517908463 - critic/lr:1e-05 - actor/pg_loss:0.12560658273287117 - actor/pg_clipfrac:0.0026283277620677836 - actor/ppo_kl:0.0005842712971571018 - actor/pg_clipfrac_lower:4.960317528457381e-05 - actor/grad_norm:3.2040440440177917 - perf/mfu/actor:0.07167400335560624 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.49188995361328 - actor/lr:1e-06 - training/global_step:369 - training/epoch:12 - critic/score/mean:0.75 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.75 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.4042718099460672e-09 - critic/advantages/max:1.826786756515503 - critic/advantages/min:-2.215725898742676 - critic/returns/mean:0.7149449586868286 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.48046875 - critic/values/max:0.6796875 - critic/values/min:-0.0020751953125 - critic/vf_explained_var:0.16598081588745117 - response_length/mean:257.32421875 - response_length/max:485.0 - response_length/min:133.0 - response_length/clip_ratio:0.0 - prompt_length/mean:102.14453125 - prompt_length/max:174.0 - prompt_length/min:65.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.945082426071167e-06 - timing_s/generate_sequences:3.1210439205169678 - timing_s/reshard:0.8650541305541992 - timing_s/gen:4.627377788070589 - timing_s/reward:0.03347888309508562 - timing_s/old_log_prob:2.0771251460537314 - timing_s/values:1.3422272740863264 - timing_s/adv:0.03739725099876523 - timing_s/update_critic:5.327179423999041 - timing_s/update_actor:6.8886978747323155 - timing_s/step:20.340948968194425 - timing_s/stop_profile:6.128568202257156e-06 - timing_per_token_ms/values:0.014585621947386837 - timing_per_token_ms/adv:0.0004063858449835394 - timing_per_token_ms/update_actor:0.07485762273681122 - timing_per_token_ms/update_critic:0.057889022689722694 - timing_per_token_ms/gen:0.07024482410733342 - perf/total_num_tokens:92024 - perf/time_per_step:20.340948968194425 - perf/throughput:1131.019011746832
[36m(TaskRunner pid=2914832)[0m Training Progress:  85%|████████▍ | 369/435 [2:16:48<22:50, 20.77s/it]
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 370}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and bakes muffins for her friends every day with four. She sells the remainder at the farmers' market daily for $2 per fresh duck egg. How much in dollars does she make every day at the farmers' market? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much Janet makes every day from selling the eggs at the farmers' market, we will follow these steps:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. Calculate the number of eggs Janet lays in a day.
[36m(TaskRunner pid=2914832)[0m 2. Subtract the number of eggs she eats in a day.
[36m(TaskRunner pid=2914832)[0m 3. Subtract the number of eggs she bakes.
[36m(TaskRunner pid=2914832)[0m 4. Determine the number of ducks she has and calculate the revenue from selling the eggs.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m First, Janet's ducks lay 16 eggs per day. She eats 3 eggs for breakfast and bakes 4 eggs for her friends every day. Therefore, the number of eggs she eats in a day is:
[36m(TaskRunner pid=2914832)[0m \[ 3 + 4 = 7 \text{ eggs} \]
[36m(TaskRunner pid=2914832)[0m The number of eggs she sells at the farmers' market is the remainder after subtracting the eggs she eats and the eggs she bakes. Therefore, the number of eggs she sells in a day is:
[36m(TaskRunner pid=2914832)[0m \[ 16 - 7 = 9 \text{ eggs} \]
[36m(TaskRunner pid=2914832)[0m Since she sells each egg for $2, the total revenue from selling the eggs is:
[36m(TaskRunner pid=2914832)[0m \[ 9 \times 2 = 18 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Therefore, the final answer is:
[36m(TaskRunner pid=2914832)[0m \[ \boxed{18} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m #### 18
[36m(TaskRunner pid=2914832)[0m [ground_truth] 18
[36m(TaskRunner pid=2914832)[0m [score] 1.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1312
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 370}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Tom's restaurant gets 6 reservations a night.  They normally order 2 meals that cost $5 each and a $5 bottle of wine.  How much do they make a week if they are open 2 days a week? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much Tom's restaurant makes in a week, we will follow these steps:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. Calculate the number of reservations per day and the amount spent on reservations per day.
[36m(TaskRunner pid=2914832)[0m 2. Multiply the daily amount by the number of days the restaurant is open in a week.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m First, Tom's restaurant gets 6 reservations a night. Since they are open 2 days a week, the number of reservations they make in a week is:
[36m(TaskRunner pid=2914832)[0m \[ 6 \times 2 = 12 \text{ reservations per week} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Next, the amount spent on the meals is:
[36m(TaskRunner pid=2914832)[0m \[ 12 \times 5 = 60 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m The amount spent on the wine is:
[36m(TaskRunner pid=2914832)[0m \[ 12 \times 5 = 60 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Therefore, the total amount made in a week is the sum of the money spent on the meals and the money spent on the wine:
[36m(TaskRunner pid=2914832)[0m \[ 60 + 60 = 120 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Thus, the final answer is:
[36m(TaskRunner pid=2914832)[0m \[ \boxed{120} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m #### 120
[36m(TaskRunner pid=2914832)[0m [ground_truth] 180
[36m(TaskRunner pid=2914832)[0m [score] 0.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1319
[36m(TaskRunner pid=2914832)[0m step:370 - global_seqlen/min:21753 - global_seqlen/max:24014 - global_seqlen/minmax_diff:2261 - global_seqlen/balanced_min:23154 - global_seqlen/balanced_max:23155 - global_seqlen/mean:23154.5 - actor/entropy:0.04692866653203964 - critic/vf_loss:0.08253848924141494 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.9578940272331238 - critic/grad_norm:34.35224485397339 - perf/mfu/critic:0.09018400530661519 - critic/lr:1e-05 - actor/pg_loss:-0.13974617095664144 - actor/pg_clipfrac:0.0032585803710389882 - actor/ppo_kl:-0.00023190261799754808 - actor/pg_clipfrac_lower:4.894283483736217e-05 - actor/grad_norm:4.1764639019966125 - perf/mfu/actor:0.06944001432114046 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.6652946472168 - actor/lr:1e-06 - val-core/openai/gsm8k/reward/mean@1:0.5595147839272175 - training/global_step:370 - training/epoch:12 - critic/score/mean:0.734375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.734375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:3.341587984095895e-08 - critic/advantages/max:1.7074806690216064 - critic/advantages/min:-2.1253914833068848 - critic/returns/mean:0.6994562149047852 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.921875 - critic/values/max:1.125 - critic/values/min:0.439453125 - critic/vf_explained_var:0.217396080493927 - response_length/mean:259.30859375 - response_length/max:512.0 - response_length/min:107.0 - response_length/clip_ratio:0.01171875 - prompt_length/mean:102.48046875 - prompt_length/max:177.0 - prompt_length/min:66.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.919020622968674e-06 - timing_s/generate_sequences:3.127610683441162 - timing_s/reshard:0.5822339057922363 - timing_s/gen:4.609513641800731 - timing_s/reward:0.033432894852012396 - timing_s/old_log_prob:2.3936242279596627 - timing_s/values:1.7343729468993843 - timing_s/adv:0.03372511966153979 - timing_s/update_critic:5.514864652883261 - timing_s/update_actor:7.1577508160844445 - timing_s/testing:13.855267538223416 - timing_s/step:35.34043417405337 - timing_s/stop_profile:2.368353307247162e-06 - timing_per_token_ms/values:0.018726089387585396 - timing_per_token_ms/adv:0.00036413137469541333 - timing_per_token_ms/update_actor:0.07728250249502737 - timing_per_token_ms/update_critic:0.059544199322845034 - timing_per_token_ms/gen:0.06943816401489435 - perf/total_num_tokens:92618 - perf/time_per_step:35.34043417405337 - perf/throughput:655.1843671745218
[36m(TaskRunner pid=2914832)[0m Training Progress:  85%|████████▌ | 370/435 [2:17:23<27:14, 25.14s/it]
[36m(TaskRunner pid=2914832)[0m step:371 - global_seqlen/min:22874 - global_seqlen/max:25128 - global_seqlen/minmax_diff:2254 - global_seqlen/balanced_min:24153 - global_seqlen/balanced_max:24154 - global_seqlen/mean:24153.75 - actor/entropy:0.04832397401332855 - critic/vf_loss:0.08132907573599368 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6247321180999279 - critic/grad_norm:18.522637844085693 - perf/mfu/critic:0.09346571951278206 - critic/lr:1e-05 - actor/pg_loss:-0.21984980558045208 - actor/pg_clipfrac:0.0032145298464456573 - actor/ppo_kl:0.0006917944710949087 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.0353508591651917 - perf/mfu/actor:0.07464494201626727 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.5032730102539 - actor/lr:1e-06 - training/global_step:371 - training/epoch:12 - critic/score/mean:0.7265625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.7265625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:3.343945209621779e-08 - critic/advantages/max:1.7202850580215454 - critic/advantages/min:-2.1320300102233887 - critic/returns/mean:0.6774361729621887 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.76171875 - critic/values/max:0.96484375 - critic/values/min:0.296875 - critic/vf_explained_var:0.26030510663986206 - response_length/mean:269.375 - response_length/max:512.0 - response_length/min:123.0 - response_length/clip_ratio:0.01171875 - prompt_length/mean:108.02734375 - prompt_length/max:232.0 - prompt_length/min:69.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:6.597023457288742e-06 - timing_s/generate_sequences:3.4595532417297363 - timing_s/reshard:0.3006507158279419 - timing_s/gen:4.681557623203844 - timing_s/reward:0.043189392890781164 - timing_s/old_log_prob:2.0864734910428524 - timing_s/values:1.3432860625907779 - timing_s/adv:0.03489127801731229 - timing_s/update_critic:5.556194259785116 - timing_s/update_actor:6.954175006132573 - timing_s/step:20.70942671224475 - timing_s/stop_profile:2.452172338962555e-06 - timing_per_token_ms/values:0.013903493894227376 - timing_per_token_ms/adv:0.00036113727699955793 - timing_per_token_ms/update_actor:0.07197821255635846 - timing_per_token_ms/update_critic:0.057508609012939145 - timing_per_token_ms/gen:0.06788801657778196 - perf/total_num_tokens:96615 - perf/time_per_step:20.70942671224475 - perf/throughput:1166.3166892842448
[36m(TaskRunner pid=2914832)[0m Training Progress:  85%|████████▌ | 371/435 [2:17:44<25:24, 23.82s/it]
[36m(TaskRunner pid=2914832)[0m step:372 - global_seqlen/min:22536 - global_seqlen/max:24715 - global_seqlen/minmax_diff:2179 - global_seqlen/balanced_min:23424 - global_seqlen/balanced_max:23425 - global_seqlen/mean:23424.5 - actor/entropy:0.052028413861989975 - critic/vf_loss:0.0772136461455375 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.625972505658865 - critic/grad_norm:12.67087459564209 - perf/mfu/critic:0.09171598435339764 - critic/lr:1e-05 - actor/pg_loss:0.16315183998085558 - actor/pg_clipfrac:0.0027943761233473197 - actor/ppo_kl:0.0004480493425944587 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.0870429277420044 - perf/mfu/actor:0.07379588903611482 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.03284072875977 - actor/lr:1e-06 - training/global_step:372 - training/epoch:12 - critic/score/mean:0.734375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.734375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:3.245600410650695e-08 - critic/advantages/max:1.8281434774398804 - critic/advantages/min:-2.1154680252075195 - critic/returns/mean:0.6902900338172913 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.5390625 - critic/values/max:0.7421875 - critic/values/min:0.049560546875 - critic/vf_explained_var:0.24868226051330566 - response_length/mean:261.8125 - response_length/max:512.0 - response_length/min:136.0 - response_length/clip_ratio:0.01171875 - prompt_length/mean:104.1953125 - prompt_length/max:196.0 - prompt_length/min:63.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.6049244701862335e-06 - timing_s/generate_sequences:3.3060555458068848 - timing_s/reshard:0.8673728108406067 - timing_s/gen:4.853338394314051 - timing_s/reward:0.03362639620900154 - timing_s/old_log_prob:2.0794826322235167 - timing_s/values:1.3516431800089777 - timing_s/adv:0.040502586867660284 - timing_s/update_critic:5.488982453010976 - timing_s/update_actor:6.81873858300969 - timing_s/step:20.6747446609661 - timing_s/stop_profile:3.34298238158226e-06 - timing_per_token_ms/values:0.014425528613299939 - timing_per_token_ms/adv:0.0004322673575493637 - timing_per_token_ms/update_actor:0.07277357662927374 - timing_per_token_ms/update_critic:0.058581639448130975 - timing_per_token_ms/gen:0.07241194787410556 - perf/total_num_tokens:93698 - perf/time_per_step:20.6747446609661 - perf/throughput:1133.00069162283
[36m(TaskRunner pid=2914832)[0m Training Progress:  86%|████████▌ | 372/435 [2:18:05<24:01, 22.88s/it]
[36m(TaskRunner pid=2914832)[0m step:373 - global_seqlen/min:21989 - global_seqlen/max:24934 - global_seqlen/minmax_diff:2945 - global_seqlen/balanced_min:23424 - global_seqlen/balanced_max:23424 - global_seqlen/mean:23424.0 - actor/entropy:0.048880673944950104 - critic/vf_loss:0.08971694820502307 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.8196982257068157 - critic/grad_norm:26.155390858650208 - perf/mfu/critic:0.0933227397157423 - critic/lr:1e-05 - actor/pg_loss:-0.007366665173321962 - actor/pg_clipfrac:0.003829947647318477 - actor/ppo_kl:0.00015627994856970417 - actor/pg_clipfrac_lower:6.0444875998655334e-05 - actor/grad_norm:3.2790547013282776 - perf/mfu/actor:0.07026452633220495 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.07599258422852 - actor/lr:1e-06 - training/global_step:373 - training/epoch:12 - critic/score/mean:0.68359375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.68359375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.3618023153583181e-08 - critic/advantages/max:2.5889830589294434 - critic/advantages/min:-2.6160223484039307 - critic/returns/mean:0.6352079510688782 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.72265625 - critic/values/max:1.1640625 - critic/values/min:0.10498046875 - critic/vf_explained_var:0.4188225269317627 - response_length/mean:261.79296875 - response_length/max:512.0 - response_length/min:105.0 - response_length/clip_ratio:0.01171875 - prompt_length/mean:104.20703125 - prompt_length/max:201.0 - prompt_length/min:62.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.681052476167679e-06 - timing_s/generate_sequences:3.365809917449951 - timing_s/reshard:0.5834876894950867 - timing_s/gen:5.009005275554955 - timing_s/reward:0.033357041887938976 - timing_s/old_log_prob:2.127247559837997 - timing_s/values:1.619537269230932 - timing_s/adv:0.03504442889243364 - timing_s/update_critic:5.395327678881586 - timing_s/update_actor:7.158885105047375 - timing_s/step:21.38626874424517 - timing_s/stop_profile:5.179084837436676e-06 - timing_per_token_ms/values:0.01728502037686702 - timing_per_token_ms/adv:0.00037402267858215553 - timing_per_token_ms/update_actor:0.07640545066008554 - timing_per_token_ms/update_critic:0.05758332990609616 - timing_per_token_ms/gen:0.07474007782203487 - perf/total_num_tokens:93696 - perf/time_per_step:21.38626874424517 - perf/throughput:1095.2822243152239
[36m(TaskRunner pid=2914832)[0m Training Progress:  86%|████████▌ | 373/435 [2:18:26<23:10, 22.43s/it]
[36m(TaskRunner pid=2914832)[0m step:374 - global_seqlen/min:23037 - global_seqlen/max:23990 - global_seqlen/minmax_diff:953 - global_seqlen/balanced_min:23649 - global_seqlen/balanced_max:23650 - global_seqlen/mean:23649.25 - actor/entropy:0.04900605231523514 - critic/vf_loss:0.06171495997114107 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.5987068172544241 - critic/grad_norm:15.857436567544937 - perf/mfu/critic:0.09355988888762744 - critic/lr:1e-05 - actor/pg_loss:-0.11839467193931341 - actor/pg_clipfrac:0.004032184850075282 - actor/ppo_kl:-0.000142855036756373 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.2053942680358887 - perf/mfu/actor:0.07473444090649692 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:91.1947021484375 - actor/lr:1e-06 - training/global_step:374 - training/epoch:12 - critic/score/mean:0.68359375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.68359375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:3.4427158901451094e-09 - critic/advantages/max:2.853931188583374 - critic/advantages/min:-3.3899917602539062 - critic/returns/mean:0.63062584400177 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.7109375 - critic/values/max:1.4296875 - critic/values/min:-0.08203125 - critic/vf_explained_var:0.4749927520751953 - response_length/mean:266.19140625 - response_length/max:512.0 - response_length/min:134.0 - response_length/clip_ratio:0.015625 - prompt_length/mean:103.328125 - prompt_length/max:199.0 - prompt_length/min:65.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:1.2073665857315063e-05 - timing_s/generate_sequences:3.5280182361602783 - timing_s/reshard:0.9553786516189575 - timing_s/gen:5.294025185983628 - timing_s/reward:0.035202874802052975 - timing_s/old_log_prob:2.076324049849063 - timing_s/values:1.358540547080338 - timing_s/adv:0.03400860680267215 - timing_s/update_critic:5.430803674273193 - timing_s/update_actor:6.797147752251476 - timing_s/step:21.034020762890577 - timing_s/stop_profile:2.03913077712059e-06 - timing_per_token_ms/values:0.014361349166256202 - timing_per_token_ms/adv:0.00035951041579196114 - timing_per_token_ms/update_actor:0.0718537348145446 - timing_per_token_ms/update_critic:0.05740989327645901 - timing_per_token_ms/gen:0.0776876540609528 - perf/total_num_tokens:94597 - perf/time_per_step:21.034020762890577 - perf/throughput:1124.3333011120421
[36m(TaskRunner pid=2914832)[0m Training Progress:  86%|████████▌ | 374/435 [2:18:47<22:23, 22.02s/it]
[36m(TaskRunner pid=2914832)[0m step:375 - global_seqlen/min:23165 - global_seqlen/max:24737 - global_seqlen/minmax_diff:1572 - global_seqlen/balanced_min:23925 - global_seqlen/balanced_max:23926 - global_seqlen/mean:23925.5 - actor/entropy:0.04535549134016037 - critic/vf_loss:0.055387745902407914 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.7473137844353914 - critic/grad_norm:16.87191593647003 - perf/mfu/critic:0.09327514590321417 - critic/lr:1e-05 - actor/pg_loss:-0.09064024488907307 - actor/pg_clipfrac:0.004147803701926023 - actor/ppo_kl:-0.00025106365046667634 - actor/pg_clipfrac_lower:5.857544601894915e-05 - actor/grad_norm:3.2413554787635803 - perf/mfu/actor:0.0725122944169137 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.98562240600586 - actor/lr:1e-06 - training/global_step:375 - training/epoch:12 - critic/score/mean:0.71484375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.71484375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:1.2489589806818913e-08 - critic/advantages/max:3.2132883071899414 - critic/advantages/min:-3.08868145942688 - critic/returns/mean:0.6574651598930359 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.59375 - critic/values/max:1.2578125 - critic/values/min:-0.36328125 - critic/vf_explained_var:0.3662590980529785 - response_length/mean:271.12890625 - response_length/max:512.0 - response_length/min:130.0 - response_length/clip_ratio:0.02734375 - prompt_length/mean:102.70703125 - prompt_length/max:212.0 - prompt_length/min:65.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.374196916818619e-06 - timing_s/generate_sequences:3.506535530090332 - timing_s/reshard:0.5802409648895264 - timing_s/gen:4.816504707094282 - timing_s/reward:0.03568168915808201 - timing_s/old_log_prob:2.1283178692683578 - timing_s/values:1.615819909144193 - timing_s/adv:0.03642393369227648 - timing_s/update_critic:5.515236895997077 - timing_s/update_actor:7.090775654185563 - timing_s/step:21.245631334837526 - timing_s/stop_profile:1.6121193766593933e-06 - timing_per_token_ms/values:0.016883867726319127 - timing_per_token_ms/adv:0.00038059741376644666 - timing_per_token_ms/update_actor:0.07409224106273185 - timing_per_token_ms/update_critic:0.05762927520842905 - timing_per_token_ms/gen:0.06939308601325883 - perf/total_num_tokens:95702 - perf/time_per_step:21.245631334837526 - perf/throughput:1126.1373984574493
[36m(TaskRunner pid=2914832)[0m Training Progress:  86%|████████▌ | 375/435 [2:19:08<21:47, 21.79s/it]
[36m(TaskRunner pid=2914832)[0m step:376 - global_seqlen/min:23346 - global_seqlen/max:24300 - global_seqlen/minmax_diff:954 - global_seqlen/balanced_min:23662 - global_seqlen/balanced_max:23662 - global_seqlen/mean:23662.0 - actor/entropy:0.04767410457134247 - critic/vf_loss:0.07266992845688947 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6896811109036207 - critic/grad_norm:9.936870336532593 - perf/mfu/critic:0.09243743016657414 - critic/lr:1e-05 - actor/pg_loss:0.012427926587406546 - actor/pg_clipfrac:0.0037845598853891715 - actor/ppo_kl:0.0009671371194599487 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.9812873005867004 - perf/mfu/actor:0.0742832155528553 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.81819152832031 - actor/lr:1e-06 - training/global_step:376 - training/epoch:12 - critic/score/mean:0.71875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.71875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-4.1738079659126015e-08 - critic/advantages/max:2.5492284297943115 - critic/advantages/min:-2.8891963958740234 - critic/returns/mean:0.6746377944946289 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.8046875 - critic/values/max:1.328125 - critic/values/min:0.0986328125 - critic/vf_explained_var:0.36143958568573 - response_length/mean:266.9140625 - response_length/max:512.0 - response_length/min:127.0 - response_length/clip_ratio:0.015625 - prompt_length/mean:102.8046875 - prompt_length/max:202.0 - prompt_length/min:63.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.526918590068817e-06 - timing_s/generate_sequences:3.4802050590515137 - timing_s/reshard:0.9597336053848267 - timing_s/gen:4.927158219739795 - timing_s/reward:0.033649717923253775 - timing_s/old_log_prob:2.075046829879284 - timing_s/values:1.3803332932293415 - timing_s/adv:0.03352000005543232 - timing_s/update_critic:5.501717451028526 - timing_s/update_actor:6.842952052131295 - timing_s/step:20.800840631127357 - timing_s/stop_profile:1.85379758477211e-06 - timing_per_token_ms/values:0.014583861182796694 - timing_per_token_ms/adv:0.0003541543408781202 - timing_per_token_ms/update_actor:0.07229896090917183 - timing_per_token_ms/update_critic:0.05812819553533646 - timing_per_token_ms/gen:0.07210827191189513 - perf/total_num_tokens:94648 - perf/time_per_step:20.800840631127357 - perf/throughput:1137.5501798033617
[36m(TaskRunner pid=2914832)[0m Training Progress:  86%|████████▋ | 376/435 [2:19:29<21:08, 21.50s/it]
[36m(TaskRunner pid=2914832)[0m step:377 - global_seqlen/min:22185 - global_seqlen/max:23985 - global_seqlen/minmax_diff:1800 - global_seqlen/balanced_min:23390 - global_seqlen/balanced_max:23390 - global_seqlen/mean:23390.0 - actor/entropy:0.04702255502343178 - critic/vf_loss:0.05985832121223211 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6843263581395149 - critic/grad_norm:6.901607275009155 - perf/mfu/critic:0.09246735639762525 - critic/lr:1e-05 - actor/pg_loss:0.06563223747070879 - actor/pg_clipfrac:0.004160137570579536 - actor/ppo_kl:0.00023094269090506714 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.102934420108795 - perf/mfu/actor:0.07015236570365924 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.8305549621582 - actor/lr:1e-06 - training/global_step:377 - training/epoch:12 - critic/score/mean:0.71484375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.71484375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:2.769048634831961e-08 - critic/advantages/max:2.7295756340026855 - critic/advantages/min:-2.895005941390991 - critic/returns/mean:0.6608262062072754 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.609375 - critic/values/max:1.0546875 - critic/values/min:-0.0189208984375 - critic/vf_explained_var:0.47700440883636475 - response_length/mean:261.734375 - response_length/max:512.0 - response_length/min:127.0 - response_length/clip_ratio:0.015625 - prompt_length/mean:103.734375 - prompt_length/max:194.0 - prompt_length/min:71.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.843102604150772e-06 - timing_s/generate_sequences:3.4029088020324707 - timing_s/reshard:0.5856587886810303 - timing_s/gen:5.0122802862897515 - timing_s/reward:0.033087246119976044 - timing_s/old_log_prob:2.126180450897664 - timing_s/values:1.62653584824875 - timing_s/adv:0.033079047221690416 - timing_s/update_critic:5.435107346158475 - timing_s/update_actor:7.159751275088638 - timing_s/step:21.432527170982212 - timing_s/stop_profile:1.7401762306690216e-06 - timing_per_token_ms/values:0.017384949211722425 - timing_per_token_ms/adv:0.00035355971805996596 - timing_per_token_ms/update_actor:0.07652577249987856 - timing_per_token_ms/update_critic:0.058092211908491606 - timing_per_token_ms/gen:0.07480568751551775 - perf/total_num_tokens:93560 - perf/time_per_step:21.432527170982212 - perf/throughput:1091.3318720373786
[36m(TaskRunner pid=2914832)[0m Training Progress:  87%|████████▋ | 377/435 [2:19:51<20:45, 21.48s/it]
[36m(TaskRunner pid=2914832)[0m step:378 - global_seqlen/min:22455 - global_seqlen/max:24364 - global_seqlen/minmax_diff:1909 - global_seqlen/balanced_min:23367 - global_seqlen/balanced_max:23368 - global_seqlen/mean:23367.5 - actor/entropy:0.04768568277359009 - critic/vf_loss:0.07557189010549337 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6770897414535284 - critic/grad_norm:8.767958521842957 - perf/mfu/critic:0.09152331070014416 - critic/lr:1e-05 - actor/pg_loss:-0.08817984629422426 - actor/pg_clipfrac:0.003915803172276355 - actor/ppo_kl:0.0005913513950872584 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.922699272632599 - perf/mfu/actor:0.07062862213561828 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.73093795776367 - actor/lr:1e-06 - training/global_step:378 - training/epoch:13 - critic/score/mean:0.69921875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.69921875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:2.0562493929787706e-09 - critic/advantages/max:2.5333399772644043 - critic/advantages/min:-2.726383924484253 - critic/returns/mean:0.6458587646484375 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.65234375 - critic/values/max:1.0859375 - critic/values/min:-0.0225830078125 - critic/vf_explained_var:0.4295768737792969 - response_length/mean:262.6953125 - response_length/max:512.0 - response_length/min:126.0 - response_length/clip_ratio:0.00390625 - prompt_length/mean:102.421875 - prompt_length/max:179.0 - prompt_length/min:64.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:1.282012090086937e-05 - timing_s/generate_sequences:3.270264148712158 - timing_s/reshard:0.8604177236557007 - timing_s/gen:5.024656869005412 - timing_s/reward:0.033044051844626665 - timing_s/old_log_prob:2.4698969912715256 - timing_s/values:1.748845670837909 - timing_s/adv:0.03764538513496518 - timing_s/update_critic:5.486466094851494 - timing_s/update_actor:7.104816446080804 - timing_s/step:21.917018509004265 - timing_s/stop_profile:1.7900019884109497e-06 - timing_per_token_ms/values:0.01871023505764319 - timing_per_token_ms/adv:0.0004027536657212494 - timing_per_token_ms/update_actor:0.07601173045983528 - timing_per_token_ms/update_critic:0.058697615222547274 - timing_per_token_ms/gen:0.07471608727145594 - perf/total_num_tokens:93470 - perf/time_per_step:21.917018509004265 - perf/throughput:1066.1806025486462
[36m(TaskRunner pid=2914832)[0m Training Progress:  87%|████████▋ | 378/435 [2:20:13<20:39, 21.75s/it]
[36m(TaskRunner pid=2914832)[0m step:379 - global_seqlen/min:23529 - global_seqlen/max:24743 - global_seqlen/minmax_diff:1214 - global_seqlen/balanced_min:24243 - global_seqlen/balanced_max:24243 - global_seqlen/mean:24243.0 - actor/entropy:0.04749971255660057 - critic/vf_loss:0.07322684221435338 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6562358550727367 - critic/grad_norm:17.207696437835693 - perf/mfu/critic:0.1011004000363774 - critic/lr:1e-05 - actor/pg_loss:0.04959373583551496 - actor/pg_clipfrac:0.002999802709382493 - actor/ppo_kl:0.00014580717652279418 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.921405076980591 - perf/mfu/actor:0.07598880629909771 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.42585372924805 - actor/lr:1e-06 - training/global_step:379 - training/epoch:13 - critic/score/mean:0.7109375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.7109375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-2.042534674728813e-08 - critic/advantages/max:2.5560736656188965 - critic/advantages/min:-2.850980520248413 - critic/returns/mean:0.6562699675559998 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.7265625 - critic/values/max:1.125 - critic/values/min:0.0284423828125 - critic/vf_explained_var:0.4388415217399597 - response_length/mean:275.40234375 - response_length/max:512.0 - response_length/min:145.0 - response_length/clip_ratio:0.0234375 - prompt_length/mean:103.39453125 - prompt_length/max:178.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:1.0428018867969513e-05 - timing_s/generate_sequences:3.5314908027648926 - timing_s/reshard:0.9616484642028809 - timing_s/gen:5.158260708209127 - timing_s/reward:0.03559222212061286 - timing_s/old_log_prob:2.0786737129092216 - timing_s/values:1.349522755946964 - timing_s/adv:0.0344063057564199 - timing_s/update_critic:5.157378641888499 - timing_s/update_actor:6.859817314893007 - timing_s/step:20.680291788186878 - timing_s/stop_profile:1.89291313290596e-06 - timing_per_token_ms/values:0.01391662290090917 - timing_per_token_ms/adv:0.0003548066014562956 - timing_per_token_ms/update_actor:0.0707401859804171 - timing_per_token_ms/update_critic:0.05318420411962731 - timing_per_token_ms/gen:0.0731637052070001 - perf/total_num_tokens:96972 - perf/time_per_step:20.680291788186878 - perf/throughput:1172.2755291996525
[36m(TaskRunner pid=2914832)[0m Training Progress:  87%|████████▋ | 379/435 [2:20:34<20:00, 21.43s/it]
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 380}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and bakes muffins for her friends every day with four. She sells the remainder at the farmers' market daily for $2 per fresh duck egg. How much in dollars does she make every day at the farmers' market? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much Janet makes every day from selling the eggs at the farmers' market, we will follow these steps:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. Calculate the number of eggs Janet lays in a day.
[36m(TaskRunner pid=2914832)[0m 2. Subtract the number of eggs she eats in a day.
[36m(TaskRunner pid=2914832)[0m 3. Subtract the number of eggs she bakes.
[36m(TaskRunner pid=2914832)[0m 4. Determine the number of ducks she has and calculate the revenue from selling the eggs.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m First, Janet's ducks lay 16 eggs per day. She eats 3 eggs for breakfast and bakes 4 eggs for her friends every day. Therefore, the number of eggs she eats in a day is:
[36m(TaskRunner pid=2914832)[0m \[ 3 + 4 = 7 \text{ eggs} \]
[36m(TaskRunner pid=2914832)[0m The number of eggs she sells at the farmers' market is the total number of eggs laid minus the number of eggs she eats. Therefore, the number of eggs she sells in a day is:
[36m(TaskRunner pid=2914832)[0m \[ 16 - 7 = 9 \text{ eggs} \]
[36m(TaskRunner pid=2914832)[0m Since she sells each egg for $2, the total revenue from selling the eggs daily is:
[36m(TaskRunner pid=2914832)[0m \[ 9 \times 2 = 18 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Therefore, the final answer is:
[36m(TaskRunner pid=2914832)[0m \[
[36m(TaskRunner pid=2914832)[0m \boxed{18}
[36m(TaskRunner pid=2914832)[0m \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m #### 18
[36m(TaskRunner pid=2914832)[0m [ground_truth] 18
[36m(TaskRunner pid=2914832)[0m [score] 1.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1312
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 380}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Tom's restaurant gets 6 reservations a night.  They normally order 2 meals that cost $5 each and a $5 bottle of wine.  How much do they make a week if they are open 2 days a week? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much Tom's restaurant makes a week, we will follow these steps:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. Calculate the number of reservations per day and the amount spent on reservations per day.
[36m(TaskRunner pid=2914832)[0m 2. Multiply the daily amount by the number of days the restaurant is open in a week.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m First, Tom's restaurant gets 6 reservations a night. Since they are open 2 days a week, the number of reservations they make in a week is:
[36m(TaskRunner pid=2914832)[0m \[ 6 \times 2 = 12 \text{ reservations per week} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Next, the amount spent on the meals is calculated as follows. They normally order 2 meals that cost $5 each and 1 bottle of wine that costs $5. Therefore, the total cost of the meals per week is:
[36m(TaskRunner pid=2914832)[0m \[ 2 \times 5 + 5 = 10 + 5 = 15 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m The amount spent on the wine per week is:
[36m(TaskRunner pid=2914832)[0m \[ 1 \times 5 = 5 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Therefore, the total amount made per week is the sum of the amount spent on the meals and the amount spent on the wine:
[36m(TaskRunner pid=2914832)[0m \[ 15 + 5 = 20 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Thus, the final answer is:
[36m(TaskRunner pid=2914832)[0m \[ \boxed{20} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m #### 20
[36m(TaskRunner pid=2914832)[0m [ground_truth] 180
[36m(TaskRunner pid=2914832)[0m [score] 0.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1319
[36m(TaskRunner pid=2914832)[0m step:380 - global_seqlen/min:23049 - global_seqlen/max:24137 - global_seqlen/minmax_diff:1088 - global_seqlen/balanced_min:23631 - global_seqlen/balanced_max:23631 - global_seqlen/mean:23631.0 - actor/entropy:0.04916618391871452 - critic/vf_loss:0.06984049471793696 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.7520220167934895 - critic/grad_norm:17.52233862876892 - perf/mfu/critic:0.09879045038695862 - critic/lr:1e-05 - actor/pg_loss:0.2161981938406825 - actor/pg_clipfrac:0.004003788664704189 - actor/ppo_kl:-0.00012310823012740002 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.294219434261322 - perf/mfu/actor:0.07339939320871434 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.38282775878906 - actor/lr:1e-06 - val-core/openai/gsm8k/reward/mean@1:0.5504169825625473 - training/global_step:380 - training/epoch:13 - critic/score/mean:0.734375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.734375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-3.022492123250231e-08 - critic/advantages/max:2.764909505844116 - critic/advantages/min:-3.069706439971924 - critic/returns/mean:0.6867818832397461 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.5703125 - critic/values/max:0.9765625 - critic/values/min:-0.212890625 - critic/vf_explained_var:0.45033812522888184 - response_length/mean:267.2109375 - response_length/max:512.0 - response_length/min:144.0 - response_length/clip_ratio:0.0234375 - prompt_length/mean:102.0234375 - prompt_length/max:171.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.317851901054382e-06 - timing_s/generate_sequences:3.5113794803619385 - timing_s/reshard:0.6804331541061401 - timing_s/gen:5.121256826911122 - timing_s/reward:0.0336077930405736 - timing_s/old_log_prob:2.1201567403040826 - timing_s/values:1.619115699082613 - timing_s/adv:0.03677644766867161 - timing_s/update_critic:5.14114475203678 - timing_s/update_actor:6.915705177001655 - timing_s/testing:13.224209147971123 - timing_s/step:34.2189777828753 - timing_s/stop_profile:2.2710300981998444e-06 - timing_per_token_ms/values:0.017129149201077113 - timing_per_token_ms/adv:0.0003890699469835344 - timing_per_token_ms/update_actor:0.07316348416276983 - timing_per_token_ms/update_critic:0.05438983487830371 - timing_per_token_ms/gen:0.07486560867337838 - perf/total_num_tokens:94524 - perf/time_per_step:34.2189777828753 - perf/throughput:690.5817043963833
[36m(TaskRunner pid=2914832)[0m Training Progress:  87%|████████▋ | 380/435 [2:21:08<23:09, 25.27s/it]
[36m(TaskRunner pid=2914832)[0m step:381 - global_seqlen/min:23090 - global_seqlen/max:25218 - global_seqlen/minmax_diff:2128 - global_seqlen/balanced_min:24092 - global_seqlen/balanced_max:24093 - global_seqlen/mean:24092.75 - actor/entropy:0.04788415506482124 - critic/vf_loss:0.06355634494684637 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.7205387186259031 - critic/grad_norm:18.758360028266907 - perf/mfu/critic:0.10097112656371673 - critic/lr:1e-05 - actor/pg_loss:0.017487030461779796 - actor/pg_clipfrac:0.0037287700979504734 - actor/ppo_kl:0.00046773472581662645 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.0758453011512756 - perf/mfu/actor:0.07494710452454416 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.69522476196289 - actor/lr:1e-06 - training/global_step:381 - training/epoch:13 - critic/score/mean:0.69140625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.69140625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-5.281812676116715e-08 - critic/advantages/max:2.677689790725708 - critic/advantages/min:-2.6841554641723633 - critic/returns/mean:0.6359506249427795 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.83203125 - critic/values/max:1.25 - critic/values/min:-0.0191650390625 - critic/vf_explained_var:0.39436763525009155 - response_length/mean:271.68359375 - response_length/max:512.0 - response_length/min:125.0 - response_length/clip_ratio:0.02734375 - prompt_length/mean:104.765625 - prompt_length/max:216.0 - prompt_length/min:63.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:1.0132789611816406e-05 - timing_s/generate_sequences:3.475156784057617 - timing_s/reshard:0.6870635747909546 - timing_s/gen:4.725705872289836 - timing_s/reward:0.0339653380215168 - timing_s/old_log_prob:2.083807099144906 - timing_s/values:1.3476197021082044 - timing_s/adv:0.035546015948057175 - timing_s/update_critic:5.131976676173508 - timing_s/update_actor:6.910815581213683 - timing_s/step:20.279606394004077 - timing_s/stop_profile:1.8416903913021088e-06 - timing_per_token_ms/values:0.013983664194707996 - timing_per_token_ms/adv:0.00036884556503571794 - timing_per_token_ms/update_actor:0.07171053098145379 - timing_per_token_ms/update_critic:0.053252292454924285 - timing_per_token_ms/gen:0.0679459083591873 - perf/total_num_tokens:96371 - perf/time_per_step:20.279606394004077 - perf/throughput:1188.0284820085724
[36m(TaskRunner pid=2914832)[0m Training Progress:  88%|████████▊ | 381/435 [2:21:28<21:24, 23.78s/it]
[36m(TaskRunner pid=2914832)[0m step:382 - global_seqlen/min:23481 - global_seqlen/max:25384 - global_seqlen/minmax_diff:1903 - global_seqlen/balanced_min:24232 - global_seqlen/balanced_max:24233 - global_seqlen/mean:24232.5 - actor/entropy:0.050431910902261734 - critic/vf_loss:0.0594752756296657 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.59647854603827 - critic/grad_norm:5.815407872200012 - perf/mfu/critic:0.09975231987751643 - critic/lr:1e-05 - actor/pg_loss:0.08008464693557471 - actor/pg_clipfrac:0.003848538108286448 - actor/ppo_kl:0.0005118388799019158 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.111190676689148 - perf/mfu/actor:0.07614340375439259 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.42612075805664 - actor/lr:1e-06 - training/global_step:382 - training/epoch:13 - critic/score/mean:0.69921875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.69921875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-3.4215941191462207e-09 - critic/advantages/max:2.834493637084961 - critic/advantages/min:-2.7700695991516113 - critic/returns/mean:0.6476978063583374 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.5625 - critic/values/max:1.0546875 - critic/values/min:-0.2255859375 - critic/vf_explained_var:0.3630604147911072 - response_length/mean:274.3671875 - response_length/max:512.0 - response_length/min:129.0 - response_length/clip_ratio:0.01953125 - prompt_length/mean:104.265625 - prompt_length/max:175.0 - prompt_length/min:66.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.699919372797012e-06 - timing_s/generate_sequences:3.5537590980529785 - timing_s/reshard:0.6832525730133057 - timing_s/gen:5.12447574082762 - timing_s/reward:0.03379015205428004 - timing_s/old_log_prob:2.1199568221345544 - timing_s/values:1.6206870218738914 - timing_s/adv:0.03472357429563999 - timing_s/update_critic:5.22505749296397 - timing_s/update_actor:6.8470554309897125 - timing_s/step:21.0127671668306 - timing_s/stop_profile:3.10409814119339e-06 - timing_per_token_ms/values:0.016720179736654198 - timing_per_token_ms/adv:0.0003582335117676673 - timing_per_token_ms/update_actor:0.07063917704518428 - timing_per_token_ms/update_critic:0.05390547294917951 - timing_per_token_ms/gen:0.07295873659312081 - perf/total_num_tokens:96930 - perf/time_per_step:21.0127671668306 - perf/throughput:1153.22745488999
[36m(TaskRunner pid=2914832)[0m Training Progress:  88%|████████▊ | 382/435 [2:21:49<20:16, 22.95s/it]
[36m(TaskRunner pid=2914832)[0m step:383 - global_seqlen/min:23090 - global_seqlen/max:25471 - global_seqlen/minmax_diff:2381 - global_seqlen/balanced_min:24272 - global_seqlen/balanced_max:24273 - global_seqlen/mean:24272.5 - actor/entropy:0.051334261894226074 - critic/vf_loss:0.08985801230301149 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.7658823300153017 - critic/grad_norm:20.386239409446716 - perf/mfu/critic:0.09737985437018201 - critic/lr:1e-05 - actor/pg_loss:-0.04421400825958699 - actor/pg_clipfrac:0.004963806197338272 - actor/ppo_kl:4.785957480635261e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.1939684748649597 - perf/mfu/actor:0.07332000381801022 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.15078353881836 - actor/lr:1e-06 - training/global_step:383 - training/epoch:13 - critic/score/mean:0.6796875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.6796875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:2.456249248439235e-08 - critic/advantages/max:2.5667660236358643 - critic/advantages/min:-2.654228448867798 - critic/returns/mean:0.618830680847168 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.76171875 - critic/values/max:1.234375 - critic/values/min:-0.00145721435546875 - critic/vf_explained_var:0.3712298274040222 - response_length/mean:275.2734375 - response_length/max:512.0 - response_length/min:127.0 - response_length/clip_ratio:0.03125 - prompt_length/mean:103.984375 - prompt_length/max:185.0 - prompt_length/min:65.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.628913640975952e-06 - timing_s/generate_sequences:3.4472544193267822 - timing_s/reshard:0.5834710001945496 - timing_s/gen:4.574331178795546 - timing_s/reward:0.03395425109192729 - timing_s/old_log_prob:2.08166430471465 - timing_s/values:1.3503113449551165 - timing_s/adv:0.033546593971550465 - timing_s/update_critic:5.360970077570528 - timing_s/update_actor:7.116198665928096 - timing_s/step:20.55951239494607 - timing_s/stop_profile:2.074986696243286e-06 - timing_per_token_ms/values:0.013907831341591476 - timing_per_token_ms/adv:0.0003455205888510708 - timing_per_token_ms/update_actor:0.07329486729764235 - timing_per_token_ms/update_critic:0.055216500953450695 - timing_per_token_ms/gen:0.0649117522179019 - perf/total_num_tokens:97090 - perf/time_per_step:20.55951239494607 - perf/throughput:1180.5970654229454
[36m(TaskRunner pid=2914832)[0m Training Progress:  88%|████████▊ | 383/435 [2:22:10<19:16, 22.24s/it]
[36m(TaskRunner pid=2914832)[0m step:384 - global_seqlen/min:23374 - global_seqlen/max:25036 - global_seqlen/minmax_diff:1662 - global_seqlen/balanced_min:24079 - global_seqlen/balanced_max:24080 - global_seqlen/mean:24079.75 - actor/entropy:0.050351645797491074 - critic/vf_loss:0.06339694384951144 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.5391375403851271 - critic/grad_norm:9.059962451457977 - perf/mfu/critic:0.10072856407761664 - critic/lr:1e-05 - actor/pg_loss:0.15950677113141865 - actor/pg_clipfrac:0.004011865210486576 - actor/ppo_kl:-6.196627390409049e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.324346661567688 - perf/mfu/actor:0.07559126041788575 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.3282699584961 - actor/lr:1e-06 - training/global_step:384 - training/epoch:13 - critic/score/mean:0.66015625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.66015625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:7.187122896823439e-09 - critic/advantages/max:2.537254571914673 - critic/advantages/min:-2.620811939239502 - critic/returns/mean:0.6012184619903564 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.6015625 - critic/values/max:1.015625 - critic/values/min:-0.04248046875 - critic/vf_explained_var:0.44716817140579224 - response_length/mean:271.86328125 - response_length/max:512.0 - response_length/min:138.0 - response_length/clip_ratio:0.0234375 - prompt_length/mean:104.3828125 - prompt_length/max:194.0 - prompt_length/min:66.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.924608558416367e-06 - timing_s/generate_sequences:3.542567253112793 - timing_s/reshard:0.8861808180809021 - timing_s/gen:5.178386264946312 - timing_s/reward:0.03723462903872132 - timing_s/old_log_prob:2.079471536912024 - timing_s/values:1.3441275181248784 - timing_s/adv:0.03470810176804662 - timing_s/update_critic:5.14187270635739 - timing_s/update_actor:6.847100484184921 - timing_s/step:20.670039454009384 - timing_s/stop_profile:2.874806523323059e-05 - timing_per_token_ms/values:0.013954957154090869 - timing_per_token_ms/adv:0.00036034532925016476 - timing_per_token_ms/update_actor:0.0710877447251832 - timing_per_token_ms/update_critic:0.05338378415844631 - timing_per_token_ms/gen:0.07440530863322142 - perf/total_num_tokens:96319 - perf/time_per_step:20.670039454009384 - perf/throughput:1164.9590729411614
[36m(TaskRunner pid=2914832)[0m Training Progress:  88%|████████▊ | 384/435 [2:22:31<18:30, 21.77s/it]
[36m(TaskRunner pid=2914832)[0m step:385 - global_seqlen/min:21654 - global_seqlen/max:24150 - global_seqlen/minmax_diff:2496 - global_seqlen/balanced_min:22853 - global_seqlen/balanced_max:22854 - global_seqlen/mean:22853.75 - actor/entropy:0.0503750778734684 - critic/vf_loss:0.06381855567451566 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6670488379895687 - critic/grad_norm:16.00532341003418 - perf/mfu/critic:0.09088265869358196 - critic/lr:1e-05 - actor/pg_loss:-0.02795801917091012 - actor/pg_clipfrac:0.003642376308562234 - actor/ppo_kl:0.0002655458520166576 - actor/pg_clipfrac_lower:6.69164874125272e-05 - actor/grad_norm:3.0965631008148193 - perf/mfu/actor:0.06834372659784654 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.81277847290039 - actor/lr:1e-06 - training/global_step:385 - training/epoch:13 - critic/score/mean:0.76171875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.76171875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:3.2614874356795553e-08 - critic/advantages/max:2.351915121078491 - critic/advantages/min:-3.0615105628967285 - critic/returns/mean:0.7064221501350403 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.56640625 - critic/values/max:0.96875 - critic/values/min:-0.07958984375 - critic/vf_explained_var:0.451900839805603 - response_length/mean:256.25390625 - response_length/max:512.0 - response_length/min:125.0 - response_length/clip_ratio:0.0234375 - prompt_length/mean:100.8359375 - prompt_length/max:184.0 - prompt_length/min:65.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.348585546016693e-06 - timing_s/generate_sequences:3.492784023284912 - timing_s/reshard:0.6883916854858398 - timing_s/gen:5.1227548136375844 - timing_s/reward:0.03343593515455723 - timing_s/old_log_prob:2.1126611749641597 - timing_s/values:1.6132703297771513 - timing_s/adv:0.03468719683587551 - timing_s/update_critic:5.399188105948269 - timing_s/update_actor:7.177703799214214 - timing_s/step:21.501238617580384 - timing_s/stop_profile:1.92178413271904e-06 - timing_per_token_ms/values:0.017647763821879905 - timing_per_token_ms/adv:0.0003794475396365532 - timing_per_token_ms/update_actor:0.0785177902884014 - timing_per_token_ms/update_critic:0.05906238698187682 - timing_per_token_ms/gen:0.07808958420813074 - perf/total_num_tokens:91415 - perf/time_per_step:21.501238617580384 - perf/throughput:1062.9038822588454
[36m(TaskRunner pid=2914832)[0m Training Progress:  89%|████████▊ | 385/435 [2:22:52<18:04, 21.69s/it]
[36m(TaskRunner pid=2914832)[0m step:386 - global_seqlen/min:23142 - global_seqlen/max:25234 - global_seqlen/minmax_diff:2092 - global_seqlen/balanced_min:24116 - global_seqlen/balanced_max:24117 - global_seqlen/mean:24116.25 - actor/entropy:0.04841937497258186 - critic/vf_loss:0.06784770646481775 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6803477089852095 - critic/grad_norm:12.666362285614014 - perf/mfu/critic:0.10129889101501319 - critic/lr:1e-05 - actor/pg_loss:0.11474302341230214 - actor/pg_clipfrac:0.003709817843628116 - actor/ppo_kl:0.00041680796488208216 - actor/pg_clipfrac_lower:5.879586024093442e-05 - actor/grad_norm:3.0211614966392517 - perf/mfu/actor:0.0757909340628958 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.47915649414062 - actor/lr:1e-06 - training/global_step:386 - training/epoch:13 - critic/score/mean:0.71875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.71875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:1.8131105505858613e-08 - critic/advantages/max:2.6923556327819824 - critic/advantages/min:-2.9552645683288574 - critic/returns/mean:0.656195342540741 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.765625 - critic/values/max:1.2109375 - critic/values/min:0.042236328125 - critic/vf_explained_var:0.45064347982406616 - response_length/mean:272.4453125 - response_length/max:512.0 - response_length/min:135.0 - response_length/clip_ratio:0.01953125 - prompt_length/mean:104.37109375 - prompt_length/max:232.0 - prompt_length/min:70.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.1800161600112915e-06 - timing_s/generate_sequences:3.4583678245544434 - timing_s/reshard:0.9639780521392822 - timing_s/gen:5.096453093923628 - timing_s/reward:0.033455261029303074 - timing_s/old_log_prob:2.072281951084733 - timing_s/values:1.3425527419894934 - timing_s/adv:0.03454189095646143 - timing_s/update_critic:5.122315116692334 - timing_s/update_actor:6.841695956885815 - timing_s/step:20.550058349967003 - timing_s/stop_profile:1.984182745218277e-06 - timing_per_token_ms/values:0.013917511449639697 - timing_per_token_ms/adv:0.00035807692900493887 - timing_per_token_ms/update_actor:0.07092412747510304 - timing_per_token_ms/update_critic:0.05310024482135836 - timing_per_token_ms/gen:0.07307161835694705 - perf/total_num_tokens:96465 - perf/time_per_step:20.550058349967003 - perf/throughput:1173.5368138280114
[36m(TaskRunner pid=2914832)[0m Training Progress:  89%|████████▊ | 386/435 [2:23:13<17:26, 21.36s/it]
[36m(TaskRunner pid=2914832)[0m step:387 - global_seqlen/min:22936 - global_seqlen/max:24555 - global_seqlen/minmax_diff:1619 - global_seqlen/balanced_min:23965 - global_seqlen/balanced_max:23966 - global_seqlen/mean:23965.5 - actor/entropy:0.046523112803697586 - critic/vf_loss:0.05051526856550481 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.7454397454857826 - critic/grad_norm:17.801084876060486 - perf/mfu/critic:0.0955515497420492 - critic/lr:1e-05 - actor/pg_loss:-0.11480593017768115 - actor/pg_clipfrac:0.0031444051855942234 - actor/ppo_kl:-0.0001835729635786265 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.0591461062431335 - perf/mfu/actor:0.07151198359251061 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.62392807006836 - actor/lr:1e-06 - training/global_step:387 - training/epoch:13 - critic/score/mean:0.71484375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.71484375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-2.0277532986057167e-09 - critic/advantages/max:2.6282951831817627 - critic/advantages/min:-2.87565541267395 - critic/returns/mean:0.6633192300796509 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.6015625 - critic/values/max:1.0703125 - critic/values/min:-0.123046875 - critic/vf_explained_var:0.39893072843551636 - response_length/mean:271.8984375 - response_length/max:512.0 - response_length/min:130.0 - response_length/clip_ratio:0.015625 - prompt_length/mean:102.5625 - prompt_length/max:199.0 - prompt_length/min:67.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.068948328495026e-06 - timing_s/generate_sequences:3.4379384517669678 - timing_s/reshard:0.7814334034919739 - timing_s/gen:5.220723915379494 - timing_s/reward:0.03385539213195443 - timing_s/old_log_prob:2.1262364126741886 - timing_s/values:1.6328344503417611 - timing_s/adv:0.03342460282146931 - timing_s/update_critic:5.392868958879262 - timing_s/update_actor:7.202263263985515 - timing_s/step:21.649055143352598 - timing_s/stop_profile:2.2049061954021454e-06 - timing_per_token_ms/values:0.017033177383548863 - timing_per_token_ms/adv:0.00034867416516940294 - timing_per_token_ms/update_actor:0.07513157730889732 - timing_per_token_ms/update_critic:0.056256587165709686 - timing_per_token_ms/gen:0.07500393522655366 - perf/total_num_tokens:95862 - perf/time_per_step:21.649055143352598 - perf/throughput:1106.9998132162675
[36m(TaskRunner pid=2914832)[0m Training Progress:  89%|████████▉ | 387/435 [2:23:34<17:09, 21.45s/it]
[36m(TaskRunner pid=2914832)[0m step:388 - global_seqlen/min:23304 - global_seqlen/max:24529 - global_seqlen/minmax_diff:1225 - global_seqlen/balanced_min:23733 - global_seqlen/balanced_max:23734 - global_seqlen/mean:23733.75 - actor/entropy:0.04675782471895218 - critic/vf_loss:0.06974509952124208 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.7145331688225269 - critic/grad_norm:15.879565834999084 - perf/mfu/critic:0.09894428758304864 - critic/lr:1e-05 - actor/pg_loss:-0.044282810762524605 - actor/pg_clipfrac:0.004170714288193267 - actor/ppo_kl:5.898928338865517e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.093351364135742 - perf/mfu/actor:0.07529834358056547 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.23891830444336 - actor/lr:1e-06 - training/global_step:388 - training/epoch:13 - critic/score/mean:0.69921875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.69921875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:1.7479347746984786e-08 - critic/advantages/max:2.871438503265381 - critic/advantages/min:-3.038363218307495 - critic/returns/mean:0.6501851677894592 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.828125 - critic/values/max:1.296875 - critic/values/min:-0.0263671875 - critic/vf_explained_var:0.4776252508163452 - response_length/mean:267.8984375 - response_length/max:512.0 - response_length/min:134.0 - response_length/clip_ratio:0.0234375 - prompt_length/mean:102.94140625 - prompt_length/max:202.0 - prompt_length/min:71.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.6587007343769073e-06 - timing_s/generate_sequences:3.537285804748535 - timing_s/reshard:0.5857309699058533 - timing_s/gen:4.914815480355173 - timing_s/reward:0.033050382044166327 - timing_s/old_log_prob:2.076867970172316 - timing_s/values:1.3459337279200554 - timing_s/adv:0.04034838825464249 - timing_s/update_critic:5.160176210105419 - timing_s/update_actor:6.771468269173056 - timing_s/step:20.349357563070953 - timing_s/stop_profile:1.8603168427944183e-06 - timing_per_token_ms/values:0.014177423794386216 - timing_per_token_ms/adv:0.0004250106731410174 - timing_per_token_ms/update_actor:0.07132741632878344 - timing_per_token_ms/update_critic:0.05435483446679749 - timing_per_token_ms/gen:0.07166334432292983 - perf/total_num_tokens:94935 - perf/time_per_step:20.349357563070953 - perf/throughput:1166.3144611047026
[36m(TaskRunner pid=2914832)[0m Training Progress:  89%|████████▉ | 388/435 [2:23:55<16:32, 21.12s/it]
[36m(TaskRunner pid=2914832)[0m step:389 - global_seqlen/min:23260 - global_seqlen/max:24282 - global_seqlen/minmax_diff:1022 - global_seqlen/balanced_min:23648 - global_seqlen/balanced_max:23649 - global_seqlen/mean:23648.25 - actor/entropy:0.04863036423921585 - critic/vf_loss:0.06604121474083513 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6224983772262931 - critic/grad_norm:10.637929439544678 - perf/mfu/critic:0.0986293434334346 - critic/lr:1e-05 - actor/pg_loss:0.07077997620217502 - actor/pg_clipfrac:0.0036512457591015846 - actor/ppo_kl:0.0006295470066106645 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.2350869178771973 - perf/mfu/actor:0.07486666282926886 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.74324417114258 - actor/lr:1e-06 - training/global_step:389 - training/epoch:13 - critic/score/mean:0.6875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.6875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-7.130171120195428e-09 - critic/advantages/max:2.9427263736724854 - critic/advantages/min:-2.6370081901550293 - critic/returns/mean:0.640235960483551 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.671875 - critic/values/max:1.1171875 - critic/values/min:-0.25390625 - critic/vf_explained_var:0.3850089907646179 - response_length/mean:267.50390625 - response_length/max:512.0 - response_length/min:137.0 - response_length/clip_ratio:0.01953125 - prompt_length/mean:102.0 - prompt_length/max:161.0 - prompt_length/min:66.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.0549784898757935e-06 - timing_s/generate_sequences:3.5088326930999756 - timing_s/reshard:0.8663272261619568 - timing_s/gen:5.0541053880006075 - timing_s/reward:0.03379786107689142 - timing_s/old_log_prob:2.400424233172089 - timing_s/values:1.3455340303480625 - timing_s/adv:0.035119698848575354 - timing_s/update_critic:5.1557640712708235 - timing_s/update_actor:6.786793672014028 - timing_s/step:20.81930575799197 - timing_s/stop_profile:1.6284175217151642e-06 - timing_per_token_ms/values:0.014224456675949198 - timing_per_token_ms/adv:0.0003712716464069789 - timing_per_token_ms/update_actor:0.07174731398744122 - timing_per_token_ms/update_critic:0.05450471040426695 - timing_per_token_ms/gen:0.0738030313225655 - perf/total_num_tokens:94593 - perf/time_per_step:20.81930575799197 - perf/throughput:1135.8808153783934
[36m(TaskRunner pid=2914832)[0m Training Progress:  89%|████████▉ | 389/435 [2:24:16<16:07, 21.03s/it]
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 390}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and bakes muffins for her friends every day with four. She sells the remainder at the farmers' market daily for $2 per fresh duck egg. How much in dollars does she make every day at the farmers' market? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much Janet makes every day from selling the eggs at the farmers' market, we will follow these steps:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. Calculate the number of eggs Janet lays in a day.
[36m(TaskRunner pid=2914832)[0m 2. Subtract the number of eggs she eats in a day.
[36m(TaskRunner pid=2914832)[0m 3. Subtract the number of eggs she bakes.
[36m(TaskRunner pid=2914832)[0m 4. Sell the remaining eggs at the farmers' market.
[36m(TaskRunner pid=2914832)[0m 5. Determine the amount earned from selling the eggs.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Let's start with the number of eggs Janet lays in a day. She lays 16 eggs per day.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Next, she eats 3 eggs for breakfast every day. So, the number of eggs she eats in a day is:
[36m(TaskRunner pid=2914832)[0m \[ 3 \text{ eggs} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Then, she bakes 4 eggs for her friends every day. So, the number of eggs she bakes in a day is:
[36m(TaskRunner pid=2914832)[0m \[ 4 \text{ eggs} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Therefore, the number of eggs she sells in a day is:
[36m(TaskRunner pid=2914832)[0m \[ 16 \text{ eggs} - 3 \text{ eggs} - 4 \text{ eggs} = 17 \text{ eggs} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Since she sells each egg for $2, the amount of money she makes from selling the eggs per day is:
[36m(TaskRunner pid=2914832)[0m \[ 17 \text{ eggs} \times 2 \text{ dollars per egg} = 34 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Therefore, the final answer is:
[36m(TaskRunner pid=2914832)[0m \[ \boxed{34} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m #### 34
[36m(TaskRunner pid=2914832)[0m [ground_truth] 18
[36m(TaskRunner pid=2914832)[0m [score] 0.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1312
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 390}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Tom's restaurant gets 6 reservations a night.  They normally order 2 meals that cost $5 each and a $5 bottle of wine.  How much do they make a week if they are open 2 days a week? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much Tom's restaurant makes in a week, we need to follow these steps:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. Calculate the number of reservations per day and the amount of money made from reservations per day.
[36m(TaskRunner pid=2914832)[0m 2. Multiply the daily amount by the number of days the restaurant is open in a week.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m First, Tom gets 6 reservations a night. If the restaurant is open 2 days a week, the number of reservations per week is:
[36m(TaskRunner pid=2914832)[0m \[ 6 \times 2 = 12 \text{ reservations per week} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Next, the restaurant orders 2 meals that cost $5 each and a $5 bottle of wine. The total cost of the meals is:
[36m(TaskRunner pid=2914832)[0m \[ 2 \times 5 = 10 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m The total cost of the wine is:
[36m(TaskRunner pid=2914832)[0m \[ 5 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m Therefore, the total cost of the meals and the wine per week is:
[36m(TaskRunner pid=2914832)[0m \[ 10 + 5 = 15 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m So, the amount made from reservations per week is:
[36m(TaskRunner pid=2914832)[0m \[ 12 \times 15 = 180 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Therefore, the final answer is:
[36m(TaskRunner pid=2914832)[0m \[ \boxed{180} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m #### 180
[36m(TaskRunner pid=2914832)[0m [ground_truth] 180
[36m(TaskRunner pid=2914832)[0m [score] 1.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1319
[36m(TaskRunner pid=2914832)[0m step:390 - global_seqlen/min:23025 - global_seqlen/max:24800 - global_seqlen/minmax_diff:1775 - global_seqlen/balanced_min:24189 - global_seqlen/balanced_max:24190 - global_seqlen/mean:24189.5 - actor/entropy:0.050216663628816605 - critic/vf_loss:0.04794007513555698 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6313151475042105 - critic/grad_norm:11.316630572080612 - perf/mfu/critic:0.09544695490713193 - critic/lr:1e-05 - actor/pg_loss:0.007785379304550588 - actor/pg_clipfrac:0.004086794579052366 - actor/ppo_kl:-0.00026721197718870826 - actor/pg_clipfrac_lower:0.00010200205360888503 - actor/grad_norm:3.132681727409363 - perf/mfu/actor:0.07280698675618102 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.15957260131836 - actor/lr:1e-06 - val-core/openai/gsm8k/reward/mean@1:0.5633055344958302 - training/global_step:390 - training/epoch:13 - critic/score/mean:0.67578125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.67578125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-2.300003743016532e-08 - critic/advantages/max:2.998570203781128 - critic/advantages/min:-3.1468188762664795 - critic/returns/mean:0.6004436612129211 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.50390625 - critic/values/max:0.984375 - critic/values/min:-0.380859375 - critic/vf_explained_var:0.5596219301223755 - response_length/mean:274.69921875 - response_length/max:512.0 - response_length/min:134.0 - response_length/clip_ratio:0.02734375 - prompt_length/mean:103.26171875 - prompt_length/max:238.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.536006599664688e-06 - timing_s/generate_sequences:3.5517122745513916 - timing_s/reshard:0.5877631902694702 - timing_s/gen:5.036999441217631 - timing_s/reward:0.034456418827176094 - timing_s/old_log_prob:2.103601444978267 - timing_s/values:1.3436510260216892 - timing_s/adv:0.03339764196425676 - timing_s/update_critic:5.452185908332467 - timing_s/update_actor:7.142263217829168 - timing_s/testing:13.918837083037943 - timing_s/step:35.07203255081549 - timing_s/stop_profile:1.7937272787094116e-06 - timing_per_token_ms/values:0.01388671764631027 - timing_per_token_ms/adv:0.00034516672486261356 - timing_per_token_ms/update_actor:0.07381573841779665 - timing_per_token_ms/update_critic:0.05634868339912428 - timing_per_token_ms/gen:0.07162662914292096 - perf/total_num_tokens:96758 - perf/time_per_step:35.07203255081549 - perf/throughput:689.7090998348069
[36m(TaskRunner pid=2914832)[0m Training Progress:  90%|████████▉ | 390/435 [2:24:51<18:56, 25.25s/it]
[36m(TaskRunner pid=2914832)[0m step:391 - global_seqlen/min:23757 - global_seqlen/max:24768 - global_seqlen/minmax_diff:1011 - global_seqlen/balanced_min:24235 - global_seqlen/balanced_max:24236 - global_seqlen/mean:24235.25 - actor/entropy:0.047078996896743774 - critic/vf_loss:0.05483603069296805 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.718638127669692 - critic/grad_norm:4.892741680145264 - perf/mfu/critic:0.09371571074351352 - critic/lr:1e-05 - actor/pg_loss:-0.07515386329032481 - actor/pg_clipfrac:0.0038563079724553972 - actor/ppo_kl:-6.483040692728537e-06 - actor/pg_clipfrac_lower:5.191029777051881e-05 - actor/grad_norm:3.117770195007324 - perf/mfu/actor:0.0750337978801614 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.82311248779297 - actor/lr:1e-06 - training/global_step:391 - training/epoch:13 - critic/score/mean:0.7265625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.7265625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.1143804101720889e-08 - critic/advantages/max:2.9545209407806396 - critic/advantages/min:-3.0675177574157715 - critic/returns/mean:0.6813108921051025 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.73046875 - critic/values/max:1.203125 - critic/values/min:-0.1162109375 - critic/vf_explained_var:0.40822672843933105 - response_length/mean:275.45703125 - response_length/max:512.0 - response_length/min:136.0 - response_length/clip_ratio:0.015625 - prompt_length/mean:103.21875 - prompt_length/max:184.0 - prompt_length/min:71.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.289671778678894e-06 - timing_s/generate_sequences:3.4561047554016113 - timing_s/reshard:0.3013215959072113 - timing_s/gen:4.683746149297804 - timing_s/reward:0.03393500670790672 - timing_s/old_log_prob:2.0959991491399705 - timing_s/values:1.3468841649591923 - timing_s/adv:0.034138645976781845 - timing_s/update_critic:5.560110354796052 - timing_s/update_actor:6.942043871153146 - timing_s/step:20.704625382088125 - timing_s/stop_profile:1.966021955013275e-06 - timing_per_token_ms/values:0.013893854663756226 - timing_per_token_ms/adv:0.0003521590036907175 - timing_per_token_ms/update_actor:0.07161101980744108 - timing_per_token_ms/update_critic:0.05735561171017477 - timing_per_token_ms/gen:0.0664200993986954 - perf/total_num_tokens:96941 - perf/time_per_step:20.704625382088125 - perf/throughput:1170.5234725457178
[36m(TaskRunner pid=2914832)[0m Training Progress:  90%|████████▉ | 391/435 [2:25:11<17:31, 23.89s/it]
[36m(TaskRunner pid=2914832)[0m step:392 - global_seqlen/min:22230 - global_seqlen/max:24641 - global_seqlen/minmax_diff:2411 - global_seqlen/balanced_min:23210 - global_seqlen/balanced_max:23211 - global_seqlen/mean:23210.25 - actor/entropy:0.0485868938267231 - critic/vf_loss:0.07615928597806487 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6743386648595333 - critic/grad_norm:6.0639872550964355 - perf/mfu/critic:0.09408018514484384 - critic/lr:1e-05 - actor/pg_loss:0.22342410404235125 - actor/pg_clipfrac:0.003828490531304851 - actor/ppo_kl:-0.0002977031454065582 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.3084579706192017 - perf/mfu/actor:0.07298569628764463 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.61555480957031 - actor/lr:1e-06 - training/global_step:392 - training/epoch:13 - critic/score/mean:0.66015625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.66015625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-6.839877109143799e-09 - critic/advantages/max:2.678663492202759 - critic/advantages/min:-3.0872631072998047 - critic/returns/mean:0.6041616201400757 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.65625 - critic/values/max:1.125 - critic/values/min:-0.1279296875 - critic/vf_explained_var:0.4952118396759033 - response_length/mean:259.25 - response_length/max:512.0 - response_length/min:123.0 - response_length/clip_ratio:0.01171875 - prompt_length/mean:103.41015625 - prompt_length/max:191.0 - prompt_length/min:64.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.108063876628876e-06 - timing_s/generate_sequences:3.471470832824707 - timing_s/reshard:0.8696023225784302 - timing_s/gen:4.990642935037613 - timing_s/reward:0.03300649533048272 - timing_s/old_log_prob:2.0801225383765996 - timing_s/values:1.3452141140587628 - timing_s/adv:0.03318271692842245 - timing_s/update_critic:5.301311781164259 - timing_s/update_actor:6.828874529805034 - timing_s/step:20.619043660815805 - timing_s/stop_profile:1.5920959413051605e-06 - timing_per_token_ms/values:0.014489440161768645 - timing_per_token_ms/adv:0.0003574144712834034 - timing_per_token_ms/update_actor:0.07355451287475398 - timing_per_token_ms/update_critic:0.05710097673618615 - timing_per_token_ms/gen:0.07519652445512315 - perf/total_num_tokens:92841 - perf/time_per_step:20.619043660815805 - perf/throughput:1125.6705394202397
[36m(TaskRunner pid=2914832)[0m Training Progress:  90%|█████████ | 392/435 [2:25:32<16:25, 22.91s/it]
[36m(TaskRunner pid=2914832)[0m step:393 - global_seqlen/min:22884 - global_seqlen/max:23984 - global_seqlen/minmax_diff:1100 - global_seqlen/balanced_min:23568 - global_seqlen/balanced_max:23569 - global_seqlen/mean:23568.5 - actor/entropy:0.04810017719864845 - critic/vf_loss:0.06781151966424659 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6600169539451599 - critic/grad_norm:14.077794551849365 - perf/mfu/critic:0.09025874297828501 - critic/lr:1e-05 - actor/pg_loss:0.07630998559761792 - actor/pg_clipfrac:0.0059098124474985525 - actor/ppo_kl:0.00025397133867954835 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.2079694867134094 - perf/mfu/actor:0.0717615468373049 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.64223098754883 - actor/lr:1e-06 - training/global_step:393 - training/epoch:13 - critic/score/mean:0.73828125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.73828125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-2.8230287441033397e-08 - critic/advantages/max:2.9268476963043213 - critic/advantages/min:-2.9512720108032227 - critic/returns/mean:0.6854366064071655 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.609375 - critic/values/max:0.99609375 - critic/values/min:-0.16796875 - critic/vf_explained_var:0.4578593969345093 - response_length/mean:263.26171875 - response_length/max:512.0 - response_length/min:134.0 - response_length/clip_ratio:0.01171875 - prompt_length/mean:104.99609375 - prompt_length/max:212.0 - prompt_length/min:70.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:2.9550865292549133e-06 - timing_s/generate_sequences:3.3609824180603027 - timing_s/reshard:0.6836450695991516 - timing_s/gen:5.117261099629104 - timing_s/reward:0.03318570600822568 - timing_s/old_log_prob:2.128432512283325 - timing_s/values:1.616021275985986 - timing_s/adv:0.0331514161080122 - timing_s/update_critic:5.60989444097504 - timing_s/update_actor:7.05218409281224 - timing_s/step:21.596552553121 - timing_s/stop_profile:1.559033989906311e-06 - timing_per_token_ms/values:0.017141749326282815 - timing_per_token_ms/adv:0.0003516496182193627 - timing_per_token_ms/update_actor:0.07480518587110169 - timing_per_token_ms/update_critic:0.05950627363827821 - timing_per_token_ms/gen:0.07592938793128724 - perf/total_num_tokens:94274 - perf/time_per_step:21.596552553121 - perf/throughput:1091.308436475155
[36m(TaskRunner pid=2914832)[0m Training Progress:  90%|█████████ | 393/435 [2:25:54<15:45, 22.52s/it]
[36m(TaskRunner pid=2914832)[0m step:394 - global_seqlen/min:23607 - global_seqlen/max:24294 - global_seqlen/minmax_diff:687 - global_seqlen/balanced_min:24030 - global_seqlen/balanced_max:24031 - global_seqlen/mean:24030.5 - actor/entropy:0.049096111208200455 - critic/vf_loss:0.07272273558191955 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.5622058548033237 - critic/grad_norm:13.761119604110718 - perf/mfu/critic:0.10039461109380975 - critic/lr:1e-05 - actor/pg_loss:-0.0047995708882808685 - actor/pg_clipfrac:0.004097749275388196 - actor/ppo_kl:0.0002730947580857901 - actor/pg_clipfrac_lower:7.00672680977732e-05 - actor/grad_norm:3.0887203216552734 - perf/mfu/actor:0.07600460623522344 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.1578483581543 - actor/lr:1e-06 - training/global_step:394 - training/epoch:13 - critic/score/mean:0.7109375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.7109375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:2.744228622120204e-09 - critic/advantages/max:2.8348336219787598 - critic/advantages/min:-2.9143447875976562 - critic/returns/mean:0.6757308840751648 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.67578125 - critic/values/max:1.0703125 - critic/values/min:-0.0361328125 - critic/vf_explained_var:0.44703274965286255 - response_length/mean:271.5 - response_length/max:512.0 - response_length/min:134.0 - response_length/clip_ratio:0.015625 - prompt_length/mean:103.9765625 - prompt_length/max:222.0 - prompt_length/min:67.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.2908435463905334e-06 - timing_s/generate_sequences:3.403988838195801 - timing_s/reshard:0.864747941493988 - timing_s/gen:4.843725025188178 - timing_s/reward:0.036570372991263866 - timing_s/old_log_prob:2.076146223116666 - timing_s/values:1.353877916932106 - timing_s/adv:0.03408462228253484 - timing_s/update_critic:5.143727062735707 - timing_s/update_actor:6.79095256421715 - timing_s/step:20.285490220878273 - timing_s/stop_profile:6.618909537792206e-06 - timing_per_token_ms/values:0.014084995286532802 - timing_per_token_ms/adv:0.00035459751443514325 - timing_per_token_ms/update_actor:0.07064930571791213 - timing_per_token_ms/update_critic:0.05351248478741294 - timing_per_token_ms/gen:0.06968987432648736 - perf/total_num_tokens:96122 - perf/time_per_step:20.285490220878273 - perf/throughput:1184.6151972835876
[36m(TaskRunner pid=2914832)[0m Training Progress:  91%|█████████ | 394/435 [2:26:14<14:56, 21.86s/it]
[36m(TaskRunner pid=2914832)[0m step:395 - global_seqlen/min:22837 - global_seqlen/max:24723 - global_seqlen/minmax_diff:1886 - global_seqlen/balanced_min:23660 - global_seqlen/balanced_max:23661 - global_seqlen/mean:23660.5 - actor/entropy:0.04930770769715309 - critic/vf_loss:0.04817014712898526 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.723036527633667 - critic/grad_norm:6.371282607316971 - perf/mfu/critic:0.09312977143541953 - critic/lr:1e-05 - actor/pg_loss:-0.12902106810361147 - actor/pg_clipfrac:0.00449157680850476 - actor/ppo_kl:-0.00033928003676919616 - actor/pg_clipfrac_lower:5.028157829656266e-05 - actor/grad_norm:3.3329033255577087 - perf/mfu/actor:0.07467949139686118 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.32920455932617 - actor/lr:1e-06 - training/global_step:395 - training/epoch:13 - critic/score/mean:0.70703125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.70703125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.5434322708784975e-09 - critic/advantages/max:2.883877992630005 - critic/advantages/min:-2.9035065174102783 - critic/returns/mean:0.6529904007911682 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.64453125 - critic/values/max:1.0703125 - critic/values/min:-0.10205078125 - critic/vf_explained_var:0.46737492084503174 - response_length/mean:267.9140625 - response_length/max:512.0 - response_length/min:111.0 - response_length/clip_ratio:0.01171875 - prompt_length/mean:101.78125 - prompt_length/max:178.0 - prompt_length/min:67.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:1.2581702321767807e-05 - timing_s/generate_sequences:3.41550612449646 - timing_s/reshard:0.8551313877105713 - timing_s/gen:4.8552835886366665 - timing_s/reward:0.032795121893286705 - timing_s/old_log_prob:2.0873356917873025 - timing_s/values:1.346528559923172 - timing_s/adv:0.033105894923210144 - timing_s/update_critic:5.4579482660628855 - timing_s/update_actor:6.805951870977879 - timing_s/step:20.625239433255047 - timing_s/stop_profile:1.5739351511001587e-06 - timing_per_token_ms/values:0.01422760043028647 - timing_per_token_ms/adv:0.0003498013030494933 - timing_per_token_ms/update_actor:0.07191259558100926 - timing_per_token_ms/update_critic:0.05766940962852524 - timing_per_token_ms/gen:0.07079117587607772 - perf/total_num_tokens:94642 - perf/time_per_step:20.625239433255047 - perf/throughput:1147.162440298805
[36m(TaskRunner pid=2914832)[0m Training Progress:  91%|█████████ | 395/435 [2:26:34<14:19, 21.49s/it]
[36m(TaskRunner pid=2914832)[0m step:396 - global_seqlen/min:23816 - global_seqlen/max:25626 - global_seqlen/minmax_diff:1810 - global_seqlen/balanced_min:24503 - global_seqlen/balanced_max:24504 - global_seqlen/mean:24503.5 - actor/entropy:0.04859805107116699 - critic/vf_loss:0.06426717550493777 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6749973278492689 - critic/grad_norm:11.842865228652954 - perf/mfu/critic:0.09645332411076848 - critic/lr:1e-05 - actor/pg_loss:-0.0598622839897871 - actor/pg_clipfrac:0.003217168225091882 - actor/ppo_kl:0.00014402462511498015 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.823931574821472 - perf/mfu/actor:0.07417202766411364 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.58673477172852 - actor/lr:1e-06 - training/global_step:396 - training/epoch:13 - critic/score/mean:0.69921875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.69921875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.5505372985558097e-08 - critic/advantages/max:2.6392767429351807 - critic/advantages/min:-2.8590168952941895 - critic/returns/mean:0.6507503390312195 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.5703125 - critic/values/max:1.0625 - critic/values/min:-0.1328125 - critic/vf_explained_var:0.3826637268066406 - response_length/mean:277.73828125 - response_length/max:512.0 - response_length/min:133.0 - response_length/clip_ratio:0.01953125 - prompt_length/mean:105.12890625 - prompt_length/max:195.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.448927938938141e-06 - timing_s/generate_sequences:3.4527688026428223 - timing_s/reshard:0.5829306244850159 - timing_s/gen:4.744583674706519 - timing_s/reward:0.03360307868570089 - timing_s/old_log_prob:2.1411701971665025 - timing_s/values:1.6282604518346488 - timing_s/adv:0.0332740843296051 - timing_s/update_critic:5.463527518790215 - timing_s/update_actor:7.101290877908468 - timing_s/step:21.152110463008285 - timing_s/stop_profile:1.6116537153720856e-06 - timing_per_token_ms/values:0.01661252935126256 - timing_per_token_ms/adv:0.00033948297518318914 - timing_per_token_ms/update_actor:0.0724518015580271 - timing_per_token_ms/update_critic:0.055742317615750964 - timing_per_token_ms/gen:0.066730196125322 - perf/total_num_tokens:98014 - perf/time_per_step:21.152110463008285 - perf/throughput:1158.442323892586
[36m(TaskRunner pid=2914832)[0m Training Progress:  91%|█████████ | 396/435 [2:26:56<13:54, 21.39s/it]
[36m(TaskRunner pid=2914832)[0m step:397 - global_seqlen/min:23644 - global_seqlen/max:25550 - global_seqlen/minmax_diff:1906 - global_seqlen/balanced_min:24568 - global_seqlen/balanced_max:24569 - global_seqlen/mean:24568.5 - actor/entropy:0.04932303726673126 - critic/vf_loss:0.08917729054519441 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.7065186910331249 - critic/grad_norm:14.134379506111145 - perf/mfu/critic:0.09500875034111911 - critic/lr:1e-05 - actor/pg_loss:0.04180348198860884 - actor/pg_clipfrac:0.004000731889391318 - actor/ppo_kl:-9.394144763064105e-05 - actor/pg_clipfrac_lower:4.5126354962121695e-05 - actor/grad_norm:3.1857866048812866 - perf/mfu/actor:0.0777477953609965 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:87.2991828918457 - actor/lr:1e-06 - training/global_step:397 - training/epoch:13 - critic/score/mean:0.7109375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.7109375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-2.83730940964233e-08 - critic/advantages/max:2.3196799755096436 - critic/advantages/min:-2.799558162689209 - critic/returns/mean:0.6691447496414185 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.73046875 - critic/values/max:1.2421875 - critic/values/min:0.057373046875 - critic/vf_explained_var:0.3206706643104553 - response_length/mean:277.4296875 - response_length/max:512.0 - response_length/min:133.0 - response_length/clip_ratio:0.015625 - prompt_length/mean:106.453125 - prompt_length/max:201.0 - prompt_length/min:62.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.6740675568580627e-06 - timing_s/generate_sequences:3.4542741775512695 - timing_s/reshard:0.5817804932594299 - timing_s/gen:4.59286486171186 - timing_s/reward:0.03466844605281949 - timing_s/old_log_prob:2.078242775052786 - timing_s/values:1.340158165898174 - timing_s/adv:0.03320880280807614 - timing_s/update_critic:5.5619330098852515 - timing_s/update_actor:6.794850646983832 - timing_s/step:20.44318708218634 - timing_s/stop_profile:2.2170133888721466e-06 - timing_per_token_ms/values:0.013636955511103385 - timing_per_token_ms/adv:0.00033792053654146714 - timing_per_token_ms/update_actor:0.0691418955876817 - timing_per_token_ms/update_critic:0.056596180168561896 - timing_per_token_ms/gen:0.0646681994552654 - perf/total_num_tokens:98274 - perf/time_per_step:20.44318708218634 - perf/throughput:1201.7940207282234
[36m(TaskRunner pid=2914832)[0m Training Progress:  91%|█████████▏| 397/435 [2:27:16<13:22, 21.11s/it]
[36m(TaskRunner pid=2914832)[0m step:398 - global_seqlen/min:23240 - global_seqlen/max:25466 - global_seqlen/minmax_diff:2226 - global_seqlen/balanced_min:24219 - global_seqlen/balanced_max:24220 - global_seqlen/mean:24219.25 - actor/entropy:0.049316324293613434 - critic/vf_loss:0.07698453968623653 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.6790536288172007 - critic/grad_norm:5.790328741073608 - perf/mfu/critic:0.09434881900940342 - critic/lr:1e-05 - actor/pg_loss:0.16529905376955867 - actor/pg_clipfrac:0.004071818068041466 - actor/ppo_kl:8.882386634923023e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.289848268032074 - perf/mfu/actor:0.07269589301711643 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.61106872558594 - actor/lr:1e-06 - training/global_step:398 - training/epoch:13 - critic/score/mean:0.734375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.734375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-6.038916033901387e-09 - critic/advantages/max:2.2835757732391357 - critic/advantages/min:-3.1423211097717285 - critic/returns/mean:0.7043806910514832 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.65625 - critic/values/max:1.1484375 - critic/values/min:0.055419921875 - critic/vf_explained_var:0.3814995288848877 - response_length/mean:274.8203125 - response_length/max:512.0 - response_length/min:118.0 - response_length/clip_ratio:0.0078125 - prompt_length/mean:103.60546875 - prompt_length/max:256.0 - prompt_length/min:67.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.609581083059311e-06 - timing_s/generate_sequences:3.39121150970459 - timing_s/reshard:0.8937760591506958 - timing_s/gen:5.092817103955895 - timing_s/reward:0.03357265889644623 - timing_s/old_log_prob:2.3999313237145543 - timing_s/values:1.757003415375948 - timing_s/adv:0.03278070688247681 - timing_s/update_critic:5.517284983303398 - timing_s/update_actor:7.157680708914995 - timing_s/step:21.99723033281043 - timing_s/stop_profile:2.345070242881775e-06 - timing_per_token_ms/values:0.018136435019415836 - timing_per_token_ms/adv:0.00033837450460353654 - timing_per_token_ms/update_actor:0.0738842109986374 - timing_per_token_ms/update_critic:0.056951443410751756 - timing_per_token_ms/gen:0.07238845131699541 - perf/total_num_tokens:96877 - perf/time_per_step:21.99723033281043 - perf/throughput:1101.0136109669802
[36m(TaskRunner pid=2914832)[0m Training Progress:  91%|█████████▏| 398/435 [2:27:38<13:10, 21.38s/it]
[36m(TaskRunner pid=2914832)[0m step:399 - global_seqlen/min:22339 - global_seqlen/max:25044 - global_seqlen/minmax_diff:2705 - global_seqlen/balanced_min:23983 - global_seqlen/balanced_max:23984 - global_seqlen/mean:23983.25 - actor/entropy:0.048271987587213516 - critic/vf_loss:0.0673345529648941 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.7110986411571503 - critic/grad_norm:16.695727825164795 - perf/mfu/critic:0.09966075574812022 - critic/lr:1e-05 - actor/pg_loss:-0.140591771050822 - actor/pg_clipfrac:0.004131125046114903 - actor/ppo_kl:0.0002763371776381973 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.0862053632736206 - perf/mfu/actor:0.07584519440484819 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.4435806274414 - actor/lr:1e-06 - training/global_step:399 - training/epoch:13 - critic/score/mean:0.6796875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.6796875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.8993858930116403e-08 - critic/advantages/max:2.3401918411254883 - critic/advantages/min:-2.5850272178649902 - critic/returns/mean:0.6348088979721069 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.79296875 - critic/values/max:1.2109375 - critic/values/min:0.1767578125 - critic/vf_explained_var:0.36573082208633423 - response_length/mean:271.34765625 - response_length/max:512.0 - response_length/min:118.0 - response_length/clip_ratio:0.0078125 - prompt_length/mean:103.390625 - prompt_length/max:211.0 - prompt_length/min:56.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.628898411989212e-06 - timing_s/generate_sequences:3.323385000228882 - timing_s/reshard:0.8566383123397827 - timing_s/gen:4.729437841102481 - timing_s/reward:0.03369663981720805 - timing_s/old_log_prob:2.078434126917273 - timing_s/values:1.3507337411865592 - timing_s/adv:0.034772587940096855 - timing_s/update_critic:5.173316049855202 - timing_s/update_actor:6.795277405995876 - timing_s/step:20.20293996622786 - timing_s/stop_profile:1.8910504877567291e-06 - timing_per_token_ms/values:0.014079969782937667 - timing_per_token_ms/adv:0.00036246742976970235 - timing_per_token_ms/update_actor:0.07083357557874637 - timing_per_token_ms/update_critic:0.053926344947569683 - timing_per_token_ms/gen:0.06808375212124783 - perf/total_num_tokens:95933 - perf/time_per_step:20.20293996622786 - perf/throughput:1187.1168275553696
[36m(TaskRunner pid=2914832)[0m Training Progress:  92%|█████████▏| 399/435 [2:27:58<12:37, 21.03s/it]
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 400}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and bakes muffins for her friends every day with four. She sells the remainder at the farmers' market daily for $2 per fresh duck egg. How much in dollars does she make every day at the farmers' market? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much Janet makes every day from selling the eggs, we will follow these steps:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. Calculate the number of eggs Janet lays in a day.
[36m(TaskRunner pid=2914832)[0m 2. Subtract the number of eggs she eats in a day.
[36m(TaskRunner pid=2914832)[0m 3. Subtract the number of eggs she bakes.
[36m(TaskRunner pid=2914832)[0m 4. Sell the remaining eggs at the farmers' market.
[36m(TaskRunner pid=2914832)[0m 5. Determine the amount earned from selling the eggs.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m First, Janet's ducks lay 16 eggs per day. She eats 3 eggs for breakfast and bakes 4 eggs for her friends every day. Therefore, the number of eggs she eats in a day is:
[36m(TaskRunner pid=2914832)[0m \[ 3 + 4 = 7 \text{ eggs} \]
[36m(TaskRunner pid=2914832)[0m The number of eggs she sells at the farmers' market is the remainder after subtracting the eggs she eats and the eggs she bakes. Therefore, the number of eggs she sells in a day is:
[36m(TaskRunner pid=2914832)[0m \[ 16 - 7 = 9 \text{ eggs} \]
[36m(TaskRunner pid=2914832)[0m Since she sells each egg for $2, the amount of money she makes in a day is:
[36m(TaskRunner pid=2914832)[0m \[ 9 \times 2 = 18 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Therefore, the final answer is:
[36m(TaskRunner pid=2914832)[0m \[
[36m(TaskRunner pid=2914832)[0m \boxed{18}
[36m(TaskRunner pid=2914832)[0m \]
[36m(TaskRunner pid=2914832)[0m #### 18
[36m(TaskRunner pid=2914832)[0m [ground_truth] 18
[36m(TaskRunner pid=2914832)[0m [score] 1.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1312
[36m(TaskRunner pid=2914832)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 400}
[36m(TaskRunner pid=2914832)[0m validation generation end
[36m(TaskRunner pid=2914832)[0m [prompt] system
[36m(TaskRunner pid=2914832)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=2914832)[0m user
[36m(TaskRunner pid=2914832)[0m Tom's restaurant gets 6 reservations a night.  They normally order 2 meals that cost $5 each and a $5 bottle of wine.  How much do they make a week if they are open 2 days a week? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=2914832)[0m assistant
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m [response] To determine how much Tom's restaurant makes a week, we need to follow these steps:
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m 1. Calculate the number of reservations per day.
[36m(TaskRunner pid=2914832)[0m 2. Determine the revenue from reservations per day.
[36m(TaskRunner pid=2914832)[0m 3. Find the total revenue for the week.
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m First, Tom's restaurant gets 6 reservations a night. If they are open 2 days a week, the number of reservations per week is:
[36m(TaskRunner pid=2914832)[0m \[ 6 \times 2 = 12 \text{ reservations per week} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Next, the restaurant orders 2 meals that cost $5 each and a $5 bottle of wine. The total revenue from the meals is:
[36m(TaskRunner pid=2914832)[0m \[ 2 \times 5 = 10 \text{ dollars from meals per week} \]
[36m(TaskRunner pid=2914832)[0m The revenue from the wine is:
[36m(TaskRunner pid=2914832)[0m \[ 5 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m So, the total revenue from the meals and the wine is:
[36m(TaskRunner pid=2914832)[0m \[ 10 + 5 = 15 \text{ dollars from meals and wine per week} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Therefore, the total revenue for the week is:
[36m(TaskRunner pid=2914832)[0m \[ 15 \text{ dollars} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m Thus, the final answer is:
[36m(TaskRunner pid=2914832)[0m \[ \boxed{15} \]
[36m(TaskRunner pid=2914832)[0m 
[36m(TaskRunner pid=2914832)[0m #### 15
[36m(TaskRunner pid=2914832)[0m [ground_truth] 180
[36m(TaskRunner pid=2914832)[0m [score] 0.0
[36m(TaskRunner pid=2914832)[0m len reward_extra_infos_dict['reward']: 1319
[36m(TaskRunner pid=2914832)[0m step:400 - global_seqlen/min:23753 - global_seqlen/max:25486 - global_seqlen/minmax_diff:1733 - global_seqlen/balanced_min:24531 - global_seqlen/balanced_max:24532 - global_seqlen/mean:24531.75 - actor/entropy:0.049047525972127914 - critic/vf_loss:0.08133965381421149 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.5285587999969721 - critic/grad_norm:24.00042700767517 - perf/mfu/critic:0.09219647568016216 - critic/lr:1e-05 - actor/pg_loss:-0.12383441510610282 - actor/pg_clipfrac:0.003338126181915868 - actor/ppo_kl:-0.00014753357481822604 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.210767686367035 - perf/mfu/actor:0.07576505040078896 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:88.65291213989258 - actor/lr:1e-06 - val-core/openai/gsm8k/reward/mean@1:0.5617892342683851 - training/global_step:400 - training/epoch:13 - critic/score/mean:0.69921875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.69921875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:3.440262474896372e-08 - critic/advantages/max:2.296309232711792 - critic/advantages/min:-2.4939980506896973 - critic/returns/mean:0.6414262056350708 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.45703125 - critic/values/max:0.83203125 - critic/values/min:-0.1181640625 - critic/vf_explained_var:0.37993162870407104 - response_length/mean:279.80859375 - response_length/max:512.0 - response_length/min:142.0 - response_length/clip_ratio:0.02734375 - prompt_length/mean:103.5 - prompt_length/max:184.0 - prompt_length/min:63.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.804002285003662e-06 - timing_s/generate_sequences:3.5669362545013428 - timing_s/reshard:0.8530307412147522 - timing_s/gen:5.433235161006451 - timing_s/reward:0.034539426676929 - timing_s/old_log_prob:2.139381050132215 - timing_s/values:1.613422708120197 - timing_s/adv:0.03340757358819246 - timing_s/update_critic:5.723850470967591 - timing_s/update_actor:6.96134978486225 - timing_s/testing:13.85574358701706 - timing_s/step:35.801605759654194 - timing_s/stop_profile:2.0121224224567413e-06 - timing_per_token_ms/values:0.016442189286538844 - timing_per_token_ms/adv:0.000340452409512086 - timing_per_token_ms/update_actor:0.07094224611842052 - timing_per_token_ms/update_critic:0.05833104518600987 - timing_per_token_ms/gen:0.07585033241203461 - perf/total_num_tokens:98127 - perf/time_per_step:35.801605759654194 - perf/throughput:685.2136790927266
[36m(TaskRunner pid=2914832)[0m Training Progress:  92%|█████████▏| 400/435 [2:28:34<14:51, 25.46s/it]
[36m(TaskRunner pid=2914832)[0m step:401 - global_seqlen/min:22848 - global_seqlen/max:24603 - global_seqlen/minmax_diff:1755 - global_seqlen/balanced_min:23504 - global_seqlen/balanced_max:23505 - global_seqlen/mean:23504.5 - actor/entropy:0.050013646483421326 - critic/vf_loss:0.0868833542772336 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.8651888407766819 - critic/grad_norm:37.400322914123535 - perf/mfu/critic:0.09364994818859942 - critic/lr:1e-05 - actor/pg_loss:-0.10911199051770382 - actor/pg_clipfrac:0.005209825583733618 - actor/ppo_kl:8.503977710461186e-06 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.346805155277252 - perf/mfu/actor:0.0704646384134633 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:90.1932601928711 - actor/lr:1e-06 - training/global_step:401 - training/epoch:13 - critic/score/mean:0.73046875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.73046875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-1.9767612546850444e-10 - critic/advantages/max:2.4251227378845215 - critic/advantages/min:-2.619431495666504 - critic/returns/mean:0.6778004765510559 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.72265625 - critic/values/max:1.0625 - critic/values/min:0.055419921875 - critic/vf_explained_var:0.38185012340545654 - response_length/mean:263.8359375 - response_length/max:512.0 - response_length/min:131.0 - response_length/clip_ratio:0.01953125 - prompt_length/mean:103.421875 - prompt_length/max:190.0 - prompt_length/min:68.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.402121365070343e-06 - timing_s/generate_sequences:3.3919315338134766 - timing_s/reshard:0.30021747946739197 - timing_s/gen:4.537669544108212 - timing_s/reward:0.03364615608006716 - timing_s/old_log_prob:2.0828827037476003 - timing_s/values:1.3446320611983538 - timing_s/adv:0.03358098492026329 - timing_s/update_critic:5.392393231857568 - timing_s/update_actor:7.162636013235897 - timing_s/step:20.5950693981722 - timing_s/stop_profile:2.398621290922165e-06 - timing_per_token_ms/values:0.014301857742116975 - timing_per_token_ms/adv:0.0003571761250001414 - timing_per_token_ms/update_actor:0.07618366709817159 - timing_per_token_ms/update_critic:0.05735490259160552 - timing_per_token_ms/gen:0.06718293127399562 - perf/total_num_tokens:94018 - perf/time_per_step:20.5950693981722 - perf/throughput:1141.2683077477764
[36m(TaskRunner pid=2914832)[0m Training Progress:  92%|█████████▏| 401/435 [2:28:55<13:36, 24.01s/it]
[36m(TaskRunner pid=2914832)[0m step:402 - global_seqlen/min:24776 - global_seqlen/max:24972 - global_seqlen/minmax_diff:196 - global_seqlen/balanced_min:24882 - global_seqlen/balanced_max:24883 - global_seqlen/mean:24882.25 - actor/entropy:0.04831714928150177 - critic/vf_loss:0.08234291909320746 - critic/vf_clipfrac:0.0 - critic/vpred_mean:0.8796724826097488 - critic/grad_norm:28.73870611190796 - perf/mfu/critic:0.10278791570216926 - critic/lr:1e-05 - actor/pg_loss:0.03538735071197152 - actor/pg_clipfrac:0.0035347460507182404 - actor/ppo_kl:0.00025912134333339054 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.0894073247909546 - perf/mfu/actor:0.07891825791174178 - perf/max_memory_allocated_gb:34.07566833496094 - perf/max_memory_reserved_gb:40.74609375 - perf/cpu_memory_used_gb:89.55192184448242 - actor/lr:1e-06 - training/global_step:402 - training/epoch:13 - critic/score/mean:0.7109375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.7109375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:7.0577312882846854e-09 - critic/advantages/max:2.374939441680908 - critic/advantages/min:-2.4886698722839355 - critic/returns/mean:0.6585953831672668 - critic/returns/max:1.0 - critic/returns/min:0.0 - critic/values/mean:0.98828125 - critic/values/max:1.296875 - critic/values/min:0.314453125 - critic/vf_explained_var:0.358182430267334 - response_length/mean:283.4453125 - response_length/max:512.0 - response_length/min:133.0 - response_length/clip_ratio:0.0234375 - prompt_length/mean:105.33984375 - prompt_length/max:201.0 - prompt_length/min:65.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.283858627080917e-06 - timing_s/generate_sequences:3.7910590171813965 - timing_s/reshard:0.581477165222168 - timing_s/gen:5.021078305784613 - timing_s/reward:0.03409002022817731 - timing_s/old_log_prob:2.0703155887313187 - timing_s/values:1.3494947678409517 - timing_s/adv:0.0331962569616735 - timing_s/update_critic:5.208978557027876 - timing_s/update_actor:6.780607700813562 - timing_s/step:20.5070605808869 - timing_s/stop_profile:1.7709098756313324e-06 - timing_per_token_ms/values:0.01355880967196447 - timing_per_token_ms/adv:0.0003335335124604236 - timing_per_token_ms/update_actor:0.0681269549660256 - timing_per_token_ms/update_critic:0.052336289493794534 - timing_per_token_ms/gen:0.06919707706216219 - perf/total_num_tokens:99529 - perf/time_per_step:20.5070605808869 - perf/throughput:1213.3503922639643
[36m(TaskRunner pid=2914832)[0m Training Progress:  92%|█████████▏| 402/435 [2:29:15<12:37, 22.96s/it]
